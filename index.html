<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>K-12 Tradeoffs</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="results_files/libs/clipboard/clipboard.min.js"></script>
<script src="results_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="results_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="results_files/libs/quarto-html/popper.min.js"></script>
<script src="results_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="results_files/libs/quarto-html/anchor.min.js"></script>
<link href="results_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="results_files/libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="results_files/libs/quarto-html/quarto-syntax-highlighting-dark-2fef5ea3f8957b3e4ecc936fc74692ca.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="results_files/libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="results_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="results_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="results_files/libs/bootstrap/bootstrap-e34e999c5ec40446cda825c9d876ac62.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="results_files/libs/bootstrap/bootstrap-dark-e34e999c5ec40446cda825c9d876ac62.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="light">
<link href="results_files/libs/bootstrap/bootstrap-e34e999c5ec40446cda825c9d876ac62.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light">
<script src="results_files/libs/quarto-dashboard/quarto-dashboard.js"></script>
<script src="results_files/libs/quarto-dashboard/stickythead.js"></script>



<script src="results_files/libs/quarto-dashboard/web-components.js" type="module"></script>
<script src="results_files/libs/quarto-dashboard/components.js"></script>

<script type="module" src="results_files/libs/quarto-ojs/quarto-ojs-runtime.js"></script>
<link href="results_files/libs/quarto-ojs/quarto-ojs.css" rel="stylesheet">
<style>
  .quarto-dashboard .sidebar form {
    margin-bottom: 0.1em;
  }
  .sidebar-section-header p {
    margin-bottom: 0.1em;
    margin-top: 1em;
  }
  .sidebar-section-header p::before {
    content: "";
    display: block;
    border-top: 1px solid black;
    width: 100%;
  }
  #bslib-sidebar-1 {
    position: sticky;
    top: 0;
    width: 170px;
  }
  .observablehq--string {color: white;}
</style>


</head>

<body class="quarto-dashboard dashboard-fill dashboard-sidebar fullcontent quarto-light">

<header id="quarto-dashboard-header">
<nav class="navbar navbar-expand-md slim" data-bs-theme="dark">
  <div class="navbar-container container-fluid">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#dashboard-collapse" aria-controls="dashboard-collapse" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>    


    <div class="navbar-brand-container">       

      <div class="navbar-title">
        <div class="navbar-title-text"><a href="#">K-12 Tradeoffs</a></div>
        
        
      </div>
    </div>
<div id="dashboard-collapse" class="navbar-collapse collapse"><ul class="navbar-nav navbar-nav-scroll me-auto" role="tablist"><li class="nav-item" role="presentation"><a id="tab-overall" class="nav-link active" data-bs-toggle="tab" role="tab" data-bs-target="#overall" data-scrolling="false" href="#overall" aria-controls="overall" aria-selected="true"><span class="nav-link-text">Overall</span></a></li><li class="nav-item" role="presentation"><a id="tab-treatment-timing-groups" class="nav-link" data-bs-toggle="tab" role="tab" data-bs-target="#treatment-timing-groups" data-scrolling="true" href="#treatment-timing-groups" aria-controls="treatment-timing-groups" aria-selected="false"><span class="nav-link-text">Treatment Timing Groups</span></a></li><li class="nav-item" role="presentation"><a id="tab-individual-states" class="nav-link" data-bs-toggle="tab" role="tab" data-bs-target="#individual-states" data-scrolling="true" href="#individual-states" aria-controls="individual-states" aria-selected="false"><span class="nav-link-text">Individual States</span></a></li></ul></div></div>
</nav>
</header>
<div class="page-layout-custom quarto-dashboard-content bslib-gap-spacing html-fill-container bslib-page-fill quarto-dashboard-pages dashboard-sidebar-container">  

<div class="cell hidden bslib-grid-item html-fill-item">
<div class="sourceCode cell-code hidden" id="cb1" data-startfrom="34" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 33;"><span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>d3 <span class="op">=</span> <span class="pp">require</span>(<span class="st">'d3@7'</span>)<span class="op">;</span></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> { aq } <span class="im">from</span> <span class="st">'@uwdata/arquero'</span><span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-1-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-1-2" data-nodetype="declaration">

</div>
</div>
</div>
</div>
<div class="cell hidden bslib-grid-item html-fill-item">
<div class="sourceCode cell-code hidden" id="cb2" data-startfrom="44" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 43;"><span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a>dataAllStates0 <span class="op">=</span> aq<span class="op">.</span><span class="fu">loadArrow</span>(<span class="st">'data/treat-groups_all-data.arrow'</span>)<span class="op">;</span></span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a>dataTreatMeans0 <span class="op">=</span> aq<span class="op">.</span><span class="fu">loadArrow</span>(<span class="st">'data/treat_means.arrow'</span>)<span class="op">;</span></span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a>dataCtrlMeansDiD0 <span class="op">=</span> aq<span class="op">.</span><span class="fu">loadArrow</span>(<span class="st">'data/did_ctrl_means.arrow'</span>)<span class="op">;</span></span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a>dataCtrlMeansSynth0 <span class="op">=</span> aq<span class="op">.</span><span class="fu">loadArrow</span>(<span class="st">'data/synth_ctrl_means.arrow'</span>)<span class="op">;</span></span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a>dataCtrlStatesDiD0 <span class="op">=</span> aq<span class="op">.</span><span class="fu">loadArrow</span>(<span class="st">'data/did_ctrl_states.arrow'</span>)<span class="op">;</span></span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a>dataCtrlStatesSynth0 <span class="op">=</span> aq<span class="op">.</span><span class="fu">loadArrow</span>(<span class="st">'data/synth_ctrl_states.arrow'</span>)<span class="op">;</span></span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a>dataResSynth0 <span class="op">=</span> aq<span class="op">.</span><span class="fu">loadArrow</span>(<span class="st">'data/synth_res.arrow'</span>)<span class="op">;</span></span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a>dataResDiD0 <span class="op">=</span> aq<span class="op">.</span><span class="fu">loadArrow</span>(<span class="st">'data/did_res.arrow'</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-2-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-2-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-2-3" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-2-4" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-2-5" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-2-6" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-2-7" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-2-8" data-nodetype="declaration">

</div>
</div>
</div>
</div>
<div class="cell hidden bslib-grid-item html-fill-item">
<div class="sourceCode cell-code hidden" id="cb3" data-startfrom="56" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 55;"><span id="cb3-56"><a href="#cb3-56" aria-hidden="true" tabindex="-1"></a>dataAllStates <span class="op">=</span> dataAllStates0<span class="op">.</span><span class="fu">objects</span>()<span class="op">;</span></span>
<span id="cb3-57"><a href="#cb3-57" aria-hidden="true" tabindex="-1"></a>dataTreatMeans <span class="op">=</span> dataTreatMeans0<span class="op">.</span><span class="fu">objects</span>()<span class="op">;</span></span>
<span id="cb3-58"><a href="#cb3-58" aria-hidden="true" tabindex="-1"></a>dataCtrlMeansDiD <span class="op">=</span> dataCtrlMeansDiD0<span class="op">.</span><span class="fu">objects</span>()<span class="op">;</span></span>
<span id="cb3-59"><a href="#cb3-59" aria-hidden="true" tabindex="-1"></a>dataCtrlMeansSynth <span class="op">=</span> dataCtrlMeansSynth0<span class="op">.</span><span class="fu">objects</span>()<span class="op">;</span></span>
<span id="cb3-60"><a href="#cb3-60" aria-hidden="true" tabindex="-1"></a>dataCtrlStatesDiD <span class="op">=</span> dataCtrlStatesDiD0<span class="op">.</span><span class="fu">objects</span>()<span class="op">;</span></span>
<span id="cb3-61"><a href="#cb3-61" aria-hidden="true" tabindex="-1"></a>dataCtrlStatesSynth <span class="op">=</span> dataCtrlStatesSynth0<span class="op">.</span><span class="fu">objects</span>()<span class="op">;</span></span>
<span id="cb3-62"><a href="#cb3-62" aria-hidden="true" tabindex="-1"></a>dataResSynth <span class="op">=</span> dataResSynth0<span class="op">.</span><span class="fu">objects</span>()<span class="op">;</span></span>
<span id="cb3-63"><a href="#cb3-63" aria-hidden="true" tabindex="-1"></a>dataResDiD <span class="op">=</span> dataResDiD0<span class="op">.</span><span class="fu">objects</span>()<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-3-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-3-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-3-3" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-3-4" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-3-5" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-3-6" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-3-7" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-3-8" data-nodetype="declaration">

</div>
</div>
</div>
</div>
<div class="cell hidden bslib-grid-item html-fill-item">
<div class="sourceCode cell-code hidden" id="cb4" data-startfrom="71" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 70;"><span id="cb4-71"><a href="#cb4-71" aria-hidden="true" tabindex="-1"></a>outcomeName <span class="op">=</span> fe <span class="op">?</span> selectedOutcome <span class="op">+</span> <span class="st">'_fe'</span> <span class="op">:</span> selectedOutcome<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display hidden">
<div id="ojs-cell-4" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell hidden bslib-grid-item html-fill-item">
<div class="sourceCode cell-code hidden" id="cb5" data-startfrom="76" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 75;"><span id="cb5-76"><a href="#cb5-76" aria-hidden="true" tabindex="-1"></a>dataTreatMeansUse <span class="op">=</span> {</span>
<span id="cb5-77"><a href="#cb5-77" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> dataFilt <span class="op">=</span> dataTreatMeans<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">treat_spec</span> <span class="op">===</span> treatSpec)<span class="op">;</span></span>
<span id="cb5-78"><a href="#cb5-78" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (dropAK) {</span>
<span id="cb5-79"><a href="#cb5-79" aria-hidden="true" tabindex="-1"></a>    dataFilt <span class="op">=</span> dataFilt<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">treat_group</span> <span class="op">!==</span> <span class="st">'2000'</span>)<span class="op">;</span></span>
<span id="cb5-80"><a href="#cb5-80" aria-hidden="true" tabindex="-1"></a>    dataFilt <span class="op">=</span> dataFilt<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> </span>
<span id="cb5-81"><a href="#cb5-81" aria-hidden="true" tabindex="-1"></a>      d<span class="op">.</span><span class="at">treat_group</span> <span class="op">===</span> <span class="st">'2000 no ak'</span> <span class="op">?</span> {<span class="op">...</span>d<span class="op">,</span> <span class="dt">treat_group</span><span class="op">:</span> <span class="st">'2000'</span>} <span class="op">:</span> d</span>
<span id="cb5-82"><a href="#cb5-82" aria-hidden="true" tabindex="-1"></a>    )<span class="op">;</span></span>
<span id="cb5-83"><a href="#cb5-83" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb5-84"><a href="#cb5-84" aria-hidden="true" tabindex="-1"></a>    dataFilt <span class="op">=</span> dataFilt<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">treat_group</span> <span class="op">!==</span> <span class="st">'2000 no ak'</span>)<span class="op">;</span></span>
<span id="cb5-85"><a href="#cb5-85" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb5-86"><a href="#cb5-86" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> dataNonAgg <span class="op">=</span> dataFilt<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> <span class="ss">/</span><span class="sc">\d\d\d\d</span><span class="ss">/</span><span class="op">.</span><span class="fu">test</span>(d<span class="op">.</span><span class="at">treat_group</span>))<span class="op">;</span></span>
<span id="cb5-87"><a href="#cb5-87" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="ss">/</span><span class="sc">\d</span><span class="ss">/</span><span class="op">.</span><span class="fu">test</span>(stacked)) {</span>
<span id="cb5-88"><a href="#cb5-88" aria-hidden="true" tabindex="-1"></a>    dataNonAgg <span class="op">=</span> dataNonAgg<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> </span>
<span id="cb5-89"><a href="#cb5-89" aria-hidden="true" tabindex="-1"></a>      d<span class="op">.</span><span class="at">year</span> <span class="op">&lt;</span> <span class="bu">Number</span>(d<span class="op">.</span><span class="at">treat_group</span>) <span class="op">+</span> <span class="bu">Number</span>(stacked)</span>
<span id="cb5-90"><a href="#cb5-90" aria-hidden="true" tabindex="-1"></a>    )<span class="op">;</span></span>
<span id="cb5-91"><a href="#cb5-91" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb5-92"><a href="#cb5-92" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> dataAgg <span class="op">=</span> dataFilt<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> <span class="ss">/aggregate/</span><span class="op">.</span><span class="fu">test</span>(d<span class="op">.</span><span class="at">treat_group</span>))<span class="op">;</span></span>
<span id="cb5-93"><a href="#cb5-93" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> dataOut <span class="op">=</span> [<span class="op">...</span>dataNonAgg<span class="op">,</span> <span class="op">...</span>dataAgg]<span class="op">;</span></span>
<span id="cb5-94"><a href="#cb5-94" aria-hidden="true" tabindex="-1"></a>  dataOut <span class="op">=</span> dataOut<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> ({</span>
<span id="cb5-95"><a href="#cb5-95" aria-hidden="true" tabindex="-1"></a>    <span class="dt">treat_group</span><span class="op">:</span> d<span class="op">.</span><span class="at">treat_group</span><span class="op">,</span> <span class="dt">year</span><span class="op">:</span> d<span class="op">.</span><span class="at">year</span><span class="op">,</span> <span class="dt">e</span><span class="op">:</span> d<span class="op">.</span><span class="at">e</span><span class="op">,</span> <span class="dt">outcome</span><span class="op">:</span> d[outcomeName]</span>
<span id="cb5-96"><a href="#cb5-96" aria-hidden="true" tabindex="-1"></a>  }))<span class="op">;</span></span>
<span id="cb5-97"><a href="#cb5-97" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> dataOut<span class="op">;</span></span>
<span id="cb5-98"><a href="#cb5-98" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display hidden">
<div id="ojs-cell-5" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell hidden bslib-grid-item html-fill-item">
<div class="sourceCode cell-code hidden" id="cb6" data-startfrom="103" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 102;"><span id="cb6-103"><a href="#cb6-103" aria-hidden="true" tabindex="-1"></a>dataCtrlMeansDiDUse <span class="op">=</span> {</span>
<span id="cb6-104"><a href="#cb6-104" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> dataFilt <span class="op">=</span> dataCtrlMeansDiD<span class="op">.</span><span class="fu">filter</span>(</span>
<span id="cb6-105"><a href="#cb6-105" aria-hidden="true" tabindex="-1"></a>    d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">ctrl_spec</span> <span class="op">===</span> ctrlSpecDiD <span class="op">&amp;&amp;</span> d<span class="op">.</span><span class="at">treat_spec</span> <span class="op">===</span> treatSpec</span>
<span id="cb6-106"><a href="#cb6-106" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb6-107"><a href="#cb6-107" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> dataOut <span class="op">=</span> dataFilt<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> ({</span>
<span id="cb6-108"><a href="#cb6-108" aria-hidden="true" tabindex="-1"></a>    <span class="dt">treat_group</span><span class="op">:</span> d<span class="op">.</span><span class="at">treat_group</span><span class="op">,</span> <span class="dt">year</span><span class="op">:</span> d<span class="op">.</span><span class="at">year</span><span class="op">,</span> <span class="dt">e</span><span class="op">:</span> d<span class="op">.</span><span class="at">e</span><span class="op">,</span> <span class="dt">outcome</span><span class="op">:</span> d[outcomeName]</span>
<span id="cb6-109"><a href="#cb6-109" aria-hidden="true" tabindex="-1"></a>  }))<span class="op">;</span></span>
<span id="cb6-110"><a href="#cb6-110" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> dataOut<span class="op">;</span></span>
<span id="cb6-111"><a href="#cb6-111" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display hidden">
<div id="ojs-cell-6" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell hidden bslib-grid-item html-fill-item">
<div class="sourceCode cell-code hidden" id="cb7" data-startfrom="116" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 115;"><span id="cb7-116"><a href="#cb7-116" aria-hidden="true" tabindex="-1"></a>dataCtrlMeansSynthUse <span class="op">=</span> {</span>
<span id="cb7-117"><a href="#cb7-117" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> dataFilt <span class="op">=</span> dataCtrlMeansSynth<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> </span>
<span id="cb7-118"><a href="#cb7-118" aria-hidden="true" tabindex="-1"></a>    d<span class="op">.</span><span class="at">ctrl_spec</span> <span class="op">===</span> ctrlSpecSynth <span class="op">&amp;&amp;</span> d<span class="op">.</span><span class="at">treat_spec</span> <span class="op">===</span> treatSpec</span>
<span id="cb7-119"><a href="#cb7-119" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb7-120"><a href="#cb7-120" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (dropAK) {</span>
<span id="cb7-121"><a href="#cb7-121" aria-hidden="true" tabindex="-1"></a>    dataFilt <span class="op">=</span> dataFilt<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">treat_group</span> <span class="op">!==</span> <span class="st">'2000'</span>)<span class="op">;</span></span>
<span id="cb7-122"><a href="#cb7-122" aria-hidden="true" tabindex="-1"></a>    dataFilt <span class="op">=</span> dataFilt<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> </span>
<span id="cb7-123"><a href="#cb7-123" aria-hidden="true" tabindex="-1"></a>      d<span class="op">.</span><span class="at">treat_group</span> <span class="op">===</span> <span class="st">'2000 no ak'</span> <span class="op">?</span> {<span class="op">...</span>d<span class="op">,</span> <span class="dt">treat_group</span><span class="op">:</span> <span class="st">'2000'</span>} <span class="op">:</span> d</span>
<span id="cb7-124"><a href="#cb7-124" aria-hidden="true" tabindex="-1"></a>    )<span class="op">;</span></span>
<span id="cb7-125"><a href="#cb7-125" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb7-126"><a href="#cb7-126" aria-hidden="true" tabindex="-1"></a>    dataFilt <span class="op">=</span> dataFilt<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">treat_group</span> <span class="op">!==</span> <span class="st">'2000 no ak'</span>)<span class="op">;</span></span>
<span id="cb7-127"><a href="#cb7-127" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb7-128"><a href="#cb7-128" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> dataOut <span class="op">=</span> dataFilt<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> ({</span>
<span id="cb7-129"><a href="#cb7-129" aria-hidden="true" tabindex="-1"></a>    <span class="dt">treat_group</span><span class="op">:</span> d<span class="op">.</span><span class="at">treat_group</span><span class="op">,</span> <span class="dt">year</span><span class="op">:</span> d<span class="op">.</span><span class="at">year</span><span class="op">,</span> <span class="dt">e</span><span class="op">:</span> d<span class="op">.</span><span class="at">e</span><span class="op">,</span> <span class="dt">outcome</span><span class="op">:</span> d[outcomeName]</span>
<span id="cb7-130"><a href="#cb7-130" aria-hidden="true" tabindex="-1"></a>  }))<span class="op">;</span></span>
<span id="cb7-131"><a href="#cb7-131" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> dataOut<span class="op">;</span></span>
<span id="cb7-132"><a href="#cb7-132" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display hidden">
<div id="ojs-cell-7" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell hidden bslib-grid-item html-fill-item">
<div class="sourceCode cell-code hidden" id="cb8" data-startfrom="137" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 136;"><span id="cb8-137"><a href="#cb8-137" aria-hidden="true" tabindex="-1"></a>dataAllStatesUse <span class="op">=</span> {</span>
<span id="cb8-138"><a href="#cb8-138" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> dataFilt <span class="op">=</span> dataAllStates<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span></span>
<span id="cb8-139"><a href="#cb8-139" aria-hidden="true" tabindex="-1"></a>    d<span class="op">.</span><span class="at">treat_spec</span> <span class="op">===</span> treatSpec</span>
<span id="cb8-140"><a href="#cb8-140" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb8-141"><a href="#cb8-141" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (dropAK) dataFilt <span class="op">=</span> dataFilt<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">st</span> <span class="op">!==</span> <span class="st">'AK'</span>)<span class="op">;</span></span>
<span id="cb8-142"><a href="#cb8-142" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="ss">/</span><span class="sc">\d</span><span class="ss">/</span><span class="op">.</span><span class="fu">test</span>(stacked)) {</span>
<span id="cb8-143"><a href="#cb8-143" aria-hidden="true" tabindex="-1"></a>    dataFilt <span class="op">=</span> dataFilt<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> </span>
<span id="cb8-144"><a href="#cb8-144" aria-hidden="true" tabindex="-1"></a>      d<span class="op">.</span><span class="at">year</span> <span class="op">&lt;</span> <span class="bu">Number</span>(d<span class="op">.</span><span class="at">treat_group</span>) <span class="op">+</span> <span class="bu">Number</span>(stacked)</span>
<span id="cb8-145"><a href="#cb8-145" aria-hidden="true" tabindex="-1"></a>    )<span class="op">;</span></span>
<span id="cb8-146"><a href="#cb8-146" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb8-147"><a href="#cb8-147" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> dataOut <span class="op">=</span> dataFilt<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> ({</span>
<span id="cb8-148"><a href="#cb8-148" aria-hidden="true" tabindex="-1"></a>    <span class="dt">treat_group</span><span class="op">:</span> d<span class="op">.</span><span class="at">treat_group</span><span class="op">,</span> <span class="dt">st</span><span class="op">:</span> d<span class="op">.</span><span class="at">st</span><span class="op">,</span> <span class="dt">treated</span><span class="op">:</span> d<span class="op">.</span><span class="at">treated</span><span class="op">,</span> </span>
<span id="cb8-149"><a href="#cb8-149" aria-hidden="true" tabindex="-1"></a>    <span class="dt">year</span><span class="op">:</span> d<span class="op">.</span><span class="at">year</span><span class="op">,</span> <span class="dt">e</span><span class="op">:</span> d<span class="op">.</span><span class="at">e</span><span class="op">,</span> <span class="dt">outcome</span><span class="op">:</span> d[outcomeName]</span>
<span id="cb8-150"><a href="#cb8-150" aria-hidden="true" tabindex="-1"></a>  }))<span class="op">;</span></span>
<span id="cb8-151"><a href="#cb8-151" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> dataOut<span class="op">;</span></span>
<span id="cb8-152"><a href="#cb8-152" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display hidden">
<div id="ojs-cell-8" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell hidden bslib-grid-item html-fill-item">
<div class="sourceCode cell-code hidden" id="cb9" data-startfrom="157" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 156;"><span id="cb9-157"><a href="#cb9-157" aria-hidden="true" tabindex="-1"></a>dataCtrlStatesDiDUse <span class="op">=</span> dataCtrlStatesDiD<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> </span>
<span id="cb9-158"><a href="#cb9-158" aria-hidden="true" tabindex="-1"></a>  d<span class="op">.</span><span class="at">ctrl_spec</span> <span class="op">===</span> ctrlSpecDiD <span class="op">&amp;&amp;</span> d<span class="op">.</span><span class="at">treat_spec</span> <span class="op">===</span> treatSpec</span>
<span id="cb9-159"><a href="#cb9-159" aria-hidden="true" tabindex="-1"></a>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display hidden">
<div id="ojs-cell-9" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell hidden bslib-grid-item html-fill-item">
<div class="sourceCode cell-code hidden" id="cb10" data-startfrom="164" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 163;"><span id="cb10-164"><a href="#cb10-164" aria-hidden="true" tabindex="-1"></a>dataCtrlStatesSynthUse <span class="op">=</span> {</span>
<span id="cb10-165"><a href="#cb10-165" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> dataFilt <span class="op">=</span> dataCtrlStatesSynth<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> </span>
<span id="cb10-166"><a href="#cb10-166" aria-hidden="true" tabindex="-1"></a>    d<span class="op">.</span><span class="at">ctrl_spec</span> <span class="op">===</span> ctrlSpecSynth </span>
<span id="cb10-167"><a href="#cb10-167" aria-hidden="true" tabindex="-1"></a>      <span class="op">&amp;&amp;</span> d<span class="op">.</span><span class="at">treat_spec</span> <span class="op">===</span> treatSpec</span>
<span id="cb10-168"><a href="#cb10-168" aria-hidden="true" tabindex="-1"></a>      <span class="op">&amp;&amp;</span> outcomeName<span class="op">.</span><span class="fu">includes</span>(d<span class="op">.</span><span class="at">y</span>)</span>
<span id="cb10-169"><a href="#cb10-169" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb10-170"><a href="#cb10-170" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (dropAK) {</span>
<span id="cb10-171"><a href="#cb10-171" aria-hidden="true" tabindex="-1"></a>    dataFilt <span class="op">=</span> dataFilt<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">treat_group</span> <span class="op">!==</span> <span class="st">'2000'</span>)<span class="op">;</span></span>
<span id="cb10-172"><a href="#cb10-172" aria-hidden="true" tabindex="-1"></a>    dataFilt <span class="op">=</span> dataFilt<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> </span>
<span id="cb10-173"><a href="#cb10-173" aria-hidden="true" tabindex="-1"></a>      d<span class="op">.</span><span class="at">treat_group</span> <span class="op">===</span> <span class="st">'2000 no ak'</span> <span class="op">?</span> {<span class="op">...</span>d<span class="op">,</span> <span class="dt">treat_group</span><span class="op">:</span> <span class="st">'2000'</span>} <span class="op">:</span> d</span>
<span id="cb10-174"><a href="#cb10-174" aria-hidden="true" tabindex="-1"></a>    )<span class="op">;</span></span>
<span id="cb10-175"><a href="#cb10-175" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb10-176"><a href="#cb10-176" aria-hidden="true" tabindex="-1"></a>    dataFilt <span class="op">=</span> dataFilt<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">treat_group</span> <span class="op">!==</span> <span class="st">'2000 no ak'</span>)<span class="op">;</span></span>
<span id="cb10-177"><a href="#cb10-177" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb10-178"><a href="#cb10-178" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> dataFilt<span class="op">;</span></span>
<span id="cb10-179"><a href="#cb10-179" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display hidden">
<div id="ojs-cell-10" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell hidden bslib-grid-item html-fill-item">
<div class="sourceCode cell-code hidden" id="cb11" data-startfrom="184" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 183;"><span id="cb11-184"><a href="#cb11-184" aria-hidden="true" tabindex="-1"></a>dataK12Means <span class="op">=</span> {</span>
<span id="cb11-185"><a href="#cb11-185" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> k12YName <span class="op">=</span> fe <span class="op">?</span> </span>
<span id="cb11-186"><a href="#cb11-186" aria-hidden="true" tabindex="-1"></a>    <span class="st">'e027_elem_educ_direct_exp_fe'</span> <span class="op">:</span> <span class="st">'e027_elem_educ_direct_exp'</span><span class="op">;</span></span>
<span id="cb11-187"><a href="#cb11-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-188"><a href="#cb11-188" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> dataTreatFilt <span class="op">=</span> dataTreatMeans<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">treat_spec</span> <span class="op">===</span> treatSpec)<span class="op">;</span></span>
<span id="cb11-189"><a href="#cb11-189" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (dropAK) {</span>
<span id="cb11-190"><a href="#cb11-190" aria-hidden="true" tabindex="-1"></a>    dataTreatFilt <span class="op">=</span> dataTreatFilt<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">treat_group</span> <span class="op">!==</span> <span class="st">'2000'</span>)<span class="op">;</span></span>
<span id="cb11-191"><a href="#cb11-191" aria-hidden="true" tabindex="-1"></a>    dataTreatFilt <span class="op">=</span> dataTreatFilt<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> </span>
<span id="cb11-192"><a href="#cb11-192" aria-hidden="true" tabindex="-1"></a>      d<span class="op">.</span><span class="at">treat_group</span> <span class="op">===</span> <span class="st">'2000 no ak'</span> <span class="op">?</span> {<span class="op">...</span>d<span class="op">,</span> <span class="dt">treat_group</span><span class="op">:</span> <span class="st">'2000'</span>} <span class="op">:</span> d</span>
<span id="cb11-193"><a href="#cb11-193" aria-hidden="true" tabindex="-1"></a>    )<span class="op">;</span></span>
<span id="cb11-194"><a href="#cb11-194" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb11-195"><a href="#cb11-195" aria-hidden="true" tabindex="-1"></a>    dataTreatFilt <span class="op">=</span> dataTreatFilt<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">treat_group</span> <span class="op">!==</span> <span class="st">'2000 no ak'</span>)<span class="op">;</span></span>
<span id="cb11-196"><a href="#cb11-196" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb11-197"><a href="#cb11-197" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> dataTreatNonAgg <span class="op">=</span> dataTreatFilt<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> <span class="ss">/</span><span class="sc">\d\d\d\d</span><span class="ss">/</span><span class="op">.</span><span class="fu">test</span>(d<span class="op">.</span><span class="at">treat_group</span>))<span class="op">;</span></span>
<span id="cb11-198"><a href="#cb11-198" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="ss">/</span><span class="sc">\d</span><span class="ss">/</span><span class="op">.</span><span class="fu">test</span>(stacked)) {</span>
<span id="cb11-199"><a href="#cb11-199" aria-hidden="true" tabindex="-1"></a>    dataTreatNonAgg <span class="op">=</span> dataTreatNonAgg<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> </span>
<span id="cb11-200"><a href="#cb11-200" aria-hidden="true" tabindex="-1"></a>      d<span class="op">.</span><span class="at">year</span> <span class="op">&lt;</span> <span class="bu">Number</span>(d<span class="op">.</span><span class="at">treat_group</span>) <span class="op">+</span> <span class="bu">Number</span>(stacked)</span>
<span id="cb11-201"><a href="#cb11-201" aria-hidden="true" tabindex="-1"></a>    )<span class="op">;</span></span>
<span id="cb11-202"><a href="#cb11-202" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb11-203"><a href="#cb11-203" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> dataTreatAgg <span class="op">=</span> dataTreatFilt<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> <span class="ss">/aggregate/</span><span class="op">.</span><span class="fu">test</span>(d<span class="op">.</span><span class="at">treat_group</span>))<span class="op">;</span></span>
<span id="cb11-204"><a href="#cb11-204" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> dataTreatClean <span class="op">=</span> [<span class="op">...</span>dataTreatNonAgg<span class="op">,</span> <span class="op">...</span>dataTreatAgg]<span class="op">;</span></span>
<span id="cb11-205"><a href="#cb11-205" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> k12MeansTreat <span class="op">=</span> dataTreatClean<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> ({</span>
<span id="cb11-206"><a href="#cb11-206" aria-hidden="true" tabindex="-1"></a>    <span class="dt">treat_group</span><span class="op">:</span> d<span class="op">.</span><span class="at">treat_group</span><span class="op">,</span> </span>
<span id="cb11-207"><a href="#cb11-207" aria-hidden="true" tabindex="-1"></a>    <span class="dt">year</span><span class="op">:</span> d<span class="op">.</span><span class="at">year</span><span class="op">,</span> </span>
<span id="cb11-208"><a href="#cb11-208" aria-hidden="true" tabindex="-1"></a>    <span class="dt">e</span><span class="op">:</span> d<span class="op">.</span><span class="at">e</span><span class="op">,</span></span>
<span id="cb11-209"><a href="#cb11-209" aria-hidden="true" tabindex="-1"></a>    <span class="dt">outcome</span><span class="op">:</span> d[k12YName]<span class="op">,</span></span>
<span id="cb11-210"><a href="#cb11-210" aria-hidden="true" tabindex="-1"></a>    <span class="dt">id</span><span class="op">:</span> <span class="st">'treat group'</span><span class="op">,</span></span>
<span id="cb11-211"><a href="#cb11-211" aria-hidden="true" tabindex="-1"></a>    <span class="dt">st</span><span class="op">:</span> <span class="st">'n/a'</span></span>
<span id="cb11-212"><a href="#cb11-212" aria-hidden="true" tabindex="-1"></a>  }))<span class="op">;</span></span>
<span id="cb11-213"><a href="#cb11-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-214"><a href="#cb11-214" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> treatedStates <span class="op">=</span> dataAllStates<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> </span>
<span id="cb11-215"><a href="#cb11-215" aria-hidden="true" tabindex="-1"></a>    d<span class="op">.</span><span class="at">treated</span> <span class="op">===</span> <span class="dv">1</span> <span class="op">&amp;&amp;</span> d<span class="op">.</span><span class="at">treat_spec</span> <span class="op">===</span> treatSpec</span>
<span id="cb11-216"><a href="#cb11-216" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb11-217"><a href="#cb11-217" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (dropAK) treatedStates <span class="op">=</span> treatedStates<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">st</span> <span class="op">!==</span> <span class="st">'AK'</span>)<span class="op">;</span></span>
<span id="cb11-218"><a href="#cb11-218" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="ss">/</span><span class="sc">\d</span><span class="ss">/</span><span class="op">.</span><span class="fu">test</span>(stacked)) {</span>
<span id="cb11-219"><a href="#cb11-219" aria-hidden="true" tabindex="-1"></a>    treatedStates <span class="op">=</span> treatedStates<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> </span>
<span id="cb11-220"><a href="#cb11-220" aria-hidden="true" tabindex="-1"></a>      d<span class="op">.</span><span class="at">year</span> <span class="op">&lt;</span> <span class="bu">Number</span>(d<span class="op">.</span><span class="at">treat_group</span>) <span class="op">+</span> <span class="bu">Number</span>(stacked)</span>
<span id="cb11-221"><a href="#cb11-221" aria-hidden="true" tabindex="-1"></a>    )<span class="op">;</span></span>
<span id="cb11-222"><a href="#cb11-222" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb11-223"><a href="#cb11-223" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> k12StatesTreat <span class="op">=</span> treatedStates<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> ({</span>
<span id="cb11-224"><a href="#cb11-224" aria-hidden="true" tabindex="-1"></a>    <span class="dt">treat_group</span><span class="op">:</span> d<span class="op">.</span><span class="at">treat_group</span><span class="op">,</span> </span>
<span id="cb11-225"><a href="#cb11-225" aria-hidden="true" tabindex="-1"></a>    <span class="dt">year</span><span class="op">:</span> d<span class="op">.</span><span class="at">year</span><span class="op">,</span> </span>
<span id="cb11-226"><a href="#cb11-226" aria-hidden="true" tabindex="-1"></a>    <span class="dt">e</span><span class="op">:</span> d<span class="op">.</span><span class="at">e</span><span class="op">,</span></span>
<span id="cb11-227"><a href="#cb11-227" aria-hidden="true" tabindex="-1"></a>    <span class="dt">outcome</span><span class="op">:</span> d[k12YName]<span class="op">,</span></span>
<span id="cb11-228"><a href="#cb11-228" aria-hidden="true" tabindex="-1"></a>    <span class="dt">id</span><span class="op">:</span> <span class="st">'treat st'</span><span class="op">,</span></span>
<span id="cb11-229"><a href="#cb11-229" aria-hidden="true" tabindex="-1"></a>    <span class="dt">st</span><span class="op">:</span> d<span class="op">.</span><span class="at">st</span></span>
<span id="cb11-230"><a href="#cb11-230" aria-hidden="true" tabindex="-1"></a>  }))<span class="op">;</span></span>
<span id="cb11-231"><a href="#cb11-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-232"><a href="#cb11-232" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> dataDiDFilt <span class="op">=</span> dataCtrlMeansDiD<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> </span>
<span id="cb11-233"><a href="#cb11-233" aria-hidden="true" tabindex="-1"></a>    d<span class="op">.</span><span class="at">ctrl_spec</span> <span class="op">===</span> ctrlSpecDiD <span class="op">&amp;&amp;</span> d<span class="op">.</span><span class="at">treat_spec</span> <span class="op">===</span> treatSpec</span>
<span id="cb11-234"><a href="#cb11-234" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb11-235"><a href="#cb11-235" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> k12MeansCtrlDiD <span class="op">=</span> dataDiDFilt<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> ({</span>
<span id="cb11-236"><a href="#cb11-236" aria-hidden="true" tabindex="-1"></a>    <span class="dt">treat_group</span><span class="op">:</span> d<span class="op">.</span><span class="at">treat_group</span><span class="op">,</span> </span>
<span id="cb11-237"><a href="#cb11-237" aria-hidden="true" tabindex="-1"></a>    <span class="dt">year</span><span class="op">:</span> d<span class="op">.</span><span class="at">year</span><span class="op">,</span> </span>
<span id="cb11-238"><a href="#cb11-238" aria-hidden="true" tabindex="-1"></a>    <span class="dt">e</span><span class="op">:</span> d<span class="op">.</span><span class="at">e</span><span class="op">,</span></span>
<span id="cb11-239"><a href="#cb11-239" aria-hidden="true" tabindex="-1"></a>    <span class="dt">outcome</span><span class="op">:</span> d[k12YName]<span class="op">,</span></span>
<span id="cb11-240"><a href="#cb11-240" aria-hidden="true" tabindex="-1"></a>    <span class="dt">id</span><span class="op">:</span> <span class="st">'ctrl did'</span><span class="op">,</span></span>
<span id="cb11-241"><a href="#cb11-241" aria-hidden="true" tabindex="-1"></a>    <span class="dt">st</span><span class="op">:</span> <span class="st">'n/a'</span></span>
<span id="cb11-242"><a href="#cb11-242" aria-hidden="true" tabindex="-1"></a>  }))<span class="op">;</span></span>
<span id="cb11-243"><a href="#cb11-243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-244"><a href="#cb11-244" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> dataSynthFilt <span class="op">=</span> dataCtrlMeansSynth<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> </span>
<span id="cb11-245"><a href="#cb11-245" aria-hidden="true" tabindex="-1"></a>    d<span class="op">.</span><span class="at">ctrl_spec</span> <span class="op">===</span> ctrlSpecSynth <span class="op">&amp;&amp;</span> d<span class="op">.</span><span class="at">treat_spec</span> <span class="op">===</span> treatSpec</span>
<span id="cb11-246"><a href="#cb11-246" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb11-247"><a href="#cb11-247" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (dropAK) {</span>
<span id="cb11-248"><a href="#cb11-248" aria-hidden="true" tabindex="-1"></a>    dataSynthFilt <span class="op">=</span> dataSynthFilt<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">treat_group</span> <span class="op">!==</span> <span class="st">'2000'</span>)<span class="op">;</span></span>
<span id="cb11-249"><a href="#cb11-249" aria-hidden="true" tabindex="-1"></a>    dataSynthFilt <span class="op">=</span> dataSynthFilt<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> </span>
<span id="cb11-250"><a href="#cb11-250" aria-hidden="true" tabindex="-1"></a>      d<span class="op">.</span><span class="at">treat_group</span> <span class="op">===</span> <span class="st">'2000 no ak'</span> <span class="op">?</span> {<span class="op">...</span>d<span class="op">,</span> <span class="dt">treat_group</span><span class="op">:</span> <span class="st">'2000'</span>} <span class="op">:</span> d</span>
<span id="cb11-251"><a href="#cb11-251" aria-hidden="true" tabindex="-1"></a>    )<span class="op">;</span></span>
<span id="cb11-252"><a href="#cb11-252" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb11-253"><a href="#cb11-253" aria-hidden="true" tabindex="-1"></a>    dataSynthFilt <span class="op">=</span> dataSynthFilt<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">treat_group</span> <span class="op">!==</span> <span class="st">'2000 no ak'</span>)<span class="op">;</span></span>
<span id="cb11-254"><a href="#cb11-254" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb11-255"><a href="#cb11-255" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> k12MeansSynthDiD <span class="op">=</span> dataSynthFilt<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> ({</span>
<span id="cb11-256"><a href="#cb11-256" aria-hidden="true" tabindex="-1"></a>    <span class="dt">treat_group</span><span class="op">:</span> d<span class="op">.</span><span class="at">treat_group</span><span class="op">,</span> </span>
<span id="cb11-257"><a href="#cb11-257" aria-hidden="true" tabindex="-1"></a>    <span class="dt">year</span><span class="op">:</span> d<span class="op">.</span><span class="at">year</span><span class="op">,</span> </span>
<span id="cb11-258"><a href="#cb11-258" aria-hidden="true" tabindex="-1"></a>    <span class="dt">e</span><span class="op">:</span> d<span class="op">.</span><span class="at">e</span><span class="op">,</span></span>
<span id="cb11-259"><a href="#cb11-259" aria-hidden="true" tabindex="-1"></a>    <span class="dt">outcome</span><span class="op">:</span> d[k12YName]<span class="op">,</span></span>
<span id="cb11-260"><a href="#cb11-260" aria-hidden="true" tabindex="-1"></a>    <span class="dt">id</span><span class="op">:</span> <span class="st">'ctrl synth'</span><span class="op">,</span></span>
<span id="cb11-261"><a href="#cb11-261" aria-hidden="true" tabindex="-1"></a>    <span class="dt">st</span><span class="op">:</span> <span class="st">'n/a'</span></span>
<span id="cb11-262"><a href="#cb11-262" aria-hidden="true" tabindex="-1"></a>  }))<span class="op">;</span></span>
<span id="cb11-263"><a href="#cb11-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-264"><a href="#cb11-264" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> [</span>
<span id="cb11-265"><a href="#cb11-265" aria-hidden="true" tabindex="-1"></a>    <span class="op">...</span>k12MeansTreat<span class="op">,</span> <span class="op">...</span>k12StatesTreat<span class="op">,</span> </span>
<span id="cb11-266"><a href="#cb11-266" aria-hidden="true" tabindex="-1"></a>    <span class="op">...</span>k12MeansCtrlDiD<span class="op">,</span> <span class="op">...</span>k12MeansSynthDiD</span>
<span id="cb11-267"><a href="#cb11-267" aria-hidden="true" tabindex="-1"></a>  ]<span class="op">;</span></span>
<span id="cb11-268"><a href="#cb11-268" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display hidden">
<div id="ojs-cell-11" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell hidden bslib-grid-item html-fill-item">
<div class="sourceCode cell-code hidden" id="cb12" data-startfrom="277" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 276;"><span id="cb12-277"><a href="#cb12-277" aria-hidden="true" tabindex="-1"></a>dataResDiDUseG <span class="op">=</span> {</span>
<span id="cb12-278"><a href="#cb12-278" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> re <span class="op">=</span> <span class="ss">/</span><span class="sc">\d|</span><span class="ss">aggregate/</span></span>
<span id="cb12-279"><a href="#cb12-279" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> simultCband <span class="op">=</span> modSpecDiD<span class="op">.</span><span class="fu">includes</span>(<span class="st">'simult cband'</span>) <span class="op">?</span> <span class="kw">true</span> <span class="op">:</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb12-280"><a href="#cb12-280" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> dataFilt <span class="op">=</span> dataResDiD<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span></span>
<span id="cb12-281"><a href="#cb12-281" aria-hidden="true" tabindex="-1"></a>    d<span class="op">.</span><span class="at">ctrl_spec</span> <span class="op">===</span> ctrlSpecDiD</span>
<span id="cb12-282"><a href="#cb12-282" aria-hidden="true" tabindex="-1"></a>      <span class="op">&amp;&amp;</span> d<span class="op">.</span><span class="at">treat_spec</span> <span class="op">===</span> treatSpec</span>
<span id="cb12-283"><a href="#cb12-283" aria-hidden="true" tabindex="-1"></a>      <span class="op">&amp;&amp;</span> d<span class="op">.</span><span class="at">simult_cband</span> <span class="op">===</span> simultCband</span>
<span id="cb12-284"><a href="#cb12-284" aria-hidden="true" tabindex="-1"></a>      <span class="op">&amp;&amp;</span> d<span class="op">.</span><span class="at">y</span> <span class="op">===</span> selectedOutcome</span>
<span id="cb12-285"><a href="#cb12-285" aria-hidden="true" tabindex="-1"></a>      <span class="op">&amp;&amp;</span> re<span class="op">.</span><span class="fu">test</span>(d<span class="op">.</span><span class="at">g</span>)</span>
<span id="cb12-286"><a href="#cb12-286" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb12-287"><a href="#cb12-287" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> dataOut <span class="op">=</span> dataFilt<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> ({</span>
<span id="cb12-288"><a href="#cb12-288" aria-hidden="true" tabindex="-1"></a>    <span class="dt">treat_group</span><span class="op">:</span> d<span class="op">.</span><span class="at">g</span><span class="op">,</span> <span class="dt">year</span><span class="op">:</span> d<span class="op">.</span><span class="at">year</span><span class="op">,</span> <span class="dt">e</span><span class="op">:</span> d<span class="op">.</span><span class="at">e</span><span class="op">,</span></span>
<span id="cb12-289"><a href="#cb12-289" aria-hidden="true" tabindex="-1"></a>    <span class="dt">att</span><span class="op">:</span> d<span class="op">.</span><span class="at">att</span><span class="op">,</span> <span class="dt">ci_low</span><span class="op">:</span> d<span class="op">.</span><span class="at">ci_low</span><span class="op">,</span> <span class="dt">ci_up</span><span class="op">:</span> d<span class="op">.</span><span class="at">ci_up</span></span>
<span id="cb12-290"><a href="#cb12-290" aria-hidden="true" tabindex="-1"></a>  }))<span class="op">;</span></span>
<span id="cb12-291"><a href="#cb12-291" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> dataOut<span class="op">;</span></span>
<span id="cb12-292"><a href="#cb12-292" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display hidden">
<div id="ojs-cell-12" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell hidden bslib-grid-item html-fill-item">
<div class="sourceCode cell-code hidden" id="cb13" data-startfrom="297" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 296;"><span id="cb13-297"><a href="#cb13-297" aria-hidden="true" tabindex="-1"></a>dataResSynthUseG <span class="op">=</span> {</span>
<span id="cb13-298"><a href="#cb13-298" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> dataFilt <span class="op">=</span> dataResSynth<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> </span>
<span id="cb13-299"><a href="#cb13-299" aria-hidden="true" tabindex="-1"></a>    d<span class="op">.</span><span class="at">ctrl_spec</span> <span class="op">===</span> ctrlSpecSynth</span>
<span id="cb13-300"><a href="#cb13-300" aria-hidden="true" tabindex="-1"></a>      <span class="op">&amp;&amp;</span> d<span class="op">.</span><span class="at">treat_spec</span> <span class="op">===</span> treatSpec</span>
<span id="cb13-301"><a href="#cb13-301" aria-hidden="true" tabindex="-1"></a>      <span class="op">&amp;&amp;</span> d<span class="op">.</span><span class="at">y</span> <span class="op">===</span> selectedOutcome </span>
<span id="cb13-302"><a href="#cb13-302" aria-hidden="true" tabindex="-1"></a>      <span class="op">&amp;&amp;</span> d<span class="op">.</span><span class="at">year</span> <span class="op">!==</span> <span class="kw">null</span></span>
<span id="cb13-303"><a href="#cb13-303" aria-hidden="true" tabindex="-1"></a>      <span class="op">&amp;&amp;</span> d<span class="op">.</span><span class="at">time_cohort</span> <span class="op">===</span> <span class="kw">true</span></span>
<span id="cb13-304"><a href="#cb13-304" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb13-305"><a href="#cb13-305" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (dropAK) {</span>
<span id="cb13-306"><a href="#cb13-306" aria-hidden="true" tabindex="-1"></a>    dataFilt <span class="op">=</span> dataFilt<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">g</span> <span class="op">!==</span> <span class="st">'2000'</span>)<span class="op">;</span></span>
<span id="cb13-307"><a href="#cb13-307" aria-hidden="true" tabindex="-1"></a>    dataFilt <span class="op">=</span> dataFilt<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> </span>
<span id="cb13-308"><a href="#cb13-308" aria-hidden="true" tabindex="-1"></a>      d<span class="op">.</span><span class="at">g</span> <span class="op">===</span> <span class="st">'2000 no ak'</span> <span class="op">?</span> {<span class="op">...</span>d<span class="op">,</span> <span class="dt">g</span><span class="op">:</span> <span class="st">'2000'</span>} <span class="op">:</span> d</span>
<span id="cb13-309"><a href="#cb13-309" aria-hidden="true" tabindex="-1"></a>    )<span class="op">;</span></span>
<span id="cb13-310"><a href="#cb13-310" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb13-311"><a href="#cb13-311" aria-hidden="true" tabindex="-1"></a>    dataFilt <span class="op">=</span> dataFilt<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">g</span> <span class="op">!==</span> <span class="st">'2000 no ak'</span>)<span class="op">;</span></span>
<span id="cb13-312"><a href="#cb13-312" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb13-313"><a href="#cb13-313" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> dataOut <span class="op">=</span> dataFilt<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> ({</span>
<span id="cb13-314"><a href="#cb13-314" aria-hidden="true" tabindex="-1"></a>    <span class="dt">treat_group</span><span class="op">:</span> d<span class="op">.</span><span class="at">g</span><span class="op">,</span> <span class="dt">year</span><span class="op">:</span> d<span class="op">.</span><span class="at">year</span><span class="op">,</span> <span class="dt">e</span><span class="op">:</span> d<span class="op">.</span><span class="at">e</span><span class="op">,</span></span>
<span id="cb13-315"><a href="#cb13-315" aria-hidden="true" tabindex="-1"></a>    <span class="dt">att</span><span class="op">:</span> d<span class="op">.</span><span class="at">att</span><span class="op">,</span> <span class="dt">ci_low</span><span class="op">:</span> d<span class="op">.</span><span class="at">ci_low</span><span class="op">,</span> <span class="dt">ci_up</span><span class="op">:</span> d<span class="op">.</span><span class="at">ci_up</span></span>
<span id="cb13-316"><a href="#cb13-316" aria-hidden="true" tabindex="-1"></a>  }))<span class="op">;</span></span>
<span id="cb13-317"><a href="#cb13-317" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> dataOut<span class="op">;</span></span>
<span id="cb13-318"><a href="#cb13-318" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display hidden">
<div id="ojs-cell-13" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell hidden bslib-grid-item html-fill-item">
<div class="sourceCode cell-code hidden" id="cb14" data-startfrom="323" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 322;"><span id="cb14-323"><a href="#cb14-323" aria-hidden="true" tabindex="-1"></a>dataResDiDUseSt <span class="op">=</span> {</span>
<span id="cb14-324"><a href="#cb14-324" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> re <span class="op">=</span> <span class="ss">/</span><span class="sc">[A-Z][A-Z]</span><span class="ss">/</span></span>
<span id="cb14-325"><a href="#cb14-325" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> simultCband <span class="op">=</span> modSpecDiD<span class="op">.</span><span class="fu">includes</span>(<span class="st">'simult cband'</span>) <span class="op">?</span> <span class="kw">true</span> <span class="op">:</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb14-326"><a href="#cb14-326" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> dataFilt <span class="op">=</span> dataResDiD<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> </span>
<span id="cb14-327"><a href="#cb14-327" aria-hidden="true" tabindex="-1"></a>    d<span class="op">.</span><span class="at">ctrl_spec</span> <span class="op">===</span> ctrlSpecDiD</span>
<span id="cb14-328"><a href="#cb14-328" aria-hidden="true" tabindex="-1"></a>      <span class="op">&amp;&amp;</span> d<span class="op">.</span><span class="at">treat_spec</span> <span class="op">===</span> treatSpec</span>
<span id="cb14-329"><a href="#cb14-329" aria-hidden="true" tabindex="-1"></a>      <span class="op">&amp;&amp;</span> d<span class="op">.</span><span class="at">simult_cband</span> <span class="op">===</span> simultCband</span>
<span id="cb14-330"><a href="#cb14-330" aria-hidden="true" tabindex="-1"></a>      <span class="op">&amp;&amp;</span> d<span class="op">.</span><span class="at">y</span> <span class="op">===</span> selectedOutcome </span>
<span id="cb14-331"><a href="#cb14-331" aria-hidden="true" tabindex="-1"></a>      <span class="op">&amp;&amp;</span> re<span class="op">.</span><span class="fu">test</span>(d<span class="op">.</span><span class="at">g</span>)</span>
<span id="cb14-332"><a href="#cb14-332" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb14-333"><a href="#cb14-333" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> dataOut <span class="op">=</span> dataFilt<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> ({</span>
<span id="cb14-334"><a href="#cb14-334" aria-hidden="true" tabindex="-1"></a>    <span class="dt">treat_group</span><span class="op">:</span> d<span class="op">.</span><span class="at">g</span><span class="op">,</span> <span class="dt">year</span><span class="op">:</span> d<span class="op">.</span><span class="at">year</span><span class="op">,</span> <span class="dt">e</span><span class="op">:</span> d<span class="op">.</span><span class="at">e</span><span class="op">,</span></span>
<span id="cb14-335"><a href="#cb14-335" aria-hidden="true" tabindex="-1"></a>    <span class="dt">att</span><span class="op">:</span> d<span class="op">.</span><span class="at">att</span><span class="op">,</span> <span class="dt">ci_low</span><span class="op">:</span> d<span class="op">.</span><span class="at">ci_low</span><span class="op">,</span> <span class="dt">ci_up</span><span class="op">:</span> d<span class="op">.</span><span class="at">ci_up</span></span>
<span id="cb14-336"><a href="#cb14-336" aria-hidden="true" tabindex="-1"></a>  }))<span class="op">;</span></span>
<span id="cb14-337"><a href="#cb14-337" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> dataOut<span class="op">;</span></span>
<span id="cb14-338"><a href="#cb14-338" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display hidden">
<div id="ojs-cell-14" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell hidden bslib-grid-item html-fill-item">
<div class="sourceCode cell-code hidden" id="cb15" data-startfrom="343" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 342;"><span id="cb15-343"><a href="#cb15-343" aria-hidden="true" tabindex="-1"></a>dataResSynthUseSt <span class="op">=</span> {</span>
<span id="cb15-344"><a href="#cb15-344" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> dataFilt <span class="op">=</span> dataResSynth<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> </span>
<span id="cb15-345"><a href="#cb15-345" aria-hidden="true" tabindex="-1"></a>    d<span class="op">.</span><span class="at">ctrl_spec</span> <span class="op">===</span> ctrlSpecSynth </span>
<span id="cb15-346"><a href="#cb15-346" aria-hidden="true" tabindex="-1"></a>      <span class="op">&amp;&amp;</span> d<span class="op">.</span><span class="at">treat_spec</span> <span class="op">===</span> treatSpec</span>
<span id="cb15-347"><a href="#cb15-347" aria-hidden="true" tabindex="-1"></a>      <span class="op">&amp;&amp;</span> d<span class="op">.</span><span class="at">y</span> <span class="op">===</span> selectedOutcome </span>
<span id="cb15-348"><a href="#cb15-348" aria-hidden="true" tabindex="-1"></a>      <span class="op">&amp;&amp;</span> d<span class="op">.</span><span class="at">time_cohort</span> <span class="op">===</span> <span class="kw">false</span></span>
<span id="cb15-349"><a href="#cb15-349" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb15-350"><a href="#cb15-350" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> dataOut <span class="op">=</span> dataFilt<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> ({</span>
<span id="cb15-351"><a href="#cb15-351" aria-hidden="true" tabindex="-1"></a>    <span class="dt">treat_group</span><span class="op">:</span> d<span class="op">.</span><span class="at">g</span><span class="op">,</span> <span class="dt">year</span><span class="op">:</span> d<span class="op">.</span><span class="at">year</span><span class="op">,</span> <span class="dt">e</span><span class="op">:</span> d<span class="op">.</span><span class="at">e</span><span class="op">,</span></span>
<span id="cb15-352"><a href="#cb15-352" aria-hidden="true" tabindex="-1"></a>    <span class="dt">att</span><span class="op">:</span> d<span class="op">.</span><span class="at">att</span><span class="op">,</span> <span class="dt">ci_low</span><span class="op">:</span> d<span class="op">.</span><span class="at">ci_low</span><span class="op">,</span> <span class="dt">ci_up</span><span class="op">:</span> d<span class="op">.</span><span class="at">ci_up</span></span>
<span id="cb15-353"><a href="#cb15-353" aria-hidden="true" tabindex="-1"></a>  }))<span class="op">;</span></span>
<span id="cb15-354"><a href="#cb15-354" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> dataOut<span class="op">;</span></span>
<span id="cb15-355"><a href="#cb15-355" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display hidden">
<div id="ojs-cell-15" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell hidden bslib-grid-item html-fill-item">
<div class="sourceCode cell-code hidden" id="cb16" data-startfrom="360" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 359;"><span id="cb16-360"><a href="#cb16-360" aria-hidden="true" tabindex="-1"></a>dataResK12UseG <span class="op">=</span> {</span>
<span id="cb16-361"><a href="#cb16-361" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> re <span class="op">=</span> <span class="ss">/</span><span class="sc">\d|</span><span class="ss">aggregate/</span><span class="op">;</span></span>
<span id="cb16-362"><a href="#cb16-362" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> k12ResSynthFilt <span class="op">=</span> dataResSynth<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> </span>
<span id="cb16-363"><a href="#cb16-363" aria-hidden="true" tabindex="-1"></a>    d<span class="op">.</span><span class="at">ctrl_spec</span> <span class="op">===</span> ctrlSpecSynth</span>
<span id="cb16-364"><a href="#cb16-364" aria-hidden="true" tabindex="-1"></a>      <span class="op">&amp;&amp;</span> d<span class="op">.</span><span class="at">treat_spec</span> <span class="op">===</span> treatSpec</span>
<span id="cb16-365"><a href="#cb16-365" aria-hidden="true" tabindex="-1"></a>      <span class="op">&amp;&amp;</span> d<span class="op">.</span><span class="at">y</span> <span class="op">===</span> <span class="st">'e027_elem_educ_direct_exp'</span></span>
<span id="cb16-366"><a href="#cb16-366" aria-hidden="true" tabindex="-1"></a>      <span class="op">&amp;&amp;</span> re<span class="op">.</span><span class="fu">test</span>(d<span class="op">.</span><span class="at">g</span>)</span>
<span id="cb16-367"><a href="#cb16-367" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb16-368"><a href="#cb16-368" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> k12ResSynth <span class="op">=</span> k12ResSynthFilt<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> ({</span>
<span id="cb16-369"><a href="#cb16-369" aria-hidden="true" tabindex="-1"></a>    <span class="dt">treat_group</span><span class="op">:</span> d<span class="op">.</span><span class="at">g</span><span class="op">,</span> <span class="dt">year</span><span class="op">:</span> d<span class="op">.</span><span class="at">year</span><span class="op">,</span> <span class="dt">e</span><span class="op">:</span> d<span class="op">.</span><span class="at">e</span><span class="op">,</span> <span class="dt">att</span><span class="op">:</span> d<span class="op">.</span><span class="at">att</span><span class="op">,</span> <span class="dt">id</span><span class="op">:</span> <span class="st">'synth'</span></span>
<span id="cb16-370"><a href="#cb16-370" aria-hidden="true" tabindex="-1"></a>  }))<span class="op">;</span></span>
<span id="cb16-371"><a href="#cb16-371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-372"><a href="#cb16-372" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> simultCband <span class="op">=</span> modSpecDiD<span class="op">.</span><span class="fu">includes</span>(<span class="st">'simult cband'</span>) <span class="op">?</span> <span class="kw">true</span> <span class="op">:</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb16-373"><a href="#cb16-373" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> k12ResDiDFilt <span class="op">=</span> dataResDiD<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span></span>
<span id="cb16-374"><a href="#cb16-374" aria-hidden="true" tabindex="-1"></a>    d<span class="op">.</span><span class="at">ctrl_spec</span> <span class="op">===</span> ctrlSpecDiD</span>
<span id="cb16-375"><a href="#cb16-375" aria-hidden="true" tabindex="-1"></a>      <span class="op">&amp;&amp;</span> d<span class="op">.</span><span class="at">treat_spec</span> <span class="op">===</span> treatSpec</span>
<span id="cb16-376"><a href="#cb16-376" aria-hidden="true" tabindex="-1"></a>      <span class="op">&amp;&amp;</span> d<span class="op">.</span><span class="at">simult_cband</span> <span class="op">===</span> simultCband</span>
<span id="cb16-377"><a href="#cb16-377" aria-hidden="true" tabindex="-1"></a>      <span class="op">&amp;&amp;</span> d<span class="op">.</span><span class="at">y</span> <span class="op">===</span> <span class="st">'e027_elem_educ_direct_exp'</span></span>
<span id="cb16-378"><a href="#cb16-378" aria-hidden="true" tabindex="-1"></a>      <span class="op">&amp;&amp;</span> re<span class="op">.</span><span class="fu">test</span>(d<span class="op">.</span><span class="at">g</span>)</span>
<span id="cb16-379"><a href="#cb16-379" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb16-380"><a href="#cb16-380" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> k12ResDiD <span class="op">=</span> k12ResDiDFilt<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> ({</span>
<span id="cb16-381"><a href="#cb16-381" aria-hidden="true" tabindex="-1"></a>    <span class="dt">treat_group</span><span class="op">:</span> d<span class="op">.</span><span class="at">g</span><span class="op">,</span> <span class="dt">year</span><span class="op">:</span> d<span class="op">.</span><span class="at">year</span><span class="op">,</span> <span class="dt">e</span><span class="op">:</span> d<span class="op">.</span><span class="at">e</span><span class="op">,</span> <span class="dt">att</span><span class="op">:</span> d<span class="op">.</span><span class="at">att</span><span class="op">,</span> <span class="dt">id</span><span class="op">:</span> <span class="st">'did'</span></span>
<span id="cb16-382"><a href="#cb16-382" aria-hidden="true" tabindex="-1"></a>  }))<span class="op">;</span></span>
<span id="cb16-383"><a href="#cb16-383" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-384"><a href="#cb16-384" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> [<span class="op">...</span>k12ResSynth<span class="op">,</span> <span class="op">...</span>k12ResDiD]<span class="op">;</span></span>
<span id="cb16-385"><a href="#cb16-385" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display hidden">
<div id="ojs-cell-16" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell hidden bslib-grid-item html-fill-item">
<div class="sourceCode cell-code hidden" id="cb17" data-startfrom="390" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 389;"><span id="cb17-390"><a href="#cb17-390" aria-hidden="true" tabindex="-1"></a>dataResK12UseSt <span class="op">=</span> {</span>
<span id="cb17-391"><a href="#cb17-391" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> k12ResSynthFilt <span class="op">=</span> dataResSynth<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> </span>
<span id="cb17-392"><a href="#cb17-392" aria-hidden="true" tabindex="-1"></a>    d<span class="op">.</span><span class="at">ctrl_spec</span> <span class="op">===</span> ctrlSpecSynth</span>
<span id="cb17-393"><a href="#cb17-393" aria-hidden="true" tabindex="-1"></a>      <span class="op">&amp;&amp;</span> d<span class="op">.</span><span class="at">treat_spec</span> <span class="op">===</span> treatSpec</span>
<span id="cb17-394"><a href="#cb17-394" aria-hidden="true" tabindex="-1"></a>      <span class="op">&amp;&amp;</span> d<span class="op">.</span><span class="at">y</span> <span class="op">===</span> <span class="st">'e027_elem_educ_direct_exp'</span></span>
<span id="cb17-395"><a href="#cb17-395" aria-hidden="true" tabindex="-1"></a>      <span class="op">&amp;&amp;</span> d<span class="op">.</span><span class="at">time_cohort</span> <span class="op">===</span> <span class="kw">false</span></span>
<span id="cb17-396"><a href="#cb17-396" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb17-397"><a href="#cb17-397" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> k12ResSynth <span class="op">=</span> k12ResSynthFilt<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> ({</span>
<span id="cb17-398"><a href="#cb17-398" aria-hidden="true" tabindex="-1"></a>    <span class="dt">treat_group</span><span class="op">:</span> d<span class="op">.</span><span class="at">g</span><span class="op">,</span> <span class="dt">year</span><span class="op">:</span> d<span class="op">.</span><span class="at">year</span><span class="op">,</span> <span class="dt">e</span><span class="op">:</span> d<span class="op">.</span><span class="at">e</span><span class="op">,</span> <span class="dt">att</span><span class="op">:</span> d<span class="op">.</span><span class="at">att</span><span class="op">,</span> <span class="dt">id</span><span class="op">:</span> <span class="st">'synth'</span></span>
<span id="cb17-399"><a href="#cb17-399" aria-hidden="true" tabindex="-1"></a>  }))<span class="op">;</span></span>
<span id="cb17-400"><a href="#cb17-400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-401"><a href="#cb17-401" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> re <span class="op">=</span> <span class="ss">/</span><span class="sc">[A-Z][A-Z]</span><span class="ss">/</span><span class="op">;</span></span>
<span id="cb17-402"><a href="#cb17-402" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> simultCband <span class="op">=</span> modSpecDiD<span class="op">.</span><span class="fu">includes</span>(<span class="st">'simult cband'</span>) <span class="op">?</span> <span class="kw">true</span> <span class="op">:</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb17-403"><a href="#cb17-403" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> k12ResDiDFilt <span class="op">=</span> dataResDiD<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> </span>
<span id="cb17-404"><a href="#cb17-404" aria-hidden="true" tabindex="-1"></a>    d<span class="op">.</span><span class="at">ctrl_spec</span> <span class="op">===</span> ctrlSpecDiD</span>
<span id="cb17-405"><a href="#cb17-405" aria-hidden="true" tabindex="-1"></a>      <span class="op">&amp;&amp;</span> d<span class="op">.</span><span class="at">treat_spec</span> <span class="op">===</span> treatSpec</span>
<span id="cb17-406"><a href="#cb17-406" aria-hidden="true" tabindex="-1"></a>      <span class="op">&amp;&amp;</span> d<span class="op">.</span><span class="at">simult_cband</span> <span class="op">===</span> simultCband</span>
<span id="cb17-407"><a href="#cb17-407" aria-hidden="true" tabindex="-1"></a>      <span class="op">&amp;&amp;</span> d<span class="op">.</span><span class="at">y</span> <span class="op">===</span> <span class="st">'e027_elem_educ_direct_exp'</span></span>
<span id="cb17-408"><a href="#cb17-408" aria-hidden="true" tabindex="-1"></a>      <span class="op">&amp;&amp;</span> re<span class="op">.</span><span class="fu">test</span>(d<span class="op">.</span><span class="at">g</span>)</span>
<span id="cb17-409"><a href="#cb17-409" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb17-410"><a href="#cb17-410" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> k12ResDiD <span class="op">=</span> k12ResDiDFilt<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> ({</span>
<span id="cb17-411"><a href="#cb17-411" aria-hidden="true" tabindex="-1"></a>    <span class="dt">treat_group</span><span class="op">:</span> d<span class="op">.</span><span class="at">g</span><span class="op">,</span> <span class="dt">year</span><span class="op">:</span> d<span class="op">.</span><span class="at">year</span><span class="op">,</span> <span class="dt">e</span><span class="op">:</span> d<span class="op">.</span><span class="at">e</span><span class="op">,</span> <span class="dt">att</span><span class="op">:</span> d<span class="op">.</span><span class="at">att</span><span class="op">,</span> <span class="dt">id</span><span class="op">:</span> <span class="st">'did'</span></span>
<span id="cb17-412"><a href="#cb17-412" aria-hidden="true" tabindex="-1"></a>  }))<span class="op">;</span></span>
<span id="cb17-413"><a href="#cb17-413" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> [<span class="op">...</span>k12ResSynth<span class="op">,</span> <span class="op">...</span>k12ResDiD]<span class="op">;</span></span>
<span id="cb17-414"><a href="#cb17-414" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display hidden">
<div id="ojs-cell-17" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell hidden bslib-grid-item html-fill-item">
<div class="sourceCode cell-code hidden" id="cb18" data-startfrom="425" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 424;"><span id="cb18-425"><a href="#cb18-425" aria-hidden="true" tabindex="-1"></a>treatGroupStatesMap <span class="op">=</span> {</span>
<span id="cb18-426"><a href="#cb18-426" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> treatGroups <span class="op">=</span> [</span>
<span id="cb18-427"><a href="#cb18-427" aria-hidden="true" tabindex="-1"></a>    <span class="st">'1990'</span><span class="op">,</span> <span class="st">'1991'</span><span class="op">,</span> <span class="st">'1992'</span><span class="op">,</span> <span class="st">'1993'</span><span class="op">,</span> <span class="st">'1994'</span><span class="op">,</span> <span class="st">'1995'</span><span class="op">,</span> <span class="st">'1996'</span><span class="op">,</span> <span class="st">'1997'</span><span class="op">,</span> </span>
<span id="cb18-428"><a href="#cb18-428" aria-hidden="true" tabindex="-1"></a>    <span class="st">'1998'</span><span class="op">,</span> <span class="st">'1999'</span><span class="op">,</span> <span class="st">'2000'</span><span class="op">,</span> <span class="st">'2001'</span><span class="op">,</span> <span class="st">'2002'</span><span class="op">,</span> <span class="st">'2003'</span><span class="op">,</span> <span class="st">'2004'</span><span class="op">,</span> <span class="st">'2005'</span><span class="op">,</span></span>
<span id="cb18-429"><a href="#cb18-429" aria-hidden="true" tabindex="-1"></a>    <span class="st">'2007'</span><span class="op">,</span> <span class="st">'2008'</span><span class="op">,</span> <span class="st">'2009'</span><span class="op">,</span> <span class="st">'2010'</span><span class="op">,</span> <span class="st">'2012'</span><span class="op">,</span> <span class="st">'2015'</span></span>
<span id="cb18-430"><a href="#cb18-430" aria-hidden="true" tabindex="-1"></a>  ]<span class="op">;</span></span>
<span id="cb18-431"><a href="#cb18-431" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> treatStates <span class="op">=</span> []<span class="op">;</span></span>
<span id="cb18-432"><a href="#cb18-432" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (<span class="kw">let</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> <span class="dv">22</span><span class="op">;</span> i<span class="op">++</span>) {</span>
<span id="cb18-433"><a href="#cb18-433" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> treatedStatesGroup <span class="op">=</span> dataAllStates<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> </span>
<span id="cb18-434"><a href="#cb18-434" aria-hidden="true" tabindex="-1"></a>      d<span class="op">.</span><span class="at">treat_spec</span> <span class="op">===</span> treatSpec</span>
<span id="cb18-435"><a href="#cb18-435" aria-hidden="true" tabindex="-1"></a>        <span class="op">&amp;&amp;</span> treatGroups[i]<span class="op">.</span><span class="fu">includes</span>(d<span class="op">.</span><span class="at">treat_group</span>) </span>
<span id="cb18-436"><a href="#cb18-436" aria-hidden="true" tabindex="-1"></a>        <span class="op">&amp;&amp;</span> d<span class="op">.</span><span class="at">treated</span> <span class="op">===</span> <span class="dv">1</span></span>
<span id="cb18-437"><a href="#cb18-437" aria-hidden="true" tabindex="-1"></a>    )<span class="op">;</span></span>
<span id="cb18-438"><a href="#cb18-438" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (dropAK) {</span>
<span id="cb18-439"><a href="#cb18-439" aria-hidden="true" tabindex="-1"></a>      treatedStatesGroup <span class="op">=</span> treatedStatesGroup<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">st</span> <span class="op">!==</span> <span class="st">'AK'</span>)<span class="op">;</span></span>
<span id="cb18-440"><a href="#cb18-440" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb18-441"><a href="#cb18-441" aria-hidden="true" tabindex="-1"></a>    treatStates[i] <span class="op">=</span> [<span class="op">...</span><span class="kw">new</span> <span class="bu">Set</span>(treatedStatesGroup<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">st</span>))]<span class="op">;</span></span>
<span id="cb18-442"><a href="#cb18-442" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb18-443"><a href="#cb18-443" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> keysValsCombined <span class="op">=</span> treatGroups<span class="op">.</span><span class="fu">map</span>((key<span class="op">,</span> i) <span class="kw">=&gt;</span> [key<span class="op">,</span> treatStates[i]])<span class="op">;</span></span>
<span id="cb18-444"><a href="#cb18-444" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="kw">new</span> <span class="bu">Map</span>(keysValsCombined)<span class="op">;</span></span>
<span id="cb18-445"><a href="#cb18-445" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display hidden">
<div id="ojs-cell-18" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell hidden bslib-grid-item html-fill-item">
<div class="sourceCode cell-code hidden" id="cb19" data-startfrom="454" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 453;"><span id="cb19-454"><a href="#cb19-454" aria-hidden="true" tabindex="-1"></a>treatGroupIds <span class="op">=</span> {</span>
<span id="cb19-455"><a href="#cb19-455" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> init <span class="op">=</span> dataTreatMeansUse<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> </span>
<span id="cb19-456"><a href="#cb19-456" aria-hidden="true" tabindex="-1"></a>    <span class="ss">/</span><span class="sc">^\d</span><span class="ss">/</span><span class="op">.</span><span class="fu">test</span>(d<span class="op">.</span><span class="at">treat_group</span>)</span>
<span id="cb19-457"><a href="#cb19-457" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb19-458"><a href="#cb19-458" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> out <span class="op">=</span> [<span class="op">...</span><span class="kw">new</span> <span class="bu">Set</span>(init<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">treat_group</span>))]<span class="op">;</span></span>
<span id="cb19-459"><a href="#cb19-459" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> out<span class="op">.</span><span class="fu">sort</span>((a<span class="op">,</span> b) <span class="kw">=&gt;</span> a <span class="op">-</span> b)<span class="op">;</span></span>
<span id="cb19-460"><a href="#cb19-460" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display hidden">
<div id="ojs-cell-19" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell hidden bslib-grid-item html-fill-item">
<div class="sourceCode cell-code hidden" id="cb20" data-startfrom="465" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 464;"><span id="cb20-465"><a href="#cb20-465" aria-hidden="true" tabindex="-1"></a>treatStYearsLookup <span class="op">=</span> {</span>
<span id="cb20-466"><a href="#cb20-466" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> sortVar <span class="op">=</span> sortChrono <span class="op">?</span> <span class="st">'treat_group'</span> <span class="op">:</span> <span class="st">'st'</span><span class="op">;</span></span>
<span id="cb20-467"><a href="#cb20-467" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> init <span class="op">=</span> dataAllStatesUse<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">treated</span> <span class="op">===</span> <span class="dv">1</span>)<span class="op">;</span></span>
<span id="cb20-468"><a href="#cb20-468" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (dropAK) init <span class="op">=</span> init<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">st</span> <span class="op">!==</span> <span class="st">'AK'</span>)<span class="op">;</span></span>
<span id="cb20-469"><a href="#cb20-469" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> sorted <span class="op">=</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb20-470"><a href="#cb20-470" aria-hidden="true" tabindex="-1"></a>  sorted <span class="op">=</span> init<span class="op">.</span><span class="fu">sort</span>((a<span class="op">,</span> b) <span class="kw">=&gt;</span> a[sortVar] <span class="op">&gt;</span> b[sortVar] <span class="op">?</span> <span class="dv">1</span> <span class="op">:</span> <span class="op">-</span><span class="dv">1</span>)<span class="op">;</span></span>
<span id="cb20-471"><a href="#cb20-471" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> stTreat <span class="op">=</span> sorted<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> ({<span class="dt">st</span><span class="op">:</span> d<span class="op">.</span><span class="at">st</span><span class="op">,</span> <span class="dt">year</span><span class="op">:</span> d<span class="op">.</span><span class="at">treat_group</span>}))<span class="op">;</span></span>
<span id="cb20-472"><a href="#cb20-472" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> stTreatUnique <span class="op">=</span> stTreat<span class="op">.</span><span class="fu">filter</span>((d<span class="op">,</span> i<span class="op">,</span> self) <span class="kw">=&gt;</span> </span>
<span id="cb20-473"><a href="#cb20-473" aria-hidden="true" tabindex="-1"></a>    i <span class="op">===</span> self<span class="op">.</span><span class="fu">findIndex</span>(t <span class="kw">=&gt;</span> t<span class="op">.</span><span class="at">st</span> <span class="op">===</span> d<span class="op">.</span><span class="at">st</span> <span class="op">&amp;&amp;</span> t<span class="op">.</span><span class="at">year</span> <span class="op">===</span> d<span class="op">.</span><span class="at">year</span>)</span>
<span id="cb20-474"><a href="#cb20-474" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb20-475"><a href="#cb20-475" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> stTreatUnique<span class="op">;</span></span>
<span id="cb20-476"><a href="#cb20-476" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display hidden">
<div id="ojs-cell-20" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell hidden bslib-grid-item html-fill-item">
<div class="sourceCode cell-code hidden" id="cb21" data-startfrom="482" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 481;"><span id="cb21-482"><a href="#cb21-482" aria-hidden="true" tabindex="-1"></a>treatStIds <span class="op">=</span> <span class="bu">Array</span><span class="op">.</span><span class="fu">from</span>(treatStYearsLookup<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">st</span>))<span class="op">;</span></span>
<span id="cb21-483"><a href="#cb21-483" aria-hidden="true" tabindex="-1"></a>treatStYears <span class="op">=</span> <span class="bu">Array</span><span class="op">.</span><span class="fu">from</span>(treatStYearsLookup<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">year</span>))<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-21-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-21-2" data-nodetype="declaration">

</div>
</div>
</div>
</div>
<div class="bslib-sidebar-layout html-fill-item html-fill-container" data-bslib-sidebar-open="desktop" data-bslib-sidebar-init="true" style=" --bslib-sidebar-width: 170px" data-bslib-sidebar-border="false" data-bslib-sidebar-border-radius="false"><div class="main html-fill-container html-fill-item"><div class="sidebar-content html-fill-item html-fill-container">
<div class="tab-content bslib-grid html-fill-item html-fill-container" style="display: grid; grid-template-columns: minmax(3em, 1fr);
grid-auto-rows: minmax(0, 1fr);">
<div id="overall" class="dashboard-page tab-pane show active html-fill-item html-fill-container" data-orientation="rows" aria-labelledby="tab-overall">
<div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-rows: minmax(3em, 1fr) minmax(3em, 1fr); grid-auto-columns: minmax(0, 1fr);">
<div class="card cell html-fill-item html-fill-container bslib-card" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-body html-fill-item html-fill-container">
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb53" data-startfrom="2319" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 2318;"><span id="cb53-2319"><a href="#cb53-2319" aria-hidden="true" tabindex="-1"></a>modelResults <span class="op">?</span> <span class="fu">plotAggResults</span>(<span class="st">'e'</span>) <span class="op">:</span> <span class="fu">plotAggTrends</span>(<span class="st">'e'</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div id="ojs-cell-52" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div>
<div class="card cell html-fill-item html-fill-container bslib-card" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-body html-fill-item html-fill-container">
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb54" data-startfrom="2323" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 2322;"><span id="cb54-2323"><a href="#cb54-2323" aria-hidden="true" tabindex="-1"></a>modelResults <span class="op">?</span> <span class="fu">plotAggResults</span>(<span class="st">'cal'</span>) <span class="op">:</span> <span class="fu">plotAggTrends</span>(<span class="st">'cal'</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div id="ojs-cell-53" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div>
</div>
</div><div id="treatment-timing-groups" class="dashboard-page tab-pane grid-skip html-fill-item html-fill-container" data-scrolling="true" data-orientation="rows" aria-labelledby="tab-treatment-timing-groups">
<div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-rows: minmax(3em, 1fr) minmax(3em, 1fr) minmax(3em, 1fr) minmax(3em, 1fr) minmax(3em, 1fr) minmax(3em, 1fr); grid-auto-columns: minmax(0, 1fr);">
<div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-columns: minmax(3em, 1fr) minmax(3em, 1fr) minmax(3em, 1fr);
grid-auto-rows: minmax(0, 1fr);">
<div class="card cell html-fill-item html-fill-container bslib-card" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-body html-fill-item html-fill-container">
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb55" data-startfrom="2331" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 2330;"><span id="cb55-2331"><a href="#cb55-2331" aria-hidden="true" tabindex="-1"></a>modelResults <span class="op">?</span> <span class="fu">plotResults</span>(treatGroupIds[<span class="dv">0</span>]) <span class="op">:</span> <span class="fu">plotTrends</span>(treatGroupIds[<span class="dv">0</span>])<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div id="ojs-cell-54" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div><div class="card cell html-fill-item html-fill-container bslib-card" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-body html-fill-item html-fill-container">
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb56" data-startfrom="2335" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 2334;"><span id="cb56-2335"><a href="#cb56-2335" aria-hidden="true" tabindex="-1"></a>modelResults <span class="op">?</span> <span class="fu">plotResults</span>(treatGroupIds[<span class="dv">1</span>]) <span class="op">:</span> <span class="fu">plotTrends</span>(treatGroupIds[<span class="dv">1</span>])<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div id="ojs-cell-55" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div><div class="card cell html-fill-item html-fill-container bslib-card" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-body html-fill-item html-fill-container">
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb57" data-startfrom="2339" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 2338;"><span id="cb57-2339"><a href="#cb57-2339" aria-hidden="true" tabindex="-1"></a>modelResults <span class="op">?</span> <span class="fu">plotResults</span>(treatGroupIds[<span class="dv">2</span>]) <span class="op">:</span> <span class="fu">plotTrends</span>(treatGroupIds[<span class="dv">2</span>])<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div id="ojs-cell-56" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div>
</div>
<div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-columns: minmax(3em, 1fr) minmax(3em, 1fr) minmax(3em, 1fr);
grid-auto-rows: minmax(0, 1fr);">
<div class="card cell html-fill-item html-fill-container bslib-card" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-body html-fill-item html-fill-container">
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb58" data-startfrom="2345" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 2344;"><span id="cb58-2345"><a href="#cb58-2345" aria-hidden="true" tabindex="-1"></a>modelResults <span class="op">?</span> <span class="fu">plotResults</span>(treatGroupIds[<span class="dv">3</span>]) <span class="op">:</span> <span class="fu">plotTrends</span>(treatGroupIds[<span class="dv">3</span>])<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div id="ojs-cell-57" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div><div class="card cell html-fill-item html-fill-container bslib-card" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-body html-fill-item html-fill-container">
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb59" data-startfrom="2349" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 2348;"><span id="cb59-2349"><a href="#cb59-2349" aria-hidden="true" tabindex="-1"></a>modelResults <span class="op">?</span> <span class="fu">plotResults</span>(treatGroupIds[<span class="dv">4</span>]) <span class="op">:</span> <span class="fu">plotTrends</span>(treatGroupIds[<span class="dv">4</span>])<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div id="ojs-cell-58" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div><div class="card cell html-fill-item html-fill-container bslib-card" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-body html-fill-item html-fill-container">
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb60" data-startfrom="2353" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 2352;"><span id="cb60-2353"><a href="#cb60-2353" aria-hidden="true" tabindex="-1"></a>modelResults <span class="op">?</span> <span class="fu">plotResults</span>(treatGroupIds[<span class="dv">5</span>]) <span class="op">:</span> <span class="fu">plotTrends</span>(treatGroupIds[<span class="dv">5</span>])<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div id="ojs-cell-59" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div>
</div>
<div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-columns: minmax(3em, 1fr) minmax(3em, 1fr) minmax(3em, 1fr);
grid-auto-rows: minmax(0, 1fr);">
<div class="card cell html-fill-item html-fill-container bslib-card" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-body html-fill-item html-fill-container">
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb61" data-startfrom="2359" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 2358;"><span id="cb61-2359"><a href="#cb61-2359" aria-hidden="true" tabindex="-1"></a>modelResults <span class="op">?</span> <span class="fu">plotResults</span>(treatGroupIds[<span class="dv">6</span>]) <span class="op">:</span> <span class="fu">plotTrends</span>(treatGroupIds[<span class="dv">6</span>])<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div id="ojs-cell-60" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div><div class="card cell html-fill-item html-fill-container bslib-card" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-body html-fill-item html-fill-container">
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb62" data-startfrom="2363" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 2362;"><span id="cb62-2363"><a href="#cb62-2363" aria-hidden="true" tabindex="-1"></a>modelResults <span class="op">?</span> <span class="fu">plotResults</span>(treatGroupIds[<span class="dv">7</span>]) <span class="op">:</span> <span class="fu">plotTrends</span>(treatGroupIds[<span class="dv">7</span>])<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div id="ojs-cell-61" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div><div class="card cell html-fill-item html-fill-container bslib-card" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-body html-fill-item html-fill-container">
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb63" data-startfrom="2367" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 2366;"><span id="cb63-2367"><a href="#cb63-2367" aria-hidden="true" tabindex="-1"></a>modelResults <span class="op">?</span> <span class="fu">plotResults</span>(treatGroupIds[<span class="dv">8</span>]) <span class="op">:</span> <span class="fu">plotTrends</span>(treatGroupIds[<span class="dv">8</span>])<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div id="ojs-cell-62" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div>
</div>
<div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-columns: minmax(3em, 1fr) minmax(3em, 1fr) minmax(3em, 1fr);
grid-auto-rows: minmax(0, 1fr);">
<div class="card cell html-fill-item html-fill-container bslib-card" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-body html-fill-item html-fill-container">
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb64" data-startfrom="2373" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 2372;"><span id="cb64-2373"><a href="#cb64-2373" aria-hidden="true" tabindex="-1"></a>modelResults <span class="op">?</span> <span class="fu">plotResults</span>(treatGroupIds[<span class="dv">9</span>]) <span class="op">:</span> <span class="fu">plotTrends</span>(treatGroupIds[<span class="dv">9</span>])<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div id="ojs-cell-63" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div><div class="card cell html-fill-item html-fill-container bslib-card" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-body html-fill-item html-fill-container">
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb65" data-startfrom="2377" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 2376;"><span id="cb65-2377"><a href="#cb65-2377" aria-hidden="true" tabindex="-1"></a>modelResults <span class="op">?</span> <span class="fu">plotResults</span>(treatGroupIds[<span class="dv">10</span>]) <span class="op">:</span> <span class="fu">plotTrends</span>(treatGroupIds[<span class="dv">10</span>])<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div id="ojs-cell-64" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div><div class="card cell html-fill-item html-fill-container bslib-card" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-body html-fill-item html-fill-container">
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb66" data-startfrom="2381" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 2380;"><span id="cb66-2381"><a href="#cb66-2381" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb66-2382"><a href="#cb66-2382" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (stacked <span class="op">!==</span> <span class="st">'no'</span>) {</span>
<span id="cb66-2383"><a href="#cb66-2383" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="bu">Number</span>(treatGroupIds[<span class="dv">11</span>]) <span class="op">+</span> <span class="bu">Number</span>(stacked) <span class="op">-</span> <span class="dv">1</span> <span class="op">&lt;=</span> <span class="dv">2019</span>) {</span>
<span id="cb66-2384"><a href="#cb66-2384" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> modelResults <span class="op">?</span> </span>
<span id="cb66-2385"><a href="#cb66-2385" aria-hidden="true" tabindex="-1"></a>        <span class="fu">plotResults</span>(treatGroupIds[<span class="dv">11</span>]) <span class="op">:</span> <span class="fu">plotTrends</span>(treatGroupIds[<span class="dv">11</span>])<span class="op">;</span></span>
<span id="cb66-2386"><a href="#cb66-2386" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb66-2387"><a href="#cb66-2387" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> <span class="st">''</span><span class="op">;</span></span>
<span id="cb66-2388"><a href="#cb66-2388" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb66-2389"><a href="#cb66-2389" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb66-2390"><a href="#cb66-2390" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> modelResults <span class="op">?</span> </span>
<span id="cb66-2391"><a href="#cb66-2391" aria-hidden="true" tabindex="-1"></a>      <span class="fu">plotResults</span>(treatGroupIds[<span class="dv">11</span>]) <span class="op">:</span> <span class="fu">plotTrends</span>(treatGroupIds[<span class="dv">11</span>])<span class="op">;</span></span>
<span id="cb66-2392"><a href="#cb66-2392" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb66-2393"><a href="#cb66-2393" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div id="ojs-cell-65" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div>
</div>
<div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-columns: minmax(3em, 1fr) minmax(3em, 1fr) minmax(3em, 1fr);
grid-auto-rows: minmax(0, 1fr);">
<div class="card cell html-fill-item html-fill-container bslib-card" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-body html-fill-item html-fill-container">
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb67" data-startfrom="2399" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 2398;"><span id="cb67-2399"><a href="#cb67-2399" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb67-2400"><a href="#cb67-2400" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (stacked <span class="op">!==</span> <span class="st">'no'</span>) {</span>
<span id="cb67-2401"><a href="#cb67-2401" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="bu">Number</span>(treatGroupIds[<span class="dv">12</span>]) <span class="op">+</span> <span class="bu">Number</span>(stacked) <span class="op">-</span> <span class="dv">1</span> <span class="op">&lt;=</span> <span class="dv">2019</span>) {</span>
<span id="cb67-2402"><a href="#cb67-2402" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> modelResults <span class="op">?</span> </span>
<span id="cb67-2403"><a href="#cb67-2403" aria-hidden="true" tabindex="-1"></a>        <span class="fu">plotResults</span>(treatGroupIds[<span class="dv">12</span>]) <span class="op">:</span> <span class="fu">plotTrends</span>(treatGroupIds[<span class="dv">12</span>])<span class="op">;</span></span>
<span id="cb67-2404"><a href="#cb67-2404" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb67-2405"><a href="#cb67-2405" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> <span class="st">''</span><span class="op">;</span></span>
<span id="cb67-2406"><a href="#cb67-2406" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb67-2407"><a href="#cb67-2407" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb67-2408"><a href="#cb67-2408" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> modelResults <span class="op">?</span> </span>
<span id="cb67-2409"><a href="#cb67-2409" aria-hidden="true" tabindex="-1"></a>      <span class="fu">plotResults</span>(treatGroupIds[<span class="dv">12</span>]) <span class="op">:</span> <span class="fu">plotTrends</span>(treatGroupIds[<span class="dv">12</span>])<span class="op">;</span></span>
<span id="cb67-2410"><a href="#cb67-2410" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb67-2411"><a href="#cb67-2411" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div id="ojs-cell-66" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div><div class="card cell html-fill-item html-fill-container bslib-card" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-body html-fill-item html-fill-container">
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb68" data-startfrom="2415" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 2414;"><span id="cb68-2415"><a href="#cb68-2415" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb68-2416"><a href="#cb68-2416" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (stacked <span class="op">!==</span> <span class="st">'no'</span>) {</span>
<span id="cb68-2417"><a href="#cb68-2417" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="bu">Number</span>(treatGroupIds[<span class="dv">13</span>]) <span class="op">+</span> <span class="bu">Number</span>(stacked) <span class="op">-</span> <span class="dv">1</span> <span class="op">&lt;=</span> <span class="dv">2019</span>) {</span>
<span id="cb68-2418"><a href="#cb68-2418" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> modelResults <span class="op">?</span> </span>
<span id="cb68-2419"><a href="#cb68-2419" aria-hidden="true" tabindex="-1"></a>        <span class="fu">plotResults</span>(treatGroupIds[<span class="dv">13</span>]) <span class="op">:</span> <span class="fu">plotTrends</span>(treatGroupIds[<span class="dv">13</span>])<span class="op">;</span></span>
<span id="cb68-2420"><a href="#cb68-2420" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb68-2421"><a href="#cb68-2421" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> <span class="st">''</span><span class="op">;</span></span>
<span id="cb68-2422"><a href="#cb68-2422" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb68-2423"><a href="#cb68-2423" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb68-2424"><a href="#cb68-2424" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> modelResults <span class="op">?</span> </span>
<span id="cb68-2425"><a href="#cb68-2425" aria-hidden="true" tabindex="-1"></a>      <span class="fu">plotResults</span>(treatGroupIds[<span class="dv">13</span>]) <span class="op">:</span> <span class="fu">plotTrends</span>(treatGroupIds[<span class="dv">13</span>])<span class="op">;</span></span>
<span id="cb68-2426"><a href="#cb68-2426" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb68-2427"><a href="#cb68-2427" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div id="ojs-cell-67" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div><div class="card cell html-fill-item html-fill-container bslib-card" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-body html-fill-item html-fill-container">
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb69" data-startfrom="2431" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 2430;"><span id="cb69-2431"><a href="#cb69-2431" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb69-2432"><a href="#cb69-2432" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (treatGroupIds<span class="op">.</span><span class="at">length</span> <span class="op">&gt;</span> <span class="dv">14</span>) {</span>
<span id="cb69-2433"><a href="#cb69-2433" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (stacked <span class="op">!==</span> <span class="st">'no'</span>) {</span>
<span id="cb69-2434"><a href="#cb69-2434" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="bu">Number</span>(treatGroupIds[<span class="dv">14</span>]) <span class="op">+</span> <span class="bu">Number</span>(stacked) <span class="op">-</span> <span class="dv">1</span> <span class="op">&lt;=</span> <span class="dv">2019</span>) {</span>
<span id="cb69-2435"><a href="#cb69-2435" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> modelResults <span class="op">?</span> </span>
<span id="cb69-2436"><a href="#cb69-2436" aria-hidden="true" tabindex="-1"></a>          <span class="fu">plotResults</span>(treatGroupIds[<span class="dv">14</span>]) <span class="op">:</span> <span class="fu">plotTrends</span>(treatGroupIds[<span class="dv">14</span>])<span class="op">;</span></span>
<span id="cb69-2437"><a href="#cb69-2437" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb69-2438"><a href="#cb69-2438" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">''</span><span class="op">;</span></span>
<span id="cb69-2439"><a href="#cb69-2439" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb69-2440"><a href="#cb69-2440" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb69-2441"><a href="#cb69-2441" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> modelResults <span class="op">?</span> </span>
<span id="cb69-2442"><a href="#cb69-2442" aria-hidden="true" tabindex="-1"></a>        <span class="fu">plotResults</span>(treatGroupIds[<span class="dv">14</span>]) <span class="op">:</span> <span class="fu">plotTrends</span>(treatGroupIds[<span class="dv">14</span>])<span class="op">;</span></span>
<span id="cb69-2443"><a href="#cb69-2443" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb69-2444"><a href="#cb69-2444" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb69-2445"><a href="#cb69-2445" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="st">''</span><span class="op">;</span></span>
<span id="cb69-2446"><a href="#cb69-2446" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb69-2447"><a href="#cb69-2447" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div id="ojs-cell-68" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div>
</div>
<div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-columns: minmax(3em, 1fr) minmax(3em, 1fr) minmax(3em, 1fr);
grid-auto-rows: minmax(0, 1fr);">
<div class="card cell html-fill-item html-fill-container bslib-card" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-body html-fill-item html-fill-container">
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb70" data-startfrom="2453" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 2452;"><span id="cb70-2453"><a href="#cb70-2453" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb70-2454"><a href="#cb70-2454" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (treatGroupIds<span class="op">.</span><span class="at">length</span> <span class="op">&gt;</span> <span class="dv">15</span>) {</span>
<span id="cb70-2455"><a href="#cb70-2455" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (stacked <span class="op">!==</span> <span class="st">'no'</span>) {</span>
<span id="cb70-2456"><a href="#cb70-2456" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="bu">Number</span>(treatGroupIds[<span class="dv">15</span>]) <span class="op">+</span> <span class="bu">Number</span>(stacked) <span class="op">-</span> <span class="dv">1</span> <span class="op">&lt;=</span> <span class="dv">2019</span>) {</span>
<span id="cb70-2457"><a href="#cb70-2457" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> modelResults <span class="op">?</span> </span>
<span id="cb70-2458"><a href="#cb70-2458" aria-hidden="true" tabindex="-1"></a>          <span class="fu">plotResults</span>(treatGroupIds[<span class="dv">15</span>]) <span class="op">:</span> <span class="fu">plotTrends</span>(treatGroupIds[<span class="dv">15</span>])<span class="op">;</span></span>
<span id="cb70-2459"><a href="#cb70-2459" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb70-2460"><a href="#cb70-2460" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">''</span><span class="op">;</span></span>
<span id="cb70-2461"><a href="#cb70-2461" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb70-2462"><a href="#cb70-2462" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb70-2463"><a href="#cb70-2463" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> modelResults <span class="op">?</span> </span>
<span id="cb70-2464"><a href="#cb70-2464" aria-hidden="true" tabindex="-1"></a>        <span class="fu">plotResults</span>(treatGroupIds[<span class="dv">15</span>]) <span class="op">:</span> <span class="fu">plotTrends</span>(treatGroupIds[<span class="dv">15</span>])<span class="op">;</span></span>
<span id="cb70-2465"><a href="#cb70-2465" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb70-2466"><a href="#cb70-2466" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb70-2467"><a href="#cb70-2467" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="st">''</span><span class="op">;</span></span>
<span id="cb70-2468"><a href="#cb70-2468" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb70-2469"><a href="#cb70-2469" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div id="ojs-cell-69" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div><div class="card cell html-fill-item html-fill-container bslib-card" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-body html-fill-item html-fill-container">
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb71" data-startfrom="2473" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 2472;"><span id="cb71-2473"><a href="#cb71-2473" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb71-2474"><a href="#cb71-2474" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (treatGroupIds<span class="op">.</span><span class="at">length</span> <span class="op">&gt;</span> <span class="dv">16</span>) {</span>
<span id="cb71-2475"><a href="#cb71-2475" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (stacked <span class="op">!==</span> <span class="st">'no'</span>) {</span>
<span id="cb71-2476"><a href="#cb71-2476" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="bu">Number</span>(treatGroupIds[<span class="dv">16</span>]) <span class="op">+</span> <span class="bu">Number</span>(stacked) <span class="op">-</span> <span class="dv">1</span> <span class="op">&lt;=</span> <span class="dv">2019</span>) {</span>
<span id="cb71-2477"><a href="#cb71-2477" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> modelResults <span class="op">?</span> </span>
<span id="cb71-2478"><a href="#cb71-2478" aria-hidden="true" tabindex="-1"></a>          <span class="fu">plotResults</span>(treatGroupIds[<span class="dv">16</span>]) <span class="op">:</span> <span class="fu">plotTrends</span>(treatGroupIds[<span class="dv">16</span>])<span class="op">;</span></span>
<span id="cb71-2479"><a href="#cb71-2479" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb71-2480"><a href="#cb71-2480" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">''</span><span class="op">;</span></span>
<span id="cb71-2481"><a href="#cb71-2481" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb71-2482"><a href="#cb71-2482" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb71-2483"><a href="#cb71-2483" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> modelResults <span class="op">?</span> </span>
<span id="cb71-2484"><a href="#cb71-2484" aria-hidden="true" tabindex="-1"></a>        <span class="fu">plotResults</span>(treatGroupIds[<span class="dv">16</span>]) <span class="op">:</span> <span class="fu">plotTrends</span>(treatGroupIds[<span class="dv">16</span>])<span class="op">;</span></span>
<span id="cb71-2485"><a href="#cb71-2485" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb71-2486"><a href="#cb71-2486" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb71-2487"><a href="#cb71-2487" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="st">''</span><span class="op">;</span></span>
<span id="cb71-2488"><a href="#cb71-2488" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb71-2489"><a href="#cb71-2489" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div id="ojs-cell-70" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div><div class="card cell html-fill-item html-fill-container bslib-card" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-body html-fill-item html-fill-container">
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb72" data-startfrom="2493" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 2492;"><span id="cb72-2493"><a href="#cb72-2493" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb72-2494"><a href="#cb72-2494" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (treatGroupIds<span class="op">.</span><span class="at">length</span> <span class="op">&gt;</span> <span class="dv">17</span>) {</span>
<span id="cb72-2495"><a href="#cb72-2495" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (stacked <span class="op">!==</span> <span class="st">'no'</span>) {</span>
<span id="cb72-2496"><a href="#cb72-2496" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="bu">Number</span>(treatGroupIds[<span class="dv">17</span>]) <span class="op">+</span> <span class="bu">Number</span>(stacked) <span class="op">-</span> <span class="dv">1</span> <span class="op">&lt;=</span> <span class="dv">2019</span>) {</span>
<span id="cb72-2497"><a href="#cb72-2497" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> modelResults <span class="op">?</span> </span>
<span id="cb72-2498"><a href="#cb72-2498" aria-hidden="true" tabindex="-1"></a>          <span class="fu">plotResults</span>(treatGroupIds[<span class="dv">17</span>]) <span class="op">:</span> <span class="fu">plotTrends</span>(treatGroupIds[<span class="dv">17</span>])<span class="op">;</span></span>
<span id="cb72-2499"><a href="#cb72-2499" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb72-2500"><a href="#cb72-2500" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">''</span><span class="op">;</span></span>
<span id="cb72-2501"><a href="#cb72-2501" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb72-2502"><a href="#cb72-2502" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb72-2503"><a href="#cb72-2503" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> modelResults <span class="op">?</span> </span>
<span id="cb72-2504"><a href="#cb72-2504" aria-hidden="true" tabindex="-1"></a>        <span class="fu">plotResults</span>(treatGroupIds[<span class="dv">17</span>]) <span class="op">:</span> <span class="fu">plotTrends</span>(treatGroupIds[<span class="dv">17</span>])<span class="op">;</span></span>
<span id="cb72-2505"><a href="#cb72-2505" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb72-2506"><a href="#cb72-2506" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb72-2507"><a href="#cb72-2507" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="st">''</span><span class="op">;</span></span>
<span id="cb72-2508"><a href="#cb72-2508" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb72-2509"><a href="#cb72-2509" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div id="ojs-cell-71" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div>
</div>
</div>
</div><div id="individual-states" class="dashboard-page tab-pane grid-skip html-fill-item html-fill-container" data-scrolling="true" data-orientation="rows" aria-labelledby="tab-individual-states">
<div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-rows: minmax(3em, 1fr) minmax(3em, 1fr) minmax(3em, 1fr) minmax(3em, 1fr) minmax(3em, 1fr) minmax(3em, 1fr) minmax(3em, 1fr) minmax(3em, 1fr) minmax(3em, 1fr) minmax(3em, 1fr); grid-auto-columns: minmax(0, 1fr);">
<div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-columns: minmax(3em, 1fr) minmax(3em, 1fr) minmax(3em, 1fr);
grid-auto-rows: minmax(0, 1fr);">
<div class="card cell html-fill-item html-fill-container bslib-card" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-body html-fill-item html-fill-container">
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb73" data-startfrom="2517" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 2516;"><span id="cb73-2517"><a href="#cb73-2517" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb73-2518"><a href="#cb73-2518" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (stacked <span class="op">!==</span> <span class="st">'no'</span>) {</span>
<span id="cb73-2519"><a href="#cb73-2519" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="bu">Number</span>(treatStYears[<span class="dv">0</span>]) <span class="op">+</span> <span class="bu">Number</span>(stacked) <span class="op">-</span> <span class="dv">1</span> <span class="op">&lt;=</span> <span class="dv">2019</span>) {</span>
<span id="cb73-2520"><a href="#cb73-2520" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> modelResults <span class="op">?</span> </span>
<span id="cb73-2521"><a href="#cb73-2521" aria-hidden="true" tabindex="-1"></a>        <span class="fu">plotResults</span>(treatStIds[<span class="dv">0</span>]) <span class="op">:</span> <span class="fu">plotTrends</span>(treatStIds[<span class="dv">0</span>])<span class="op">;</span></span>
<span id="cb73-2522"><a href="#cb73-2522" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb73-2523"><a href="#cb73-2523" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> <span class="st">''</span><span class="op">;</span></span>
<span id="cb73-2524"><a href="#cb73-2524" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb73-2525"><a href="#cb73-2525" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb73-2526"><a href="#cb73-2526" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> modelResults <span class="op">?</span> <span class="fu">plotResults</span>(treatStIds[<span class="dv">0</span>]) <span class="op">:</span> <span class="fu">plotTrends</span>(treatStIds[<span class="dv">0</span>])<span class="op">;</span></span>
<span id="cb73-2527"><a href="#cb73-2527" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb73-2528"><a href="#cb73-2528" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div id="ojs-cell-72" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div><div class="card cell html-fill-item html-fill-container bslib-card" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-body html-fill-item html-fill-container">
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb74" data-startfrom="2532" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 2531;"><span id="cb74-2532"><a href="#cb74-2532" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb74-2533"><a href="#cb74-2533" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (stacked <span class="op">!==</span> <span class="st">'no'</span>) {</span>
<span id="cb74-2534"><a href="#cb74-2534" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="bu">Number</span>(treatStYears[<span class="dv">1</span>]) <span class="op">+</span> <span class="bu">Number</span>(stacked) <span class="op">-</span> <span class="dv">1</span> <span class="op">&lt;=</span> <span class="dv">2019</span>) {</span>
<span id="cb74-2535"><a href="#cb74-2535" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> modelResults <span class="op">?</span> </span>
<span id="cb74-2536"><a href="#cb74-2536" aria-hidden="true" tabindex="-1"></a>        <span class="fu">plotResults</span>(treatStIds[<span class="dv">1</span>]) <span class="op">:</span> <span class="fu">plotTrends</span>(treatStIds[<span class="dv">1</span>])<span class="op">;</span></span>
<span id="cb74-2537"><a href="#cb74-2537" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb74-2538"><a href="#cb74-2538" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> <span class="st">''</span><span class="op">;</span></span>
<span id="cb74-2539"><a href="#cb74-2539" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb74-2540"><a href="#cb74-2540" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb74-2541"><a href="#cb74-2541" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> modelResults <span class="op">?</span> <span class="fu">plotResults</span>(treatStIds[<span class="dv">1</span>]) <span class="op">:</span> <span class="fu">plotTrends</span>(treatStIds[<span class="dv">1</span>])<span class="op">;</span></span>
<span id="cb74-2542"><a href="#cb74-2542" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb74-2543"><a href="#cb74-2543" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div id="ojs-cell-73" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div><div class="card cell html-fill-item html-fill-container bslib-card" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-body html-fill-item html-fill-container">
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb75" data-startfrom="2547" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 2546;"><span id="cb75-2547"><a href="#cb75-2547" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb75-2548"><a href="#cb75-2548" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (stacked <span class="op">!==</span> <span class="st">'no'</span>) {</span>
<span id="cb75-2549"><a href="#cb75-2549" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="bu">Number</span>(treatStYears[<span class="dv">2</span>]) <span class="op">+</span> <span class="bu">Number</span>(stacked) <span class="op">-</span> <span class="dv">1</span> <span class="op">&lt;=</span> <span class="dv">2019</span>) {</span>
<span id="cb75-2550"><a href="#cb75-2550" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> modelResults <span class="op">?</span> </span>
<span id="cb75-2551"><a href="#cb75-2551" aria-hidden="true" tabindex="-1"></a>        <span class="fu">plotResults</span>(treatStIds[<span class="dv">2</span>]) <span class="op">:</span> <span class="fu">plotTrends</span>(treatStIds[<span class="dv">2</span>])<span class="op">;</span></span>
<span id="cb75-2552"><a href="#cb75-2552" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb75-2553"><a href="#cb75-2553" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> <span class="st">''</span><span class="op">;</span></span>
<span id="cb75-2554"><a href="#cb75-2554" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb75-2555"><a href="#cb75-2555" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb75-2556"><a href="#cb75-2556" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> modelResults <span class="op">?</span> <span class="fu">plotResults</span>(treatStIds[<span class="dv">2</span>]) <span class="op">:</span> <span class="fu">plotTrends</span>(treatStIds[<span class="dv">2</span>])<span class="op">;</span></span>
<span id="cb75-2557"><a href="#cb75-2557" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb75-2558"><a href="#cb75-2558" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div id="ojs-cell-74" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div>
</div>
<div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-columns: minmax(3em, 1fr) minmax(3em, 1fr) minmax(3em, 1fr);
grid-auto-rows: minmax(0, 1fr);">
<div class="card cell html-fill-item html-fill-container bslib-card" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-body html-fill-item html-fill-container">
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb76" data-startfrom="2564" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 2563;"><span id="cb76-2564"><a href="#cb76-2564" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb76-2565"><a href="#cb76-2565" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (stacked <span class="op">!==</span> <span class="st">'no'</span>) {</span>
<span id="cb76-2566"><a href="#cb76-2566" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="bu">Number</span>(treatStYears[<span class="dv">3</span>]) <span class="op">+</span> <span class="bu">Number</span>(stacked) <span class="op">-</span> <span class="dv">1</span> <span class="op">&lt;=</span> <span class="dv">2019</span>) {</span>
<span id="cb76-2567"><a href="#cb76-2567" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> modelResults <span class="op">?</span> </span>
<span id="cb76-2568"><a href="#cb76-2568" aria-hidden="true" tabindex="-1"></a>        <span class="fu">plotResults</span>(treatStIds[<span class="dv">3</span>]) <span class="op">:</span> <span class="fu">plotTrends</span>(treatStIds[<span class="dv">3</span>])<span class="op">;</span></span>
<span id="cb76-2569"><a href="#cb76-2569" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb76-2570"><a href="#cb76-2570" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> <span class="st">''</span><span class="op">;</span></span>
<span id="cb76-2571"><a href="#cb76-2571" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb76-2572"><a href="#cb76-2572" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb76-2573"><a href="#cb76-2573" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> modelResults <span class="op">?</span> <span class="fu">plotResults</span>(treatStIds[<span class="dv">3</span>]) <span class="op">:</span> <span class="fu">plotTrends</span>(treatStIds[<span class="dv">3</span>])<span class="op">;</span></span>
<span id="cb76-2574"><a href="#cb76-2574" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb76-2575"><a href="#cb76-2575" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div id="ojs-cell-75" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div><div class="card cell html-fill-item html-fill-container bslib-card" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-body html-fill-item html-fill-container">
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb77" data-startfrom="2579" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 2578;"><span id="cb77-2579"><a href="#cb77-2579" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb77-2580"><a href="#cb77-2580" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (stacked <span class="op">!==</span> <span class="st">'no'</span>) {</span>
<span id="cb77-2581"><a href="#cb77-2581" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="bu">Number</span>(treatStYears[<span class="dv">4</span>]) <span class="op">+</span> <span class="bu">Number</span>(stacked) <span class="op">-</span> <span class="dv">1</span> <span class="op">&lt;=</span> <span class="dv">2019</span>) {</span>
<span id="cb77-2582"><a href="#cb77-2582" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> modelResults <span class="op">?</span> </span>
<span id="cb77-2583"><a href="#cb77-2583" aria-hidden="true" tabindex="-1"></a>        <span class="fu">plotResults</span>(treatStIds[<span class="dv">4</span>]) <span class="op">:</span> <span class="fu">plotTrends</span>(treatStIds[<span class="dv">4</span>])<span class="op">;</span></span>
<span id="cb77-2584"><a href="#cb77-2584" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb77-2585"><a href="#cb77-2585" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> <span class="st">''</span><span class="op">;</span></span>
<span id="cb77-2586"><a href="#cb77-2586" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb77-2587"><a href="#cb77-2587" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb77-2588"><a href="#cb77-2588" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> modelResults <span class="op">?</span> <span class="fu">plotResults</span>(treatStIds[<span class="dv">4</span>]) <span class="op">:</span> <span class="fu">plotTrends</span>(treatStIds[<span class="dv">4</span>])<span class="op">;</span></span>
<span id="cb77-2589"><a href="#cb77-2589" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb77-2590"><a href="#cb77-2590" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div id="ojs-cell-76" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div><div class="card cell html-fill-item html-fill-container bslib-card" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-body html-fill-item html-fill-container">
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb78" data-startfrom="2594" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 2593;"><span id="cb78-2594"><a href="#cb78-2594" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb78-2595"><a href="#cb78-2595" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (stacked <span class="op">!==</span> <span class="st">'no'</span>) {</span>
<span id="cb78-2596"><a href="#cb78-2596" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="bu">Number</span>(treatStYears[<span class="dv">5</span>]) <span class="op">+</span> <span class="bu">Number</span>(stacked) <span class="op">-</span> <span class="dv">1</span> <span class="op">&lt;=</span> <span class="dv">2019</span>) {</span>
<span id="cb78-2597"><a href="#cb78-2597" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> modelResults <span class="op">?</span> </span>
<span id="cb78-2598"><a href="#cb78-2598" aria-hidden="true" tabindex="-1"></a>        <span class="fu">plotResults</span>(treatStIds[<span class="dv">5</span>]) <span class="op">:</span> <span class="fu">plotTrends</span>(treatStIds[<span class="dv">5</span>])<span class="op">;</span></span>
<span id="cb78-2599"><a href="#cb78-2599" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb78-2600"><a href="#cb78-2600" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> <span class="st">''</span><span class="op">;</span></span>
<span id="cb78-2601"><a href="#cb78-2601" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb78-2602"><a href="#cb78-2602" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb78-2603"><a href="#cb78-2603" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> modelResults <span class="op">?</span> <span class="fu">plotResults</span>(treatStIds[<span class="dv">5</span>]) <span class="op">:</span> <span class="fu">plotTrends</span>(treatStIds[<span class="dv">5</span>])<span class="op">;</span></span>
<span id="cb78-2604"><a href="#cb78-2604" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb78-2605"><a href="#cb78-2605" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div id="ojs-cell-77" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div>
</div>
<div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-columns: minmax(3em, 1fr) minmax(3em, 1fr) minmax(3em, 1fr);
grid-auto-rows: minmax(0, 1fr);">
<div class="card cell html-fill-item html-fill-container bslib-card" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-body html-fill-item html-fill-container">
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb79" data-startfrom="2611" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 2610;"><span id="cb79-2611"><a href="#cb79-2611" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb79-2612"><a href="#cb79-2612" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (stacked <span class="op">!==</span> <span class="st">'no'</span>) {</span>
<span id="cb79-2613"><a href="#cb79-2613" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="bu">Number</span>(treatStYears[<span class="dv">6</span>]) <span class="op">+</span> <span class="bu">Number</span>(stacked) <span class="op">-</span> <span class="dv">1</span> <span class="op">&lt;=</span> <span class="dv">2019</span>) {</span>
<span id="cb79-2614"><a href="#cb79-2614" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> modelResults <span class="op">?</span> </span>
<span id="cb79-2615"><a href="#cb79-2615" aria-hidden="true" tabindex="-1"></a>        <span class="fu">plotResults</span>(treatStIds[<span class="dv">6</span>]) <span class="op">:</span> <span class="fu">plotTrends</span>(treatStIds[<span class="dv">6</span>])<span class="op">;</span></span>
<span id="cb79-2616"><a href="#cb79-2616" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb79-2617"><a href="#cb79-2617" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> <span class="st">''</span><span class="op">;</span></span>
<span id="cb79-2618"><a href="#cb79-2618" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb79-2619"><a href="#cb79-2619" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb79-2620"><a href="#cb79-2620" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> modelResults <span class="op">?</span> <span class="fu">plotResults</span>(treatStIds[<span class="dv">6</span>]) <span class="op">:</span> <span class="fu">plotTrends</span>(treatStIds[<span class="dv">6</span>])<span class="op">;</span></span>
<span id="cb79-2621"><a href="#cb79-2621" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb79-2622"><a href="#cb79-2622" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div id="ojs-cell-78" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div><div class="card cell html-fill-item html-fill-container bslib-card" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-body html-fill-item html-fill-container">
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb80" data-startfrom="2626" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 2625;"><span id="cb80-2626"><a href="#cb80-2626" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb80-2627"><a href="#cb80-2627" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (stacked <span class="op">!==</span> <span class="st">'no'</span>) {</span>
<span id="cb80-2628"><a href="#cb80-2628" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="bu">Number</span>(treatStYears[<span class="dv">7</span>]) <span class="op">+</span> <span class="bu">Number</span>(stacked) <span class="op">-</span> <span class="dv">1</span> <span class="op">&lt;=</span> <span class="dv">2019</span>) {</span>
<span id="cb80-2629"><a href="#cb80-2629" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> modelResults <span class="op">?</span> </span>
<span id="cb80-2630"><a href="#cb80-2630" aria-hidden="true" tabindex="-1"></a>        <span class="fu">plotResults</span>(treatStIds[<span class="dv">7</span>]) <span class="op">:</span> <span class="fu">plotTrends</span>(treatStIds[<span class="dv">7</span>])<span class="op">;</span></span>
<span id="cb80-2631"><a href="#cb80-2631" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb80-2632"><a href="#cb80-2632" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> <span class="st">''</span><span class="op">;</span></span>
<span id="cb80-2633"><a href="#cb80-2633" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb80-2634"><a href="#cb80-2634" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb80-2635"><a href="#cb80-2635" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> modelResults <span class="op">?</span> <span class="fu">plotResults</span>(treatStIds[<span class="dv">7</span>]) <span class="op">:</span> <span class="fu">plotTrends</span>(treatStIds[<span class="dv">7</span>])<span class="op">;</span></span>
<span id="cb80-2636"><a href="#cb80-2636" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb80-2637"><a href="#cb80-2637" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div id="ojs-cell-79" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div><div class="card cell html-fill-item html-fill-container bslib-card" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-body html-fill-item html-fill-container">
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb81" data-startfrom="2641" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 2640;"><span id="cb81-2641"><a href="#cb81-2641" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb81-2642"><a href="#cb81-2642" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (stacked <span class="op">!==</span> <span class="st">'no'</span>) {</span>
<span id="cb81-2643"><a href="#cb81-2643" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="bu">Number</span>(treatStYears[<span class="dv">8</span>]) <span class="op">+</span> <span class="bu">Number</span>(stacked) <span class="op">-</span> <span class="dv">1</span> <span class="op">&lt;=</span> <span class="dv">2019</span>) {</span>
<span id="cb81-2644"><a href="#cb81-2644" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> modelResults <span class="op">?</span> </span>
<span id="cb81-2645"><a href="#cb81-2645" aria-hidden="true" tabindex="-1"></a>        <span class="fu">plotResults</span>(treatStIds[<span class="dv">8</span>]) <span class="op">:</span> <span class="fu">plotTrends</span>(treatStIds[<span class="dv">8</span>])<span class="op">;</span></span>
<span id="cb81-2646"><a href="#cb81-2646" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb81-2647"><a href="#cb81-2647" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> <span class="st">''</span><span class="op">;</span></span>
<span id="cb81-2648"><a href="#cb81-2648" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb81-2649"><a href="#cb81-2649" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb81-2650"><a href="#cb81-2650" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> modelResults <span class="op">?</span> <span class="fu">plotResults</span>(treatStIds[<span class="dv">8</span>]) <span class="op">:</span> <span class="fu">plotTrends</span>(treatStIds[<span class="dv">8</span>])<span class="op">;</span></span>
<span id="cb81-2651"><a href="#cb81-2651" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb81-2652"><a href="#cb81-2652" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div id="ojs-cell-80" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div>
</div>
<div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-columns: minmax(3em, 1fr) minmax(3em, 1fr) minmax(3em, 1fr);
grid-auto-rows: minmax(0, 1fr);">
<div class="card cell html-fill-item html-fill-container bslib-card" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-body html-fill-item html-fill-container">
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb82" data-startfrom="2658" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 2657;"><span id="cb82-2658"><a href="#cb82-2658" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb82-2659"><a href="#cb82-2659" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (stacked <span class="op">!==</span> <span class="st">'no'</span>) {</span>
<span id="cb82-2660"><a href="#cb82-2660" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="bu">Number</span>(treatStYears[<span class="dv">9</span>]) <span class="op">+</span> <span class="bu">Number</span>(stacked) <span class="op">-</span> <span class="dv">1</span> <span class="op">&lt;=</span> <span class="dv">2019</span>) {</span>
<span id="cb82-2661"><a href="#cb82-2661" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> modelResults <span class="op">?</span> </span>
<span id="cb82-2662"><a href="#cb82-2662" aria-hidden="true" tabindex="-1"></a>        <span class="fu">plotResults</span>(treatStIds[<span class="dv">9</span>]) <span class="op">:</span> <span class="fu">plotTrends</span>(treatStIds[<span class="dv">9</span>])<span class="op">;</span></span>
<span id="cb82-2663"><a href="#cb82-2663" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb82-2664"><a href="#cb82-2664" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> <span class="st">''</span><span class="op">;</span></span>
<span id="cb82-2665"><a href="#cb82-2665" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb82-2666"><a href="#cb82-2666" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb82-2667"><a href="#cb82-2667" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> modelResults <span class="op">?</span> <span class="fu">plotResults</span>(treatStIds[<span class="dv">9</span>]) <span class="op">:</span> <span class="fu">plotTrends</span>(treatStIds[<span class="dv">9</span>])<span class="op">;</span></span>
<span id="cb82-2668"><a href="#cb82-2668" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb82-2669"><a href="#cb82-2669" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div id="ojs-cell-81" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div><div class="card cell html-fill-item html-fill-container bslib-card" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-body html-fill-item html-fill-container">
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb83" data-startfrom="2673" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 2672;"><span id="cb83-2673"><a href="#cb83-2673" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb83-2674"><a href="#cb83-2674" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (stacked <span class="op">!==</span> <span class="st">'no'</span>) {</span>
<span id="cb83-2675"><a href="#cb83-2675" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="bu">Number</span>(treatStYears[<span class="dv">10</span>]) <span class="op">+</span> <span class="bu">Number</span>(stacked) <span class="op">-</span> <span class="dv">1</span> <span class="op">&lt;=</span> <span class="dv">2019</span>) {</span>
<span id="cb83-2676"><a href="#cb83-2676" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> modelResults <span class="op">?</span> </span>
<span id="cb83-2677"><a href="#cb83-2677" aria-hidden="true" tabindex="-1"></a>        <span class="fu">plotResults</span>(treatStIds[<span class="dv">10</span>]) <span class="op">:</span> <span class="fu">plotTrends</span>(treatStIds[<span class="dv">10</span>])<span class="op">;</span></span>
<span id="cb83-2678"><a href="#cb83-2678" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb83-2679"><a href="#cb83-2679" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> <span class="st">''</span><span class="op">;</span></span>
<span id="cb83-2680"><a href="#cb83-2680" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb83-2681"><a href="#cb83-2681" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb83-2682"><a href="#cb83-2682" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> modelResults <span class="op">?</span> <span class="fu">plotResults</span>(treatStIds[<span class="dv">10</span>]) <span class="op">:</span> <span class="fu">plotTrends</span>(treatStIds[<span class="dv">10</span>])<span class="op">;</span></span>
<span id="cb83-2683"><a href="#cb83-2683" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb83-2684"><a href="#cb83-2684" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div id="ojs-cell-82" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div><div class="card cell html-fill-item html-fill-container bslib-card" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-body html-fill-item html-fill-container">
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb84" data-startfrom="2688" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 2687;"><span id="cb84-2688"><a href="#cb84-2688" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb84-2689"><a href="#cb84-2689" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (stacked <span class="op">!==</span> <span class="st">'no'</span>) {</span>
<span id="cb84-2690"><a href="#cb84-2690" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="bu">Number</span>(treatStYears[<span class="dv">11</span>]) <span class="op">+</span> <span class="bu">Number</span>(stacked) <span class="op">-</span> <span class="dv">1</span> <span class="op">&lt;=</span> <span class="dv">2019</span>) {</span>
<span id="cb84-2691"><a href="#cb84-2691" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> modelResults <span class="op">?</span> </span>
<span id="cb84-2692"><a href="#cb84-2692" aria-hidden="true" tabindex="-1"></a>        <span class="fu">plotResults</span>(treatStIds[<span class="dv">11</span>]) <span class="op">:</span> <span class="fu">plotTrends</span>(treatStIds[<span class="dv">11</span>])<span class="op">;</span></span>
<span id="cb84-2693"><a href="#cb84-2693" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb84-2694"><a href="#cb84-2694" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> <span class="st">''</span><span class="op">;</span></span>
<span id="cb84-2695"><a href="#cb84-2695" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb84-2696"><a href="#cb84-2696" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb84-2697"><a href="#cb84-2697" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> modelResults <span class="op">?</span> <span class="fu">plotResults</span>(treatStIds[<span class="dv">11</span>]) <span class="op">:</span> <span class="fu">plotTrends</span>(treatStIds[<span class="dv">11</span>])<span class="op">;</span></span>
<span id="cb84-2698"><a href="#cb84-2698" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb84-2699"><a href="#cb84-2699" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div id="ojs-cell-83" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div>
</div>
<div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-columns: minmax(3em, 1fr) minmax(3em, 1fr) minmax(3em, 1fr);
grid-auto-rows: minmax(0, 1fr);">
<div class="card cell html-fill-item html-fill-container bslib-card" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-body html-fill-item html-fill-container">
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb85" data-startfrom="2705" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 2704;"><span id="cb85-2705"><a href="#cb85-2705" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb85-2706"><a href="#cb85-2706" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (stacked <span class="op">!==</span> <span class="st">'no'</span>) {</span>
<span id="cb85-2707"><a href="#cb85-2707" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="bu">Number</span>(treatStYears[<span class="dv">12</span>]) <span class="op">+</span> <span class="bu">Number</span>(stacked) <span class="op">-</span> <span class="dv">1</span> <span class="op">&lt;=</span> <span class="dv">2019</span>) {</span>
<span id="cb85-2708"><a href="#cb85-2708" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> modelResults <span class="op">?</span> </span>
<span id="cb85-2709"><a href="#cb85-2709" aria-hidden="true" tabindex="-1"></a>        <span class="fu">plotResults</span>(treatStIds[<span class="dv">12</span>]) <span class="op">:</span> <span class="fu">plotTrends</span>(treatStIds[<span class="dv">12</span>])<span class="op">;</span></span>
<span id="cb85-2710"><a href="#cb85-2710" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb85-2711"><a href="#cb85-2711" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> <span class="st">''</span><span class="op">;</span></span>
<span id="cb85-2712"><a href="#cb85-2712" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb85-2713"><a href="#cb85-2713" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb85-2714"><a href="#cb85-2714" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> modelResults <span class="op">?</span> <span class="fu">plotResults</span>(treatStIds[<span class="dv">12</span>]) <span class="op">:</span> <span class="fu">plotTrends</span>(treatStIds[<span class="dv">12</span>])<span class="op">;</span></span>
<span id="cb85-2715"><a href="#cb85-2715" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb85-2716"><a href="#cb85-2716" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div id="ojs-cell-84" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div><div class="card cell html-fill-item html-fill-container bslib-card" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-body html-fill-item html-fill-container">
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb86" data-startfrom="2720" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 2719;"><span id="cb86-2720"><a href="#cb86-2720" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb86-2721"><a href="#cb86-2721" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (stacked <span class="op">!==</span> <span class="st">'no'</span>) {</span>
<span id="cb86-2722"><a href="#cb86-2722" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="bu">Number</span>(treatStYears[<span class="dv">13</span>]) <span class="op">+</span> <span class="bu">Number</span>(stacked) <span class="op">-</span> <span class="dv">1</span> <span class="op">&lt;=</span> <span class="dv">2019</span>) {</span>
<span id="cb86-2723"><a href="#cb86-2723" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> modelResults <span class="op">?</span> </span>
<span id="cb86-2724"><a href="#cb86-2724" aria-hidden="true" tabindex="-1"></a>        <span class="fu">plotResults</span>(treatStIds[<span class="dv">13</span>]) <span class="op">:</span> <span class="fu">plotTrends</span>(treatStIds[<span class="dv">13</span>])<span class="op">;</span></span>
<span id="cb86-2725"><a href="#cb86-2725" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb86-2726"><a href="#cb86-2726" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> <span class="st">''</span><span class="op">;</span></span>
<span id="cb86-2727"><a href="#cb86-2727" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb86-2728"><a href="#cb86-2728" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb86-2729"><a href="#cb86-2729" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> modelResults <span class="op">?</span> <span class="fu">plotResults</span>(treatStIds[<span class="dv">13</span>]) <span class="op">:</span> <span class="fu">plotTrends</span>(treatStIds[<span class="dv">13</span>])<span class="op">;</span></span>
<span id="cb86-2730"><a href="#cb86-2730" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb86-2731"><a href="#cb86-2731" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div id="ojs-cell-85" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div><div class="card cell html-fill-item html-fill-container bslib-card" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-body html-fill-item html-fill-container">
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb87" data-startfrom="2735" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 2734;"><span id="cb87-2735"><a href="#cb87-2735" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb87-2736"><a href="#cb87-2736" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (stacked <span class="op">!==</span> <span class="st">'no'</span>) {</span>
<span id="cb87-2737"><a href="#cb87-2737" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="bu">Number</span>(treatStYears[<span class="dv">14</span>]) <span class="op">+</span> <span class="bu">Number</span>(stacked) <span class="op">-</span> <span class="dv">1</span> <span class="op">&lt;=</span> <span class="dv">2019</span>) {</span>
<span id="cb87-2738"><a href="#cb87-2738" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> modelResults <span class="op">?</span> </span>
<span id="cb87-2739"><a href="#cb87-2739" aria-hidden="true" tabindex="-1"></a>        <span class="fu">plotResults</span>(treatStIds[<span class="dv">14</span>]) <span class="op">:</span> <span class="fu">plotTrends</span>(treatStIds[<span class="dv">14</span>])<span class="op">;</span></span>
<span id="cb87-2740"><a href="#cb87-2740" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb87-2741"><a href="#cb87-2741" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> <span class="st">''</span><span class="op">;</span></span>
<span id="cb87-2742"><a href="#cb87-2742" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb87-2743"><a href="#cb87-2743" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb87-2744"><a href="#cb87-2744" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> modelResults <span class="op">?</span> <span class="fu">plotResults</span>(treatStIds[<span class="dv">14</span>]) <span class="op">:</span> <span class="fu">plotTrends</span>(treatStIds[<span class="dv">14</span>])<span class="op">;</span></span>
<span id="cb87-2745"><a href="#cb87-2745" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb87-2746"><a href="#cb87-2746" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div id="ojs-cell-86" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div>
</div>
<div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-columns: minmax(3em, 1fr) minmax(3em, 1fr) minmax(3em, 1fr);
grid-auto-rows: minmax(0, 1fr);">
<div class="card cell html-fill-item html-fill-container bslib-card" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-body html-fill-item html-fill-container">
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb88" data-startfrom="2752" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 2751;"><span id="cb88-2752"><a href="#cb88-2752" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb88-2753"><a href="#cb88-2753" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (stacked <span class="op">!==</span> <span class="st">'no'</span>) {</span>
<span id="cb88-2754"><a href="#cb88-2754" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="bu">Number</span>(treatStYears[<span class="dv">15</span>]) <span class="op">+</span> <span class="bu">Number</span>(stacked) <span class="op">-</span> <span class="dv">1</span> <span class="op">&lt;=</span> <span class="dv">2019</span>) {</span>
<span id="cb88-2755"><a href="#cb88-2755" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> modelResults <span class="op">?</span> </span>
<span id="cb88-2756"><a href="#cb88-2756" aria-hidden="true" tabindex="-1"></a>        <span class="fu">plotResults</span>(treatStIds[<span class="dv">15</span>]) <span class="op">:</span> <span class="fu">plotTrends</span>(treatStIds[<span class="dv">15</span>])<span class="op">;</span></span>
<span id="cb88-2757"><a href="#cb88-2757" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb88-2758"><a href="#cb88-2758" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> <span class="st">''</span><span class="op">;</span></span>
<span id="cb88-2759"><a href="#cb88-2759" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb88-2760"><a href="#cb88-2760" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb88-2761"><a href="#cb88-2761" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> modelResults <span class="op">?</span> <span class="fu">plotResults</span>(treatStIds[<span class="dv">15</span>]) <span class="op">:</span> <span class="fu">plotTrends</span>(treatStIds[<span class="dv">15</span>])<span class="op">;</span></span>
<span id="cb88-2762"><a href="#cb88-2762" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb88-2763"><a href="#cb88-2763" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div id="ojs-cell-87" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div><div class="card cell html-fill-item html-fill-container bslib-card" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-body html-fill-item html-fill-container">
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb89" data-startfrom="2767" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 2766;"><span id="cb89-2767"><a href="#cb89-2767" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb89-2768"><a href="#cb89-2768" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (stacked <span class="op">!==</span> <span class="st">'no'</span>) {</span>
<span id="cb89-2769"><a href="#cb89-2769" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="bu">Number</span>(treatStYears[<span class="dv">16</span>]) <span class="op">+</span> <span class="bu">Number</span>(stacked) <span class="op">-</span> <span class="dv">1</span> <span class="op">&lt;=</span> <span class="dv">2019</span>) {</span>
<span id="cb89-2770"><a href="#cb89-2770" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> modelResults <span class="op">?</span> </span>
<span id="cb89-2771"><a href="#cb89-2771" aria-hidden="true" tabindex="-1"></a>        <span class="fu">plotResults</span>(treatStIds[<span class="dv">16</span>]) <span class="op">:</span> <span class="fu">plotTrends</span>(treatStIds[<span class="dv">16</span>])<span class="op">;</span></span>
<span id="cb89-2772"><a href="#cb89-2772" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb89-2773"><a href="#cb89-2773" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> <span class="st">''</span><span class="op">;</span></span>
<span id="cb89-2774"><a href="#cb89-2774" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb89-2775"><a href="#cb89-2775" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb89-2776"><a href="#cb89-2776" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> modelResults <span class="op">?</span> <span class="fu">plotResults</span>(treatStIds[<span class="dv">16</span>]) <span class="op">:</span> <span class="fu">plotTrends</span>(treatStIds[<span class="dv">16</span>])<span class="op">;</span></span>
<span id="cb89-2777"><a href="#cb89-2777" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb89-2778"><a href="#cb89-2778" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div id="ojs-cell-88" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div><div class="card cell html-fill-item html-fill-container bslib-card" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-body html-fill-item html-fill-container">
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb90" data-startfrom="2782" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 2781;"><span id="cb90-2782"><a href="#cb90-2782" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb90-2783"><a href="#cb90-2783" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (stacked <span class="op">!==</span> <span class="st">'no'</span>) {</span>
<span id="cb90-2784"><a href="#cb90-2784" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="bu">Number</span>(treatStYears[<span class="dv">17</span>]) <span class="op">+</span> <span class="bu">Number</span>(stacked) <span class="op">-</span> <span class="dv">1</span> <span class="op">&lt;=</span> <span class="dv">2019</span>) {</span>
<span id="cb90-2785"><a href="#cb90-2785" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> modelResults <span class="op">?</span> </span>
<span id="cb90-2786"><a href="#cb90-2786" aria-hidden="true" tabindex="-1"></a>        <span class="fu">plotResults</span>(treatStIds[<span class="dv">17</span>]) <span class="op">:</span> <span class="fu">plotTrends</span>(treatStIds[<span class="dv">17</span>])<span class="op">;</span></span>
<span id="cb90-2787"><a href="#cb90-2787" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb90-2788"><a href="#cb90-2788" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> <span class="st">''</span><span class="op">;</span></span>
<span id="cb90-2789"><a href="#cb90-2789" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb90-2790"><a href="#cb90-2790" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb90-2791"><a href="#cb90-2791" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> modelResults <span class="op">?</span> <span class="fu">plotResults</span>(treatStIds[<span class="dv">17</span>]) <span class="op">:</span> <span class="fu">plotTrends</span>(treatStIds[<span class="dv">17</span>])<span class="op">;</span></span>
<span id="cb90-2792"><a href="#cb90-2792" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb90-2793"><a href="#cb90-2793" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div id="ojs-cell-89" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div>
</div>
<div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-columns: minmax(3em, 1fr) minmax(3em, 1fr) minmax(3em, 1fr);
grid-auto-rows: minmax(0, 1fr);">
<div class="card cell html-fill-item html-fill-container bslib-card" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-body html-fill-item html-fill-container">
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb91" data-startfrom="2799" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 2798;"><span id="cb91-2799"><a href="#cb91-2799" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb91-2800"><a href="#cb91-2800" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (stacked <span class="op">!==</span> <span class="st">'no'</span>) {</span>
<span id="cb91-2801"><a href="#cb91-2801" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="bu">Number</span>(treatStYears[<span class="dv">18</span>]) <span class="op">+</span> <span class="bu">Number</span>(stacked) <span class="op">-</span> <span class="dv">1</span> <span class="op">&lt;=</span> <span class="dv">2019</span>) {</span>
<span id="cb91-2802"><a href="#cb91-2802" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> modelResults <span class="op">?</span> </span>
<span id="cb91-2803"><a href="#cb91-2803" aria-hidden="true" tabindex="-1"></a>        <span class="fu">plotResults</span>(treatStIds[<span class="dv">18</span>]) <span class="op">:</span> <span class="fu">plotTrends</span>(treatStIds[<span class="dv">18</span>])<span class="op">;</span></span>
<span id="cb91-2804"><a href="#cb91-2804" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb91-2805"><a href="#cb91-2805" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> <span class="st">''</span><span class="op">;</span></span>
<span id="cb91-2806"><a href="#cb91-2806" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb91-2807"><a href="#cb91-2807" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb91-2808"><a href="#cb91-2808" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> modelResults <span class="op">?</span> <span class="fu">plotResults</span>(treatStIds[<span class="dv">18</span>]) <span class="op">:</span> <span class="fu">plotTrends</span>(treatStIds[<span class="dv">18</span>])<span class="op">;</span></span>
<span id="cb91-2809"><a href="#cb91-2809" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb91-2810"><a href="#cb91-2810" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div id="ojs-cell-90" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div><div class="card cell html-fill-item html-fill-container bslib-card" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-body html-fill-item html-fill-container">
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb92" data-startfrom="2814" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 2813;"><span id="cb92-2814"><a href="#cb92-2814" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb92-2815"><a href="#cb92-2815" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (stacked <span class="op">!==</span> <span class="st">'no'</span>) {</span>
<span id="cb92-2816"><a href="#cb92-2816" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="bu">Number</span>(treatStYears[<span class="dv">19</span>]) <span class="op">+</span> <span class="bu">Number</span>(stacked) <span class="op">-</span> <span class="dv">1</span> <span class="op">&lt;=</span> <span class="dv">2019</span>) {</span>
<span id="cb92-2817"><a href="#cb92-2817" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> modelResults <span class="op">?</span> </span>
<span id="cb92-2818"><a href="#cb92-2818" aria-hidden="true" tabindex="-1"></a>        <span class="fu">plotResults</span>(treatStIds[<span class="dv">19</span>]) <span class="op">:</span> <span class="fu">plotTrends</span>(treatStIds[<span class="dv">19</span>])<span class="op">;</span></span>
<span id="cb92-2819"><a href="#cb92-2819" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb92-2820"><a href="#cb92-2820" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> <span class="st">''</span><span class="op">;</span></span>
<span id="cb92-2821"><a href="#cb92-2821" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb92-2822"><a href="#cb92-2822" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb92-2823"><a href="#cb92-2823" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> modelResults <span class="op">?</span> <span class="fu">plotResults</span>(treatStIds[<span class="dv">19</span>]) <span class="op">:</span> <span class="fu">plotTrends</span>(treatStIds[<span class="dv">19</span>])<span class="op">;</span></span>
<span id="cb92-2824"><a href="#cb92-2824" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb92-2825"><a href="#cb92-2825" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div id="ojs-cell-91" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div><div class="card cell html-fill-item html-fill-container bslib-card" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-body html-fill-item html-fill-container">
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb93" data-startfrom="2829" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 2828;"><span id="cb93-2829"><a href="#cb93-2829" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb93-2830"><a href="#cb93-2830" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (stacked <span class="op">!==</span> <span class="st">'no'</span>) {</span>
<span id="cb93-2831"><a href="#cb93-2831" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="bu">Number</span>(treatStYears[<span class="dv">20</span>]) <span class="op">+</span> <span class="bu">Number</span>(stacked) <span class="op">-</span> <span class="dv">1</span> <span class="op">&lt;=</span> <span class="dv">2019</span>) {</span>
<span id="cb93-2832"><a href="#cb93-2832" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> modelResults <span class="op">?</span> </span>
<span id="cb93-2833"><a href="#cb93-2833" aria-hidden="true" tabindex="-1"></a>        <span class="fu">plotResults</span>(treatStIds[<span class="dv">20</span>]) <span class="op">:</span> <span class="fu">plotTrends</span>(treatStIds[<span class="dv">20</span>])<span class="op">;</span></span>
<span id="cb93-2834"><a href="#cb93-2834" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb93-2835"><a href="#cb93-2835" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> <span class="st">''</span><span class="op">;</span></span>
<span id="cb93-2836"><a href="#cb93-2836" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb93-2837"><a href="#cb93-2837" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb93-2838"><a href="#cb93-2838" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> modelResults <span class="op">?</span> <span class="fu">plotResults</span>(treatStIds[<span class="dv">20</span>]) <span class="op">:</span> <span class="fu">plotTrends</span>(treatStIds[<span class="dv">20</span>])<span class="op">;</span></span>
<span id="cb93-2839"><a href="#cb93-2839" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb93-2840"><a href="#cb93-2840" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div id="ojs-cell-92" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div>
</div>
<div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-columns: minmax(3em, 1fr) minmax(3em, 1fr) minmax(3em, 1fr);
grid-auto-rows: minmax(0, 1fr);">
<div class="card cell html-fill-item html-fill-container bslib-card" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-body html-fill-item html-fill-container">
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb94" data-startfrom="2846" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 2845;"><span id="cb94-2846"><a href="#cb94-2846" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb94-2847"><a href="#cb94-2847" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (stacked <span class="op">!==</span> <span class="st">'no'</span>) {</span>
<span id="cb94-2848"><a href="#cb94-2848" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="bu">Number</span>(treatStYears[<span class="dv">21</span>]) <span class="op">+</span> <span class="bu">Number</span>(stacked) <span class="op">-</span> <span class="dv">1</span> <span class="op">&lt;=</span> <span class="dv">2019</span>) {</span>
<span id="cb94-2849"><a href="#cb94-2849" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> modelResults <span class="op">?</span> </span>
<span id="cb94-2850"><a href="#cb94-2850" aria-hidden="true" tabindex="-1"></a>        <span class="fu">plotResults</span>(treatStIds[<span class="dv">21</span>]) <span class="op">:</span> <span class="fu">plotTrends</span>(treatStIds[<span class="dv">21</span>])<span class="op">;</span></span>
<span id="cb94-2851"><a href="#cb94-2851" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb94-2852"><a href="#cb94-2852" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> <span class="st">''</span><span class="op">;</span></span>
<span id="cb94-2853"><a href="#cb94-2853" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb94-2854"><a href="#cb94-2854" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb94-2855"><a href="#cb94-2855" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> modelResults <span class="op">?</span> <span class="fu">plotResults</span>(treatStIds[<span class="dv">21</span>]) <span class="op">:</span> <span class="fu">plotTrends</span>(treatStIds[<span class="dv">21</span>])<span class="op">;</span></span>
<span id="cb94-2856"><a href="#cb94-2856" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb94-2857"><a href="#cb94-2857" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div id="ojs-cell-93" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div><div class="card cell html-fill-item html-fill-container bslib-card" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-body html-fill-item html-fill-container">
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb95" data-startfrom="2861" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 2860;"><span id="cb95-2861"><a href="#cb95-2861" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb95-2862"><a href="#cb95-2862" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (treatStIds<span class="op">.</span><span class="at">length</span> <span class="op">&gt;</span> <span class="dv">22</span>) {</span>
<span id="cb95-2863"><a href="#cb95-2863" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (stacked <span class="op">!==</span> <span class="st">'no'</span>) {</span>
<span id="cb95-2864"><a href="#cb95-2864" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="bu">Number</span>(treatStYears[<span class="dv">22</span>]) <span class="op">+</span> <span class="bu">Number</span>(stacked) <span class="op">-</span> <span class="dv">1</span> <span class="op">&lt;=</span> <span class="dv">2019</span>) {</span>
<span id="cb95-2865"><a href="#cb95-2865" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> modelResults <span class="op">?</span> </span>
<span id="cb95-2866"><a href="#cb95-2866" aria-hidden="true" tabindex="-1"></a>          <span class="fu">plotResults</span>(treatStIds[<span class="dv">22</span>]) <span class="op">:</span> <span class="fu">plotTrends</span>(treatStIds[<span class="dv">22</span>])<span class="op">;</span></span>
<span id="cb95-2867"><a href="#cb95-2867" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb95-2868"><a href="#cb95-2868" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">''</span><span class="op">;</span></span>
<span id="cb95-2869"><a href="#cb95-2869" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb95-2870"><a href="#cb95-2870" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb95-2871"><a href="#cb95-2871" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> modelResults <span class="op">?</span> <span class="fu">plotResults</span>(treatStIds[<span class="dv">22</span>]) <span class="op">:</span> <span class="fu">plotTrends</span>(treatStIds[<span class="dv">22</span>])<span class="op">;</span></span>
<span id="cb95-2872"><a href="#cb95-2872" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb95-2873"><a href="#cb95-2873" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb95-2874"><a href="#cb95-2874" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="st">''</span><span class="op">;</span></span>
<span id="cb95-2875"><a href="#cb95-2875" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb95-2876"><a href="#cb95-2876" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div id="ojs-cell-94" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div><div class="card cell html-fill-item html-fill-container bslib-card" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-body html-fill-item html-fill-container">
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb96" data-startfrom="2880" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 2879;"><span id="cb96-2880"><a href="#cb96-2880" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb96-2881"><a href="#cb96-2881" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (treatStIds<span class="op">.</span><span class="at">length</span> <span class="op">&gt;</span> <span class="dv">23</span>) {</span>
<span id="cb96-2882"><a href="#cb96-2882" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (stacked <span class="op">!==</span> <span class="st">'no'</span>) {</span>
<span id="cb96-2883"><a href="#cb96-2883" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="bu">Number</span>(treatStYears[<span class="dv">23</span>]) <span class="op">+</span> <span class="bu">Number</span>(stacked) <span class="op">-</span> <span class="dv">1</span> <span class="op">&lt;=</span> <span class="dv">2019</span>) {</span>
<span id="cb96-2884"><a href="#cb96-2884" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> modelResults <span class="op">?</span> </span>
<span id="cb96-2885"><a href="#cb96-2885" aria-hidden="true" tabindex="-1"></a>          <span class="fu">plotResults</span>(treatStIds[<span class="dv">23</span>]) <span class="op">:</span> <span class="fu">plotTrends</span>(treatStIds[<span class="dv">23</span>])<span class="op">;</span></span>
<span id="cb96-2886"><a href="#cb96-2886" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb96-2887"><a href="#cb96-2887" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">''</span><span class="op">;</span></span>
<span id="cb96-2888"><a href="#cb96-2888" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb96-2889"><a href="#cb96-2889" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb96-2890"><a href="#cb96-2890" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> modelResults <span class="op">?</span> <span class="fu">plotResults</span>(treatStIds[<span class="dv">23</span>]) <span class="op">:</span> <span class="fu">plotTrends</span>(treatStIds[<span class="dv">23</span>])<span class="op">;</span></span>
<span id="cb96-2891"><a href="#cb96-2891" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb96-2892"><a href="#cb96-2892" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb96-2893"><a href="#cb96-2893" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="st">''</span><span class="op">;</span></span>
<span id="cb96-2894"><a href="#cb96-2894" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb96-2895"><a href="#cb96-2895" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div id="ojs-cell-95" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div>
</div>
<div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-columns: minmax(3em, 1fr) minmax(3em, 1fr) minmax(3em, 1fr);
grid-auto-rows: minmax(0, 1fr);">
<div class="card cell html-fill-item html-fill-container bslib-card" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-body html-fill-item html-fill-container">
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb97" data-startfrom="2901" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 2900;"><span id="cb97-2901"><a href="#cb97-2901" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb97-2902"><a href="#cb97-2902" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (treatStIds<span class="op">.</span><span class="at">length</span> <span class="op">&gt;</span> <span class="dv">24</span>) {</span>
<span id="cb97-2903"><a href="#cb97-2903" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (stacked <span class="op">!==</span> <span class="st">'no'</span>) {</span>
<span id="cb97-2904"><a href="#cb97-2904" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="bu">Number</span>(treatStYears[<span class="dv">24</span>]) <span class="op">+</span> <span class="bu">Number</span>(stacked) <span class="op">-</span> <span class="dv">1</span> <span class="op">&lt;=</span> <span class="dv">2019</span>) {</span>
<span id="cb97-2905"><a href="#cb97-2905" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> modelResults <span class="op">?</span> </span>
<span id="cb97-2906"><a href="#cb97-2906" aria-hidden="true" tabindex="-1"></a>          <span class="fu">plotResults</span>(treatStIds[<span class="dv">24</span>]) <span class="op">:</span> <span class="fu">plotTrends</span>(treatStIds[<span class="dv">24</span>])<span class="op">;</span></span>
<span id="cb97-2907"><a href="#cb97-2907" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb97-2908"><a href="#cb97-2908" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">''</span><span class="op">;</span></span>
<span id="cb97-2909"><a href="#cb97-2909" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb97-2910"><a href="#cb97-2910" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb97-2911"><a href="#cb97-2911" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> modelResults <span class="op">?</span> <span class="fu">plotResults</span>(treatStIds[<span class="dv">24</span>]) <span class="op">:</span> <span class="fu">plotTrends</span>(treatStIds[<span class="dv">24</span>])<span class="op">;</span></span>
<span id="cb97-2912"><a href="#cb97-2912" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb97-2913"><a href="#cb97-2913" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb97-2914"><a href="#cb97-2914" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="st">''</span><span class="op">;</span></span>
<span id="cb97-2915"><a href="#cb97-2915" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb97-2916"><a href="#cb97-2916" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div id="ojs-cell-96" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div><div class="card cell html-fill-item html-fill-container bslib-card" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-body html-fill-item html-fill-container">
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb98" data-startfrom="2920" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 2919;"><span id="cb98-2920"><a href="#cb98-2920" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb98-2921"><a href="#cb98-2921" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (treatStIds<span class="op">.</span><span class="at">length</span> <span class="op">&gt;</span> <span class="dv">25</span>) {</span>
<span id="cb98-2922"><a href="#cb98-2922" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (stacked <span class="op">!==</span> <span class="st">'no'</span>) {</span>
<span id="cb98-2923"><a href="#cb98-2923" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="bu">Number</span>(treatStYears[<span class="dv">25</span>]) <span class="op">+</span> <span class="bu">Number</span>(stacked) <span class="op">-</span> <span class="dv">1</span> <span class="op">&lt;=</span> <span class="dv">2019</span>) {</span>
<span id="cb98-2924"><a href="#cb98-2924" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> modelResults <span class="op">?</span> </span>
<span id="cb98-2925"><a href="#cb98-2925" aria-hidden="true" tabindex="-1"></a>          <span class="fu">plotResults</span>(treatStIds[<span class="dv">25</span>]) <span class="op">:</span> <span class="fu">plotTrends</span>(treatStIds[<span class="dv">25</span>])<span class="op">;</span></span>
<span id="cb98-2926"><a href="#cb98-2926" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb98-2927"><a href="#cb98-2927" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">''</span><span class="op">;</span></span>
<span id="cb98-2928"><a href="#cb98-2928" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb98-2929"><a href="#cb98-2929" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb98-2930"><a href="#cb98-2930" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> modelResults <span class="op">?</span> <span class="fu">plotResults</span>(treatStIds[<span class="dv">25</span>]) <span class="op">:</span> <span class="fu">plotTrends</span>(treatStIds[<span class="dv">25</span>])<span class="op">;</span></span>
<span id="cb98-2931"><a href="#cb98-2931" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb98-2932"><a href="#cb98-2932" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb98-2933"><a href="#cb98-2933" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="st">''</span><span class="op">;</span></span>
<span id="cb98-2934"><a href="#cb98-2934" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb98-2935"><a href="#cb98-2935" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div id="ojs-cell-97" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div><div class="card cell html-fill-item html-fill-container bslib-card" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-body html-fill-item html-fill-container">
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb99" data-startfrom="2939" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 2938;"><span id="cb99-2939"><a href="#cb99-2939" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb99-2940"><a href="#cb99-2940" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (treatStIds<span class="op">.</span><span class="at">length</span> <span class="op">&gt;</span> <span class="dv">26</span>) {</span>
<span id="cb99-2941"><a href="#cb99-2941" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (stacked <span class="op">!==</span> <span class="st">'no'</span>) {</span>
<span id="cb99-2942"><a href="#cb99-2942" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="bu">Number</span>(treatStYears[<span class="dv">26</span>]) <span class="op">+</span> <span class="bu">Number</span>(stacked) <span class="op">-</span> <span class="dv">1</span> <span class="op">&lt;=</span> <span class="dv">2019</span>) {</span>
<span id="cb99-2943"><a href="#cb99-2943" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> modelResults <span class="op">?</span> </span>
<span id="cb99-2944"><a href="#cb99-2944" aria-hidden="true" tabindex="-1"></a>          <span class="fu">plotResults</span>(treatStIds[<span class="dv">26</span>]) <span class="op">:</span> <span class="fu">plotTrends</span>(treatStIds[<span class="dv">26</span>])<span class="op">;</span></span>
<span id="cb99-2945"><a href="#cb99-2945" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb99-2946"><a href="#cb99-2946" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">''</span><span class="op">;</span></span>
<span id="cb99-2947"><a href="#cb99-2947" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb99-2948"><a href="#cb99-2948" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb99-2949"><a href="#cb99-2949" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> modelResults <span class="op">?</span> <span class="fu">plotResults</span>(treatStIds[<span class="dv">26</span>]) <span class="op">:</span> <span class="fu">plotTrends</span>(treatStIds[<span class="dv">26</span>])<span class="op">;</span></span>
<span id="cb99-2950"><a href="#cb99-2950" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb99-2951"><a href="#cb99-2951" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb99-2952"><a href="#cb99-2952" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="st">''</span><span class="op">;</span></span>
<span id="cb99-2953"><a href="#cb99-2953" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb99-2954"><a href="#cb99-2954" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div id="ojs-cell-98" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div>
</div>
<div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-columns: minmax(3em, 1fr) minmax(3em, 1fr) minmax(3em, 1fr);
grid-auto-rows: minmax(0, 1fr);">
<div class="card cell html-fill-item html-fill-container bslib-card" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-body html-fill-item html-fill-container">
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb100" data-startfrom="2960" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 2959;"><span id="cb100-2960"><a href="#cb100-2960" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb100-2961"><a href="#cb100-2961" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (treatStIds<span class="op">.</span><span class="at">length</span> <span class="op">&gt;</span> <span class="dv">27</span>) {</span>
<span id="cb100-2962"><a href="#cb100-2962" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (stacked <span class="op">!==</span> <span class="st">'no'</span>) {</span>
<span id="cb100-2963"><a href="#cb100-2963" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="bu">Number</span>(treatStYears[<span class="dv">27</span>]) <span class="op">+</span> <span class="bu">Number</span>(stacked) <span class="op">-</span> <span class="dv">1</span> <span class="op">&lt;=</span> <span class="dv">2019</span>) {</span>
<span id="cb100-2964"><a href="#cb100-2964" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> modelResults <span class="op">?</span> </span>
<span id="cb100-2965"><a href="#cb100-2965" aria-hidden="true" tabindex="-1"></a>          <span class="fu">plotResults</span>(treatStIds[<span class="dv">27</span>]) <span class="op">:</span> <span class="fu">plotTrends</span>(treatStIds[<span class="dv">27</span>])<span class="op">;</span></span>
<span id="cb100-2966"><a href="#cb100-2966" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb100-2967"><a href="#cb100-2967" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">''</span><span class="op">;</span></span>
<span id="cb100-2968"><a href="#cb100-2968" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb100-2969"><a href="#cb100-2969" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb100-2970"><a href="#cb100-2970" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> modelResults <span class="op">?</span> <span class="fu">plotResults</span>(treatStIds[<span class="dv">27</span>]) <span class="op">:</span> <span class="fu">plotTrends</span>(treatStIds[<span class="dv">27</span>])<span class="op">;</span></span>
<span id="cb100-2971"><a href="#cb100-2971" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb100-2972"><a href="#cb100-2972" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb100-2973"><a href="#cb100-2973" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="st">''</span><span class="op">;</span></span>
<span id="cb100-2974"><a href="#cb100-2974" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb100-2975"><a href="#cb100-2975" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div id="ojs-cell-99" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div><div class="card cell html-fill-item html-fill-container bslib-card" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-body html-fill-item html-fill-container">
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb101" data-startfrom="2979" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 2978;"><span id="cb101-2979"><a href="#cb101-2979" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb101-2980"><a href="#cb101-2980" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (treatStIds<span class="op">.</span><span class="at">length</span> <span class="op">&gt;</span> <span class="dv">28</span>) {</span>
<span id="cb101-2981"><a href="#cb101-2981" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (stacked <span class="op">!==</span> <span class="st">'no'</span>) {</span>
<span id="cb101-2982"><a href="#cb101-2982" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="bu">Number</span>(treatStYears[<span class="dv">28</span>]) <span class="op">+</span> <span class="bu">Number</span>(stacked) <span class="op">-</span> <span class="dv">1</span> <span class="op">&lt;=</span> <span class="dv">2019</span>) {</span>
<span id="cb101-2983"><a href="#cb101-2983" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> modelResults <span class="op">?</span> </span>
<span id="cb101-2984"><a href="#cb101-2984" aria-hidden="true" tabindex="-1"></a>          <span class="fu">plotResults</span>(treatStIds[<span class="dv">28</span>]) <span class="op">:</span> <span class="fu">plotTrends</span>(treatStIds[<span class="dv">28</span>])<span class="op">;</span></span>
<span id="cb101-2985"><a href="#cb101-2985" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb101-2986"><a href="#cb101-2986" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">''</span><span class="op">;</span></span>
<span id="cb101-2987"><a href="#cb101-2987" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb101-2988"><a href="#cb101-2988" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb101-2989"><a href="#cb101-2989" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> modelResults <span class="op">?</span> <span class="fu">plotResults</span>(treatStIds[<span class="dv">28</span>]) <span class="op">:</span> <span class="fu">plotTrends</span>(treatStIds[<span class="dv">28</span>])<span class="op">;</span></span>
<span id="cb101-2990"><a href="#cb101-2990" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb101-2991"><a href="#cb101-2991" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb101-2992"><a href="#cb101-2992" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="st">''</span><span class="op">;</span></span>
<span id="cb101-2993"><a href="#cb101-2993" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb101-2994"><a href="#cb101-2994" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div id="ojs-cell-100" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div><div class="card cell html-fill-item html-fill-container bslib-card" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-body html-fill-item html-fill-container">
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb102" data-startfrom="2998" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 2997;"><span id="cb102-2998"><a href="#cb102-2998" aria-hidden="true" tabindex="-1"></a><span class="st">''</span><span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div id="ojs-cell-101" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div><div id="3ade8a4a-fb1d-4a6c-8409-ac45482d5fc9" class="hidden html-fill-item html-fill-container">

</div>
</div>
</div>
</div>
</div>
</div></div><aside id="bslib-sidebar-1" class="sidebar html-fill-container html-fill-item"><div class="html-fill-container html-fill-item">
<div class="cell hidden">
<div class="sourceCode cell-code hidden" id="cb22" data-startfrom="493" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 492;"><span id="cb22-493"><a href="#cb22-493" aria-hidden="true" tabindex="-1"></a>outcomeMap <span class="op">=</span> <span class="kw">new</span> <span class="bu">Map</span>([</span>
<span id="cb22-494"><a href="#cb22-494" aria-hidden="true" tabindex="-1"></a>  [<span class="st">'K-12'</span><span class="op">,</span> <span class="st">'e027_elem_educ_direct_exp'</span>]<span class="op">,</span></span>
<span id="cb22-495"><a href="#cb22-495" aria-hidden="true" tabindex="-1"></a>  [<span class="st">'All Non-K-12'</span><span class="op">,</span> <span class="st">'e003x_direct_expenditure_non_k12'</span>]<span class="op">,</span></span>
<span id="cb22-496"><a href="#cb22-496" aria-hidden="true" tabindex="-1"></a>  [<span class="st">'Gen Non-K-12'</span><span class="op">,</span> <span class="st">'e014x_direct_general_expend_non_k12'</span>]<span class="op">,</span></span>
<span id="cb22-497"><a href="#cb22-497" aria-hidden="true" tabindex="-1"></a>  [<span class="st">'Higher Ed'</span><span class="op">,</span> <span class="st">'e030_total_high_ed_dir_exp'</span>]<span class="op">,</span></span>
<span id="cb22-498"><a href="#cb22-498" aria-hidden="true" tabindex="-1"></a>  [<span class="st">'Health'</span><span class="op">,</span> <span class="st">'e055_health_direct_expend'</span>]<span class="op">,</span></span>
<span id="cb22-499"><a href="#cb22-499" aria-hidden="true" tabindex="-1"></a>  [<span class="st">'Welfare'</span><span class="op">,</span> <span class="st">'e090_public_welf_direct_exp'</span>]<span class="op">,</span></span>
<span id="cb22-500"><a href="#cb22-500" aria-hidden="true" tabindex="-1"></a>  [<span class="st">'Parks &amp; Rec'</span><span class="op">,</span> <span class="st">'e084_parks_rec_direct_exp'</span>]<span class="op">,</span></span>
<span id="cb22-501"><a href="#cb22-501" aria-hidden="true" tabindex="-1"></a>  [<span class="st">'House &amp; Comm'</span><span class="op">,</span> <span class="st">'e074_hous_com_direct_exp'</span>]<span class="op">,</span></span>
<span id="cb22-502"><a href="#cb22-502" aria-hidden="true" tabindex="-1"></a>  [<span class="st">'Highways'</span><span class="op">,</span> <span class="st">'e065_total_highways_dir_exp'</span>]<span class="op">,</span></span>
<span id="cb22-503"><a href="#cb22-503" aria-hidden="true" tabindex="-1"></a>  [<span class="st">'Debt'</span><span class="op">,</span> <span class="st">'d01_total_debt_outstanding'</span>]<span class="op">,</span></span>
<span id="cb22-504"><a href="#cb22-504" aria-hidden="true" tabindex="-1"></a>  [<span class="st">'Total Rev'</span><span class="op">,</span> <span class="st">'r02_total_rev_own_sources'</span>]<span class="op">,</span></span>
<span id="cb22-505"><a href="#cb22-505" aria-hidden="true" tabindex="-1"></a>  [<span class="st">'Gen Rev'</span><span class="op">,</span> <span class="st">'r04_gen_rev_own_sources'</span>]<span class="op">,</span></span>
<span id="cb22-506"><a href="#cb22-506" aria-hidden="true" tabindex="-1"></a>  [<span class="st">'Tax Rev'</span><span class="op">,</span> <span class="st">'r05_total_taxes'</span>]<span class="op">,</span></span>
<span id="cb22-507"><a href="#cb22-507" aria-hidden="true" tabindex="-1"></a>  [<span class="st">'Prop Tax'</span><span class="op">,</span> <span class="st">'r06_property_tax_t01'</span>]<span class="op">,</span></span>
<span id="cb22-508"><a href="#cb22-508" aria-hidden="true" tabindex="-1"></a>  [<span class="st">'Non-Prop Tax'</span><span class="op">,</span> <span class="st">'r07_non_property_taxes'</span>]</span>
<span id="cb22-509"><a href="#cb22-509" aria-hidden="true" tabindex="-1"></a>])<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display hidden">
<div id="ojs-cell-22" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell hidden">
<div class="sourceCode cell-code hidden" id="cb23" data-startfrom="514" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 513;"><span id="cb23-514"><a href="#cb23-514" aria-hidden="true" tabindex="-1"></a>treatMap <span class="op">=</span> <span class="kw">new</span> <span class="bu">Map</span>([</span>
<span id="cb23-515"><a href="#cb23-515" aria-hidden="true" tabindex="-1"></a>  [<span class="st">'first'</span><span class="op">,</span> <span class="st">'first'</span>]<span class="op">,</span></span>
<span id="cb23-516"><a href="#cb23-516" aria-hidden="true" tabindex="-1"></a>  [<span class="st">'prog'</span><span class="op">,</span> <span class="st">'prog'</span>]<span class="op">,</span></span>
<span id="cb23-517"><a href="#cb23-517" aria-hidden="true" tabindex="-1"></a>  [<span class="st">'first court'</span><span class="op">,</span> <span class="st">'first_court'</span>]<span class="op">,</span></span>
<span id="cb23-518"><a href="#cb23-518" aria-hidden="true" tabindex="-1"></a>  [<span class="st">'prog court'</span><span class="op">,</span> <span class="st">'prog_court'</span>]</span>
<span id="cb23-519"><a href="#cb23-519" aria-hidden="true" tabindex="-1"></a>])<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display hidden">
<div id="ojs-cell-23" data-nodetype="declaration">

</div>
</div>
</div>
<div class="sidebar-section-header">
<p><strong>Outcomes</strong></p>
</div>
<div class="sourceCode cell-code hidden" id="cb24" data-startfrom="531" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 530;"><span id="cb24-531"><a href="#cb24-531" aria-hidden="true" tabindex="-1"></a>viewof selectedOutcome <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">radio</span>(</span>
<span id="cb24-532"><a href="#cb24-532" aria-hidden="true" tabindex="-1"></a>  outcomeMap<span class="op">,</span> {<span class="dt">value</span><span class="op">:</span> <span class="st">'e027_elem_educ_direct_exp'</span>}</span>
<span id="cb24-533"><a href="#cb24-533" aria-hidden="true" tabindex="-1"></a>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-24" data-nodetype="declaration">

</div>
</div>
<div class="sourceCode cell-code hidden" id="cb25" data-startfrom="537" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 536;"><span id="cb25-537"><a href="#cb25-537" aria-hidden="true" tabindex="-1"></a>viewof overlayK12 <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">toggle</span>({<span class="dt">label</span><span class="op">:</span> <span class="st">'overlay K-12'</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="kw">true</span>})<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-25" data-nodetype="declaration">

</div>
</div>
<div class="sidebar-section-header">
<p><strong>SFR Version</strong></p>
</div>
<div class="sourceCode cell-code hidden" id="cb26" data-startfrom="545" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 544;"><span id="cb26-545"><a href="#cb26-545" aria-hidden="true" tabindex="-1"></a>viewof treatSpec <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">radio</span>(treatMap<span class="op">,</span> {<span class="dt">value</span><span class="op">:</span> <span class="st">'first_court'</span>})<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-26" data-nodetype="declaration">

</div>
</div>
<div class="sidebar-section-header">
<p><strong>Control Groups</strong></p>
</div>
<div class="sourceCode cell-code hidden" id="cb27" data-startfrom="553" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 552;"><span id="cb27-553"><a href="#cb27-553" aria-hidden="true" tabindex="-1"></a>viewof stacked <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">radio</span>(</span>
<span id="cb27-554"><a href="#cb27-554" aria-hidden="true" tabindex="-1"></a>  [<span class="st">'5'</span><span class="op">,</span> <span class="st">'8'</span><span class="op">,</span> <span class="st">'12'</span><span class="op">,</span> <span class="st">'no'</span>]<span class="op">,</span></span>
<span id="cb27-555"><a href="#cb27-555" aria-hidden="true" tabindex="-1"></a>  {<span class="dt">label</span><span class="op">:</span> <span class="fu">html</span><span class="vs">`&lt;i&gt;stacked&lt;/i&gt;`</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="st">'no'</span>}</span>
<span id="cb27-556"><a href="#cb27-556" aria-hidden="true" tabindex="-1"></a>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-27" data-nodetype="declaration">

</div>
</div>
<div class="sourceCode cell-code hidden" id="cb28" data-startfrom="560" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 559;"><span id="cb28-560"><a href="#cb28-560" aria-hidden="true" tabindex="-1"></a>viewof showDiD <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">radio</span>(</span>
<span id="cb28-561"><a href="#cb28-561" aria-hidden="true" tabindex="-1"></a>  [<span class="st">'never'</span><span class="op">,</span> <span class="st">'not yet'</span><span class="op">,</span> <span class="st">'none'</span>]<span class="op">,</span> </span>
<span id="cb28-562"><a href="#cb28-562" aria-hidden="true" tabindex="-1"></a>  {<span class="dt">label</span><span class="op">:</span> <span class="fu">html</span><span class="vs">`&lt;i&gt;DiD&lt;/i&gt;`</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="st">'never'</span>}</span>
<span id="cb28-563"><a href="#cb28-563" aria-hidden="true" tabindex="-1"></a>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-28" data-nodetype="declaration">

</div>
</div>
<div class="sourceCode cell-code hidden" id="cb29" data-startfrom="567" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 566;"><span id="cb29-567"><a href="#cb29-567" aria-hidden="true" tabindex="-1"></a>viewof showSynth <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">toggle</span>(</span>
<span id="cb29-568"><a href="#cb29-568" aria-hidden="true" tabindex="-1"></a>  {<span class="dt">label</span><span class="op">:</span> <span class="fu">html</span><span class="vs">`&lt;i&gt;synth&lt;/i&gt;`</span><span class="op">,</span> <span class="dt">values</span><span class="op">:</span> [<span class="st">'never'</span><span class="op">,</span> <span class="st">'none'</span>]<span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="st">'never'</span>}</span>
<span id="cb29-569"><a href="#cb29-569" aria-hidden="true" tabindex="-1"></a>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-29" data-nodetype="declaration">

</div>
</div>
<div class="cell hidden">
<div class="sourceCode cell-code hidden" id="cb30" data-startfrom="574" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 573;"><span id="cb30-574"><a href="#cb30-574" aria-hidden="true" tabindex="-1"></a>ctrlSpecDiD <span class="op">=</span> stacked <span class="op">===</span> <span class="st">'no'</span> <span class="op">|</span> showDiD <span class="op">===</span> <span class="st">'none'</span> <span class="op">?</span> </span>
<span id="cb30-575"><a href="#cb30-575" aria-hidden="true" tabindex="-1"></a>  showDiD <span class="op">:</span> <span class="st">'stacked '</span> <span class="op">+</span> stacked<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display hidden">
<div id="ojs-cell-30" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell hidden">
<div class="sourceCode cell-code hidden" id="cb31" data-startfrom="580" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 579;"><span id="cb31-580"><a href="#cb31-580" aria-hidden="true" tabindex="-1"></a>ctrlSpecSynth <span class="op">=</span> stacked <span class="op">===</span> <span class="st">'no'</span> <span class="op">|</span> showSynth <span class="op">===</span> <span class="st">'none'</span> <span class="op">?</span> </span>
<span id="cb31-581"><a href="#cb31-581" aria-hidden="true" tabindex="-1"></a>  showSynth <span class="op">:</span> <span class="st">'stacked '</span> <span class="op">+</span> stacked<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display hidden">
<div id="ojs-cell-31" data-nodetype="declaration">

</div>
</div>
</div>
<div class="sidebar-section-header">
<p><strong>Model Results</strong></p>
</div>
<div class="sourceCode cell-code hidden" id="cb32" data-startfrom="589" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 588;"><span id="cb32-589"><a href="#cb32-589" aria-hidden="true" tabindex="-1"></a>viewof modelResults <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">toggle</span>({<span class="dt">label</span><span class="op">:</span> <span class="st">'SHOW RESULTS'</span>})<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-32" data-nodetype="declaration">

</div>
</div>
<div class="sourceCode cell-code hidden" id="cb33" data-startfrom="593" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 592;"><span id="cb33-593"><a href="#cb33-593" aria-hidden="true" tabindex="-1"></a>viewof showCI <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">toggle</span>({<span class="dt">label</span><span class="op">:</span> <span class="st">'show CI'</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="kw">true</span>})<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-33" data-nodetype="declaration">

</div>
</div>
<div class="sourceCode cell-code hidden" id="cb34" data-startfrom="597" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 596;"><span id="cb34-597"><a href="#cb34-597" aria-hidden="true" tabindex="-1"></a>viewof modSpecDiD <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">checkbox</span>(</span>
<span id="cb34-598"><a href="#cb34-598" aria-hidden="true" tabindex="-1"></a>  [<span class="st">'simult cband'</span>]<span class="op">,</span> </span>
<span id="cb34-599"><a href="#cb34-599" aria-hidden="true" tabindex="-1"></a>  {<span class="dt">label</span><span class="op">:</span> <span class="fu">html</span><span class="vs">`&lt;i&gt;DiD options&lt;/i&gt;`</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> [<span class="st">'simult cband'</span>]}</span>
<span id="cb34-600"><a href="#cb34-600" aria-hidden="true" tabindex="-1"></a>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-34" data-nodetype="declaration">

</div>
</div>
<div class="sidebar-section-header">
<p><strong>States / Subgroups</strong></p>
</div>
<div class="sourceCode cell-code hidden" id="cb35" data-startfrom="608" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 607;"><span id="cb35-608"><a href="#cb35-608" aria-hidden="true" tabindex="-1"></a>viewof showSubgroups <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">toggle</span>({<span class="dt">label</span><span class="op">:</span> <span class="st">'SHOW SUBGRPS'</span>})<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-35" data-nodetype="declaration">

</div>
</div>
<div class="sourceCode cell-code hidden" id="cb36" data-startfrom="612" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 611;"><span id="cb36-612"><a href="#cb36-612" aria-hidden="true" tabindex="-1"></a>viewof subgroupsToShow <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">checkbox</span>(</span>
<span id="cb36-613"><a href="#cb36-613" aria-hidden="true" tabindex="-1"></a>  [<span class="st">'treated'</span><span class="op">,</span> <span class="st">'untreated'</span><span class="op">,</span> <span class="st">'ctrl, DiD'</span><span class="op">,</span> <span class="st">'ctrl, synth'</span>]<span class="op">,</span> </span>
<span id="cb36-614"><a href="#cb36-614" aria-hidden="true" tabindex="-1"></a>  {<span class="dt">value</span><span class="op">:</span> [<span class="st">'treated'</span><span class="op">,</span> <span class="st">'ctrl, synth'</span><span class="op">,</span> <span class="st">'ctrl, DiD'</span>]}</span>
<span id="cb36-615"><a href="#cb36-615" aria-hidden="true" tabindex="-1"></a>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-36" data-nodetype="declaration">

</div>
</div>
<div class="sidebar-section-header">
<p><strong>Overall</strong></p>
</div>
<div class="sourceCode cell-code hidden" id="cb37" data-startfrom="623" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 622;"><span id="cb37-623"><a href="#cb37-623" aria-hidden="true" tabindex="-1"></a>viewof dropAK <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">toggle</span>({<span class="dt">label</span><span class="op">:</span> <span class="st">'exclude AK'</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="kw">true</span>})<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-37" data-nodetype="declaration">

</div>
</div>
<div class="sidebar-section-header">
<p><strong>Appearance</strong></p>
</div>
<div class="sourceCode cell-code hidden" id="cb38" data-startfrom="631" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 630;"><span id="cb38-631"><a href="#cb38-631" aria-hidden="true" tabindex="-1"></a>viewof consistentAxes <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">toggle</span>({<span class="dt">label</span><span class="op">:</span> <span class="st">'consistent axes'</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="kw">false</span>})<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-38" data-nodetype="declaration">

</div>
</div>
<div class="sourceCode cell-code hidden" id="cb39" data-startfrom="635" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 634;"><span id="cb39-635"><a href="#cb39-635" aria-hidden="true" tabindex="-1"></a>viewof fe <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">toggle</span>({<span class="dt">label</span><span class="op">:</span> <span class="st">'fixed effects'</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="kw">true</span>})<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-39" data-nodetype="declaration">

</div>
</div>
<div class="sourceCode cell-code hidden" id="cb40" data-startfrom="639" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 638;"><span id="cb40-639"><a href="#cb40-639" aria-hidden="true" tabindex="-1"></a>viewof sortChrono <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">toggle</span>({<span class="dt">label</span><span class="op">:</span> <span class="st">'sort states chrono'</span>})<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-40" data-nodetype="declaration">

</div>
</div>
<div class="sourceCode cell-code hidden" id="cb41" data-startfrom="643" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 642;"><span id="cb41-643"><a href="#cb41-643" aria-hidden="true" tabindex="-1"></a>viewof synthCtrlMagnifier <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>(</span>
<span id="cb41-644"><a href="#cb41-644" aria-hidden="true" tabindex="-1"></a>  [<span class="dv">1</span><span class="op">,</span> <span class="dv">3</span>]<span class="op">,</span> {<span class="dt">label</span><span class="op">:</span> <span class="st">'magnify SC states'</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="fl">0.1</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="dv">1</span>}</span>
<span id="cb41-645"><a href="#cb41-645" aria-hidden="true" tabindex="-1"></a>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-41" data-nodetype="declaration">

</div>
</div>
<div class="cell hidden">
<div class="sourceCode cell-code hidden" id="cb42" data-startfrom="654" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 653;"><span id="cb42-654"><a href="#cb42-654" aria-hidden="true" tabindex="-1"></a>mutable ojsCellId <span class="op">=</span> {</span>
<span id="cb42-655"><a href="#cb42-655" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> ojsCell <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">querySelector</span>(</span>
<span id="cb42-656"><a href="#cb42-656" aria-hidden="true" tabindex="-1"></a>    <span class="st">'div.main .active [id*="ojs-cell-"]'</span></span>
<span id="cb42-657"><a href="#cb42-657" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb42-658"><a href="#cb42-658" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> ojsCell<span class="op">.</span><span class="at">id</span><span class="op">;</span></span>
<span id="cb42-659"><a href="#cb42-659" aria-hidden="true" tabindex="-1"></a>}<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display hidden">
<div id="ojs-cell-42" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell hidden">
<div class="sourceCode cell-code hidden" id="cb43" data-startfrom="665" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 664;"><span id="cb43-665"><a href="#cb43-665" aria-hidden="true" tabindex="-1"></a>pageTab <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">querySelectorAll</span>(<span class="st">'.nav-link[role="tab"]'</span>)</span>
<span id="cb43-666"><a href="#cb43-666" aria-hidden="true" tabindex="-1"></a>pageTab<span class="op">.</span><span class="fu">forEach</span>(el <span class="kw">=&gt;</span> {</span>
<span id="cb43-667"><a href="#cb43-667" aria-hidden="true" tabindex="-1"></a>  el<span class="op">.</span><span class="fu">addEventListener</span>(<span class="st">'click'</span><span class="op">,</span> <span class="kw">function</span>(<span class="bu">event</span>) {</span>
<span id="cb43-668"><a href="#cb43-668" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> ojsCell <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">querySelector</span>(</span>
<span id="cb43-669"><a href="#cb43-669" aria-hidden="true" tabindex="-1"></a>      <span class="st">'div.main .active.show [id*="ojs-cell-"]'</span></span>
<span id="cb43-670"><a href="#cb43-670" aria-hidden="true" tabindex="-1"></a>    )<span class="op">;</span></span>
<span id="cb43-671"><a href="#cb43-671" aria-hidden="true" tabindex="-1"></a>    mutable ojsCellId <span class="op">=</span> ojsCell<span class="op">.</span><span class="at">id</span></span>
<span id="cb43-672"><a href="#cb43-672" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb43-673"><a href="#cb43-673" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-43-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-43-2" data-nodetype="expression">

</div>
</div>
</div>
</div>
<div class="cell hidden">
<div class="sourceCode cell-code hidden" id="cb44" data-startfrom="678" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 677;"><span id="cb44-678"><a href="#cb44-678" aria-hidden="true" tabindex="-1"></a>expandButton <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">querySelectorAll</span>(<span class="st">'.bslib-full-screen-enter'</span>)<span class="op">;</span></span>
<span id="cb44-679"><a href="#cb44-679" aria-hidden="true" tabindex="-1"></a>expandButton<span class="op">.</span><span class="fu">forEach</span>(el <span class="kw">=&gt;</span> {</span>
<span id="cb44-680"><a href="#cb44-680" aria-hidden="true" tabindex="-1"></a>  el<span class="op">.</span><span class="fu">addEventListener</span>(<span class="st">'click'</span><span class="op">,</span> <span class="kw">function</span>(<span class="bu">event</span>) {</span>
<span id="cb44-681"><a href="#cb44-681" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> parentEl <span class="op">=</span> <span class="bu">event</span><span class="op">.</span><span class="at">currentTarget</span><span class="op">.</span><span class="fu">closest</span>(<span class="st">'[data-full-screen="true"]'</span>)<span class="op">;</span></span>
<span id="cb44-682"><a href="#cb44-682" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> ojsCell <span class="op">=</span> parentEl<span class="op">.</span><span class="fu">querySelector</span>(<span class="st">'[id*="ojs-cell-"]'</span>)<span class="op">;</span></span>
<span id="cb44-683"><a href="#cb44-683" aria-hidden="true" tabindex="-1"></a>    mutable ojsCellId <span class="op">=</span> ojsCell<span class="op">.</span><span class="at">id</span><span class="op">;</span></span>
<span id="cb44-684"><a href="#cb44-684" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb44-685"><a href="#cb44-685" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-44-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-44-2" data-nodetype="expression">

</div>
</div>
</div>
<div class="sourceCode cell-code hidden" id="cb45" data-startfrom="686" data-source-offset="-338"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 685;"><span id="cb45-686"><a href="#cb45-686" aria-hidden="true" tabindex="-1"></a>expandButton<span class="op">.</span><span class="fu">forEach</span>(el <span class="kw">=&gt;</span> {</span>
<span id="cb45-687"><a href="#cb45-687" aria-hidden="true" tabindex="-1"></a>  el<span class="op">.</span><span class="fu">addEventListener</span>(<span class="st">'click'</span><span class="op">,</span> <span class="kw">function</span>(<span class="bu">event</span>) {</span>
<span id="cb45-688"><a href="#cb45-688" aria-hidden="true" tabindex="-1"></a>    mutable full <span class="op">=</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb45-689"><a href="#cb45-689" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb45-690"><a href="#cb45-690" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-44-3" data-nodetype="expression">

</div>
</div>
</div>
</div>
<div class="cell hidden">
<div class="sourceCode cell-code hidden" id="cb46" data-startfrom="695" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 694;"><span id="cb46-695"><a href="#cb46-695" aria-hidden="true" tabindex="-1"></a>closeButtonParent <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">querySelector</span>(<span class="st">'div.main'</span>)<span class="op">;</span></span>
<span id="cb46-696"><a href="#cb46-696" aria-hidden="true" tabindex="-1"></a>closeButtonParent<span class="op">.</span><span class="fu">addEventListener</span>(<span class="st">'click'</span><span class="op">,</span> <span class="kw">function</span>(<span class="bu">event</span>) {</span>
<span id="cb46-697"><a href="#cb46-697" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (</span>
<span id="cb46-698"><a href="#cb46-698" aria-hidden="true" tabindex="-1"></a>    <span class="bu">event</span><span class="op">.</span><span class="at">target</span><span class="op">.</span><span class="fu">matches</span>(</span>
<span id="cb46-699"><a href="#cb46-699" aria-hidden="true" tabindex="-1"></a>      <span class="st">'.bslib-full-screen-exit, #bslib-full-screen-overlay, svg.bi.bi-x-lg, svg.bi.bi-x-lg path'</span></span>
<span id="cb46-700"><a href="#cb46-700" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb46-701"><a href="#cb46-701" aria-hidden="true" tabindex="-1"></a>  ) {</span>
<span id="cb46-702"><a href="#cb46-702" aria-hidden="true" tabindex="-1"></a>    mutable full <span class="op">=</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb46-703"><a href="#cb46-703" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb46-704"><a href="#cb46-704" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-45-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-45-2" data-nodetype="expression">

</div>
</div>
</div>
</div>
<div class="cell hidden">
<div class="sourceCode cell-code hidden" id="cb47" data-startfrom="709" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 708;"><span id="cb47-709"><a href="#cb47-709" aria-hidden="true" tabindex="-1"></a>container <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">querySelector</span>(<span class="st">'#'</span> <span class="op">+</span> ojsCellId)<span class="op">;</span></span>
<span id="cb47-710"><a href="#cb47-710" aria-hidden="true" tabindex="-1"></a>dims <span class="op">=</span> Generators<span class="op">.</span><span class="fu">observe</span>(notify <span class="kw">=&gt;</span> {</span>
<span id="cb47-711"><a href="#cb47-711" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> observer <span class="op">=</span> <span class="kw">new</span> <span class="fu">ResizeObserver</span>(entries <span class="kw">=&gt;</span> {</span>
<span id="cb47-712"><a href="#cb47-712" aria-hidden="true" tabindex="-1"></a>    <span class="fu">notify</span>(entries[<span class="dv">0</span>]<span class="op">.</span><span class="at">contentRect</span>)<span class="op">;</span></span>
<span id="cb47-713"><a href="#cb47-713" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb47-714"><a href="#cb47-714" aria-hidden="true" tabindex="-1"></a>  observer<span class="op">.</span><span class="fu">observe</span>(container<span class="op">.</span><span class="at">parentNode</span>)<span class="op">;</span></span>
<span id="cb47-715"><a href="#cb47-715" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> () <span class="kw">=&gt;</span> observer<span class="op">.</span><span class="fu">disconnect</span>()<span class="op">;</span></span>
<span id="cb47-716"><a href="#cb47-716" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb47-717"><a href="#cb47-717" aria-hidden="true" tabindex="-1"></a>height <span class="op">=</span> dims<span class="op">.</span><span class="at">height</span><span class="op">;</span></span>
<span id="cb47-718"><a href="#cb47-718" aria-hidden="true" tabindex="-1"></a>mutable width <span class="op">=</span> dims<span class="op">.</span><span class="at">width</span><span class="op">;</span></span>
<span id="cb47-719"><a href="#cb47-719" aria-hidden="true" tabindex="-1"></a>mutable full <span class="op">=</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb47-720"><a href="#cb47-720" aria-hidden="true" tabindex="-1"></a>ht <span class="op">=</span> full <span class="op">?</span> dims<span class="op">.</span><span class="at">height</span> <span class="op">:</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">min</span>(<span class="dv">226</span><span class="op">,</span> dims<span class="op">.</span><span class="at">width</span> <span class="op">*</span> <span class="op">.</span><span class="dv">7</span>)<span class="op">;</span></span>
<span id="cb47-721"><a href="#cb47-721" aria-hidden="true" tabindex="-1"></a>tickNumY <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">max</span>(height <span class="op">/</span> <span class="dv">50</span><span class="op">,</span> <span class="dv">2</span>)<span class="op">;</span></span>
<span id="cb47-722"><a href="#cb47-722" aria-hidden="true" tabindex="-1"></a>tickNumX <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">max</span>(width <span class="op">/</span> <span class="dv">75</span><span class="op">,</span> <span class="dv">2</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-46-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-46-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-46-3" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-46-4" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-46-5" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-46-6" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-46-7" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-46-8" data-nodetype="declaration">

</div>
</div>
</div>
</div>
<div class="cell hidden">
<div class="sourceCode cell-code hidden" id="cb48" data-startfrom="726" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 725;"><span id="cb48-726"><a href="#cb48-726" aria-hidden="true" tabindex="-1"></a>margin <span class="op">=</span> {<span class="cf">return</span> {<span class="dt">top</span><span class="op">:</span> <span class="dv">20</span><span class="op">,</span> <span class="dt">right</span><span class="op">:</span> <span class="dv">20</span><span class="op">,</span> <span class="dt">bottom</span><span class="op">:</span> <span class="dv">30</span><span class="op">,</span> <span class="dt">left</span><span class="op">:</span> <span class="dv">40</span>}<span class="op">;</span>}<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display hidden">
<div id="ojs-cell-47" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell hidden">
<div class="sourceCode cell-code hidden" id="cb49" data-startfrom="737" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 736;"><span id="cb49-737"><a href="#cb49-737" aria-hidden="true" tabindex="-1"></a>plotTrends <span class="op">=</span> <span class="kw">function</span>(treatGroup) {</span>
<span id="cb49-738"><a href="#cb49-738" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb49-739"><a href="#cb49-739" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Variable Setup ============================================================</span></span>
<span id="cb49-740"><a href="#cb49-740" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-741"><a href="#cb49-741" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> treatYear <span class="op">=</span> treatGroup<span class="op">;</span></span>
<span id="cb49-742"><a href="#cb49-742" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (treatGroup<span class="op">.</span><span class="at">length</span> <span class="op">===</span> <span class="dv">2</span>) {</span>
<span id="cb49-743"><a href="#cb49-743" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (<span class="kw">const</span> [key<span class="op">,</span> value] <span class="kw">of</span> treatGroupStatesMap<span class="op">.</span><span class="fu">entries</span>()) {</span>
<span id="cb49-744"><a href="#cb49-744" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (value<span class="op">.</span><span class="fu">includes</span>(treatGroup)) {</span>
<span id="cb49-745"><a href="#cb49-745" aria-hidden="true" tabindex="-1"></a>        treatYear <span class="op">=</span> key<span class="op">;</span></span>
<span id="cb49-746"><a href="#cb49-746" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb49-747"><a href="#cb49-747" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb49-748"><a href="#cb49-748" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb49-749"><a href="#cb49-749" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> stackedYr <span class="op">=</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb49-750"><a href="#cb49-750" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (ctrlSpecDiD<span class="op">.</span><span class="fu">includes</span>(<span class="st">'stacked'</span>)) {</span>
<span id="cb49-751"><a href="#cb49-751" aria-hidden="true" tabindex="-1"></a>    stackedYr <span class="op">=</span> <span class="bu">Number</span>(ctrlSpecDiD<span class="op">.</span><span class="fu">match</span>(<span class="ss">/</span><span class="sc">\d\d?</span><span class="ss">/</span>))<span class="op">;</span></span>
<span id="cb49-752"><a href="#cb49-752" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb49-753"><a href="#cb49-753" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-754"><a href="#cb49-754" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Data Setup ================================================================</span></span>
<span id="cb49-755"><a href="#cb49-755" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-756"><a href="#cb49-756" aria-hidden="true" tabindex="-1"></a>  <span class="co">//// Means -------------------------------------------------------------------</span></span>
<span id="cb49-757"><a href="#cb49-757" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-758"><a href="#cb49-758" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> dataTreatMeanG <span class="op">=</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb49-759"><a href="#cb49-759" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (treatGroup<span class="op">.</span><span class="at">length</span> <span class="op">===</span> <span class="dv">2</span>) {</span>
<span id="cb49-760"><a href="#cb49-760" aria-hidden="true" tabindex="-1"></a>    dataTreatMeanG <span class="op">=</span> dataAllStatesUse<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span></span>
<span id="cb49-761"><a href="#cb49-761" aria-hidden="true" tabindex="-1"></a>      treatGroup<span class="op">.</span><span class="fu">includes</span>(d<span class="op">.</span><span class="at">st</span>) <span class="op">&amp;&amp;</span> d<span class="op">.</span><span class="at">treated</span> <span class="op">===</span> <span class="dv">1</span></span>
<span id="cb49-762"><a href="#cb49-762" aria-hidden="true" tabindex="-1"></a>    )<span class="op">;</span></span>
<span id="cb49-763"><a href="#cb49-763" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb49-764"><a href="#cb49-764" aria-hidden="true" tabindex="-1"></a>    dataTreatMeanG <span class="op">=</span> dataTreatMeansUse<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> </span>
<span id="cb49-765"><a href="#cb49-765" aria-hidden="true" tabindex="-1"></a>      treatGroup<span class="op">.</span><span class="fu">includes</span>(d<span class="op">.</span><span class="at">treat_group</span>)</span>
<span id="cb49-766"><a href="#cb49-766" aria-hidden="true" tabindex="-1"></a>    )<span class="op">;</span></span>
<span id="cb49-767"><a href="#cb49-767" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb49-768"><a href="#cb49-768" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> dataCtrlMeanDiDG <span class="op">=</span> dataCtrlMeansDiDUse<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> </span>
<span id="cb49-769"><a href="#cb49-769" aria-hidden="true" tabindex="-1"></a>    treatYear<span class="op">.</span><span class="fu">includes</span>(d<span class="op">.</span><span class="at">treat_group</span>)</span>
<span id="cb49-770"><a href="#cb49-770" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb49-771"><a href="#cb49-771" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (</span>
<span id="cb49-772"><a href="#cb49-772" aria-hidden="true" tabindex="-1"></a>    ctrlSpecDiD<span class="op">.</span><span class="fu">includes</span>(<span class="st">'stacked'</span>) <span class="op">&amp;&amp;</span> <span class="bu">Number</span>(treatYear) <span class="op">+</span> stackedYr <span class="op">-</span> <span class="dv">1</span> <span class="op">&gt;</span> <span class="dv">2019</span></span>
<span id="cb49-773"><a href="#cb49-773" aria-hidden="true" tabindex="-1"></a>  ) {</span>
<span id="cb49-774"><a href="#cb49-774" aria-hidden="true" tabindex="-1"></a>    dataCtrlMeanDiDG <span class="op">=</span> [{<span class="dt">year</span><span class="op">:</span> <span class="dv">1983</span><span class="op">,</span> <span class="dt">outcome</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span> <span class="dt">treated</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span> <span class="dt">st</span><span class="op">:</span> <span class="st">'blank'</span>}]<span class="op">;</span></span>
<span id="cb49-775"><a href="#cb49-775" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb49-776"><a href="#cb49-776" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> dataCtrlMeanSynthG <span class="op">=</span> dataCtrlMeansSynthUse<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> </span>
<span id="cb49-777"><a href="#cb49-777" aria-hidden="true" tabindex="-1"></a>    treatGroup<span class="op">.</span><span class="fu">includes</span>(d<span class="op">.</span><span class="at">treat_group</span>)</span>
<span id="cb49-778"><a href="#cb49-778" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb49-779"><a href="#cb49-779" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-780"><a href="#cb49-780" aria-hidden="true" tabindex="-1"></a>  <span class="co">//// States, filter by treat group -------------------------------------------</span></span>
<span id="cb49-781"><a href="#cb49-781" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-782"><a href="#cb49-782" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> dataAllStatesG <span class="op">=</span> dataAllStatesUse<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> </span>
<span id="cb49-783"><a href="#cb49-783" aria-hidden="true" tabindex="-1"></a>    treatYear<span class="op">.</span><span class="fu">includes</span>(d<span class="op">.</span><span class="at">treat_group</span>)</span>
<span id="cb49-784"><a href="#cb49-784" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb49-785"><a href="#cb49-785" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (treatGroup<span class="op">.</span><span class="at">length</span> <span class="op">===</span> <span class="dv">2</span>) {</span>
<span id="cb49-786"><a href="#cb49-786" aria-hidden="true" tabindex="-1"></a>    dataAllStatesG <span class="op">=</span> dataAllStatesG<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> </span>
<span id="cb49-787"><a href="#cb49-787" aria-hidden="true" tabindex="-1"></a>      d<span class="op">.</span><span class="at">treated</span> <span class="op">===</span> <span class="dv">0</span> <span class="op">||</span> treatGroup<span class="op">.</span><span class="fu">includes</span>(d<span class="op">.</span><span class="at">st</span>)</span>
<span id="cb49-788"><a href="#cb49-788" aria-hidden="true" tabindex="-1"></a>    )<span class="op">;</span></span>
<span id="cb49-789"><a href="#cb49-789" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb49-790"><a href="#cb49-790" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> dataCtrlStatesDiDG <span class="op">=</span> dataCtrlStatesDiDUse<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span></span>
<span id="cb49-791"><a href="#cb49-791" aria-hidden="true" tabindex="-1"></a>    treatYear<span class="op">.</span><span class="fu">includes</span>(d<span class="op">.</span><span class="at">treat_group</span>)</span>
<span id="cb49-792"><a href="#cb49-792" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb49-793"><a href="#cb49-793" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> dataCtrlStatesSynthG <span class="op">=</span> dataCtrlStatesSynthUse<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> </span>
<span id="cb49-794"><a href="#cb49-794" aria-hidden="true" tabindex="-1"></a>    treatGroup<span class="op">.</span><span class="fu">includes</span>(d<span class="op">.</span><span class="at">treat_group</span>) </span>
<span id="cb49-795"><a href="#cb49-795" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb49-796"><a href="#cb49-796" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-797"><a href="#cb49-797" aria-hidden="true" tabindex="-1"></a>  <span class="co">//// States, non-synth -------------------------------------------------------</span></span>
<span id="cb49-798"><a href="#cb49-798" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-799"><a href="#cb49-799" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> dataStatesMain <span class="op">=</span> dataAllStatesG<span class="op">;</span></span>
<span id="cb49-800"><a href="#cb49-800" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="op">!</span>subgroupsToShow<span class="op">.</span><span class="fu">includes</span>(<span class="st">'treated'</span>)) {</span>
<span id="cb49-801"><a href="#cb49-801" aria-hidden="true" tabindex="-1"></a>    dataStatesMain <span class="op">=</span> dataStatesMain<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">treated</span> <span class="op">===</span> <span class="dv">0</span>)<span class="op">;</span></span>
<span id="cb49-802"><a href="#cb49-802" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb49-803"><a href="#cb49-803" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="op">!</span>subgroupsToShow<span class="op">.</span><span class="fu">includes</span>(<span class="st">'untreated'</span>)) {</span>
<span id="cb49-804"><a href="#cb49-804" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (subgroupsToShow<span class="op">.</span><span class="fu">includes</span>(<span class="st">'ctrl, DiD'</span>) <span class="op">&amp;&amp;</span> ctrlSpecDiD <span class="op">!==</span> <span class="st">'none'</span>) {</span>
<span id="cb49-805"><a href="#cb49-805" aria-hidden="true" tabindex="-1"></a>      <span class="kw">const</span> ctrlStates <span class="op">=</span> dataCtrlStatesDiDG<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">ctrl_states</span>)[<span class="dv">0</span>]<span class="op">;</span></span>
<span id="cb49-806"><a href="#cb49-806" aria-hidden="true" tabindex="-1"></a>      dataStatesMain <span class="op">=</span> dataStatesMain<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> </span>
<span id="cb49-807"><a href="#cb49-807" aria-hidden="true" tabindex="-1"></a>        <span class="op">!</span>(d<span class="op">.</span><span class="at">treated</span> <span class="op">===</span> <span class="dv">0</span> <span class="op">&amp;&amp;</span> <span class="op">!</span>ctrlStates<span class="op">.</span><span class="fu">includes</span>(d<span class="op">.</span><span class="at">st</span>))</span>
<span id="cb49-808"><a href="#cb49-808" aria-hidden="true" tabindex="-1"></a>      )<span class="op">;</span></span>
<span id="cb49-809"><a href="#cb49-809" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (ctrlSpecDiD<span class="op">.</span><span class="fu">includes</span>(<span class="st">'stacked'</span>)) {</span>
<span id="cb49-810"><a href="#cb49-810" aria-hidden="true" tabindex="-1"></a>        dataStatesMain <span class="op">=</span> dataStatesMain<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span></span>
<span id="cb49-811"><a href="#cb49-811" aria-hidden="true" tabindex="-1"></a>          <span class="op">!</span>(d<span class="op">.</span><span class="at">treated</span> <span class="op">===</span> <span class="dv">0</span> <span class="op">&amp;&amp;</span> d<span class="op">.</span><span class="at">year</span> <span class="op">&gt;=</span> <span class="bu">Number</span>(treatYear) <span class="op">+</span> stackedYr)</span>
<span id="cb49-812"><a href="#cb49-812" aria-hidden="true" tabindex="-1"></a>        )<span class="op">;</span></span>
<span id="cb49-813"><a href="#cb49-813" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb49-814"><a href="#cb49-814" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="bu">Number</span>(treatYear) <span class="op">+</span> stackedYr <span class="op">-</span> <span class="dv">1</span> <span class="op">&gt;</span> <span class="dv">2019</span>) {</span>
<span id="cb49-815"><a href="#cb49-815" aria-hidden="true" tabindex="-1"></a>        dataStatesMain <span class="op">=</span> dataStatesMain<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">treated</span> <span class="op">!==</span> <span class="dv">0</span>)<span class="op">;</span></span>
<span id="cb49-816"><a href="#cb49-816" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb49-817"><a href="#cb49-817" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb49-818"><a href="#cb49-818" aria-hidden="true" tabindex="-1"></a>      dataStatesMain <span class="op">=</span> dataStatesMain<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">treated</span> <span class="op">!==</span> <span class="dv">0</span>)<span class="op">;</span></span>
<span id="cb49-819"><a href="#cb49-819" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb49-820"><a href="#cb49-820" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb49-821"><a href="#cb49-821" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="op">!</span>showSubgroups) dataStatesMain <span class="op">=</span> [</span>
<span id="cb49-822"><a href="#cb49-822" aria-hidden="true" tabindex="-1"></a>    {<span class="dt">year</span><span class="op">:</span> <span class="dv">1983</span><span class="op">,</span> <span class="dt">outcome</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span> <span class="dt">treated</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span> <span class="dt">st</span><span class="op">:</span> <span class="st">'blank'</span>}</span>
<span id="cb49-823"><a href="#cb49-823" aria-hidden="true" tabindex="-1"></a>  ]<span class="op">;</span></span>
<span id="cb49-824"><a href="#cb49-824" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (showSubgroups <span class="op">&amp;&amp;</span> dataStatesMain<span class="op">.</span><span class="at">length</span> <span class="op">===</span> <span class="dv">0</span>) dataStatesMain <span class="op">=</span> [</span>
<span id="cb49-825"><a href="#cb49-825" aria-hidden="true" tabindex="-1"></a>    {<span class="dt">year</span><span class="op">:</span> <span class="dv">1983</span><span class="op">,</span> <span class="dt">outcome</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span> <span class="dt">treated</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span> <span class="dt">st</span><span class="op">:</span> <span class="st">'blank'</span>}</span>
<span id="cb49-826"><a href="#cb49-826" aria-hidden="true" tabindex="-1"></a>  ]<span class="op">;</span></span>
<span id="cb49-827"><a href="#cb49-827" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-828"><a href="#cb49-828" aria-hidden="true" tabindex="-1"></a>  <span class="co">//// States, synth -----------------------------------------------------------</span></span>
<span id="cb49-829"><a href="#cb49-829" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-830"><a href="#cb49-830" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> dataStatesSynth <span class="op">=</span> dataAllStatesG<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> </span>
<span id="cb49-831"><a href="#cb49-831" aria-hidden="true" tabindex="-1"></a>    dataCtrlStatesSynthG<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">st</span>)<span class="op">.</span><span class="fu">includes</span>(d<span class="op">.</span><span class="at">st</span>)</span>
<span id="cb49-832"><a href="#cb49-832" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb49-833"><a href="#cb49-833" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> synthWtsMap <span class="op">=</span> <span class="kw">new</span> <span class="bu">Map</span>(dataCtrlStatesSynthG<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> [d<span class="op">.</span><span class="at">st</span><span class="op">,</span> d<span class="op">.</span><span class="at">weight</span>]))<span class="op">;</span></span>
<span id="cb49-834"><a href="#cb49-834" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> dataStatesSynthWts <span class="op">=</span> dataStatesSynth<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> ({</span>
<span id="cb49-835"><a href="#cb49-835" aria-hidden="true" tabindex="-1"></a>    <span class="op">...</span>d<span class="op">,</span> <span class="dt">weight</span><span class="op">:</span> synthWtsMap<span class="op">.</span><span class="fu">get</span>(d<span class="op">.</span><span class="at">st</span>)</span>
<span id="cb49-836"><a href="#cb49-836" aria-hidden="true" tabindex="-1"></a>  }))<span class="op">;</span></span>
<span id="cb49-837"><a href="#cb49-837" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="op">!</span>showSubgroups <span class="op">||</span> <span class="op">!</span>subgroupsToShow<span class="op">.</span><span class="fu">includes</span>(<span class="st">'ctrl, synth'</span>)) {</span>
<span id="cb49-838"><a href="#cb49-838" aria-hidden="true" tabindex="-1"></a>    dataStatesSynthWts <span class="op">=</span> [{<span class="dt">year</span><span class="op">:</span> <span class="dv">1983</span><span class="op">,</span> <span class="dt">outcome</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span> <span class="dt">st</span><span class="op">:</span> <span class="st">'blank'</span><span class="op">,</span> <span class="dt">weight</span><span class="op">:</span> <span class="dv">0</span>}]<span class="op">;</span></span>
<span id="cb49-839"><a href="#cb49-839" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb49-840"><a href="#cb49-840" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-841"><a href="#cb49-841" aria-hidden="true" tabindex="-1"></a>  <span class="co">//// Overlay K-12 means ------------------------------------------------------</span></span>
<span id="cb49-842"><a href="#cb49-842" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-843"><a href="#cb49-843" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> dataK12MeansG <span class="op">=</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb49-844"><a href="#cb49-844" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (overlayK12 <span class="op">&amp;&amp;</span> selectedOutcome <span class="op">!==</span> <span class="st">'e027_elem_educ_direct_exp'</span>) {</span>
<span id="cb49-845"><a href="#cb49-845" aria-hidden="true" tabindex="-1"></a>    dataK12MeansG <span class="op">=</span> dataK12Means<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> </span>
<span id="cb49-846"><a href="#cb49-846" aria-hidden="true" tabindex="-1"></a>      treatGroup<span class="op">.</span><span class="fu">includes</span>(d<span class="op">.</span><span class="at">treat_group</span>) <span class="op">||</span> </span>
<span id="cb49-847"><a href="#cb49-847" aria-hidden="true" tabindex="-1"></a>        treatYear<span class="op">.</span><span class="fu">includes</span>(d<span class="op">.</span><span class="at">treat_group</span>) <span class="op">&amp;&amp;</span> </span>
<span id="cb49-848"><a href="#cb49-848" aria-hidden="true" tabindex="-1"></a>        [<span class="st">'ctrl did'</span><span class="op">,</span> <span class="st">'treat st'</span><span class="op">,</span> <span class="st">'treat group'</span>]<span class="op">.</span><span class="fu">includes</span>(d<span class="op">.</span><span class="at">id</span>)</span>
<span id="cb49-849"><a href="#cb49-849" aria-hidden="true" tabindex="-1"></a>    )<span class="op">;</span></span>
<span id="cb49-850"><a href="#cb49-850" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (treatGroup<span class="op">.</span><span class="at">length</span> <span class="op">===</span> <span class="dv">2</span>) {</span>
<span id="cb49-851"><a href="#cb49-851" aria-hidden="true" tabindex="-1"></a>      dataK12MeansG <span class="op">=</span> dataK12MeansG<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> </span>
<span id="cb49-852"><a href="#cb49-852" aria-hidden="true" tabindex="-1"></a>        d<span class="op">.</span><span class="at">id</span> <span class="op">!==</span> <span class="st">'treat group'</span> <span class="op">&amp;&amp;</span></span>
<span id="cb49-853"><a href="#cb49-853" aria-hidden="true" tabindex="-1"></a>          <span class="op">!</span>(<span class="op">!</span>treatGroup<span class="op">.</span><span class="fu">includes</span>(d<span class="op">.</span><span class="at">st</span>) <span class="op">&amp;&amp;</span> d<span class="op">.</span><span class="at">id</span> <span class="op">===</span> <span class="st">'treat st'</span>)</span>
<span id="cb49-854"><a href="#cb49-854" aria-hidden="true" tabindex="-1"></a>      )<span class="op">;</span></span>
<span id="cb49-855"><a href="#cb49-855" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb49-856"><a href="#cb49-856" aria-hidden="true" tabindex="-1"></a>      dataK12MeansG <span class="op">=</span> dataK12MeansG<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">id</span> <span class="op">!==</span> <span class="st">'treat st'</span>)<span class="op">;</span></span>
<span id="cb49-857"><a href="#cb49-857" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb49-858"><a href="#cb49-858" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (ctrlSpecDiD <span class="op">===</span> <span class="st">'none'</span>) {</span>
<span id="cb49-859"><a href="#cb49-859" aria-hidden="true" tabindex="-1"></a>      dataK12MeansG <span class="op">=</span> dataK12MeansG<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">id</span> <span class="op">!==</span> <span class="st">'ctrl did'</span>)<span class="op">;</span></span>
<span id="cb49-860"><a href="#cb49-860" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb49-861"><a href="#cb49-861" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (ctrlSpecSynth <span class="op">===</span> <span class="st">'none'</span>) {</span>
<span id="cb49-862"><a href="#cb49-862" aria-hidden="true" tabindex="-1"></a>      dataK12MeansG <span class="op">=</span> dataK12MeansG<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">id</span> <span class="op">!==</span> <span class="st">'ctrl synth'</span>)<span class="op">;</span></span>
<span id="cb49-863"><a href="#cb49-863" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb49-864"><a href="#cb49-864" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb49-865"><a href="#cb49-865" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb49-866"><a href="#cb49-866" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Scale Functions ===========================================================</span></span>
<span id="cb49-867"><a href="#cb49-867" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-868"><a href="#cb49-868" aria-hidden="true" tabindex="-1"></a>  <span class="co">//// Find min &amp; max y and x values -------------------------------------------</span></span>
<span id="cb49-869"><a href="#cb49-869" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-870"><a href="#cb49-870" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> maxX<span class="op">,</span> minY<span class="op">,</span> maxY<span class="op">,</span> minYTreat<span class="op">,</span> maxYTreat <span class="op">=</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb49-871"><a href="#cb49-871" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-872"><a href="#cb49-872" aria-hidden="true" tabindex="-1"></a>  <span class="co">////// Consistent axes -------------------------------------------------------</span></span>
<span id="cb49-873"><a href="#cb49-873" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-874"><a href="#cb49-874" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (consistentAxes) {</span>
<span id="cb49-875"><a href="#cb49-875" aria-hidden="true" tabindex="-1"></a>    maxX <span class="op">=</span> d3<span class="op">.</span><span class="fu">max</span>(dataTreatMeansUse<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">year</span>)<span class="op">;</span></span>
<span id="cb49-876"><a href="#cb49-876" aria-hidden="true" tabindex="-1"></a>    minYTreat <span class="op">=</span> d3<span class="op">.</span><span class="fu">min</span>(dataTreatMeansUse<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">outcome</span>)<span class="op">;</span></span>
<span id="cb49-877"><a href="#cb49-877" aria-hidden="true" tabindex="-1"></a>    maxYTreat <span class="op">=</span> d3<span class="op">.</span><span class="fu">max</span>(dataTreatMeansUse<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">outcome</span>)<span class="op">;</span></span>
<span id="cb49-878"><a href="#cb49-878" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-879"><a href="#cb49-879" aria-hidden="true" tabindex="-1"></a>    <span class="co">//////// States shown ------------------------------------------------------</span></span>
<span id="cb49-880"><a href="#cb49-880" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-881"><a href="#cb49-881" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (showSubgroups) {</span>
<span id="cb49-882"><a href="#cb49-882" aria-hidden="true" tabindex="-1"></a>      minY <span class="op">=</span> fe <span class="op">?</span> </span>
<span id="cb49-883"><a href="#cb49-883" aria-hidden="true" tabindex="-1"></a>        <span class="bu">Math</span><span class="op">.</span><span class="fu">min</span>(d3<span class="op">.</span><span class="fu">min</span>(dataAllStatesUse<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">outcome</span>)<span class="op">,</span> minYTreat) <span class="op">:</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb49-884"><a href="#cb49-884" aria-hidden="true" tabindex="-1"></a>      maxY <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">max</span>(d3<span class="op">.</span><span class="fu">max</span>(dataAllStatesUse<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">outcome</span>)<span class="op">,</span> maxYTreat)<span class="op">;</span></span>
<span id="cb49-885"><a href="#cb49-885" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-886"><a href="#cb49-886" aria-hidden="true" tabindex="-1"></a>    <span class="co">//////// Means only --------------------------------------------------------</span></span>
<span id="cb49-887"><a href="#cb49-887" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-888"><a href="#cb49-888" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (ctrlSpecDiD <span class="op">!==</span> <span class="st">'none'</span> <span class="op">&amp;&amp;</span> ctrlSpecSynth <span class="op">!==</span> <span class="st">'none'</span>) {</span>
<span id="cb49-889"><a href="#cb49-889" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (fe) {</span>
<span id="cb49-890"><a href="#cb49-890" aria-hidden="true" tabindex="-1"></a>        minY <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">min</span>(</span>
<span id="cb49-891"><a href="#cb49-891" aria-hidden="true" tabindex="-1"></a>          d3<span class="op">.</span><span class="fu">min</span>(dataCtrlMeansDiDUse<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">outcome</span>)<span class="op">,</span> </span>
<span id="cb49-892"><a href="#cb49-892" aria-hidden="true" tabindex="-1"></a>          d3<span class="op">.</span><span class="fu">min</span>(dataCtrlMeansSynthUse<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">outcome</span>)<span class="op">,</span> </span>
<span id="cb49-893"><a href="#cb49-893" aria-hidden="true" tabindex="-1"></a>          minYTreat</span>
<span id="cb49-894"><a href="#cb49-894" aria-hidden="true" tabindex="-1"></a>        )<span class="op">;</span></span>
<span id="cb49-895"><a href="#cb49-895" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb49-896"><a href="#cb49-896" aria-hidden="true" tabindex="-1"></a>        minY <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb49-897"><a href="#cb49-897" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb49-898"><a href="#cb49-898" aria-hidden="true" tabindex="-1"></a>      maxY <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">max</span>(</span>
<span id="cb49-899"><a href="#cb49-899" aria-hidden="true" tabindex="-1"></a>        d3<span class="op">.</span><span class="fu">max</span>(dataCtrlMeansDiDUse<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">outcome</span>)<span class="op">,</span> </span>
<span id="cb49-900"><a href="#cb49-900" aria-hidden="true" tabindex="-1"></a>        d3<span class="op">.</span><span class="fu">max</span>(dataCtrlMeansSynthUse<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">outcome</span>)<span class="op">,</span> </span>
<span id="cb49-901"><a href="#cb49-901" aria-hidden="true" tabindex="-1"></a>        maxYTreat</span>
<span id="cb49-902"><a href="#cb49-902" aria-hidden="true" tabindex="-1"></a>      )<span class="op">;</span></span>
<span id="cb49-903"><a href="#cb49-903" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (ctrlSpecSynth <span class="op">===</span> <span class="st">'none'</span>) {</span>
<span id="cb49-904"><a href="#cb49-904" aria-hidden="true" tabindex="-1"></a>      minY <span class="op">=</span> fe <span class="op">?</span> </span>
<span id="cb49-905"><a href="#cb49-905" aria-hidden="true" tabindex="-1"></a>        <span class="bu">Math</span><span class="op">.</span><span class="fu">min</span>(d3<span class="op">.</span><span class="fu">min</span>(dataCtrlMeansDiDUse<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">outcome</span>)<span class="op">,</span> minYTreat) <span class="op">:</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb49-906"><a href="#cb49-906" aria-hidden="true" tabindex="-1"></a>      maxY <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">max</span>(d3<span class="op">.</span><span class="fu">max</span>(dataCtrlMeansDiDUse<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">outcome</span>)<span class="op">,</span> maxYTreat)<span class="op">;</span></span>
<span id="cb49-907"><a href="#cb49-907" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb49-908"><a href="#cb49-908" aria-hidden="true" tabindex="-1"></a>      minY <span class="op">=</span> fe <span class="op">?</span> </span>
<span id="cb49-909"><a href="#cb49-909" aria-hidden="true" tabindex="-1"></a>        <span class="bu">Math</span><span class="op">.</span><span class="fu">min</span>(d3<span class="op">.</span><span class="fu">min</span>(dataCtrlMeansSynthUse<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">outcome</span>)<span class="op">,</span> minYTreat) <span class="op">:</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb49-910"><a href="#cb49-910" aria-hidden="true" tabindex="-1"></a>      maxY <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">max</span>(d3<span class="op">.</span><span class="fu">max</span>(dataCtrlMeansSynthUse<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">outcome</span>)<span class="op">,</span> maxYTreat)<span class="op">;</span></span>
<span id="cb49-911"><a href="#cb49-911" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb49-912"><a href="#cb49-912" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb49-913"><a href="#cb49-913" aria-hidden="true" tabindex="-1"></a>  <span class="co">////// Varying axes ----------------------------------------------------------</span></span>
<span id="cb49-914"><a href="#cb49-914" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-915"><a href="#cb49-915" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb49-916"><a href="#cb49-916" aria-hidden="true" tabindex="-1"></a>    maxX <span class="op">=</span> d3<span class="op">.</span><span class="fu">max</span>(dataTreatMeanG<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">year</span>)<span class="op">;</span></span>
<span id="cb49-917"><a href="#cb49-917" aria-hidden="true" tabindex="-1"></a>    minYTreat <span class="op">=</span> d3<span class="op">.</span><span class="fu">min</span>(dataTreatMeanG<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">outcome</span>)<span class="op">;</span></span>
<span id="cb49-918"><a href="#cb49-918" aria-hidden="true" tabindex="-1"></a>    maxYTreat <span class="op">=</span> d3<span class="op">.</span><span class="fu">max</span>(dataTreatMeanG<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">outcome</span>)<span class="op">;</span></span>
<span id="cb49-919"><a href="#cb49-919" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-920"><a href="#cb49-920" aria-hidden="true" tabindex="-1"></a>    <span class="co">//////// States shown ------------------------------------------------------</span></span>
<span id="cb49-921"><a href="#cb49-921" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-922"><a href="#cb49-922" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (showSubgroups) {</span>
<span id="cb49-923"><a href="#cb49-923" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (subgroupsToShow<span class="op">.</span><span class="fu">includes</span>(<span class="st">'ctrl, synth'</span>) <span class="op">&amp;&amp;</span> ctrlSpecSynth <span class="op">!==</span> <span class="st">'none'</span>) {</span>
<span id="cb49-924"><a href="#cb49-924" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (fe) {</span>
<span id="cb49-925"><a href="#cb49-925" aria-hidden="true" tabindex="-1"></a>          minY <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">min</span>(</span>
<span id="cb49-926"><a href="#cb49-926" aria-hidden="true" tabindex="-1"></a>            d3<span class="op">.</span><span class="fu">min</span>(dataStatesMain<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">outcome</span>)<span class="op">,</span> </span>
<span id="cb49-927"><a href="#cb49-927" aria-hidden="true" tabindex="-1"></a>            d3<span class="op">.</span><span class="fu">min</span>(dataStatesSynthWts<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">outcome</span>)<span class="op">,</span> </span>
<span id="cb49-928"><a href="#cb49-928" aria-hidden="true" tabindex="-1"></a>            minYTreat</span>
<span id="cb49-929"><a href="#cb49-929" aria-hidden="true" tabindex="-1"></a>          )<span class="op">;</span></span>
<span id="cb49-930"><a href="#cb49-930" aria-hidden="true" tabindex="-1"></a>        } <span class="cf">else</span> {</span>
<span id="cb49-931"><a href="#cb49-931" aria-hidden="true" tabindex="-1"></a>          minY <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb49-932"><a href="#cb49-932" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb49-933"><a href="#cb49-933" aria-hidden="true" tabindex="-1"></a>        maxY <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">max</span>(</span>
<span id="cb49-934"><a href="#cb49-934" aria-hidden="true" tabindex="-1"></a>          d3<span class="op">.</span><span class="fu">max</span>(dataStatesMain<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">outcome</span>)<span class="op">,</span> </span>
<span id="cb49-935"><a href="#cb49-935" aria-hidden="true" tabindex="-1"></a>          d3<span class="op">.</span><span class="fu">max</span>(dataStatesSynthWts<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">outcome</span>)<span class="op">,</span> </span>
<span id="cb49-936"><a href="#cb49-936" aria-hidden="true" tabindex="-1"></a>          maxYTreat</span>
<span id="cb49-937"><a href="#cb49-937" aria-hidden="true" tabindex="-1"></a>        )<span class="op">;</span></span>
<span id="cb49-938"><a href="#cb49-938" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> <span class="cf">if</span> (ctrlSpecDiD <span class="op">!==</span> <span class="st">'none'</span> <span class="op">&amp;&amp;</span> ctrlSpecSynth <span class="op">!==</span> <span class="st">'none'</span>) {</span>
<span id="cb49-939"><a href="#cb49-939" aria-hidden="true" tabindex="-1"></a>        minY <span class="op">=</span> fe <span class="op">?</span> </span>
<span id="cb49-940"><a href="#cb49-940" aria-hidden="true" tabindex="-1"></a>          <span class="bu">Math</span><span class="op">.</span><span class="fu">min</span>(</span>
<span id="cb49-941"><a href="#cb49-941" aria-hidden="true" tabindex="-1"></a>            d3<span class="op">.</span><span class="fu">min</span>(dataStatesMain<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">outcome</span>)<span class="op">,</span></span>
<span id="cb49-942"><a href="#cb49-942" aria-hidden="true" tabindex="-1"></a>            d3<span class="op">.</span><span class="fu">min</span>(dataCtrlMeanDiDG<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">outcome</span>)<span class="op">,</span></span>
<span id="cb49-943"><a href="#cb49-943" aria-hidden="true" tabindex="-1"></a>            d3<span class="op">.</span><span class="fu">min</span>(dataCtrlMeanSynthG<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">outcome</span>)<span class="op">,</span></span>
<span id="cb49-944"><a href="#cb49-944" aria-hidden="true" tabindex="-1"></a>            minYTreat</span>
<span id="cb49-945"><a href="#cb49-945" aria-hidden="true" tabindex="-1"></a>          ) <span class="op">:</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb49-946"><a href="#cb49-946" aria-hidden="true" tabindex="-1"></a>        maxY <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">max</span>(</span>
<span id="cb49-947"><a href="#cb49-947" aria-hidden="true" tabindex="-1"></a>          d3<span class="op">.</span><span class="fu">max</span>(dataStatesMain<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">outcome</span>)<span class="op">,</span> </span>
<span id="cb49-948"><a href="#cb49-948" aria-hidden="true" tabindex="-1"></a>          d3<span class="op">.</span><span class="fu">max</span>(dataCtrlMeanDiDG<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">outcome</span>)<span class="op">,</span></span>
<span id="cb49-949"><a href="#cb49-949" aria-hidden="true" tabindex="-1"></a>          d3<span class="op">.</span><span class="fu">max</span>(dataCtrlMeanSynthG<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">outcome</span>)<span class="op">,</span></span>
<span id="cb49-950"><a href="#cb49-950" aria-hidden="true" tabindex="-1"></a>          maxYTreat</span>
<span id="cb49-951"><a href="#cb49-951" aria-hidden="true" tabindex="-1"></a>        )<span class="op">;</span></span>
<span id="cb49-952"><a href="#cb49-952" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> <span class="cf">if</span> (ctrlSpecDiD <span class="op">!==</span> <span class="st">'none'</span> <span class="op">&amp;&amp;</span> ctrlSpecSynth <span class="op">===</span> <span class="st">'none'</span>) {</span>
<span id="cb49-953"><a href="#cb49-953" aria-hidden="true" tabindex="-1"></a>        minY <span class="op">=</span> fe <span class="op">?</span> </span>
<span id="cb49-954"><a href="#cb49-954" aria-hidden="true" tabindex="-1"></a>          <span class="bu">Math</span><span class="op">.</span><span class="fu">min</span>(</span>
<span id="cb49-955"><a href="#cb49-955" aria-hidden="true" tabindex="-1"></a>            d3<span class="op">.</span><span class="fu">min</span>(dataStatesMain<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">outcome</span>)<span class="op">,</span></span>
<span id="cb49-956"><a href="#cb49-956" aria-hidden="true" tabindex="-1"></a>            d3<span class="op">.</span><span class="fu">min</span>(dataCtrlMeanDiDG<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">outcome</span>)<span class="op">,</span></span>
<span id="cb49-957"><a href="#cb49-957" aria-hidden="true" tabindex="-1"></a>            minYTreat</span>
<span id="cb49-958"><a href="#cb49-958" aria-hidden="true" tabindex="-1"></a>          ) <span class="op">:</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb49-959"><a href="#cb49-959" aria-hidden="true" tabindex="-1"></a>        maxY <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">max</span>(</span>
<span id="cb49-960"><a href="#cb49-960" aria-hidden="true" tabindex="-1"></a>          d3<span class="op">.</span><span class="fu">max</span>(dataStatesMain<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">outcome</span>)<span class="op">,</span> </span>
<span id="cb49-961"><a href="#cb49-961" aria-hidden="true" tabindex="-1"></a>          d3<span class="op">.</span><span class="fu">max</span>(dataCtrlMeanDiDG<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">outcome</span>)<span class="op">,</span></span>
<span id="cb49-962"><a href="#cb49-962" aria-hidden="true" tabindex="-1"></a>          maxYTreat</span>
<span id="cb49-963"><a href="#cb49-963" aria-hidden="true" tabindex="-1"></a>        )<span class="op">;</span></span>
<span id="cb49-964"><a href="#cb49-964" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> <span class="cf">if</span> (ctrlSpecDiD <span class="op">===</span> <span class="st">'none'</span> <span class="op">&amp;&amp;</span> ctrlSpecSynth <span class="op">!==</span> <span class="st">'none'</span>) {</span>
<span id="cb49-965"><a href="#cb49-965" aria-hidden="true" tabindex="-1"></a>        minY <span class="op">=</span> fe <span class="op">?</span> </span>
<span id="cb49-966"><a href="#cb49-966" aria-hidden="true" tabindex="-1"></a>          <span class="bu">Math</span><span class="op">.</span><span class="fu">min</span>(</span>
<span id="cb49-967"><a href="#cb49-967" aria-hidden="true" tabindex="-1"></a>            d3<span class="op">.</span><span class="fu">min</span>(dataStatesMain<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">outcome</span>)<span class="op">,</span></span>
<span id="cb49-968"><a href="#cb49-968" aria-hidden="true" tabindex="-1"></a>            d3<span class="op">.</span><span class="fu">min</span>(dataCtrlMeanSynthG<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">outcome</span>)<span class="op">,</span></span>
<span id="cb49-969"><a href="#cb49-969" aria-hidden="true" tabindex="-1"></a>            minYTreat</span>
<span id="cb49-970"><a href="#cb49-970" aria-hidden="true" tabindex="-1"></a>          ) <span class="op">:</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb49-971"><a href="#cb49-971" aria-hidden="true" tabindex="-1"></a>        maxY <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">max</span>(</span>
<span id="cb49-972"><a href="#cb49-972" aria-hidden="true" tabindex="-1"></a>          d3<span class="op">.</span><span class="fu">max</span>(dataStatesMain<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">outcome</span>)<span class="op">,</span> </span>
<span id="cb49-973"><a href="#cb49-973" aria-hidden="true" tabindex="-1"></a>          d3<span class="op">.</span><span class="fu">max</span>(dataCtrlMeanSynthG<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">outcome</span>)<span class="op">,</span></span>
<span id="cb49-974"><a href="#cb49-974" aria-hidden="true" tabindex="-1"></a>          maxYTreat</span>
<span id="cb49-975"><a href="#cb49-975" aria-hidden="true" tabindex="-1"></a>        )<span class="op">;</span></span>
<span id="cb49-976"><a href="#cb49-976" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb49-977"><a href="#cb49-977" aria-hidden="true" tabindex="-1"></a>        minY <span class="op">=</span> fe <span class="op">?</span> </span>
<span id="cb49-978"><a href="#cb49-978" aria-hidden="true" tabindex="-1"></a>          <span class="bu">Math</span><span class="op">.</span><span class="fu">min</span>(d3<span class="op">.</span><span class="fu">min</span>(dataStatesMain<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">outcome</span>)<span class="op">,</span> minYTreat) <span class="op">:</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb49-979"><a href="#cb49-979" aria-hidden="true" tabindex="-1"></a>        maxY <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">max</span>(d3<span class="op">.</span><span class="fu">max</span>(dataStatesMain<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">outcome</span>)<span class="op">,</span> maxYTreat)<span class="op">;</span></span>
<span id="cb49-980"><a href="#cb49-980" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb49-981"><a href="#cb49-981" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-982"><a href="#cb49-982" aria-hidden="true" tabindex="-1"></a>    <span class="co">//////// Means only --------------------------------------------------------</span></span>
<span id="cb49-983"><a href="#cb49-983" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-984"><a href="#cb49-984" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (ctrlSpecDiD <span class="op">!==</span> <span class="st">'none'</span> <span class="op">&amp;&amp;</span> ctrlSpecSynth <span class="op">!==</span> <span class="st">'none'</span>) {</span>
<span id="cb49-985"><a href="#cb49-985" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (fe) {</span>
<span id="cb49-986"><a href="#cb49-986" aria-hidden="true" tabindex="-1"></a>        minY <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">min</span>(</span>
<span id="cb49-987"><a href="#cb49-987" aria-hidden="true" tabindex="-1"></a>          d3<span class="op">.</span><span class="fu">min</span>(dataCtrlMeanDiDG<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">outcome</span>)<span class="op">,</span> </span>
<span id="cb49-988"><a href="#cb49-988" aria-hidden="true" tabindex="-1"></a>          d3<span class="op">.</span><span class="fu">min</span>(dataCtrlMeanSynthG<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">outcome</span>)<span class="op">,</span> </span>
<span id="cb49-989"><a href="#cb49-989" aria-hidden="true" tabindex="-1"></a>          minYTreat</span>
<span id="cb49-990"><a href="#cb49-990" aria-hidden="true" tabindex="-1"></a>        )<span class="op">;</span></span>
<span id="cb49-991"><a href="#cb49-991" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb49-992"><a href="#cb49-992" aria-hidden="true" tabindex="-1"></a>        minY <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb49-993"><a href="#cb49-993" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb49-994"><a href="#cb49-994" aria-hidden="true" tabindex="-1"></a>      maxY <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">max</span>(</span>
<span id="cb49-995"><a href="#cb49-995" aria-hidden="true" tabindex="-1"></a>        d3<span class="op">.</span><span class="fu">max</span>(dataCtrlMeanDiDG<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">outcome</span>)<span class="op">,</span> </span>
<span id="cb49-996"><a href="#cb49-996" aria-hidden="true" tabindex="-1"></a>        d3<span class="op">.</span><span class="fu">max</span>(dataCtrlMeanSynthG<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">outcome</span>)<span class="op">,</span> </span>
<span id="cb49-997"><a href="#cb49-997" aria-hidden="true" tabindex="-1"></a>        maxYTreat</span>
<span id="cb49-998"><a href="#cb49-998" aria-hidden="true" tabindex="-1"></a>      )<span class="op">;</span></span>
<span id="cb49-999"><a href="#cb49-999" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (ctrlSpecDiD <span class="op">!==</span> <span class="st">'none'</span> <span class="op">&amp;&amp;</span> ctrlSpecSynth <span class="op">===</span> <span class="st">'none'</span>) {</span>
<span id="cb49-1000"><a href="#cb49-1000" aria-hidden="true" tabindex="-1"></a>      minY <span class="op">=</span> fe <span class="op">?</span> </span>
<span id="cb49-1001"><a href="#cb49-1001" aria-hidden="true" tabindex="-1"></a>        <span class="bu">Math</span><span class="op">.</span><span class="fu">min</span>(d3<span class="op">.</span><span class="fu">min</span>(dataCtrlMeanDiDG<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">outcome</span>)<span class="op">,</span> minYTreat) <span class="op">:</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb49-1002"><a href="#cb49-1002" aria-hidden="true" tabindex="-1"></a>      maxY <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">max</span>(d3<span class="op">.</span><span class="fu">max</span>(dataCtrlMeanDiDG<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">outcome</span>)<span class="op">,</span> maxYTreat)<span class="op">;</span></span>
<span id="cb49-1003"><a href="#cb49-1003" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (ctrlSpecDiD <span class="op">===</span> <span class="st">'none'</span> <span class="op">&amp;&amp;</span> ctrlSpecSynth <span class="op">!==</span> <span class="st">'none'</span>) {</span>
<span id="cb49-1004"><a href="#cb49-1004" aria-hidden="true" tabindex="-1"></a>      minY <span class="op">=</span> fe <span class="op">?</span> </span>
<span id="cb49-1005"><a href="#cb49-1005" aria-hidden="true" tabindex="-1"></a>        <span class="bu">Math</span><span class="op">.</span><span class="fu">min</span>(d3<span class="op">.</span><span class="fu">min</span>(dataCtrlMeanSynthG<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">outcome</span>)<span class="op">,</span> minYTreat) <span class="op">:</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb49-1006"><a href="#cb49-1006" aria-hidden="true" tabindex="-1"></a>      maxY <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">max</span>(d3<span class="op">.</span><span class="fu">max</span>(dataCtrlMeanSynthG<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">outcome</span>)<span class="op">,</span> maxYTreat)<span class="op">;</span></span>
<span id="cb49-1007"><a href="#cb49-1007" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb49-1008"><a href="#cb49-1008" aria-hidden="true" tabindex="-1"></a>      minY <span class="op">=</span> fe <span class="op">?</span> minYTreat <span class="op">:</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb49-1009"><a href="#cb49-1009" aria-hidden="true" tabindex="-1"></a>      maxY <span class="op">=</span> maxYTreat<span class="op">;</span></span>
<span id="cb49-1010"><a href="#cb49-1010" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb49-1011"><a href="#cb49-1011" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb49-1012"><a href="#cb49-1012" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1013"><a href="#cb49-1013" aria-hidden="true" tabindex="-1"></a>  <span class="co">//// If overlaying K-12 means</span></span>
<span id="cb49-1014"><a href="#cb49-1014" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (overlayK12 <span class="op">&amp;&amp;</span> selectedOutcome <span class="op">!==</span> <span class="st">'e027_elem_educ_direct_exp'</span>) {</span>
<span id="cb49-1015"><a href="#cb49-1015" aria-hidden="true" tabindex="-1"></a>    minY <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">min</span>(minY<span class="op">,</span> d3<span class="op">.</span><span class="fu">min</span>(dataK12MeansG<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">outcome</span>))<span class="op">;</span></span>
<span id="cb49-1016"><a href="#cb49-1016" aria-hidden="true" tabindex="-1"></a>    maxY <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">max</span>(maxY<span class="op">,</span> d3<span class="op">.</span><span class="fu">max</span>(dataK12MeansG<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">outcome</span>))<span class="op">;</span></span>
<span id="cb49-1017"><a href="#cb49-1017" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb49-1018"><a href="#cb49-1018" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1019"><a href="#cb49-1019" aria-hidden="true" tabindex="-1"></a>  <span class="co">//// Define scale functions --------------------------------------------------</span></span>
<span id="cb49-1020"><a href="#cb49-1020" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1021"><a href="#cb49-1021" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> x <span class="op">=</span> d3<span class="op">.</span><span class="fu">scaleLinear</span>()</span>
<span id="cb49-1022"><a href="#cb49-1022" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">domain</span>([<span class="dv">1983</span><span class="op">,</span> maxX])</span>
<span id="cb49-1023"><a href="#cb49-1023" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">range</span>([margin<span class="op">.</span><span class="at">left</span><span class="op">,</span> width <span class="op">-</span> margin<span class="op">.</span><span class="at">right</span>])<span class="op">;</span></span>
<span id="cb49-1024"><a href="#cb49-1024" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> y <span class="op">=</span> d3<span class="op">.</span><span class="fu">scaleLinear</span>()</span>
<span id="cb49-1025"><a href="#cb49-1025" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">domain</span>([minY<span class="op">,</span> maxY])</span>
<span id="cb49-1026"><a href="#cb49-1026" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">range</span>([ht <span class="op">-</span> margin<span class="op">.</span><span class="at">bottom</span><span class="op">,</span> margin<span class="op">.</span><span class="at">top</span>])</span>
<span id="cb49-1027"><a href="#cb49-1027" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">nice</span>()<span class="op">;</span></span>
<span id="cb49-1028"><a href="#cb49-1028" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb49-1029"><a href="#cb49-1029" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Parent SVG ================================================================</span></span>
<span id="cb49-1030"><a href="#cb49-1030" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1031"><a href="#cb49-1031" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> svg <span class="op">=</span> d3<span class="op">.</span><span class="fu">create</span>(<span class="st">'svg'</span>)</span>
<span id="cb49-1032"><a href="#cb49-1032" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'width'</span><span class="op">,</span> width)</span>
<span id="cb49-1033"><a href="#cb49-1033" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'height'</span><span class="op">,</span> ht)<span class="op">;</span></span>
<span id="cb49-1034"><a href="#cb49-1034" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb49-1035"><a href="#cb49-1035" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Axes ======================================================================</span></span>
<span id="cb49-1036"><a href="#cb49-1036" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1037"><a href="#cb49-1037" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> xAxis <span class="op">=</span> d3<span class="op">.</span><span class="fu">axisBottom</span>(x)</span>
<span id="cb49-1038"><a href="#cb49-1038" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">ticks</span>(tickNumX)</span>
<span id="cb49-1039"><a href="#cb49-1039" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">tickFormat</span>(d3<span class="op">.</span><span class="fu">format</span>(<span class="st">'d'</span>))<span class="op">;</span></span>
<span id="cb49-1040"><a href="#cb49-1040" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> yAxis <span class="op">=</span> d3<span class="op">.</span><span class="fu">axisLeft</span>(y)</span>
<span id="cb49-1041"><a href="#cb49-1041" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">ticks</span>(tickNumY)<span class="op">;</span></span>
<span id="cb49-1042"><a href="#cb49-1042" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1043"><a href="#cb49-1043" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">append</span>(<span class="st">'g'</span>)</span>
<span id="cb49-1044"><a href="#cb49-1044" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'transform'</span><span class="op">,</span> <span class="vs">`translate(0, </span><span class="sc">${</span>ht <span class="op">-</span> margin<span class="op">.</span><span class="at">bottom</span><span class="sc">}</span><span class="vs">)`</span>)</span>
<span id="cb49-1045"><a href="#cb49-1045" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">call</span>(xAxis)</span>
<span id="cb49-1046"><a href="#cb49-1046" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.tick text'</span>)</span>
<span id="cb49-1047"><a href="#cb49-1047" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'font-size'</span><span class="op">,</span> <span class="st">'12px'</span>)<span class="op">;</span></span>
<span id="cb49-1048"><a href="#cb49-1048" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">append</span>(<span class="st">'g'</span>)</span>
<span id="cb49-1049"><a href="#cb49-1049" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'transform'</span><span class="op">,</span> <span class="vs">`translate(</span><span class="sc">${</span>margin<span class="op">.</span><span class="at">left</span><span class="sc">}</span><span class="vs">, 0)`</span>)</span>
<span id="cb49-1050"><a href="#cb49-1050" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">call</span>(yAxis)</span>
<span id="cb49-1051"><a href="#cb49-1051" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.tick text'</span>)</span>
<span id="cb49-1052"><a href="#cb49-1052" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'font-size'</span><span class="op">,</span> <span class="st">'12px'</span>)<span class="op">;</span></span>
<span id="cb49-1053"><a href="#cb49-1053" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb49-1054"><a href="#cb49-1054" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Treat Year Vertical Line ==================================================</span></span>
<span id="cb49-1055"><a href="#cb49-1055" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1056"><a href="#cb49-1056" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">append</span>(<span class="st">'line'</span>)</span>
<span id="cb49-1057"><a href="#cb49-1057" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'stroke-width'</span><span class="op">,</span> <span class="dv">2</span>)</span>
<span id="cb49-1058"><a href="#cb49-1058" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'stroke'</span><span class="op">,</span> <span class="st">'black'</span>)</span>
<span id="cb49-1059"><a href="#cb49-1059" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'stroke-dasharray'</span><span class="op">,</span> <span class="dv">5</span>)</span>
<span id="cb49-1060"><a href="#cb49-1060" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x1'</span><span class="op">,</span> <span class="fu">x</span>(treatYear <span class="op">-</span> <span class="dv">1</span>))</span>
<span id="cb49-1061"><a href="#cb49-1061" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x2'</span><span class="op">,</span> <span class="fu">x</span>(treatYear <span class="op">-</span> <span class="dv">1</span>))</span>
<span id="cb49-1062"><a href="#cb49-1062" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y1'</span><span class="op">,</span> margin<span class="op">.</span><span class="at">top</span>)</span>
<span id="cb49-1063"><a href="#cb49-1063" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y2'</span><span class="op">,</span> ht <span class="op">-</span> margin<span class="op">.</span><span class="at">bottom</span>)<span class="op">;</span></span>
<span id="cb49-1064"><a href="#cb49-1064" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb49-1065"><a href="#cb49-1065" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Outcome Trends ============================================================</span></span>
<span id="cb49-1066"><a href="#cb49-1066" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1067"><a href="#cb49-1067" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> line <span class="op">=</span> d3<span class="op">.</span><span class="fu">line</span>()<span class="op">.</span><span class="fu">defined</span>(d <span class="kw">=&gt;</span> </span>
<span id="cb49-1068"><a href="#cb49-1068" aria-hidden="true" tabindex="-1"></a>    <span class="op">!</span><span class="pp">isNaN</span>(d[<span class="dv">1</span>]) <span class="op">&amp;</span> d[<span class="dv">1</span>] <span class="op">!==</span> <span class="kw">undefined</span> <span class="op">&amp;</span> d[<span class="dv">1</span>] <span class="op">!==</span> <span class="kw">null</span></span>
<span id="cb49-1069"><a href="#cb49-1069" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb49-1070"><a href="#cb49-1070" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb49-1071"><a href="#cb49-1071" aria-hidden="true" tabindex="-1"></a>  <span class="co">//// State, non-synth --------------------------------------------------------</span></span>
<span id="cb49-1072"><a href="#cb49-1072" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1073"><a href="#cb49-1073" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> pointsState <span class="op">=</span> dataStatesMain<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> </span>
<span id="cb49-1074"><a href="#cb49-1074" aria-hidden="true" tabindex="-1"></a>    [<span class="fu">x</span>(d<span class="op">.</span><span class="at">year</span>)<span class="op">,</span> <span class="fu">y</span>(d<span class="op">.</span><span class="at">outcome</span>)<span class="op">,</span> d<span class="op">.</span><span class="at">st</span><span class="op">,</span> d<span class="op">.</span><span class="at">treated</span>]</span>
<span id="cb49-1075"><a href="#cb49-1075" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb49-1076"><a href="#cb49-1076" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> groupsState <span class="op">=</span> d3<span class="op">.</span><span class="fu">rollup</span>(</span>
<span id="cb49-1077"><a href="#cb49-1077" aria-hidden="true" tabindex="-1"></a>    pointsState<span class="op">,</span> </span>
<span id="cb49-1078"><a href="#cb49-1078" aria-hidden="true" tabindex="-1"></a>    v <span class="kw">=&gt;</span> <span class="bu">Object</span><span class="op">.</span><span class="fu">assign</span>(v<span class="op">,</span> {<span class="dt">state</span><span class="op">:</span> v[<span class="dv">0</span>][<span class="dv">2</span>]<span class="op">,</span> <span class="dt">treated</span><span class="op">:</span> v[<span class="dv">0</span>][<span class="dv">3</span>]})<span class="op">,</span> </span>
<span id="cb49-1079"><a href="#cb49-1079" aria-hidden="true" tabindex="-1"></a>    d <span class="kw">=&gt;</span> d[<span class="dv">2</span>]</span>
<span id="cb49-1080"><a href="#cb49-1080" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb49-1081"><a href="#cb49-1081" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> pathState <span class="op">=</span> svg<span class="op">.</span><span class="fu">append</span>(<span class="st">'g'</span>)</span>
<span id="cb49-1082"><a href="#cb49-1082" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'fill'</span><span class="op">,</span> <span class="st">'none'</span>)</span>
<span id="cb49-1083"><a href="#cb49-1083" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'stroke-width'</span><span class="op">,</span> <span class="dv">2</span>)</span>
<span id="cb49-1084"><a href="#cb49-1084" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'stroke-linejoin'</span><span class="op">,</span> <span class="st">'round'</span>)</span>
<span id="cb49-1085"><a href="#cb49-1085" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'stroke-dasharray'</span><span class="op">,</span> <span class="dv">5</span>)</span>
<span id="cb49-1086"><a href="#cb49-1086" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'path'</span>)</span>
<span id="cb49-1087"><a href="#cb49-1087" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(groupsState<span class="op">.</span><span class="fu">values</span>())</span>
<span id="cb49-1088"><a href="#cb49-1088" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">join</span>(<span class="st">'path'</span>)</span>
<span id="cb49-1089"><a href="#cb49-1089" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">style</span>(<span class="st">'mix-blend-mode'</span><span class="op">,</span> <span class="st">'multiply'</span>)</span>
<span id="cb49-1090"><a href="#cb49-1090" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'d'</span><span class="op">,</span> line)</span>
<span id="cb49-1091"><a href="#cb49-1091" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'stroke'</span><span class="op">,</span> ({treated}) <span class="kw">=&gt;</span> treated <span class="op">===</span> <span class="dv">1</span> <span class="op">?</span> <span class="st">'hotpink'</span> <span class="op">:</span> <span class="st">'lightskyblue'</span>)<span class="op">;</span></span>
<span id="cb49-1092"><a href="#cb49-1092" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1093"><a href="#cb49-1093" aria-hidden="true" tabindex="-1"></a>  <span class="co">//// State, synth ------------------------------------------------------------</span></span>
<span id="cb49-1094"><a href="#cb49-1094" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1095"><a href="#cb49-1095" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> pointsStateSynth <span class="op">=</span> dataStatesSynthWts<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span></span>
<span id="cb49-1096"><a href="#cb49-1096" aria-hidden="true" tabindex="-1"></a>    [<span class="fu">x</span>(d<span class="op">.</span><span class="at">year</span>)<span class="op">,</span> <span class="fu">y</span>(d<span class="op">.</span><span class="at">outcome</span>)<span class="op">,</span> d<span class="op">.</span><span class="at">st</span><span class="op">,</span> d<span class="op">.</span><span class="at">weight</span>]</span>
<span id="cb49-1097"><a href="#cb49-1097" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb49-1098"><a href="#cb49-1098" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> groupsStateSynth <span class="op">=</span> d3<span class="op">.</span><span class="fu">rollup</span>(</span>
<span id="cb49-1099"><a href="#cb49-1099" aria-hidden="true" tabindex="-1"></a>    pointsStateSynth<span class="op">,</span></span>
<span id="cb49-1100"><a href="#cb49-1100" aria-hidden="true" tabindex="-1"></a>    v <span class="kw">=&gt;</span> <span class="bu">Object</span><span class="op">.</span><span class="fu">assign</span>(v<span class="op">,</span> {<span class="dt">state</span><span class="op">:</span> v[<span class="dv">0</span>][<span class="dv">2</span>]<span class="op">,</span> <span class="dt">weight</span><span class="op">:</span> v[<span class="dv">0</span>][<span class="dv">3</span>]})<span class="op">,</span></span>
<span id="cb49-1101"><a href="#cb49-1101" aria-hidden="true" tabindex="-1"></a>    d <span class="kw">=&gt;</span> d[<span class="dv">2</span>]</span>
<span id="cb49-1102"><a href="#cb49-1102" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb49-1103"><a href="#cb49-1103" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> pathStateSynth <span class="op">=</span> svg<span class="op">.</span><span class="fu">append</span>(<span class="st">'g'</span>)</span>
<span id="cb49-1104"><a href="#cb49-1104" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'fill'</span><span class="op">,</span> <span class="st">'none'</span>)</span>
<span id="cb49-1105"><a href="#cb49-1105" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'stroke-linejoin'</span><span class="op">,</span> <span class="st">'round'</span>)</span>
<span id="cb49-1106"><a href="#cb49-1106" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'stroke'</span><span class="op">,</span> <span class="st">'lightgreen'</span>)</span>
<span id="cb49-1107"><a href="#cb49-1107" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'path'</span>)</span>
<span id="cb49-1108"><a href="#cb49-1108" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(groupsStateSynth<span class="op">.</span><span class="fu">values</span>())</span>
<span id="cb49-1109"><a href="#cb49-1109" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">join</span>(<span class="st">'path'</span>)</span>
<span id="cb49-1110"><a href="#cb49-1110" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">style</span>(<span class="st">'mix-blend-mode'</span><span class="op">,</span> <span class="st">'multiply'</span>)</span>
<span id="cb49-1111"><a href="#cb49-1111" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'stroke-width'</span><span class="op">,</span> ({weight}) <span class="kw">=&gt;</span> weight <span class="op">*</span> <span class="dv">8</span> <span class="op">*</span> synthCtrlMagnifier)</span>
<span id="cb49-1112"><a href="#cb49-1112" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'d'</span><span class="op">,</span> line)<span class="op">;</span></span>
<span id="cb49-1113"><a href="#cb49-1113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1114"><a href="#cb49-1114" aria-hidden="true" tabindex="-1"></a>  <span class="co">//// Mean, treat -------------------------------------------------------------</span></span>
<span id="cb49-1115"><a href="#cb49-1115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1116"><a href="#cb49-1116" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> pointsTreatMean <span class="op">=</span> dataTreatMeanG<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> </span>
<span id="cb49-1117"><a href="#cb49-1117" aria-hidden="true" tabindex="-1"></a>    [<span class="fu">x</span>(d<span class="op">.</span><span class="at">year</span>)<span class="op">,</span> <span class="fu">y</span>(d<span class="op">.</span><span class="at">outcome</span>)<span class="op">,</span> d<span class="op">.</span><span class="at">treat_group</span>]</span>
<span id="cb49-1118"><a href="#cb49-1118" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb49-1119"><a href="#cb49-1119" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> groupsTreatMean <span class="op">=</span> d3<span class="op">.</span><span class="fu">group</span>(pointsTreatMean<span class="op">,</span> d <span class="kw">=&gt;</span> d[<span class="dv">2</span>])<span class="op">;</span></span>
<span id="cb49-1120"><a href="#cb49-1120" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> pathTreatMean <span class="op">=</span> svg<span class="op">.</span><span class="fu">append</span>(<span class="st">'g'</span>)</span>
<span id="cb49-1121"><a href="#cb49-1121" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'fill'</span><span class="op">,</span> <span class="st">'none'</span>)</span>
<span id="cb49-1122"><a href="#cb49-1122" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'stroke-width'</span><span class="op">,</span> <span class="fl">3.5</span>)</span>
<span id="cb49-1123"><a href="#cb49-1123" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'stroke-linejoin'</span><span class="op">,</span> <span class="st">'round'</span>)</span>
<span id="cb49-1124"><a href="#cb49-1124" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'stroke'</span><span class="op">,</span> <span class="st">'deeppink'</span>)</span>
<span id="cb49-1125"><a href="#cb49-1125" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'path'</span>)</span>
<span id="cb49-1126"><a href="#cb49-1126" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(groupsTreatMean<span class="op">.</span><span class="fu">values</span>())</span>
<span id="cb49-1127"><a href="#cb49-1127" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">join</span>(<span class="st">'path'</span>)</span>
<span id="cb49-1128"><a href="#cb49-1128" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'d'</span><span class="op">,</span> line)<span class="op">;</span></span>
<span id="cb49-1129"><a href="#cb49-1129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1130"><a href="#cb49-1130" aria-hidden="true" tabindex="-1"></a>  <span class="co">//// Mean, ctrl DiD ----------------------------------------------------------</span></span>
<span id="cb49-1131"><a href="#cb49-1131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1132"><a href="#cb49-1132" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> pointsCtrlMeanDiD <span class="op">=</span> dataCtrlMeanDiDG<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> </span>
<span id="cb49-1133"><a href="#cb49-1133" aria-hidden="true" tabindex="-1"></a>    [<span class="fu">x</span>(d<span class="op">.</span><span class="at">year</span>)<span class="op">,</span> <span class="fu">y</span>(d<span class="op">.</span><span class="at">outcome</span>)<span class="op">,</span> d<span class="op">.</span><span class="at">treat_group</span>]</span>
<span id="cb49-1134"><a href="#cb49-1134" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb49-1135"><a href="#cb49-1135" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> groupsCtrlMeanDiD <span class="op">=</span> d3<span class="op">.</span><span class="fu">group</span>(pointsCtrlMeanDiD<span class="op">,</span> d <span class="kw">=&gt;</span> d[<span class="dv">2</span>])<span class="op">;</span></span>
<span id="cb49-1136"><a href="#cb49-1136" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> pathCtrlMeanDiD <span class="op">=</span> svg<span class="op">.</span><span class="fu">append</span>(<span class="st">'g'</span>)</span>
<span id="cb49-1137"><a href="#cb49-1137" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'fill'</span><span class="op">,</span> <span class="st">'none'</span>)</span>
<span id="cb49-1138"><a href="#cb49-1138" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'stroke-width'</span><span class="op">,</span> <span class="fl">3.5</span>)</span>
<span id="cb49-1139"><a href="#cb49-1139" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'stroke-linejoin'</span><span class="op">,</span> <span class="st">'round'</span>)</span>
<span id="cb49-1140"><a href="#cb49-1140" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'stroke'</span><span class="op">,</span> <span class="st">'deepskyblue'</span>)</span>
<span id="cb49-1141"><a href="#cb49-1141" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'path'</span>)</span>
<span id="cb49-1142"><a href="#cb49-1142" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(groupsCtrlMeanDiD<span class="op">.</span><span class="fu">values</span>())</span>
<span id="cb49-1143"><a href="#cb49-1143" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">join</span>(<span class="st">'path'</span>)</span>
<span id="cb49-1144"><a href="#cb49-1144" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'d'</span><span class="op">,</span> line)<span class="op">;</span></span>
<span id="cb49-1145"><a href="#cb49-1145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1146"><a href="#cb49-1146" aria-hidden="true" tabindex="-1"></a>  <span class="co">//// Mean, ctrl synth --------------------------------------------------------</span></span>
<span id="cb49-1147"><a href="#cb49-1147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1148"><a href="#cb49-1148" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> pointsCtrlMeanSynth <span class="op">=</span> dataCtrlMeanSynthG<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> </span>
<span id="cb49-1149"><a href="#cb49-1149" aria-hidden="true" tabindex="-1"></a>    [<span class="fu">x</span>(d<span class="op">.</span><span class="at">year</span>)<span class="op">,</span> <span class="fu">y</span>(d<span class="op">.</span><span class="at">outcome</span>)<span class="op">,</span> d<span class="op">.</span><span class="at">treat_group</span>]</span>
<span id="cb49-1150"><a href="#cb49-1150" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb49-1151"><a href="#cb49-1151" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> groupsCtrlMeanSynth <span class="op">=</span> d3<span class="op">.</span><span class="fu">group</span>(pointsCtrlMeanSynth<span class="op">,</span> d <span class="kw">=&gt;</span> d[<span class="dv">2</span>])<span class="op">;</span></span>
<span id="cb49-1152"><a href="#cb49-1152" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> pathCtrlMeanSynth <span class="op">=</span> svg<span class="op">.</span><span class="fu">append</span>(<span class="st">'g'</span>)</span>
<span id="cb49-1153"><a href="#cb49-1153" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'fill'</span><span class="op">,</span> <span class="st">'none'</span>)</span>
<span id="cb49-1154"><a href="#cb49-1154" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'stroke-width'</span><span class="op">,</span> <span class="fl">3.5</span>)</span>
<span id="cb49-1155"><a href="#cb49-1155" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'stroke-linejoin'</span><span class="op">,</span> <span class="st">'round'</span>)</span>
<span id="cb49-1156"><a href="#cb49-1156" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'stroke'</span><span class="op">,</span> <span class="st">'springgreen'</span>)</span>
<span id="cb49-1157"><a href="#cb49-1157" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'path'</span>)</span>
<span id="cb49-1158"><a href="#cb49-1158" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(groupsCtrlMeanSynth<span class="op">.</span><span class="fu">values</span>())</span>
<span id="cb49-1159"><a href="#cb49-1159" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">join</span>(<span class="st">'path'</span>)</span>
<span id="cb49-1160"><a href="#cb49-1160" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'d'</span><span class="op">,</span> line)<span class="op">;</span></span>
<span id="cb49-1161"><a href="#cb49-1161" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb49-1162"><a href="#cb49-1162" aria-hidden="true" tabindex="-1"></a>  <span class="co">//// K-12 means --------------------------------------------------------------</span></span>
<span id="cb49-1163"><a href="#cb49-1163" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb49-1164"><a href="#cb49-1164" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (overlayK12 <span class="op">&amp;&amp;</span> selectedOutcome <span class="op">!==</span> <span class="st">'e027_elem_educ_direct_exp'</span>) {</span>
<span id="cb49-1165"><a href="#cb49-1165" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> pointsK12 <span class="op">=</span> dataK12MeansG<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> [<span class="fu">x</span>(d<span class="op">.</span><span class="at">year</span>)<span class="op">,</span> <span class="fu">y</span>(d<span class="op">.</span><span class="at">outcome</span>)<span class="op">,</span> d<span class="op">.</span><span class="at">id</span>])<span class="op">;</span></span>
<span id="cb49-1166"><a href="#cb49-1166" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> groupsK12 <span class="op">=</span> d3<span class="op">.</span><span class="fu">rollup</span>(</span>
<span id="cb49-1167"><a href="#cb49-1167" aria-hidden="true" tabindex="-1"></a>      pointsK12<span class="op">,</span> v <span class="kw">=&gt;</span> <span class="bu">Object</span><span class="op">.</span><span class="fu">assign</span>(v<span class="op">,</span> {<span class="dt">id</span><span class="op">:</span> v[<span class="dv">0</span>][<span class="dv">2</span>]})<span class="op">,</span> d <span class="kw">=&gt;</span> d[<span class="dv">2</span>]</span>
<span id="cb49-1168"><a href="#cb49-1168" aria-hidden="true" tabindex="-1"></a>    )<span class="op">;</span></span>
<span id="cb49-1169"><a href="#cb49-1169" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> pathK12 <span class="op">=</span> svg<span class="op">.</span><span class="fu">append</span>(<span class="st">'g'</span>)</span>
<span id="cb49-1170"><a href="#cb49-1170" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">'fill'</span><span class="op">,</span> <span class="st">'none'</span>)</span>
<span id="cb49-1171"><a href="#cb49-1171" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">'stroke-width'</span><span class="op">,</span> <span class="fl">3.5</span>)</span>
<span id="cb49-1172"><a href="#cb49-1172" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">'stroke-linejoin'</span><span class="op">,</span> <span class="st">'round'</span>)</span>
<span id="cb49-1173"><a href="#cb49-1173" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">'stroke-opacity'</span><span class="op">,</span> <span class="op">.</span><span class="dv">5</span>)</span>
<span id="cb49-1174"><a href="#cb49-1174" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">'stroke-dasharray'</span><span class="op">,</span> <span class="dv">5</span>)</span>
<span id="cb49-1175"><a href="#cb49-1175" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'path'</span>)</span>
<span id="cb49-1176"><a href="#cb49-1176" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">data</span>(groupsK12<span class="op">.</span><span class="fu">values</span>())</span>
<span id="cb49-1177"><a href="#cb49-1177" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">join</span>(<span class="st">'path'</span>)</span>
<span id="cb49-1178"><a href="#cb49-1178" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">'d'</span><span class="op">,</span> line)</span>
<span id="cb49-1179"><a href="#cb49-1179" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">'stroke'</span><span class="op">,</span> ({id}) <span class="kw">=&gt;</span> {</span>
<span id="cb49-1180"><a href="#cb49-1180" aria-hidden="true" tabindex="-1"></a>        <span class="kw">let</span> out <span class="op">=</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb49-1181"><a href="#cb49-1181" aria-hidden="true" tabindex="-1"></a>        <span class="cf">switch</span> (id) {</span>
<span id="cb49-1182"><a href="#cb49-1182" aria-hidden="true" tabindex="-1"></a>          <span class="cf">case</span> <span class="st">'treat group'</span><span class="op">:</span></span>
<span id="cb49-1183"><a href="#cb49-1183" aria-hidden="true" tabindex="-1"></a>            out <span class="op">=</span> <span class="st">'deeppink'</span><span class="op">;</span></span>
<span id="cb49-1184"><a href="#cb49-1184" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span><span class="op">;</span></span>
<span id="cb49-1185"><a href="#cb49-1185" aria-hidden="true" tabindex="-1"></a>          <span class="cf">case</span> <span class="st">'treat st'</span><span class="op">:</span></span>
<span id="cb49-1186"><a href="#cb49-1186" aria-hidden="true" tabindex="-1"></a>            out <span class="op">=</span> <span class="st">'deeppink'</span><span class="op">;</span></span>
<span id="cb49-1187"><a href="#cb49-1187" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span><span class="op">;</span></span>
<span id="cb49-1188"><a href="#cb49-1188" aria-hidden="true" tabindex="-1"></a>          <span class="cf">case</span> <span class="st">'ctrl did'</span><span class="op">:</span></span>
<span id="cb49-1189"><a href="#cb49-1189" aria-hidden="true" tabindex="-1"></a>            out <span class="op">=</span> <span class="st">'deepskyblue'</span><span class="op">;</span></span>
<span id="cb49-1190"><a href="#cb49-1190" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span><span class="op">;</span></span>
<span id="cb49-1191"><a href="#cb49-1191" aria-hidden="true" tabindex="-1"></a>          <span class="cf">case</span> <span class="st">'ctrl synth'</span><span class="op">:</span></span>
<span id="cb49-1192"><a href="#cb49-1192" aria-hidden="true" tabindex="-1"></a>            out <span class="op">=</span> <span class="st">'springgreen'</span><span class="op">;</span></span>
<span id="cb49-1193"><a href="#cb49-1193" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span><span class="op">;</span></span>
<span id="cb49-1194"><a href="#cb49-1194" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb49-1195"><a href="#cb49-1195" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> out<span class="op">;</span></span>
<span id="cb49-1196"><a href="#cb49-1196" aria-hidden="true" tabindex="-1"></a>      })<span class="op">;</span></span>
<span id="cb49-1197"><a href="#cb49-1197" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb49-1198"><a href="#cb49-1198" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb49-1199"><a href="#cb49-1199" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Tooltip (State Name) ======================================================</span></span>
<span id="cb49-1200"><a href="#cb49-1200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1201"><a href="#cb49-1201" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> tooltip <span class="op">=</span> svg<span class="op">.</span><span class="fu">append</span>(<span class="st">'text'</span>)  </span>
<span id="cb49-1202"><a href="#cb49-1202" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'display'</span><span class="op">,</span> <span class="st">'none'</span>)</span>
<span id="cb49-1203"><a href="#cb49-1203" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'text-anchor'</span><span class="op">,</span> <span class="st">'middle'</span>)</span>
<span id="cb49-1204"><a href="#cb49-1204" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> <span class="op">-</span><span class="dv">8</span>)<span class="op">;</span></span>
<span id="cb49-1205"><a href="#cb49-1205" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb49-1206"><a href="#cb49-1206" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Title =====================================================================</span></span>
<span id="cb49-1207"><a href="#cb49-1207" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb49-1208"><a href="#cb49-1208" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> stateNames <span class="op">=</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb49-1209"><a href="#cb49-1209" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (treatGroup<span class="op">.</span><span class="at">length</span> <span class="op">===</span> <span class="dv">2</span>) {</span>
<span id="cb49-1210"><a href="#cb49-1210" aria-hidden="true" tabindex="-1"></a>    stateNames <span class="op">=</span> treatGroup<span class="op">;</span></span>
<span id="cb49-1211"><a href="#cb49-1211" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb49-1212"><a href="#cb49-1212" aria-hidden="true" tabindex="-1"></a>    stateNames <span class="op">=</span> treatGroupStatesMap<span class="op">.</span><span class="fu">get</span>(treatGroup)<span class="op">.</span><span class="fu">join</span>(<span class="st">', '</span>)<span class="op">;</span></span>
<span id="cb49-1213"><a href="#cb49-1213" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb49-1214"><a href="#cb49-1214" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">append</span>(<span class="st">'text'</span>)</span>
<span id="cb49-1215"><a href="#cb49-1215" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x'</span><span class="op">,</span> width <span class="op">/</span> <span class="dv">2</span>)</span>
<span id="cb49-1216"><a href="#cb49-1216" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> margin<span class="op">.</span><span class="at">top</span> <span class="op">-</span> <span class="dv">10</span>)</span>
<span id="cb49-1217"><a href="#cb49-1217" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'text-anchor'</span><span class="op">,</span> <span class="st">'middle'</span>)</span>
<span id="cb49-1218"><a href="#cb49-1218" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">style</span>(<span class="st">'font-size'</span><span class="op">,</span> <span class="st">'12px'</span>)</span>
<span id="cb49-1219"><a href="#cb49-1219" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">text</span>(treatYear <span class="op">+</span> <span class="st">': '</span> <span class="op">+</span> stateNames)<span class="op">;</span></span>
<span id="cb49-1220"><a href="#cb49-1220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1221"><a href="#cb49-1221" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Event Listeners ===========================================================</span></span>
<span id="cb49-1222"><a href="#cb49-1222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1223"><a href="#cb49-1223" aria-hidden="true" tabindex="-1"></a>  svg</span>
<span id="cb49-1224"><a href="#cb49-1224" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">on</span>(<span class="st">'pointermove'</span><span class="op">,</span> pointerMoved)</span>
<span id="cb49-1225"><a href="#cb49-1225" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">on</span>(<span class="st">'pointerleave'</span><span class="op">,</span> pointerLeft)<span class="op">;</span></span>
<span id="cb49-1226"><a href="#cb49-1226" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb49-1227"><a href="#cb49-1227" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> svg<span class="op">.</span><span class="fu">node</span>()<span class="op">;</span></span>
<span id="cb49-1228"><a href="#cb49-1228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1229"><a href="#cb49-1229" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Event Handler Functions ===================================================</span></span>
<span id="cb49-1230"><a href="#cb49-1230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1231"><a href="#cb49-1231" aria-hidden="true" tabindex="-1"></a>  <span class="co">//// Pointer moved -----------------------------------------------------------</span></span>
<span id="cb49-1232"><a href="#cb49-1232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1233"><a href="#cb49-1233" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">pointerMoved</span>(<span class="bu">event</span>) {</span>
<span id="cb49-1234"><a href="#cb49-1234" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> [xm<span class="op">,</span> ym] <span class="op">=</span> d3<span class="op">.</span><span class="fu">pointer</span>(<span class="bu">event</span>)<span class="op">;</span></span>
<span id="cb49-1235"><a href="#cb49-1235" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> allPoints <span class="op">=</span> [<span class="op">...</span>pointsState<span class="op">,</span> <span class="op">...</span>pointsStateSynth]<span class="op">;</span></span>
<span id="cb49-1236"><a href="#cb49-1236" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> i <span class="op">=</span> d3<span class="op">.</span><span class="fu">leastIndex</span>(allPoints<span class="op">,</span> ([x<span class="op">,</span> y]) <span class="kw">=&gt;</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">hypot</span>(x <span class="op">-</span> xm<span class="op">,</span> y <span class="op">-</span> ym))<span class="op">;</span></span>
<span id="cb49-1237"><a href="#cb49-1237" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> [xHover<span class="op">,</span> yHover<span class="op">,</span> hoveredState] <span class="op">=</span> allPoints[i]<span class="op">;</span></span>
<span id="cb49-1238"><a href="#cb49-1238" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb49-1239"><a href="#cb49-1239" aria-hidden="true" tabindex="-1"></a>    pathState</span>
<span id="cb49-1240"><a href="#cb49-1240" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">style</span>(<span class="st">'stroke-width'</span><span class="op">,</span> ({state}) <span class="kw">=&gt;</span> state <span class="op">===</span> hoveredState <span class="op">?</span> <span class="dv">7</span> <span class="op">:</span> <span class="kw">null</span>)</span>
<span id="cb49-1241"><a href="#cb49-1241" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">filter</span>(({state}) <span class="kw">=&gt;</span> state <span class="op">===</span> hoveredState)</span>
<span id="cb49-1242"><a href="#cb49-1242" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">raise</span>()<span class="op">;</span></span>
<span id="cb49-1243"><a href="#cb49-1243" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb49-1244"><a href="#cb49-1244" aria-hidden="true" tabindex="-1"></a>    pathStateSynth</span>
<span id="cb49-1245"><a href="#cb49-1245" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">style</span>(<span class="st">'stroke'</span><span class="op">,</span> ({state}) <span class="kw">=&gt;</span> state <span class="op">===</span> hoveredState <span class="op">?</span> <span class="st">'black'</span> <span class="op">:</span> <span class="kw">null</span>)</span>
<span id="cb49-1246"><a href="#cb49-1246" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">filter</span>(({state}) <span class="kw">=&gt;</span> state <span class="op">===</span> hoveredState)</span>
<span id="cb49-1247"><a href="#cb49-1247" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">raise</span>()<span class="op">;</span></span>
<span id="cb49-1248"><a href="#cb49-1248" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb49-1249"><a href="#cb49-1249" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (showSubgroups <span class="op">&amp;</span> subgroupsToShow<span class="op">.</span><span class="at">length</span> <span class="op">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb49-1250"><a href="#cb49-1250" aria-hidden="true" tabindex="-1"></a>      tooltip</span>
<span id="cb49-1251"><a href="#cb49-1251" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">html</span>(hoveredState)</span>
<span id="cb49-1252"><a href="#cb49-1252" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">'transform'</span><span class="op">,</span> <span class="vs">`translate(</span><span class="sc">${</span>xHover<span class="sc">}</span><span class="vs">, </span><span class="sc">${</span>yHover<span class="sc">}</span><span class="vs">)`</span>)</span>
<span id="cb49-1253"><a href="#cb49-1253" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">'display'</span><span class="op">,</span> <span class="kw">null</span>)<span class="op">;</span></span>
<span id="cb49-1254"><a href="#cb49-1254" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb49-1255"><a href="#cb49-1255" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb49-1256"><a href="#cb49-1256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1257"><a href="#cb49-1257" aria-hidden="true" tabindex="-1"></a>  <span class="co">//// Pointer left ------------------------------------------------------------</span></span>
<span id="cb49-1258"><a href="#cb49-1258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1259"><a href="#cb49-1259" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">pointerLeft</span>() {</span>
<span id="cb49-1260"><a href="#cb49-1260" aria-hidden="true" tabindex="-1"></a>    pathState<span class="op">.</span><span class="fu">style</span>(<span class="st">'stroke-width'</span><span class="op">,</span> <span class="kw">null</span>)<span class="op">;</span></span>
<span id="cb49-1261"><a href="#cb49-1261" aria-hidden="true" tabindex="-1"></a>    pathStateSynth<span class="op">.</span><span class="fu">style</span>(<span class="st">'stroke'</span><span class="op">,</span> <span class="kw">null</span>)<span class="op">;</span></span>
<span id="cb49-1262"><a href="#cb49-1262" aria-hidden="true" tabindex="-1"></a>    tooltip<span class="op">.</span><span class="fu">attr</span>(<span class="st">'display'</span><span class="op">,</span> <span class="st">'none'</span>)<span class="op">;</span></span>
<span id="cb49-1263"><a href="#cb49-1263" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb49-1264"><a href="#cb49-1264" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display hidden">
<div id="ojs-cell-48" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell hidden">
<div class="sourceCode cell-code hidden" id="cb50" data-startfrom="1273" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 1272;"><span id="cb50-1273"><a href="#cb50-1273" aria-hidden="true" tabindex="-1"></a>plotResults <span class="op">=</span> <span class="kw">function</span>(treatGroup) {</span>
<span id="cb50-1274"><a href="#cb50-1274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-1275"><a href="#cb50-1275" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Data Setup ================================================================</span></span>
<span id="cb50-1276"><a href="#cb50-1276" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb50-1277"><a href="#cb50-1277" aria-hidden="true" tabindex="-1"></a>  <span class="co">//// Main --------------------------------------------------------------------</span></span>
<span id="cb50-1278"><a href="#cb50-1278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-1279"><a href="#cb50-1279" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> dataResSynthG<span class="op">,</span> dataResDiDG <span class="op">=</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb50-1280"><a href="#cb50-1280" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> treatYear <span class="op">=</span> treatGroup<span class="op">;</span></span>
<span id="cb50-1281"><a href="#cb50-1281" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (treatGroup<span class="op">.</span><span class="at">length</span> <span class="op">===</span> <span class="dv">2</span>) {</span>
<span id="cb50-1282"><a href="#cb50-1282" aria-hidden="true" tabindex="-1"></a>    dataResSynthG <span class="op">=</span> dataResSynthUseSt<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">treat_group</span> <span class="op">===</span> treatGroup)<span class="op">;</span></span>
<span id="cb50-1283"><a href="#cb50-1283" aria-hidden="true" tabindex="-1"></a>    dataResDiDG <span class="op">=</span> dataResDiDUseSt<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">treat_group</span> <span class="op">===</span> treatGroup)<span class="op">;</span></span>
<span id="cb50-1284"><a href="#cb50-1284" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (<span class="kw">const</span> [key<span class="op">,</span> value] <span class="kw">of</span> treatGroupStatesMap<span class="op">.</span><span class="fu">entries</span>()) {</span>
<span id="cb50-1285"><a href="#cb50-1285" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (value<span class="op">.</span><span class="fu">includes</span>(treatGroup)) treatYear <span class="op">=</span> key<span class="op">;</span></span>
<span id="cb50-1286"><a href="#cb50-1286" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb50-1287"><a href="#cb50-1287" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb50-1288"><a href="#cb50-1288" aria-hidden="true" tabindex="-1"></a>    dataResSynthG <span class="op">=</span> dataResSynthUseG<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">treat_group</span> <span class="op">===</span> treatGroup)<span class="op">;</span></span>
<span id="cb50-1289"><a href="#cb50-1289" aria-hidden="true" tabindex="-1"></a>    dataResDiDG <span class="op">=</span> dataResDiDUseG<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">treat_group</span> <span class="op">===</span> treatGroup)<span class="op">;</span></span>
<span id="cb50-1290"><a href="#cb50-1290" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb50-1291"><a href="#cb50-1291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-1292"><a href="#cb50-1292" aria-hidden="true" tabindex="-1"></a>  <span class="co">//// Overlay K-12 results ----------------------------------------------------</span></span>
<span id="cb50-1293"><a href="#cb50-1293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-1294"><a href="#cb50-1294" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> dataResK12G <span class="op">=</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb50-1295"><a href="#cb50-1295" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (overlayK12 <span class="op">&amp;&amp;</span> selectedOutcome <span class="op">!==</span> <span class="st">'e027_elem_educ_direct_exp'</span>) {</span>
<span id="cb50-1296"><a href="#cb50-1296" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (treatGroup<span class="op">.</span><span class="at">length</span> <span class="op">===</span> <span class="dv">2</span>) {</span>
<span id="cb50-1297"><a href="#cb50-1297" aria-hidden="true" tabindex="-1"></a>      dataResK12G <span class="op">=</span> dataResK12UseSt<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">treat_group</span> <span class="op">===</span> treatGroup)<span class="op">;</span></span>
<span id="cb50-1298"><a href="#cb50-1298" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb50-1299"><a href="#cb50-1299" aria-hidden="true" tabindex="-1"></a>      dataResK12G <span class="op">=</span> dataResK12UseG<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">treat_group</span> <span class="op">===</span> treatGroup)<span class="op">;</span></span>
<span id="cb50-1300"><a href="#cb50-1300" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb50-1301"><a href="#cb50-1301" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (ctrlSpecDiD <span class="op">===</span> <span class="st">'none'</span>) {</span>
<span id="cb50-1302"><a href="#cb50-1302" aria-hidden="true" tabindex="-1"></a>      dataResK12G <span class="op">=</span> dataResK12G<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">id</span> <span class="op">!==</span> <span class="st">'did'</span>)<span class="op">;</span></span>
<span id="cb50-1303"><a href="#cb50-1303" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb50-1304"><a href="#cb50-1304" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (ctrlSpecSynth <span class="op">===</span> <span class="st">'none'</span>) {</span>
<span id="cb50-1305"><a href="#cb50-1305" aria-hidden="true" tabindex="-1"></a>      dataResK12G <span class="op">=</span> dataResK12G<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">id</span> <span class="op">!==</span> <span class="st">'synth'</span>)<span class="op">;</span></span>
<span id="cb50-1306"><a href="#cb50-1306" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb50-1307"><a href="#cb50-1307" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb50-1308"><a href="#cb50-1308" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb50-1309"><a href="#cb50-1309" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Scale Functions ===========================================================</span></span>
<span id="cb50-1310"><a href="#cb50-1310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-1311"><a href="#cb50-1311" aria-hidden="true" tabindex="-1"></a>  <span class="co">//// Find min &amp; max y and x values</span></span>
<span id="cb50-1312"><a href="#cb50-1312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-1313"><a href="#cb50-1313" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> minX<span class="op">,</span> maxX<span class="op">,</span> minY<span class="op">,</span> maxY<span class="op">,</span> minYVar<span class="op">,</span> maxYVar <span class="op">=</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb50-1314"><a href="#cb50-1314" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (showCI) {</span>
<span id="cb50-1315"><a href="#cb50-1315" aria-hidden="true" tabindex="-1"></a>    minYVar <span class="op">=</span> <span class="st">'ci_low'</span><span class="op">;</span></span>
<span id="cb50-1316"><a href="#cb50-1316" aria-hidden="true" tabindex="-1"></a>    maxYVar <span class="op">=</span> <span class="st">'ci_up'</span><span class="op">;</span></span>
<span id="cb50-1317"><a href="#cb50-1317" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb50-1318"><a href="#cb50-1318" aria-hidden="true" tabindex="-1"></a>    minYVar <span class="op">=</span> <span class="st">'att'</span><span class="op">;</span></span>
<span id="cb50-1319"><a href="#cb50-1319" aria-hidden="true" tabindex="-1"></a>    maxYVar <span class="op">=</span> <span class="st">'att'</span><span class="op">;</span></span>
<span id="cb50-1320"><a href="#cb50-1320" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb50-1321"><a href="#cb50-1321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-1322"><a href="#cb50-1322" aria-hidden="true" tabindex="-1"></a>  <span class="co">////// Consistent axes -------------------------------------------------------</span></span>
<span id="cb50-1323"><a href="#cb50-1323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-1324"><a href="#cb50-1324" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (consistentAxes) {</span>
<span id="cb50-1325"><a href="#cb50-1325" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (ctrlSpecDiD <span class="op">!==</span> <span class="st">'none'</span> <span class="op">&amp;&amp;</span> ctrlSpecSynth <span class="op">!==</span> <span class="st">'none'</span>) {</span>
<span id="cb50-1326"><a href="#cb50-1326" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (treatGroup<span class="op">.</span><span class="at">length</span> <span class="op">===</span> <span class="dv">2</span>) {</span>
<span id="cb50-1327"><a href="#cb50-1327" aria-hidden="true" tabindex="-1"></a>        minX <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">min</span>(</span>
<span id="cb50-1328"><a href="#cb50-1328" aria-hidden="true" tabindex="-1"></a>          d3<span class="op">.</span><span class="fu">min</span>(dataResSynthUseSt<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">year</span>)<span class="op">,</span></span>
<span id="cb50-1329"><a href="#cb50-1329" aria-hidden="true" tabindex="-1"></a>          d3<span class="op">.</span><span class="fu">min</span>(dataResDiDUseSt<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">year</span>)</span>
<span id="cb50-1330"><a href="#cb50-1330" aria-hidden="true" tabindex="-1"></a>        )<span class="op">;</span></span>
<span id="cb50-1331"><a href="#cb50-1331" aria-hidden="true" tabindex="-1"></a>        maxX <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">max</span>(</span>
<span id="cb50-1332"><a href="#cb50-1332" aria-hidden="true" tabindex="-1"></a>          d3<span class="op">.</span><span class="fu">max</span>(dataResSynthUseSt<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">year</span>)<span class="op">,</span></span>
<span id="cb50-1333"><a href="#cb50-1333" aria-hidden="true" tabindex="-1"></a>          d3<span class="op">.</span><span class="fu">max</span>(dataResDiDUseSt<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">year</span>)</span>
<span id="cb50-1334"><a href="#cb50-1334" aria-hidden="true" tabindex="-1"></a>        )<span class="op">;</span></span>
<span id="cb50-1335"><a href="#cb50-1335" aria-hidden="true" tabindex="-1"></a>        minY <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">min</span>(</span>
<span id="cb50-1336"><a href="#cb50-1336" aria-hidden="true" tabindex="-1"></a>          d3<span class="op">.</span><span class="fu">min</span>(dataResSynthUseSt<span class="op">,</span> d <span class="kw">=&gt;</span> d[minYVar])<span class="op">,</span></span>
<span id="cb50-1337"><a href="#cb50-1337" aria-hidden="true" tabindex="-1"></a>          d3<span class="op">.</span><span class="fu">min</span>(dataResDiDUseSt<span class="op">,</span> d <span class="kw">=&gt;</span> d[minYVar])</span>
<span id="cb50-1338"><a href="#cb50-1338" aria-hidden="true" tabindex="-1"></a>        )<span class="op">;</span></span>
<span id="cb50-1339"><a href="#cb50-1339" aria-hidden="true" tabindex="-1"></a>        maxY <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">max</span>(</span>
<span id="cb50-1340"><a href="#cb50-1340" aria-hidden="true" tabindex="-1"></a>          d3<span class="op">.</span><span class="fu">max</span>(dataResSynthUseSt<span class="op">,</span> d <span class="kw">=&gt;</span> d[maxYVar])<span class="op">,</span></span>
<span id="cb50-1341"><a href="#cb50-1341" aria-hidden="true" tabindex="-1"></a>          d3<span class="op">.</span><span class="fu">max</span>(dataResDiDUseSt<span class="op">,</span> d <span class="kw">=&gt;</span> d[maxYVar])</span>
<span id="cb50-1342"><a href="#cb50-1342" aria-hidden="true" tabindex="-1"></a>        )<span class="op">;</span></span>
<span id="cb50-1343"><a href="#cb50-1343" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb50-1344"><a href="#cb50-1344" aria-hidden="true" tabindex="-1"></a>        minX <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">min</span>(</span>
<span id="cb50-1345"><a href="#cb50-1345" aria-hidden="true" tabindex="-1"></a>          d3<span class="op">.</span><span class="fu">min</span>(dataResSynthUseG<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">year</span>)<span class="op">,</span></span>
<span id="cb50-1346"><a href="#cb50-1346" aria-hidden="true" tabindex="-1"></a>          d3<span class="op">.</span><span class="fu">min</span>(dataResDiDUseG<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">year</span>)</span>
<span id="cb50-1347"><a href="#cb50-1347" aria-hidden="true" tabindex="-1"></a>        )<span class="op">;</span></span>
<span id="cb50-1348"><a href="#cb50-1348" aria-hidden="true" tabindex="-1"></a>        maxX <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">max</span>(</span>
<span id="cb50-1349"><a href="#cb50-1349" aria-hidden="true" tabindex="-1"></a>          d3<span class="op">.</span><span class="fu">max</span>(dataResSynthUseG<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">year</span>)<span class="op">,</span></span>
<span id="cb50-1350"><a href="#cb50-1350" aria-hidden="true" tabindex="-1"></a>          d3<span class="op">.</span><span class="fu">max</span>(dataResDiDUseG<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">year</span>)</span>
<span id="cb50-1351"><a href="#cb50-1351" aria-hidden="true" tabindex="-1"></a>        )<span class="op">;</span></span>
<span id="cb50-1352"><a href="#cb50-1352" aria-hidden="true" tabindex="-1"></a>        minY <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">min</span>(</span>
<span id="cb50-1353"><a href="#cb50-1353" aria-hidden="true" tabindex="-1"></a>          d3<span class="op">.</span><span class="fu">min</span>(dataResSynthUseG<span class="op">,</span> d <span class="kw">=&gt;</span> d[minYVar])<span class="op">,</span></span>
<span id="cb50-1354"><a href="#cb50-1354" aria-hidden="true" tabindex="-1"></a>          d3<span class="op">.</span><span class="fu">min</span>(dataResDiDUseG<span class="op">,</span> d <span class="kw">=&gt;</span> d[minYVar])</span>
<span id="cb50-1355"><a href="#cb50-1355" aria-hidden="true" tabindex="-1"></a>        )<span class="op">;</span></span>
<span id="cb50-1356"><a href="#cb50-1356" aria-hidden="true" tabindex="-1"></a>        maxY <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">max</span>(</span>
<span id="cb50-1357"><a href="#cb50-1357" aria-hidden="true" tabindex="-1"></a>          d3<span class="op">.</span><span class="fu">max</span>(dataResSynthUseG<span class="op">,</span> d <span class="kw">=&gt;</span> d[maxYVar])<span class="op">,</span></span>
<span id="cb50-1358"><a href="#cb50-1358" aria-hidden="true" tabindex="-1"></a>          d3<span class="op">.</span><span class="fu">max</span>(dataResDiDUseG<span class="op">,</span> d <span class="kw">=&gt;</span> d[maxYVar])</span>
<span id="cb50-1359"><a href="#cb50-1359" aria-hidden="true" tabindex="-1"></a>        )<span class="op">;</span></span>
<span id="cb50-1360"><a href="#cb50-1360" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb50-1361"><a href="#cb50-1361" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (ctrlSpecDiD <span class="op">===</span> <span class="st">'none'</span> <span class="op">&amp;&amp;</span> ctrlSpecSynth <span class="op">!==</span> <span class="st">'none'</span>) {</span>
<span id="cb50-1362"><a href="#cb50-1362" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (treatGroup<span class="op">.</span><span class="at">length</span> <span class="op">===</span> <span class="dv">2</span>) {</span>
<span id="cb50-1363"><a href="#cb50-1363" aria-hidden="true" tabindex="-1"></a>        minX <span class="op">=</span> d3<span class="op">.</span><span class="fu">min</span>(dataResSynthUseSt<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">year</span>)<span class="op">;</span></span>
<span id="cb50-1364"><a href="#cb50-1364" aria-hidden="true" tabindex="-1"></a>        maxX <span class="op">=</span> d3<span class="op">.</span><span class="fu">max</span>(dataResSynthUseSt<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">year</span>)<span class="op">;</span></span>
<span id="cb50-1365"><a href="#cb50-1365" aria-hidden="true" tabindex="-1"></a>        minY <span class="op">=</span> d3<span class="op">.</span><span class="fu">min</span>(dataResSynthUseSt<span class="op">,</span> d <span class="kw">=&gt;</span> d[minYVar])<span class="op">;</span></span>
<span id="cb50-1366"><a href="#cb50-1366" aria-hidden="true" tabindex="-1"></a>        maxY <span class="op">=</span> d3<span class="op">.</span><span class="fu">max</span>(dataResSynthUseSt<span class="op">,</span> d <span class="kw">=&gt;</span> d[maxYVar])<span class="op">;</span></span>
<span id="cb50-1367"><a href="#cb50-1367" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb50-1368"><a href="#cb50-1368" aria-hidden="true" tabindex="-1"></a>        minX <span class="op">=</span> d3<span class="op">.</span><span class="fu">min</span>(dataResSynthUseG<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">year</span>)<span class="op">;</span></span>
<span id="cb50-1369"><a href="#cb50-1369" aria-hidden="true" tabindex="-1"></a>        maxX <span class="op">=</span> d3<span class="op">.</span><span class="fu">max</span>(dataResSynthUseG<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">year</span>)<span class="op">;</span></span>
<span id="cb50-1370"><a href="#cb50-1370" aria-hidden="true" tabindex="-1"></a>        minY <span class="op">=</span> d3<span class="op">.</span><span class="fu">min</span>(dataResSynthUseG<span class="op">,</span> d <span class="kw">=&gt;</span> d[minYVar])<span class="op">;</span></span>
<span id="cb50-1371"><a href="#cb50-1371" aria-hidden="true" tabindex="-1"></a>        maxY <span class="op">=</span> d3<span class="op">.</span><span class="fu">max</span>(dataResSynthUseG<span class="op">,</span> d <span class="kw">=&gt;</span> d[maxYVar])<span class="op">;</span></span>
<span id="cb50-1372"><a href="#cb50-1372" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb50-1373"><a href="#cb50-1373" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (ctrlSpecDiD <span class="op">!==</span> <span class="st">'none'</span> <span class="op">&amp;&amp;</span> ctrlSpecSynth <span class="op">===</span> <span class="st">'none'</span>) {</span>
<span id="cb50-1374"><a href="#cb50-1374" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (treatGroup<span class="op">.</span><span class="at">length</span> <span class="op">===</span> <span class="dv">2</span>) {</span>
<span id="cb50-1375"><a href="#cb50-1375" aria-hidden="true" tabindex="-1"></a>        minX <span class="op">=</span> d3<span class="op">.</span><span class="fu">min</span>(dataResDiDUseSt<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">year</span>)<span class="op">;</span></span>
<span id="cb50-1376"><a href="#cb50-1376" aria-hidden="true" tabindex="-1"></a>        maxX <span class="op">=</span> d3<span class="op">.</span><span class="fu">max</span>(dataResDiDUseSt<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">year</span>)<span class="op">;</span></span>
<span id="cb50-1377"><a href="#cb50-1377" aria-hidden="true" tabindex="-1"></a>        minY <span class="op">=</span> d3<span class="op">.</span><span class="fu">min</span>(dataResDiDUseSt<span class="op">,</span> d <span class="kw">=&gt;</span> d[minYVar])<span class="op">;</span></span>
<span id="cb50-1378"><a href="#cb50-1378" aria-hidden="true" tabindex="-1"></a>        maxY <span class="op">=</span> d3<span class="op">.</span><span class="fu">max</span>(dataResDiDUseSt<span class="op">,</span> d <span class="kw">=&gt;</span> d[maxYVar])<span class="op">;</span></span>
<span id="cb50-1379"><a href="#cb50-1379" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb50-1380"><a href="#cb50-1380" aria-hidden="true" tabindex="-1"></a>        minX <span class="op">=</span> d3<span class="op">.</span><span class="fu">min</span>(dataResDiDUseG<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">year</span>)<span class="op">;</span></span>
<span id="cb50-1381"><a href="#cb50-1381" aria-hidden="true" tabindex="-1"></a>        maxX <span class="op">=</span> d3<span class="op">.</span><span class="fu">max</span>(dataResDiDUseG<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">year</span>)<span class="op">;</span></span>
<span id="cb50-1382"><a href="#cb50-1382" aria-hidden="true" tabindex="-1"></a>        minY <span class="op">=</span> d3<span class="op">.</span><span class="fu">min</span>(dataResDiDUseG<span class="op">,</span> d <span class="kw">=&gt;</span> d[minYVar])<span class="op">;</span></span>
<span id="cb50-1383"><a href="#cb50-1383" aria-hidden="true" tabindex="-1"></a>        maxY <span class="op">=</span> d3<span class="op">.</span><span class="fu">max</span>(dataResDiDUseG<span class="op">,</span> d <span class="kw">=&gt;</span> d[maxYVar])<span class="op">;</span></span>
<span id="cb50-1384"><a href="#cb50-1384" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb50-1385"><a href="#cb50-1385" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb50-1386"><a href="#cb50-1386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-1387"><a href="#cb50-1387" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (overlayK12 <span class="op">&amp;&amp;</span> selectedOutcome <span class="op">!==</span> <span class="st">'e027_elem_educ_direct_exp'</span>) {</span>
<span id="cb50-1388"><a href="#cb50-1388" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (ctrlSpecDiD <span class="op">!==</span> <span class="st">'none'</span> <span class="op">&amp;&amp;</span> ctrlSpecSynth <span class="op">!==</span> <span class="st">'none'</span>) {</span>
<span id="cb50-1389"><a href="#cb50-1389" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (treatGroup<span class="op">.</span><span class="at">length</span> <span class="op">===</span> <span class="dv">2</span>) {</span>
<span id="cb50-1390"><a href="#cb50-1390" aria-hidden="true" tabindex="-1"></a>          minY <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">min</span>(minY<span class="op">,</span> d3<span class="op">.</span><span class="fu">min</span>(dataResK12UseSt<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">att</span>))<span class="op">;</span></span>
<span id="cb50-1391"><a href="#cb50-1391" aria-hidden="true" tabindex="-1"></a>          maxY <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">max</span>(maxY<span class="op">,</span> d3<span class="op">.</span><span class="fu">max</span>(dataResK12UseSt<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">att</span>))<span class="op">;</span></span>
<span id="cb50-1392"><a href="#cb50-1392" aria-hidden="true" tabindex="-1"></a>        } <span class="cf">else</span> {</span>
<span id="cb50-1393"><a href="#cb50-1393" aria-hidden="true" tabindex="-1"></a>          minY <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">min</span>(minY<span class="op">,</span> d3<span class="op">.</span><span class="fu">min</span>(dataResK12UseG<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">att</span>))<span class="op">;</span></span>
<span id="cb50-1394"><a href="#cb50-1394" aria-hidden="true" tabindex="-1"></a>          maxY <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">max</span>(maxY<span class="op">,</span> d3<span class="op">.</span><span class="fu">max</span>(dataResK12UseG<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">att</span>))<span class="op">;</span></span>
<span id="cb50-1395"><a href="#cb50-1395" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb50-1396"><a href="#cb50-1396" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> <span class="cf">if</span> (ctrlSpecDiD <span class="op">===</span> <span class="st">'none'</span> <span class="op">&amp;&amp;</span> ctrlSpecSynth <span class="op">!==</span> <span class="st">'none'</span>) {</span>
<span id="cb50-1397"><a href="#cb50-1397" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (treatGroup<span class="op">.</span><span class="at">length</span> <span class="op">===</span> <span class="dv">2</span>) {</span>
<span id="cb50-1398"><a href="#cb50-1398" aria-hidden="true" tabindex="-1"></a>          <span class="kw">const</span> k12Synth <span class="op">=</span> dataResK12UseSt<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">id</span> <span class="op">===</span> <span class="st">'synth'</span>)<span class="op">;</span></span>
<span id="cb50-1399"><a href="#cb50-1399" aria-hidden="true" tabindex="-1"></a>          minY <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">min</span>(minY<span class="op">,</span> d3<span class="op">.</span><span class="fu">min</span>(k12Synth<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">att</span>))<span class="op">;</span></span>
<span id="cb50-1400"><a href="#cb50-1400" aria-hidden="true" tabindex="-1"></a>          maxY <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">max</span>(maxY<span class="op">,</span> d3<span class="op">.</span><span class="fu">max</span>(k12Synth<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">att</span>))<span class="op">;</span></span>
<span id="cb50-1401"><a href="#cb50-1401" aria-hidden="true" tabindex="-1"></a>        } <span class="cf">else</span> {</span>
<span id="cb50-1402"><a href="#cb50-1402" aria-hidden="true" tabindex="-1"></a>          <span class="kw">const</span> k12Synth <span class="op">=</span> dataResK12UseG<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">id</span> <span class="op">===</span> <span class="st">'synth'</span>)<span class="op">;</span></span>
<span id="cb50-1403"><a href="#cb50-1403" aria-hidden="true" tabindex="-1"></a>          minY <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">min</span>(minY<span class="op">,</span> d3<span class="op">.</span><span class="fu">min</span>(k12Synth<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">att</span>))<span class="op">;</span></span>
<span id="cb50-1404"><a href="#cb50-1404" aria-hidden="true" tabindex="-1"></a>          maxY <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">max</span>(maxY<span class="op">,</span> d3<span class="op">.</span><span class="fu">max</span>(k12Synth<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">att</span>))<span class="op">;</span></span>
<span id="cb50-1405"><a href="#cb50-1405" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb50-1406"><a href="#cb50-1406" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> <span class="cf">if</span> (ctrlSpecDiD <span class="op">!==</span> <span class="st">'none'</span> <span class="op">&amp;&amp;</span> ctrlSpecSynth <span class="op">===</span> <span class="st">'none'</span>) {</span>
<span id="cb50-1407"><a href="#cb50-1407" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (treatGroup<span class="op">.</span><span class="at">length</span> <span class="op">===</span> <span class="dv">2</span>) {</span>
<span id="cb50-1408"><a href="#cb50-1408" aria-hidden="true" tabindex="-1"></a>          <span class="kw">const</span> k12DiD <span class="op">=</span> dataResK12UseSt<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">id</span> <span class="op">===</span> <span class="st">'did'</span>)<span class="op">;</span></span>
<span id="cb50-1409"><a href="#cb50-1409" aria-hidden="true" tabindex="-1"></a>          minY <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">min</span>(minY<span class="op">,</span> d3<span class="op">.</span><span class="fu">min</span>(k12DiD<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">att</span>))<span class="op">;</span></span>
<span id="cb50-1410"><a href="#cb50-1410" aria-hidden="true" tabindex="-1"></a>          maxY <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">max</span>(maxY<span class="op">,</span> d3<span class="op">.</span><span class="fu">max</span>(k12DiD<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">att</span>))<span class="op">;</span></span>
<span id="cb50-1411"><a href="#cb50-1411" aria-hidden="true" tabindex="-1"></a>        } <span class="cf">else</span> {</span>
<span id="cb50-1412"><a href="#cb50-1412" aria-hidden="true" tabindex="-1"></a>          <span class="kw">const</span> k12DiD <span class="op">=</span> dataResK12UseG<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">id</span> <span class="op">===</span> <span class="st">'did'</span>)<span class="op">;</span></span>
<span id="cb50-1413"><a href="#cb50-1413" aria-hidden="true" tabindex="-1"></a>          minY <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">min</span>(minY<span class="op">,</span> d3<span class="op">.</span><span class="fu">min</span>(k12DiD<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">att</span>))<span class="op">;</span></span>
<span id="cb50-1414"><a href="#cb50-1414" aria-hidden="true" tabindex="-1"></a>          maxY <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">max</span>(maxY<span class="op">,</span> d3<span class="op">.</span><span class="fu">max</span>(k12DiD<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">att</span>))<span class="op">;</span></span>
<span id="cb50-1415"><a href="#cb50-1415" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb50-1416"><a href="#cb50-1416" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb50-1417"><a href="#cb50-1417" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb50-1418"><a href="#cb50-1418" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb50-1419"><a href="#cb50-1419" aria-hidden="true" tabindex="-1"></a>  <span class="co">////// Varying axes ----------------------------------------------------------</span></span>
<span id="cb50-1420"><a href="#cb50-1420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-1421"><a href="#cb50-1421" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb50-1422"><a href="#cb50-1422" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (ctrlSpecDiD <span class="op">!==</span> <span class="st">'none'</span> <span class="op">&amp;&amp;</span> ctrlSpecSynth <span class="op">!==</span> <span class="st">'none'</span>) {</span>
<span id="cb50-1423"><a href="#cb50-1423" aria-hidden="true" tabindex="-1"></a>      minX <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">min</span>(</span>
<span id="cb50-1424"><a href="#cb50-1424" aria-hidden="true" tabindex="-1"></a>        d3<span class="op">.</span><span class="fu">min</span>(dataResSynthG<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">year</span>)<span class="op">,</span></span>
<span id="cb50-1425"><a href="#cb50-1425" aria-hidden="true" tabindex="-1"></a>        d3<span class="op">.</span><span class="fu">min</span>(dataResDiDG<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">year</span>)</span>
<span id="cb50-1426"><a href="#cb50-1426" aria-hidden="true" tabindex="-1"></a>      )<span class="op">;</span></span>
<span id="cb50-1427"><a href="#cb50-1427" aria-hidden="true" tabindex="-1"></a>      maxX <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">max</span>(</span>
<span id="cb50-1428"><a href="#cb50-1428" aria-hidden="true" tabindex="-1"></a>        d3<span class="op">.</span><span class="fu">max</span>(dataResSynthG<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">year</span>)<span class="op">,</span></span>
<span id="cb50-1429"><a href="#cb50-1429" aria-hidden="true" tabindex="-1"></a>        d3<span class="op">.</span><span class="fu">max</span>(dataResDiDG<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">year</span>)</span>
<span id="cb50-1430"><a href="#cb50-1430" aria-hidden="true" tabindex="-1"></a>      )<span class="op">;</span></span>
<span id="cb50-1431"><a href="#cb50-1431" aria-hidden="true" tabindex="-1"></a>      minY <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">min</span>(</span>
<span id="cb50-1432"><a href="#cb50-1432" aria-hidden="true" tabindex="-1"></a>        d3<span class="op">.</span><span class="fu">min</span>(dataResSynthG<span class="op">,</span> d <span class="kw">=&gt;</span> d[minYVar])<span class="op">,</span></span>
<span id="cb50-1433"><a href="#cb50-1433" aria-hidden="true" tabindex="-1"></a>        d3<span class="op">.</span><span class="fu">min</span>(dataResDiDG<span class="op">,</span> d <span class="kw">=&gt;</span> d[minYVar])</span>
<span id="cb50-1434"><a href="#cb50-1434" aria-hidden="true" tabindex="-1"></a>      )<span class="op">;</span></span>
<span id="cb50-1435"><a href="#cb50-1435" aria-hidden="true" tabindex="-1"></a>      maxY <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">max</span>(</span>
<span id="cb50-1436"><a href="#cb50-1436" aria-hidden="true" tabindex="-1"></a>        d3<span class="op">.</span><span class="fu">max</span>(dataResSynthG<span class="op">,</span> d <span class="kw">=&gt;</span> d[maxYVar])<span class="op">,</span></span>
<span id="cb50-1437"><a href="#cb50-1437" aria-hidden="true" tabindex="-1"></a>        d3<span class="op">.</span><span class="fu">max</span>(dataResDiDG<span class="op">,</span> d <span class="kw">=&gt;</span> d[maxYVar])</span>
<span id="cb50-1438"><a href="#cb50-1438" aria-hidden="true" tabindex="-1"></a>      )<span class="op">;</span></span>
<span id="cb50-1439"><a href="#cb50-1439" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (ctrlSpecDiD <span class="op">===</span> <span class="st">'none'</span> <span class="op">&amp;&amp;</span> ctrlSpecSynth <span class="op">!==</span> <span class="st">'none'</span>) {</span>
<span id="cb50-1440"><a href="#cb50-1440" aria-hidden="true" tabindex="-1"></a>      minX <span class="op">=</span> d3<span class="op">.</span><span class="fu">min</span>(dataResSynthG<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">year</span>)<span class="op">;</span></span>
<span id="cb50-1441"><a href="#cb50-1441" aria-hidden="true" tabindex="-1"></a>      maxX <span class="op">=</span> d3<span class="op">.</span><span class="fu">max</span>(dataResSynthG<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">year</span>)<span class="op">;</span></span>
<span id="cb50-1442"><a href="#cb50-1442" aria-hidden="true" tabindex="-1"></a>      minY <span class="op">=</span> d3<span class="op">.</span><span class="fu">min</span>(dataResSynthG<span class="op">,</span> d <span class="kw">=&gt;</span> d[minYVar])<span class="op">;</span></span>
<span id="cb50-1443"><a href="#cb50-1443" aria-hidden="true" tabindex="-1"></a>      maxY <span class="op">=</span> d3<span class="op">.</span><span class="fu">max</span>(dataResSynthG<span class="op">,</span> d <span class="kw">=&gt;</span> d[maxYVar])<span class="op">;</span></span>
<span id="cb50-1444"><a href="#cb50-1444" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (ctrlSpecDiD <span class="op">!==</span> <span class="st">'none'</span> <span class="op">&amp;&amp;</span> ctrlSpecSynth <span class="op">===</span> <span class="st">'none'</span>) {</span>
<span id="cb50-1445"><a href="#cb50-1445" aria-hidden="true" tabindex="-1"></a>      minX <span class="op">=</span> d3<span class="op">.</span><span class="fu">min</span>(dataResDiDG<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">year</span>)<span class="op">;</span></span>
<span id="cb50-1446"><a href="#cb50-1446" aria-hidden="true" tabindex="-1"></a>      maxX <span class="op">=</span> d3<span class="op">.</span><span class="fu">max</span>(dataResDiDG<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">year</span>)<span class="op">;</span></span>
<span id="cb50-1447"><a href="#cb50-1447" aria-hidden="true" tabindex="-1"></a>      minY <span class="op">=</span> d3<span class="op">.</span><span class="fu">min</span>(dataResDiDG<span class="op">,</span> d <span class="kw">=&gt;</span> d[minYVar])<span class="op">;</span></span>
<span id="cb50-1448"><a href="#cb50-1448" aria-hidden="true" tabindex="-1"></a>      maxY <span class="op">=</span> d3<span class="op">.</span><span class="fu">max</span>(dataResDiDG<span class="op">,</span> d <span class="kw">=&gt;</span> d[maxYVar])<span class="op">;</span></span>
<span id="cb50-1449"><a href="#cb50-1449" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb50-1450"><a href="#cb50-1450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-1451"><a href="#cb50-1451" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (overlayK12 <span class="op">&amp;&amp;</span> selectedOutcome <span class="op">!==</span> <span class="st">'e027_elem_educ_direct_exp'</span>) {</span>
<span id="cb50-1452"><a href="#cb50-1452" aria-hidden="true" tabindex="-1"></a>      minY <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">min</span>(minY<span class="op">,</span> d3<span class="op">.</span><span class="fu">min</span>(dataResK12G<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">att</span>))<span class="op">;</span></span>
<span id="cb50-1453"><a href="#cb50-1453" aria-hidden="true" tabindex="-1"></a>      maxY <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">max</span>(maxY<span class="op">,</span> d3<span class="op">.</span><span class="fu">max</span>(dataResK12G<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">att</span>))<span class="op">;</span></span>
<span id="cb50-1454"><a href="#cb50-1454" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb50-1455"><a href="#cb50-1455" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb50-1456"><a href="#cb50-1456" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-1457"><a href="#cb50-1457" aria-hidden="true" tabindex="-1"></a>  <span class="co">//// Define scale functions --------------------------------------------------</span></span>
<span id="cb50-1458"><a href="#cb50-1458" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-1459"><a href="#cb50-1459" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> x <span class="op">=</span> d3<span class="op">.</span><span class="fu">scaleLinear</span>()</span>
<span id="cb50-1460"><a href="#cb50-1460" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">domain</span>([minX<span class="op">,</span> maxX])</span>
<span id="cb50-1461"><a href="#cb50-1461" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">range</span>([margin<span class="op">.</span><span class="at">left</span><span class="op">,</span> width <span class="op">-</span> margin<span class="op">.</span><span class="at">right</span>])<span class="op">;</span></span>
<span id="cb50-1462"><a href="#cb50-1462" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> y <span class="op">=</span> d3<span class="op">.</span><span class="fu">scaleLinear</span>()</span>
<span id="cb50-1463"><a href="#cb50-1463" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">domain</span>([minY<span class="op">,</span> maxY])</span>
<span id="cb50-1464"><a href="#cb50-1464" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">range</span>([ht <span class="op">-</span> margin<span class="op">.</span><span class="at">bottom</span><span class="op">,</span> margin<span class="op">.</span><span class="at">top</span>])</span>
<span id="cb50-1465"><a href="#cb50-1465" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">nice</span>()<span class="op">;</span></span>
<span id="cb50-1466"><a href="#cb50-1466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-1467"><a href="#cb50-1467" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Parent SVG ================================================================</span></span>
<span id="cb50-1468"><a href="#cb50-1468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-1469"><a href="#cb50-1469" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> svg <span class="op">=</span> d3<span class="op">.</span><span class="fu">create</span>(<span class="st">'svg'</span>)</span>
<span id="cb50-1470"><a href="#cb50-1470" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'width'</span><span class="op">,</span> width)</span>
<span id="cb50-1471"><a href="#cb50-1471" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'height'</span><span class="op">,</span> ht)<span class="op">;</span></span>
<span id="cb50-1472"><a href="#cb50-1472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-1473"><a href="#cb50-1473" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Axes ======================================================================</span></span>
<span id="cb50-1474"><a href="#cb50-1474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-1475"><a href="#cb50-1475" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> xAxis <span class="op">=</span> d3<span class="op">.</span><span class="fu">axisBottom</span>(x)</span>
<span id="cb50-1476"><a href="#cb50-1476" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">ticks</span>(tickNumX)</span>
<span id="cb50-1477"><a href="#cb50-1477" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">tickFormat</span>(d3<span class="op">.</span><span class="fu">format</span>(<span class="st">'d'</span>))<span class="op">;</span></span>
<span id="cb50-1478"><a href="#cb50-1478" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> yAxis <span class="op">=</span> d3<span class="op">.</span><span class="fu">axisLeft</span>(y)</span>
<span id="cb50-1479"><a href="#cb50-1479" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">ticks</span>(tickNumY)<span class="op">;</span></span>
<span id="cb50-1480"><a href="#cb50-1480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-1481"><a href="#cb50-1481" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">append</span>(<span class="st">'g'</span>)</span>
<span id="cb50-1482"><a href="#cb50-1482" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'transform'</span><span class="op">,</span> <span class="vs">`translate(0, </span><span class="sc">${</span>ht <span class="op">-</span> margin<span class="op">.</span><span class="at">bottom</span><span class="sc">}</span><span class="vs">)`</span>)</span>
<span id="cb50-1483"><a href="#cb50-1483" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">call</span>(xAxis)</span>
<span id="cb50-1484"><a href="#cb50-1484" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.tick text'</span>)</span>
<span id="cb50-1485"><a href="#cb50-1485" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'font-size'</span><span class="op">,</span> <span class="st">'12px'</span>)<span class="op">;</span></span>
<span id="cb50-1486"><a href="#cb50-1486" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">append</span>(<span class="st">'g'</span>)</span>
<span id="cb50-1487"><a href="#cb50-1487" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'transform'</span><span class="op">,</span> <span class="vs">`translate(</span><span class="sc">${</span>margin<span class="op">.</span><span class="at">left</span><span class="sc">}</span><span class="vs">, 0)`</span>)</span>
<span id="cb50-1488"><a href="#cb50-1488" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">call</span>(yAxis)</span>
<span id="cb50-1489"><a href="#cb50-1489" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.tick text'</span>)</span>
<span id="cb50-1490"><a href="#cb50-1490" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'font-size'</span><span class="op">,</span> <span class="st">'12px'</span>)<span class="op">;</span></span>
<span id="cb50-1491"><a href="#cb50-1491" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb50-1492"><a href="#cb50-1492" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Horizontal Line at y = 0 ==================================================</span></span>
<span id="cb50-1493"><a href="#cb50-1493" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-1494"><a href="#cb50-1494" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">append</span>(<span class="st">'line'</span>)</span>
<span id="cb50-1495"><a href="#cb50-1495" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'stroke-width'</span><span class="op">,</span> <span class="dv">2</span>)</span>
<span id="cb50-1496"><a href="#cb50-1496" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'stroke'</span><span class="op">,</span> <span class="st">'black'</span>)</span>
<span id="cb50-1497"><a href="#cb50-1497" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x1'</span><span class="op">,</span> <span class="fu">x</span>(minX))</span>
<span id="cb50-1498"><a href="#cb50-1498" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x2'</span><span class="op">,</span> <span class="fu">x</span>(maxX))</span>
<span id="cb50-1499"><a href="#cb50-1499" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y1'</span><span class="op">,</span> <span class="fu">y</span>(<span class="dv">0</span>))</span>
<span id="cb50-1500"><a href="#cb50-1500" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y2'</span><span class="op">,</span> <span class="fu">y</span>(<span class="dv">0</span>))</span>
<span id="cb50-1501"><a href="#cb50-1501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-1502"><a href="#cb50-1502" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Treat Year Vertical Line ==================================================</span></span>
<span id="cb50-1503"><a href="#cb50-1503" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-1504"><a href="#cb50-1504" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">append</span>(<span class="st">'line'</span>)</span>
<span id="cb50-1505"><a href="#cb50-1505" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'stroke-width'</span><span class="op">,</span> <span class="dv">2</span>)</span>
<span id="cb50-1506"><a href="#cb50-1506" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'stroke'</span><span class="op">,</span> <span class="st">'black'</span>)</span>
<span id="cb50-1507"><a href="#cb50-1507" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'stroke-dasharray'</span><span class="op">,</span> <span class="dv">5</span>)</span>
<span id="cb50-1508"><a href="#cb50-1508" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x1'</span><span class="op">,</span> <span class="fu">x</span>(treatYear <span class="op">-</span> <span class="dv">1</span>))</span>
<span id="cb50-1509"><a href="#cb50-1509" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x2'</span><span class="op">,</span> <span class="fu">x</span>(treatYear <span class="op">-</span> <span class="dv">1</span>))</span>
<span id="cb50-1510"><a href="#cb50-1510" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y1'</span><span class="op">,</span> margin<span class="op">.</span><span class="at">top</span>)</span>
<span id="cb50-1511"><a href="#cb50-1511" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y2'</span><span class="op">,</span> ht <span class="op">-</span> margin<span class="op">.</span><span class="at">bottom</span>)<span class="op">;</span></span>
<span id="cb50-1512"><a href="#cb50-1512" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-1513"><a href="#cb50-1513" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Results Lines =============================================================</span></span>
<span id="cb50-1514"><a href="#cb50-1514" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-1515"><a href="#cb50-1515" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> line <span class="op">=</span> d3<span class="op">.</span><span class="fu">line</span>()</span>
<span id="cb50-1516"><a href="#cb50-1516" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">defined</span>(d <span class="kw">=&gt;</span> <span class="op">!</span><span class="pp">isNaN</span>(d[<span class="dv">1</span>]) <span class="op">&amp;</span> d[<span class="dv">1</span>] <span class="op">!==</span> <span class="kw">undefined</span> <span class="op">&amp;</span> d[<span class="dv">1</span>] <span class="op">!==</span> <span class="kw">null</span>)<span class="op">;</span></span>
<span id="cb50-1517"><a href="#cb50-1517" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb50-1518"><a href="#cb50-1518" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> ci <span class="op">=</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb50-1519"><a href="#cb50-1519" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (showCI) {</span>
<span id="cb50-1520"><a href="#cb50-1520" aria-hidden="true" tabindex="-1"></a>    ci <span class="op">=</span> d3<span class="op">.</span><span class="fu">area</span>()</span>
<span id="cb50-1521"><a href="#cb50-1521" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">defined</span>(d <span class="kw">=&gt;</span> <span class="op">!</span><span class="pp">isNaN</span>(d[<span class="dv">1</span>]) <span class="op">&amp;</span> d[<span class="dv">1</span>] <span class="op">!==</span> <span class="kw">undefined</span> <span class="op">&amp;</span> d[<span class="dv">1</span>] <span class="op">!==</span> <span class="kw">null</span>)</span>
<span id="cb50-1522"><a href="#cb50-1522" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">x</span>(d <span class="kw">=&gt;</span> d[<span class="dv">0</span>])</span>
<span id="cb50-1523"><a href="#cb50-1523" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">y0</span>(d <span class="kw">=&gt;</span> d[<span class="dv">4</span>])</span>
<span id="cb50-1524"><a href="#cb50-1524" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">y1</span>(d <span class="kw">=&gt;</span> d[<span class="dv">3</span>])</span>
<span id="cb50-1525"><a href="#cb50-1525" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb50-1526"><a href="#cb50-1526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-1527"><a href="#cb50-1527" aria-hidden="true" tabindex="-1"></a>  <span class="co">//// Synth -------------------------------------------------------------------</span></span>
<span id="cb50-1528"><a href="#cb50-1528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-1529"><a href="#cb50-1529" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> pointsSynth <span class="op">=</span> dataResSynthG<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> </span>
<span id="cb50-1530"><a href="#cb50-1530" aria-hidden="true" tabindex="-1"></a>    [<span class="fu">x</span>(d<span class="op">.</span><span class="at">year</span>)<span class="op">,</span> <span class="fu">y</span>(d<span class="op">.</span><span class="at">att</span>)<span class="op">,</span> d<span class="op">.</span><span class="at">treat_group</span><span class="op">,</span> <span class="fu">y</span>(d<span class="op">.</span><span class="at">ci_low</span>)<span class="op">,</span> <span class="fu">y</span>(d<span class="op">.</span><span class="at">ci_up</span>)]</span>
<span id="cb50-1531"><a href="#cb50-1531" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb50-1532"><a href="#cb50-1532" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> groupsSynth <span class="op">=</span> d3<span class="op">.</span><span class="fu">group</span>(pointsSynth<span class="op">,</span> d <span class="kw">=&gt;</span> d[<span class="dv">2</span>])<span class="op">;</span></span>
<span id="cb50-1533"><a href="#cb50-1533" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-1534"><a href="#cb50-1534" aria-hidden="true" tabindex="-1"></a>  <span class="co">////// Confidence interval ---------------------------------------------------</span></span>
<span id="cb50-1535"><a href="#cb50-1535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-1536"><a href="#cb50-1536" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (showCI) {</span>
<span id="cb50-1537"><a href="#cb50-1537" aria-hidden="true" tabindex="-1"></a>    svg<span class="op">.</span><span class="fu">append</span>(<span class="st">'g'</span>)</span>
<span id="cb50-1538"><a href="#cb50-1538" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">'fill'</span><span class="op">,</span> <span class="st">'springgreen'</span>)</span>
<span id="cb50-1539"><a href="#cb50-1539" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">'opacity'</span><span class="op">,</span> <span class="fl">0.25</span>)</span>
<span id="cb50-1540"><a href="#cb50-1540" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">'stroke'</span><span class="op">,</span> <span class="st">'none'</span>)</span>
<span id="cb50-1541"><a href="#cb50-1541" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'path'</span>)</span>
<span id="cb50-1542"><a href="#cb50-1542" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">data</span>(groupsSynth<span class="op">.</span><span class="fu">values</span>())</span>
<span id="cb50-1543"><a href="#cb50-1543" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">join</span>(<span class="st">'path'</span>)</span>
<span id="cb50-1544"><a href="#cb50-1544" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">'d'</span><span class="op">,</span> ci)<span class="op">;</span></span>
<span id="cb50-1545"><a href="#cb50-1545" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb50-1546"><a href="#cb50-1546" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb50-1547"><a href="#cb50-1547" aria-hidden="true" tabindex="-1"></a>  <span class="co">////// ATT -------------------------------------------------------------------</span></span>
<span id="cb50-1548"><a href="#cb50-1548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-1549"><a href="#cb50-1549" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> pathSynth <span class="op">=</span> svg<span class="op">.</span><span class="fu">append</span>(<span class="st">'g'</span>)</span>
<span id="cb50-1550"><a href="#cb50-1550" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'fill'</span><span class="op">,</span> <span class="st">'none'</span>)</span>
<span id="cb50-1551"><a href="#cb50-1551" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'stroke-width'</span><span class="op">,</span> <span class="fl">3.5</span>)</span>
<span id="cb50-1552"><a href="#cb50-1552" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'stroke-linejoin'</span><span class="op">,</span> <span class="st">'round'</span>)</span>
<span id="cb50-1553"><a href="#cb50-1553" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'stroke'</span><span class="op">,</span> <span class="st">'springgreen'</span>)</span>
<span id="cb50-1554"><a href="#cb50-1554" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'path'</span>)</span>
<span id="cb50-1555"><a href="#cb50-1555" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(groupsSynth<span class="op">.</span><span class="fu">values</span>())</span>
<span id="cb50-1556"><a href="#cb50-1556" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">join</span>(<span class="st">'path'</span>)</span>
<span id="cb50-1557"><a href="#cb50-1557" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'d'</span><span class="op">,</span> line)<span class="op">;</span></span>
<span id="cb50-1558"><a href="#cb50-1558" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb50-1559"><a href="#cb50-1559" aria-hidden="true" tabindex="-1"></a>  <span class="co">//// DiD ---------------------------------------------------------------------</span></span>
<span id="cb50-1560"><a href="#cb50-1560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-1561"><a href="#cb50-1561" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> pointsDiD <span class="op">=</span> dataResDiDG<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> </span>
<span id="cb50-1562"><a href="#cb50-1562" aria-hidden="true" tabindex="-1"></a>    [<span class="fu">x</span>(d<span class="op">.</span><span class="at">year</span>)<span class="op">,</span> <span class="fu">y</span>(d<span class="op">.</span><span class="at">att</span>)<span class="op">,</span> d<span class="op">.</span><span class="at">treat_group</span><span class="op">,</span> <span class="fu">y</span>(d<span class="op">.</span><span class="at">ci_low</span>)<span class="op">,</span> <span class="fu">y</span>(d<span class="op">.</span><span class="at">ci_up</span>)]</span>
<span id="cb50-1563"><a href="#cb50-1563" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb50-1564"><a href="#cb50-1564" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> groupsDiD <span class="op">=</span> d3<span class="op">.</span><span class="fu">group</span>(pointsDiD<span class="op">,</span> d <span class="kw">=&gt;</span> d[<span class="dv">2</span>])<span class="op">;</span></span>
<span id="cb50-1565"><a href="#cb50-1565" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-1566"><a href="#cb50-1566" aria-hidden="true" tabindex="-1"></a>  <span class="co">////// Confidence interval ---------------------------------------------------</span></span>
<span id="cb50-1567"><a href="#cb50-1567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-1568"><a href="#cb50-1568" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (showCI) {</span>
<span id="cb50-1569"><a href="#cb50-1569" aria-hidden="true" tabindex="-1"></a>    svg<span class="op">.</span><span class="fu">append</span>(<span class="st">'g'</span>)</span>
<span id="cb50-1570"><a href="#cb50-1570" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">'fill'</span><span class="op">,</span> <span class="st">'deepskyblue'</span>)</span>
<span id="cb50-1571"><a href="#cb50-1571" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">'opacity'</span><span class="op">,</span> <span class="fl">0.25</span>)</span>
<span id="cb50-1572"><a href="#cb50-1572" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">'stroke'</span><span class="op">,</span> <span class="st">'none'</span>)</span>
<span id="cb50-1573"><a href="#cb50-1573" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'path'</span>)</span>
<span id="cb50-1574"><a href="#cb50-1574" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">data</span>(groupsDiD<span class="op">.</span><span class="fu">values</span>())</span>
<span id="cb50-1575"><a href="#cb50-1575" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">join</span>(<span class="st">'path'</span>)</span>
<span id="cb50-1576"><a href="#cb50-1576" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">'d'</span><span class="op">,</span> ci)<span class="op">;</span></span>
<span id="cb50-1577"><a href="#cb50-1577" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb50-1578"><a href="#cb50-1578" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb50-1579"><a href="#cb50-1579" aria-hidden="true" tabindex="-1"></a>  <span class="co">////// ATT -------------------------------------------------------------------</span></span>
<span id="cb50-1580"><a href="#cb50-1580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-1581"><a href="#cb50-1581" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> pathDiD <span class="op">=</span> svg<span class="op">.</span><span class="fu">append</span>(<span class="st">'g'</span>)</span>
<span id="cb50-1582"><a href="#cb50-1582" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'fill'</span><span class="op">,</span> <span class="st">'none'</span>)</span>
<span id="cb50-1583"><a href="#cb50-1583" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'stroke-width'</span><span class="op">,</span> <span class="fl">3.5</span>)</span>
<span id="cb50-1584"><a href="#cb50-1584" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'stroke-linejoin'</span><span class="op">,</span> <span class="st">'round'</span>)</span>
<span id="cb50-1585"><a href="#cb50-1585" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'stroke'</span><span class="op">,</span> <span class="st">'deepskyblue'</span>)</span>
<span id="cb50-1586"><a href="#cb50-1586" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'path'</span>)</span>
<span id="cb50-1587"><a href="#cb50-1587" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(groupsDiD<span class="op">.</span><span class="fu">values</span>())</span>
<span id="cb50-1588"><a href="#cb50-1588" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">join</span>(<span class="st">'path'</span>)</span>
<span id="cb50-1589"><a href="#cb50-1589" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'d'</span><span class="op">,</span> line)<span class="op">;</span></span>
<span id="cb50-1590"><a href="#cb50-1590" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb50-1591"><a href="#cb50-1591" aria-hidden="true" tabindex="-1"></a>  <span class="co">//// K-12 results ------------------------------------------------------------</span></span>
<span id="cb50-1592"><a href="#cb50-1592" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-1593"><a href="#cb50-1593" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (overlayK12 <span class="op">&amp;&amp;</span> selectedOutcome <span class="op">!==</span> <span class="st">'e027_elem_educ_direct_exp'</span>) {</span>
<span id="cb50-1594"><a href="#cb50-1594" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> pointsK12 <span class="op">=</span> dataResK12G<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> [<span class="fu">x</span>(d<span class="op">.</span><span class="at">year</span>)<span class="op">,</span> <span class="fu">y</span>(d<span class="op">.</span><span class="at">att</span>)<span class="op">,</span> d<span class="op">.</span><span class="at">id</span>])<span class="op">;</span></span>
<span id="cb50-1595"><a href="#cb50-1595" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> groupsK12 <span class="op">=</span> d3<span class="op">.</span><span class="fu">rollup</span>(</span>
<span id="cb50-1596"><a href="#cb50-1596" aria-hidden="true" tabindex="-1"></a>      pointsK12<span class="op">,</span> v <span class="kw">=&gt;</span> <span class="bu">Object</span><span class="op">.</span><span class="fu">assign</span>(v<span class="op">,</span> {<span class="dt">id</span><span class="op">:</span> v[<span class="dv">0</span>][<span class="dv">2</span>]})<span class="op">,</span> d <span class="kw">=&gt;</span> d[<span class="dv">2</span>]</span>
<span id="cb50-1597"><a href="#cb50-1597" aria-hidden="true" tabindex="-1"></a>    )<span class="op">;</span></span>
<span id="cb50-1598"><a href="#cb50-1598" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> pathK12 <span class="op">=</span> svg<span class="op">.</span><span class="fu">append</span>(<span class="st">'g'</span>)</span>
<span id="cb50-1599"><a href="#cb50-1599" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">'fill'</span><span class="op">,</span> <span class="st">'none'</span>)</span>
<span id="cb50-1600"><a href="#cb50-1600" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">'stroke-width'</span><span class="op">,</span> <span class="fl">3.5</span>)</span>
<span id="cb50-1601"><a href="#cb50-1601" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">'stroke-linejoin'</span><span class="op">,</span> <span class="st">'round'</span>)</span>
<span id="cb50-1602"><a href="#cb50-1602" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">'stroke-opacity'</span><span class="op">,</span> <span class="op">.</span><span class="dv">75</span>)</span>
<span id="cb50-1603"><a href="#cb50-1603" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">'stroke-dasharray'</span><span class="op">,</span> <span class="dv">5</span>)</span>
<span id="cb50-1604"><a href="#cb50-1604" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'path'</span>)</span>
<span id="cb50-1605"><a href="#cb50-1605" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">data</span>(groupsK12<span class="op">.</span><span class="fu">values</span>())</span>
<span id="cb50-1606"><a href="#cb50-1606" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">join</span>(<span class="st">'path'</span>)</span>
<span id="cb50-1607"><a href="#cb50-1607" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">'d'</span><span class="op">,</span> line)</span>
<span id="cb50-1608"><a href="#cb50-1608" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">'stroke'</span><span class="op">,</span> ({id}) <span class="kw">=&gt;</span> id <span class="op">===</span> <span class="st">'synth'</span> <span class="op">?</span> <span class="st">'springgreen'</span> <span class="op">:</span> <span class="st">'deepskyblue'</span>)<span class="op">;</span></span>
<span id="cb50-1609"><a href="#cb50-1609" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb50-1610"><a href="#cb50-1610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-1611"><a href="#cb50-1611" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Title =====================================================================</span></span>
<span id="cb50-1612"><a href="#cb50-1612" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb50-1613"><a href="#cb50-1613" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> stateNames <span class="op">=</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb50-1614"><a href="#cb50-1614" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (treatGroup<span class="op">.</span><span class="at">length</span> <span class="op">===</span> <span class="dv">2</span>) {</span>
<span id="cb50-1615"><a href="#cb50-1615" aria-hidden="true" tabindex="-1"></a>    stateNames <span class="op">=</span> treatGroup<span class="op">;</span></span>
<span id="cb50-1616"><a href="#cb50-1616" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb50-1617"><a href="#cb50-1617" aria-hidden="true" tabindex="-1"></a>    stateNames <span class="op">=</span> treatGroupStatesMap<span class="op">.</span><span class="fu">get</span>(treatGroup)<span class="op">.</span><span class="fu">join</span>(<span class="st">', '</span>)<span class="op">;</span></span>
<span id="cb50-1618"><a href="#cb50-1618" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb50-1619"><a href="#cb50-1619" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">append</span>(<span class="st">'text'</span>)</span>
<span id="cb50-1620"><a href="#cb50-1620" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x'</span><span class="op">,</span> width <span class="op">/</span> <span class="dv">2</span>)</span>
<span id="cb50-1621"><a href="#cb50-1621" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> margin<span class="op">.</span><span class="at">top</span> <span class="op">-</span> <span class="dv">10</span>)</span>
<span id="cb50-1622"><a href="#cb50-1622" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'text-anchor'</span><span class="op">,</span> <span class="st">'middle'</span>)</span>
<span id="cb50-1623"><a href="#cb50-1623" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">style</span>(<span class="st">'font-size'</span><span class="op">,</span> <span class="st">'12px'</span>)</span>
<span id="cb50-1624"><a href="#cb50-1624" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">text</span>(treatYear <span class="op">+</span> <span class="st">': '</span> <span class="op">+</span> stateNames)<span class="op">;</span></span>
<span id="cb50-1625"><a href="#cb50-1625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-1626"><a href="#cb50-1626" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> svg<span class="op">.</span><span class="fu">node</span>()<span class="op">;</span></span>
<span id="cb50-1627"><a href="#cb50-1627" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display hidden">
<div id="ojs-cell-49" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell hidden">
<div class="sourceCode cell-code hidden" id="cb51" data-startfrom="1636" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 1635;"><span id="cb51-1636"><a href="#cb51-1636" aria-hidden="true" tabindex="-1"></a>plotAggTrends <span class="op">=</span> <span class="kw">function</span>(aggType) {</span>
<span id="cb51-1637"><a href="#cb51-1637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-1638"><a href="#cb51-1638" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Data Setup ================================================================</span></span>
<span id="cb51-1639"><a href="#cb51-1639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-1640"><a href="#cb51-1640" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> aggX <span class="op">=</span> <span class="ss">/</span><span class="sc">^</span><span class="ss">es</span><span class="sc">?</span><span class="ss">$</span><span class="sc">|</span><span class="ss">event/</span><span class="op">.</span><span class="fu">test</span>(aggType) <span class="op">?</span> <span class="st">'e'</span> <span class="op">:</span> <span class="st">'year'</span><span class="op">;</span></span>
<span id="cb51-1641"><a href="#cb51-1641" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> aggCol <span class="op">=</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb51-1642"><a href="#cb51-1642" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (dropAK <span class="op">&amp;&amp;</span> stacked <span class="op">!==</span> <span class="st">'no'</span>) {</span>
<span id="cb51-1643"><a href="#cb51-1643" aria-hidden="true" tabindex="-1"></a>    aggCol <span class="op">=</span> <span class="kw">new</span> <span class="bu">RegExp</span>(<span class="st">'aggregate no ak( stacked '</span> <span class="op">+</span> <span class="bu">Number</span>(stacked) <span class="op">+</span> <span class="st">')?$'</span>)<span class="op">;</span></span>
<span id="cb51-1644"><a href="#cb51-1644" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (<span class="op">!</span>dropAK <span class="op">&amp;&amp;</span> stacked <span class="op">!==</span> <span class="st">'no'</span>) {</span>
<span id="cb51-1645"><a href="#cb51-1645" aria-hidden="true" tabindex="-1"></a>    aggCol <span class="op">=</span> <span class="kw">new</span> <span class="bu">RegExp</span>(<span class="st">'aggregate( stacked '</span> <span class="op">+</span> <span class="bu">Number</span>(stacked) <span class="op">+</span> <span class="st">')?$'</span>)<span class="op">;</span></span>
<span id="cb51-1646"><a href="#cb51-1646" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (dropAK <span class="op">&amp;&amp;</span> stacked <span class="op">===</span> <span class="st">'no'</span>) {</span>
<span id="cb51-1647"><a href="#cb51-1647" aria-hidden="true" tabindex="-1"></a>    aggCol <span class="op">=</span> <span class="kw">new</span> <span class="bu">RegExp</span>(<span class="st">'aggregate no ak( not stacked)?$'</span>)<span class="op">;</span></span>
<span id="cb51-1648"><a href="#cb51-1648" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb51-1649"><a href="#cb51-1649" aria-hidden="true" tabindex="-1"></a>    aggCol <span class="op">=</span> <span class="kw">new</span> <span class="bu">RegExp</span>(<span class="st">'aggregate( not stacked)?$'</span>)<span class="op">;</span></span>
<span id="cb51-1650"><a href="#cb51-1650" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb51-1651"><a href="#cb51-1651" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb51-1652"><a href="#cb51-1652" aria-hidden="true" tabindex="-1"></a>  <span class="co">//// Main --------------------------------------------------------------------</span></span>
<span id="cb51-1653"><a href="#cb51-1653" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-1654"><a href="#cb51-1654" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Means</span></span>
<span id="cb51-1655"><a href="#cb51-1655" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> dataTreatAgg <span class="op">=</span> dataTreatMeansUse<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span></span>
<span id="cb51-1656"><a href="#cb51-1656" aria-hidden="true" tabindex="-1"></a>    aggCol<span class="op">.</span><span class="fu">test</span>(d<span class="op">.</span><span class="at">treat_group</span>) <span class="op">&amp;&amp;</span> d[aggX] <span class="op">!==</span> <span class="kw">null</span></span>
<span id="cb51-1657"><a href="#cb51-1657" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb51-1658"><a href="#cb51-1658" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> dataCtrlDiDAgg <span class="op">=</span> dataCtrlMeansDiDUse<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span></span>
<span id="cb51-1659"><a href="#cb51-1659" aria-hidden="true" tabindex="-1"></a>    aggCol<span class="op">.</span><span class="fu">test</span>(d<span class="op">.</span><span class="at">treat_group</span>) <span class="op">&amp;&amp;</span> d[aggX] <span class="op">!==</span> <span class="kw">null</span></span>
<span id="cb51-1660"><a href="#cb51-1660" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb51-1661"><a href="#cb51-1661" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> dataCtrlSynthAgg <span class="op">=</span> dataCtrlMeansSynthUse<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span></span>
<span id="cb51-1662"><a href="#cb51-1662" aria-hidden="true" tabindex="-1"></a>    aggCol<span class="op">.</span><span class="fu">test</span>(d<span class="op">.</span><span class="at">treat_group</span>) <span class="op">&amp;&amp;</span> d[aggX] <span class="op">!==</span> <span class="kw">null</span></span>
<span id="cb51-1663"><a href="#cb51-1663" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb51-1664"><a href="#cb51-1664" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Subgroups</span></span>
<span id="cb51-1665"><a href="#cb51-1665" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> dataTreat <span class="op">=</span> dataAllStatesUse<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">treated</span> <span class="op">===</span> <span class="dv">1</span>)<span class="op">;</span></span>
<span id="cb51-1666"><a href="#cb51-1666" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> dataCtrlDiD <span class="op">=</span> dataCtrlMeansDiDUse<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> </span>
<span id="cb51-1667"><a href="#cb51-1667" aria-hidden="true" tabindex="-1"></a>    <span class="op">!</span>d<span class="op">.</span><span class="at">treat_group</span><span class="op">.</span><span class="fu">includes</span>(<span class="st">'aggregate'</span>)</span>
<span id="cb51-1668"><a href="#cb51-1668" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb51-1669"><a href="#cb51-1669" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> dataCtrlSynth <span class="op">=</span> dataCtrlMeansSynthUse<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> </span>
<span id="cb51-1670"><a href="#cb51-1670" aria-hidden="true" tabindex="-1"></a>    <span class="op">!</span>d<span class="op">.</span><span class="at">treat_group</span><span class="op">.</span><span class="fu">includes</span>(<span class="st">'aggregate'</span>) <span class="op">&amp;&amp;</span> <span class="ss">/</span><span class="sc">[A-Z][A-Z]</span><span class="ss">/</span><span class="op">.</span><span class="fu">test</span>(d<span class="op">.</span><span class="at">treat_group</span>)</span>
<span id="cb51-1671"><a href="#cb51-1671" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb51-1672"><a href="#cb51-1672" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="op">!</span><span class="ss">/</span><span class="sc">^</span><span class="ss">es</span><span class="sc">?</span><span class="ss">$</span><span class="sc">|</span><span class="ss">event/</span><span class="op">.</span><span class="fu">test</span>(aggType)) {</span>
<span id="cb51-1673"><a href="#cb51-1673" aria-hidden="true" tabindex="-1"></a>    dataTreat <span class="op">=</span> dataTreat<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">e</span> <span class="op">&gt;=</span> <span class="dv">0</span>)<span class="op">;</span></span>
<span id="cb51-1674"><a href="#cb51-1674" aria-hidden="true" tabindex="-1"></a>    dataCtrlDiD <span class="op">=</span> dataCtrlDiD<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">e</span> <span class="op">&gt;=</span> <span class="dv">0</span>)<span class="op">;</span></span>
<span id="cb51-1675"><a href="#cb51-1675" aria-hidden="true" tabindex="-1"></a>    dataCtrlSynth <span class="op">=</span> dataCtrlSynth<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">e</span> <span class="op">&gt;=</span> <span class="dv">0</span>)<span class="op">;</span></span>
<span id="cb51-1676"><a href="#cb51-1676" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb51-1677"><a href="#cb51-1677" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (stacked <span class="op">!==</span> <span class="st">'no'</span>) {</span>
<span id="cb51-1678"><a href="#cb51-1678" aria-hidden="true" tabindex="-1"></a>    dataTreat <span class="op">=</span> dataTreat<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> </span>
<span id="cb51-1679"><a href="#cb51-1679" aria-hidden="true" tabindex="-1"></a>      <span class="bu">Number</span>(d<span class="op">.</span><span class="at">treat_group</span>) <span class="op">+</span> <span class="bu">Number</span>(stacked) <span class="op">-</span> <span class="dv">1</span> <span class="op">&lt;=</span> <span class="dv">2019</span></span>
<span id="cb51-1680"><a href="#cb51-1680" aria-hidden="true" tabindex="-1"></a>    )<span class="op">;</span></span>
<span id="cb51-1681"><a href="#cb51-1681" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb51-1682"><a href="#cb51-1682" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (dropAK) {</span>
<span id="cb51-1683"><a href="#cb51-1683" aria-hidden="true" tabindex="-1"></a>    dataTreat <span class="op">=</span> dataTreat<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">st</span> <span class="op">!==</span> <span class="st">'AK'</span>)<span class="op">;</span></span>
<span id="cb51-1684"><a href="#cb51-1684" aria-hidden="true" tabindex="-1"></a>    dataCtrlSynth <span class="op">=</span> dataCtrlSynth<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">treat_group</span> <span class="op">!==</span> <span class="st">'AK'</span>)<span class="op">;</span></span>
<span id="cb51-1685"><a href="#cb51-1685" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb51-1686"><a href="#cb51-1686" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb51-1687"><a href="#cb51-1687" aria-hidden="true" tabindex="-1"></a>  <span class="co">//// Overlay K-12 results ----------------------------------------------------</span></span>
<span id="cb51-1688"><a href="#cb51-1688" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb51-1689"><a href="#cb51-1689" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> dataK12 <span class="op">=</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb51-1690"><a href="#cb51-1690" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (overlayK12 <span class="op">&amp;&amp;</span> selectedOutcome <span class="op">!==</span> <span class="st">'e027_elem_educ_direct_exp'</span>) {</span>
<span id="cb51-1691"><a href="#cb51-1691" aria-hidden="true" tabindex="-1"></a>    dataK12 <span class="op">=</span> dataK12Means<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span></span>
<span id="cb51-1692"><a href="#cb51-1692" aria-hidden="true" tabindex="-1"></a>      aggCol<span class="op">.</span><span class="fu">test</span>(d<span class="op">.</span><span class="at">treat_group</span>)</span>
<span id="cb51-1693"><a href="#cb51-1693" aria-hidden="true" tabindex="-1"></a>        <span class="op">&amp;&amp;</span> d[aggX] <span class="op">!==</span> <span class="kw">null</span></span>
<span id="cb51-1694"><a href="#cb51-1694" aria-hidden="true" tabindex="-1"></a>    )<span class="op">;</span></span>
<span id="cb51-1695"><a href="#cb51-1695" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (ctrlSpecDiD <span class="op">===</span> <span class="st">'none'</span>) {</span>
<span id="cb51-1696"><a href="#cb51-1696" aria-hidden="true" tabindex="-1"></a>      dataK12 <span class="op">=</span> dataK12<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">id</span> <span class="op">!==</span> <span class="st">'ctrl did'</span>)<span class="op">;</span></span>
<span id="cb51-1697"><a href="#cb51-1697" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb51-1698"><a href="#cb51-1698" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (ctrlSpecSynth <span class="op">===</span> <span class="st">'none'</span>) {</span>
<span id="cb51-1699"><a href="#cb51-1699" aria-hidden="true" tabindex="-1"></a>      dataK12 <span class="op">=</span> dataK12<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">id</span> <span class="op">!==</span> <span class="st">'ctrl synth'</span>)<span class="op">;</span></span>
<span id="cb51-1700"><a href="#cb51-1700" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb51-1701"><a href="#cb51-1701" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb51-1702"><a href="#cb51-1702" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-1703"><a href="#cb51-1703" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Scale Functions ===========================================================</span></span>
<span id="cb51-1704"><a href="#cb51-1704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-1705"><a href="#cb51-1705" aria-hidden="true" tabindex="-1"></a>  <span class="co">//// Find min &amp; max y and x values -------------------------------------------</span></span>
<span id="cb51-1706"><a href="#cb51-1706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-1707"><a href="#cb51-1707" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> minX<span class="op">,</span> maxX<span class="op">,</span> minY<span class="op">,</span> maxY <span class="op">=</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb51-1708"><a href="#cb51-1708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-1709"><a href="#cb51-1709" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="ss">/</span><span class="sc">^</span><span class="ss">es</span><span class="sc">?</span><span class="ss">$</span><span class="sc">|</span><span class="ss">event/</span><span class="op">.</span><span class="fu">test</span>(aggType)) {</span>
<span id="cb51-1710"><a href="#cb51-1710" aria-hidden="true" tabindex="-1"></a>    minX <span class="op">=</span> d3<span class="op">.</span><span class="fu">min</span>(dataTreatAgg<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">e</span>)<span class="op">;</span></span>
<span id="cb51-1711"><a href="#cb51-1711" aria-hidden="true" tabindex="-1"></a>    maxX <span class="op">=</span> d3<span class="op">.</span><span class="fu">max</span>(dataTreatAgg<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">e</span>)<span class="op">;</span></span>
<span id="cb51-1712"><a href="#cb51-1712" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb51-1713"><a href="#cb51-1713" aria-hidden="true" tabindex="-1"></a>    minX <span class="op">=</span> d3<span class="op">.</span><span class="fu">min</span>(dataTreatAgg<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">year</span>)<span class="op">;</span></span>
<span id="cb51-1714"><a href="#cb51-1714" aria-hidden="true" tabindex="-1"></a>    maxX <span class="op">=</span> d3<span class="op">.</span><span class="fu">max</span>(dataTreatAgg<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">year</span>)<span class="op">;</span></span>
<span id="cb51-1715"><a href="#cb51-1715" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb51-1716"><a href="#cb51-1716" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb51-1717"><a href="#cb51-1717" aria-hidden="true" tabindex="-1"></a>  <span class="co">////// Means -----------------------------------------------------------------</span></span>
<span id="cb51-1718"><a href="#cb51-1718" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-1719"><a href="#cb51-1719" aria-hidden="true" tabindex="-1"></a>  minY <span class="op">=</span> d3<span class="op">.</span><span class="fu">min</span>(dataTreatAgg<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">outcome</span>)<span class="op">;</span></span>
<span id="cb51-1720"><a href="#cb51-1720" aria-hidden="true" tabindex="-1"></a>  maxY <span class="op">=</span> d3<span class="op">.</span><span class="fu">max</span>(dataTreatAgg<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">outcome</span>)<span class="op">;</span></span>
<span id="cb51-1721"><a href="#cb51-1721" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb51-1722"><a href="#cb51-1722" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (ctrlSpecDiD <span class="op">!==</span> <span class="st">'none'</span> <span class="op">&amp;&amp;</span> ctrlSpecSynth <span class="op">!==</span> <span class="st">'none'</span>) {</span>
<span id="cb51-1723"><a href="#cb51-1723" aria-hidden="true" tabindex="-1"></a>    minY <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">min</span>(</span>
<span id="cb51-1724"><a href="#cb51-1724" aria-hidden="true" tabindex="-1"></a>      d3<span class="op">.</span><span class="fu">min</span>(dataCtrlDiDAgg<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">outcome</span>)<span class="op">,</span></span>
<span id="cb51-1725"><a href="#cb51-1725" aria-hidden="true" tabindex="-1"></a>      d3<span class="op">.</span><span class="fu">min</span>(dataCtrlSynthAgg<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">outcome</span>)<span class="op">,</span></span>
<span id="cb51-1726"><a href="#cb51-1726" aria-hidden="true" tabindex="-1"></a>      minY</span>
<span id="cb51-1727"><a href="#cb51-1727" aria-hidden="true" tabindex="-1"></a>    )<span class="op">;</span></span>
<span id="cb51-1728"><a href="#cb51-1728" aria-hidden="true" tabindex="-1"></a>    maxY <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">max</span>(</span>
<span id="cb51-1729"><a href="#cb51-1729" aria-hidden="true" tabindex="-1"></a>      d3<span class="op">.</span><span class="fu">max</span>(dataCtrlDiDAgg<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">outcome</span>)<span class="op">,</span></span>
<span id="cb51-1730"><a href="#cb51-1730" aria-hidden="true" tabindex="-1"></a>      d3<span class="op">.</span><span class="fu">max</span>(dataCtrlSynthAgg<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">outcome</span>)<span class="op">,</span></span>
<span id="cb51-1731"><a href="#cb51-1731" aria-hidden="true" tabindex="-1"></a>      maxY</span>
<span id="cb51-1732"><a href="#cb51-1732" aria-hidden="true" tabindex="-1"></a>    )<span class="op">;</span></span>
<span id="cb51-1733"><a href="#cb51-1733" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (ctrlSpecDiD <span class="op">===</span> <span class="st">'none'</span> <span class="op">&amp;&amp;</span> ctrlSpecSynth <span class="op">!==</span> <span class="st">'none'</span>) {</span>
<span id="cb51-1734"><a href="#cb51-1734" aria-hidden="true" tabindex="-1"></a>    minY <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">min</span>(d3<span class="op">.</span><span class="fu">min</span>(dataCtrlSynthAgg<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">outcome</span>)<span class="op">,</span> minY)<span class="op">;</span></span>
<span id="cb51-1735"><a href="#cb51-1735" aria-hidden="true" tabindex="-1"></a>    maxY <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">max</span>(d3<span class="op">.</span><span class="fu">max</span>(dataCtrlSynthAgg<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">outcome</span>)<span class="op">,</span> maxY)<span class="op">;</span></span>
<span id="cb51-1736"><a href="#cb51-1736" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (ctrlSpecDiD <span class="op">!==</span> <span class="st">'none'</span> <span class="op">&amp;&amp;</span> ctrlSpecSynth <span class="op">===</span> <span class="st">'none'</span>) {</span>
<span id="cb51-1737"><a href="#cb51-1737" aria-hidden="true" tabindex="-1"></a>    minY <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">min</span>(d3<span class="op">.</span><span class="fu">min</span>(dataCtrlDiDAgg<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">outcome</span>)<span class="op">,</span> minY)<span class="op">;</span></span>
<span id="cb51-1738"><a href="#cb51-1738" aria-hidden="true" tabindex="-1"></a>    maxY <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">max</span>(d3<span class="op">.</span><span class="fu">max</span>(dataCtrlDiDAgg<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">outcome</span>)<span class="op">,</span> maxY)<span class="op">;</span></span>
<span id="cb51-1739"><a href="#cb51-1739" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb51-1740"><a href="#cb51-1740" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb51-1741"><a href="#cb51-1741" aria-hidden="true" tabindex="-1"></a>  <span class="co">////// States / subgroup controls --------------------------------------------</span></span>
<span id="cb51-1742"><a href="#cb51-1742" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb51-1743"><a href="#cb51-1743" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (showSubgroups) {</span>
<span id="cb51-1744"><a href="#cb51-1744" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (subgroupsToShow<span class="op">.</span><span class="fu">includes</span>(<span class="st">'treated'</span>)) {</span>
<span id="cb51-1745"><a href="#cb51-1745" aria-hidden="true" tabindex="-1"></a>      minY <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">min</span>(d3<span class="op">.</span><span class="fu">min</span>(dataTreat<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">outcome</span>)<span class="op">,</span> minY)<span class="op">;</span></span>
<span id="cb51-1746"><a href="#cb51-1746" aria-hidden="true" tabindex="-1"></a>      maxY <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">max</span>(d3<span class="op">.</span><span class="fu">max</span>(dataTreat<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">outcome</span>)<span class="op">,</span> maxY)<span class="op">;</span></span>
<span id="cb51-1747"><a href="#cb51-1747" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb51-1748"><a href="#cb51-1748" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (</span>
<span id="cb51-1749"><a href="#cb51-1749" aria-hidden="true" tabindex="-1"></a>      (subgroupsToShow<span class="op">.</span><span class="fu">includes</span>(<span class="st">'ctrl, DiD'</span>) </span>
<span id="cb51-1750"><a href="#cb51-1750" aria-hidden="true" tabindex="-1"></a>        <span class="op">||</span> subgroupsToShow<span class="op">.</span><span class="fu">includes</span>(<span class="st">'untreated'</span>))</span>
<span id="cb51-1751"><a href="#cb51-1751" aria-hidden="true" tabindex="-1"></a>        <span class="op">&amp;&amp;</span> ctrlSpecDiD <span class="op">!==</span> <span class="st">'none'</span></span>
<span id="cb51-1752"><a href="#cb51-1752" aria-hidden="true" tabindex="-1"></a>    ) {</span>
<span id="cb51-1753"><a href="#cb51-1753" aria-hidden="true" tabindex="-1"></a>      minY <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">min</span>(d3<span class="op">.</span><span class="fu">min</span>(dataCtrlDiD<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">outcome</span>)<span class="op">,</span> minY)<span class="op">;</span></span>
<span id="cb51-1754"><a href="#cb51-1754" aria-hidden="true" tabindex="-1"></a>      maxY <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">max</span>(d3<span class="op">.</span><span class="fu">max</span>(dataCtrlDiD<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">outcome</span>)<span class="op">,</span> maxY)<span class="op">;</span></span>
<span id="cb51-1755"><a href="#cb51-1755" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb51-1756"><a href="#cb51-1756" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (</span>
<span id="cb51-1757"><a href="#cb51-1757" aria-hidden="true" tabindex="-1"></a>      (subgroupsToShow<span class="op">.</span><span class="fu">includes</span>(<span class="st">'ctrl, synth'</span>) </span>
<span id="cb51-1758"><a href="#cb51-1758" aria-hidden="true" tabindex="-1"></a>        <span class="op">||</span> subgroupsToShow<span class="op">.</span><span class="fu">includes</span>(<span class="st">'untreated'</span>))</span>
<span id="cb51-1759"><a href="#cb51-1759" aria-hidden="true" tabindex="-1"></a>        <span class="op">&amp;&amp;</span> ctrlSpecSynth <span class="op">!==</span> <span class="st">'none'</span></span>
<span id="cb51-1760"><a href="#cb51-1760" aria-hidden="true" tabindex="-1"></a>    ) {</span>
<span id="cb51-1761"><a href="#cb51-1761" aria-hidden="true" tabindex="-1"></a>      minY <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">min</span>(d3<span class="op">.</span><span class="fu">min</span>(dataCtrlSynth<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">outcome</span>)<span class="op">,</span> minY)<span class="op">;</span></span>
<span id="cb51-1762"><a href="#cb51-1762" aria-hidden="true" tabindex="-1"></a>      maxY <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">max</span>(d3<span class="op">.</span><span class="fu">max</span>(dataCtrlSynth<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">outcome</span>)<span class="op">,</span> maxY)<span class="op">;</span></span>
<span id="cb51-1763"><a href="#cb51-1763" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb51-1764"><a href="#cb51-1764" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb51-1765"><a href="#cb51-1765" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-1766"><a href="#cb51-1766" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (overlayK12 <span class="op">&amp;&amp;</span> selectedOutcome <span class="op">!==</span> <span class="st">'e027_elem_educ_direct_exp'</span>) {</span>
<span id="cb51-1767"><a href="#cb51-1767" aria-hidden="true" tabindex="-1"></a>    minY <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">min</span>(d3<span class="op">.</span><span class="fu">min</span>(dataK12<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">outcome</span>)<span class="op">,</span> minY)<span class="op">;</span></span>
<span id="cb51-1768"><a href="#cb51-1768" aria-hidden="true" tabindex="-1"></a>    maxY <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">max</span>(d3<span class="op">.</span><span class="fu">max</span>(dataK12<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">outcome</span>)<span class="op">,</span> maxY)<span class="op">;</span></span>
<span id="cb51-1769"><a href="#cb51-1769" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb51-1770"><a href="#cb51-1770" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-1771"><a href="#cb51-1771" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="op">!</span>fe) minY <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb51-1772"><a href="#cb51-1772" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-1773"><a href="#cb51-1773" aria-hidden="true" tabindex="-1"></a>  <span class="co">//// Define scale functions --------------------------------------------------</span></span>
<span id="cb51-1774"><a href="#cb51-1774" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-1775"><a href="#cb51-1775" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> x <span class="op">=</span> d3<span class="op">.</span><span class="fu">scaleLinear</span>()</span>
<span id="cb51-1776"><a href="#cb51-1776" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">domain</span>([minX<span class="op">,</span> maxX])</span>
<span id="cb51-1777"><a href="#cb51-1777" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">range</span>([margin<span class="op">.</span><span class="at">left</span><span class="op">,</span> width <span class="op">-</span> margin<span class="op">.</span><span class="at">right</span>])<span class="op">;</span></span>
<span id="cb51-1778"><a href="#cb51-1778" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> y <span class="op">=</span> d3<span class="op">.</span><span class="fu">scaleLinear</span>()</span>
<span id="cb51-1779"><a href="#cb51-1779" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">domain</span>([minY<span class="op">,</span> maxY])</span>
<span id="cb51-1780"><a href="#cb51-1780" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">range</span>([height <span class="op">-</span> margin<span class="op">.</span><span class="at">bottom</span><span class="op">,</span> margin<span class="op">.</span><span class="at">top</span>])</span>
<span id="cb51-1781"><a href="#cb51-1781" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">nice</span>()<span class="op">;</span></span>
<span id="cb51-1782"><a href="#cb51-1782" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-1783"><a href="#cb51-1783" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Parent SVG ================================================================</span></span>
<span id="cb51-1784"><a href="#cb51-1784" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-1785"><a href="#cb51-1785" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> svg <span class="op">=</span> d3<span class="op">.</span><span class="fu">create</span>(<span class="st">'svg'</span>)</span>
<span id="cb51-1786"><a href="#cb51-1786" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'width'</span><span class="op">,</span> width)</span>
<span id="cb51-1787"><a href="#cb51-1787" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'height'</span><span class="op">,</span> height)<span class="op">;</span></span>
<span id="cb51-1788"><a href="#cb51-1788" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-1789"><a href="#cb51-1789" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Axes ======================================================================</span></span>
<span id="cb51-1790"><a href="#cb51-1790" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-1791"><a href="#cb51-1791" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> xAxis <span class="op">=</span> d3<span class="op">.</span><span class="fu">axisBottom</span>(x)</span>
<span id="cb51-1792"><a href="#cb51-1792" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">ticks</span>(tickNumX)</span>
<span id="cb51-1793"><a href="#cb51-1793" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">tickFormat</span>(d3<span class="op">.</span><span class="fu">format</span>(<span class="st">'d'</span>))<span class="op">;</span></span>
<span id="cb51-1794"><a href="#cb51-1794" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> yAxis <span class="op">=</span> d3<span class="op">.</span><span class="fu">axisLeft</span>(y)</span>
<span id="cb51-1795"><a href="#cb51-1795" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">ticks</span>(tickNumY)<span class="op">;</span></span>
<span id="cb51-1796"><a href="#cb51-1796" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-1797"><a href="#cb51-1797" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">append</span>(<span class="st">'g'</span>)</span>
<span id="cb51-1798"><a href="#cb51-1798" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'transform'</span><span class="op">,</span> <span class="vs">`translate(0, </span><span class="sc">${</span>height <span class="op">-</span> margin<span class="op">.</span><span class="at">bottom</span><span class="sc">}</span><span class="vs">)`</span>)</span>
<span id="cb51-1799"><a href="#cb51-1799" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">call</span>(xAxis)</span>
<span id="cb51-1800"><a href="#cb51-1800" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.tick text'</span>)</span>
<span id="cb51-1801"><a href="#cb51-1801" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'font-size'</span><span class="op">,</span> <span class="st">'12px'</span>)<span class="op">;</span></span>
<span id="cb51-1802"><a href="#cb51-1802" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">append</span>(<span class="st">'g'</span>)</span>
<span id="cb51-1803"><a href="#cb51-1803" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'transform'</span><span class="op">,</span> <span class="vs">`translate(</span><span class="sc">${</span>margin<span class="op">.</span><span class="at">left</span><span class="sc">}</span><span class="vs">, 0)`</span>)</span>
<span id="cb51-1804"><a href="#cb51-1804" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">call</span>(yAxis)</span>
<span id="cb51-1805"><a href="#cb51-1805" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.tick text'</span>)</span>
<span id="cb51-1806"><a href="#cb51-1806" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'font-size'</span><span class="op">,</span> <span class="st">'12px'</span>)<span class="op">;</span></span>
<span id="cb51-1807"><a href="#cb51-1807" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb51-1808"><a href="#cb51-1808" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Treat Year Vertical Line ==================================================</span></span>
<span id="cb51-1809"><a href="#cb51-1809" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-1810"><a href="#cb51-1810" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="ss">/</span><span class="sc">^</span><span class="ss">es</span><span class="sc">?</span><span class="ss">$</span><span class="sc">|</span><span class="ss">event/</span><span class="op">.</span><span class="fu">test</span>(aggType)) {</span>
<span id="cb51-1811"><a href="#cb51-1811" aria-hidden="true" tabindex="-1"></a>    svg<span class="op">.</span><span class="fu">append</span>(<span class="st">'line'</span>)</span>
<span id="cb51-1812"><a href="#cb51-1812" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">'stroke-width'</span><span class="op">,</span> <span class="dv">2</span>)</span>
<span id="cb51-1813"><a href="#cb51-1813" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">'stroke'</span><span class="op">,</span> <span class="st">'black'</span>)</span>
<span id="cb51-1814"><a href="#cb51-1814" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">'stroke-dasharray'</span><span class="op">,</span> <span class="dv">5</span>)</span>
<span id="cb51-1815"><a href="#cb51-1815" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x1'</span><span class="op">,</span> <span class="fu">x</span>(<span class="op">-</span><span class="dv">1</span>))</span>
<span id="cb51-1816"><a href="#cb51-1816" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x2'</span><span class="op">,</span> <span class="fu">x</span>(<span class="op">-</span><span class="dv">1</span>))</span>
<span id="cb51-1817"><a href="#cb51-1817" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y1'</span><span class="op">,</span> margin<span class="op">.</span><span class="at">top</span>)</span>
<span id="cb51-1818"><a href="#cb51-1818" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y2'</span><span class="op">,</span> height <span class="op">-</span> margin<span class="op">.</span><span class="at">bottom</span>)<span class="op">;</span></span>
<span id="cb51-1819"><a href="#cb51-1819" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb51-1820"><a href="#cb51-1820" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-1821"><a href="#cb51-1821" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Outcome Trends ============================================================</span></span>
<span id="cb51-1822"><a href="#cb51-1822" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-1823"><a href="#cb51-1823" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> line <span class="op">=</span> d3<span class="op">.</span><span class="fu">line</span>()<span class="op">.</span><span class="fu">defined</span>(d <span class="kw">=&gt;</span> </span>
<span id="cb51-1824"><a href="#cb51-1824" aria-hidden="true" tabindex="-1"></a>    <span class="op">!</span><span class="pp">isNaN</span>(d[<span class="dv">1</span>]) <span class="op">&amp;</span> d[<span class="dv">1</span>] <span class="op">!==</span> <span class="kw">undefined</span> <span class="op">&amp;</span> d[<span class="dv">1</span>] <span class="op">!==</span> <span class="kw">null</span></span>
<span id="cb51-1825"><a href="#cb51-1825" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb51-1826"><a href="#cb51-1826" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-1827"><a href="#cb51-1827" aria-hidden="true" tabindex="-1"></a>  <span class="co">//// Subgroups 1: Treated states ---------------------------------------------</span></span>
<span id="cb51-1828"><a href="#cb51-1828" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-1829"><a href="#cb51-1829" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> pointsTreat <span class="op">=</span> [[<span class="fu">x</span>(minX)<span class="op">,</span> <span class="fu">y</span>(minY)<span class="op">,</span> <span class="st">''</span>]]<span class="op">;</span></span>
<span id="cb51-1830"><a href="#cb51-1830" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (showSubgroups <span class="op">&amp;&amp;</span> subgroupsToShow<span class="op">.</span><span class="fu">includes</span>(<span class="st">'treated'</span>)) {</span>
<span id="cb51-1831"><a href="#cb51-1831" aria-hidden="true" tabindex="-1"></a>    pointsTreat <span class="op">=</span> dataTreat<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> [<span class="fu">x</span>(d[aggX])<span class="op">,</span> <span class="fu">y</span>(d<span class="op">.</span><span class="at">outcome</span>)<span class="op">,</span> d<span class="op">.</span><span class="at">st</span> <span class="op">+</span> <span class="st">'treat'</span>])<span class="op">;</span></span>
<span id="cb51-1832"><a href="#cb51-1832" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb51-1833"><a href="#cb51-1833" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> groupsTreat <span class="op">=</span> d3<span class="op">.</span><span class="fu">rollup</span>(</span>
<span id="cb51-1834"><a href="#cb51-1834" aria-hidden="true" tabindex="-1"></a>    pointsTreat<span class="op">,</span> </span>
<span id="cb51-1835"><a href="#cb51-1835" aria-hidden="true" tabindex="-1"></a>    v <span class="kw">=&gt;</span> <span class="bu">Object</span><span class="op">.</span><span class="fu">assign</span>(v<span class="op">,</span> {<span class="dt">group</span><span class="op">:</span> v[<span class="dv">0</span>][<span class="dv">2</span>]})<span class="op">,</span> </span>
<span id="cb51-1836"><a href="#cb51-1836" aria-hidden="true" tabindex="-1"></a>    d <span class="kw">=&gt;</span> d[<span class="dv">2</span>]</span>
<span id="cb51-1837"><a href="#cb51-1837" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb51-1838"><a href="#cb51-1838" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> pathTreat <span class="op">=</span> svg<span class="op">.</span><span class="fu">append</span>(<span class="st">'g'</span>)</span>
<span id="cb51-1839"><a href="#cb51-1839" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'fill'</span><span class="op">,</span> <span class="st">'none'</span>)</span>
<span id="cb51-1840"><a href="#cb51-1840" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'stroke-width'</span><span class="op">,</span> <span class="dv">2</span>)</span>
<span id="cb51-1841"><a href="#cb51-1841" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'stroke-linejoin'</span><span class="op">,</span> <span class="st">'round'</span>)</span>
<span id="cb51-1842"><a href="#cb51-1842" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'stroke-dasharray'</span><span class="op">,</span> <span class="dv">5</span>)</span>
<span id="cb51-1843"><a href="#cb51-1843" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'stroke'</span><span class="op">,</span> <span class="st">'hotpink'</span>)</span>
<span id="cb51-1844"><a href="#cb51-1844" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'path'</span>)</span>
<span id="cb51-1845"><a href="#cb51-1845" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(groupsTreat<span class="op">.</span><span class="fu">values</span>())</span>
<span id="cb51-1846"><a href="#cb51-1846" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">join</span>(<span class="st">'path'</span>)</span>
<span id="cb51-1847"><a href="#cb51-1847" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">style</span>(<span class="st">'mix-blend-mode'</span><span class="op">,</span> <span class="st">'multiply'</span>)</span>
<span id="cb51-1848"><a href="#cb51-1848" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'d'</span><span class="op">,</span> line)<span class="op">;</span></span>
<span id="cb51-1849"><a href="#cb51-1849" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb51-1850"><a href="#cb51-1850" aria-hidden="true" tabindex="-1"></a>  <span class="co">//// Subgroups 2: Ctrl, DiD --------------------------------------------------</span></span>
<span id="cb51-1851"><a href="#cb51-1851" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-1852"><a href="#cb51-1852" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> pointsCtrlDiD <span class="op">=</span> [[<span class="fu">x</span>(minX)<span class="op">,</span> <span class="fu">y</span>(minY)<span class="op">,</span> <span class="st">''</span>]]<span class="op">;</span></span>
<span id="cb51-1853"><a href="#cb51-1853" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (</span>
<span id="cb51-1854"><a href="#cb51-1854" aria-hidden="true" tabindex="-1"></a>    showSubgroups </span>
<span id="cb51-1855"><a href="#cb51-1855" aria-hidden="true" tabindex="-1"></a>      <span class="op">&amp;&amp;</span> (subgroupsToShow<span class="op">.</span><span class="fu">includes</span>(<span class="st">'untreated'</span>) </span>
<span id="cb51-1856"><a href="#cb51-1856" aria-hidden="true" tabindex="-1"></a>      <span class="op">||</span> subgroupsToShow<span class="op">.</span><span class="fu">includes</span>(<span class="st">'ctrl, DiD'</span>))</span>
<span id="cb51-1857"><a href="#cb51-1857" aria-hidden="true" tabindex="-1"></a>  ) {</span>
<span id="cb51-1858"><a href="#cb51-1858" aria-hidden="true" tabindex="-1"></a>    pointsCtrlDiD <span class="op">=</span> dataCtrlDiD<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> </span>
<span id="cb51-1859"><a href="#cb51-1859" aria-hidden="true" tabindex="-1"></a>      [<span class="fu">x</span>(d[aggX])<span class="op">,</span> <span class="fu">y</span>(d<span class="op">.</span><span class="at">outcome</span>)<span class="op">,</span> d<span class="op">.</span><span class="at">treat_group</span> <span class="op">+</span> <span class="st">'did'</span>]</span>
<span id="cb51-1860"><a href="#cb51-1860" aria-hidden="true" tabindex="-1"></a>    )<span class="op">;</span></span>
<span id="cb51-1861"><a href="#cb51-1861" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb51-1862"><a href="#cb51-1862" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> groupsCtrlDiD <span class="op">=</span> d3<span class="op">.</span><span class="fu">rollup</span>(</span>
<span id="cb51-1863"><a href="#cb51-1863" aria-hidden="true" tabindex="-1"></a>    pointsCtrlDiD<span class="op">,</span> </span>
<span id="cb51-1864"><a href="#cb51-1864" aria-hidden="true" tabindex="-1"></a>    v <span class="kw">=&gt;</span> <span class="bu">Object</span><span class="op">.</span><span class="fu">assign</span>(v<span class="op">,</span> {<span class="dt">group</span><span class="op">:</span> v[<span class="dv">0</span>][<span class="dv">2</span>]})<span class="op">,</span> </span>
<span id="cb51-1865"><a href="#cb51-1865" aria-hidden="true" tabindex="-1"></a>    d <span class="kw">=&gt;</span> d[<span class="dv">2</span>]</span>
<span id="cb51-1866"><a href="#cb51-1866" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb51-1867"><a href="#cb51-1867" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> pathCtrlDiD <span class="op">=</span> svg<span class="op">.</span><span class="fu">append</span>(<span class="st">'g'</span>)</span>
<span id="cb51-1868"><a href="#cb51-1868" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'fill'</span><span class="op">,</span> <span class="st">'none'</span>)</span>
<span id="cb51-1869"><a href="#cb51-1869" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'stroke-width'</span><span class="op">,</span> <span class="dv">2</span>)</span>
<span id="cb51-1870"><a href="#cb51-1870" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'stroke-linejoin'</span><span class="op">,</span> <span class="st">'round'</span>)</span>
<span id="cb51-1871"><a href="#cb51-1871" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'stroke-dasharray'</span><span class="op">,</span> <span class="dv">5</span>)</span>
<span id="cb51-1872"><a href="#cb51-1872" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'stroke'</span><span class="op">,</span> <span class="st">'lightskyblue'</span>)</span>
<span id="cb51-1873"><a href="#cb51-1873" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'path'</span>)</span>
<span id="cb51-1874"><a href="#cb51-1874" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(groupsCtrlDiD<span class="op">.</span><span class="fu">values</span>())</span>
<span id="cb51-1875"><a href="#cb51-1875" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">join</span>(<span class="st">'path'</span>)</span>
<span id="cb51-1876"><a href="#cb51-1876" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">style</span>(<span class="st">'mix-blend-mode'</span><span class="op">,</span> <span class="st">'multiply'</span>)</span>
<span id="cb51-1877"><a href="#cb51-1877" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'d'</span><span class="op">,</span> line)<span class="op">;</span></span>
<span id="cb51-1878"><a href="#cb51-1878" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb51-1879"><a href="#cb51-1879" aria-hidden="true" tabindex="-1"></a>  <span class="co">//// Subgroups 3: Ctrl, Synth ------------------------------------------------</span></span>
<span id="cb51-1880"><a href="#cb51-1880" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-1881"><a href="#cb51-1881" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> pointsCtrlSynth <span class="op">=</span> [[<span class="fu">x</span>(minX)<span class="op">,</span> <span class="fu">y</span>(minY)<span class="op">,</span> <span class="st">''</span>]]<span class="op">;</span></span>
<span id="cb51-1882"><a href="#cb51-1882" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (</span>
<span id="cb51-1883"><a href="#cb51-1883" aria-hidden="true" tabindex="-1"></a>    showSubgroups </span>
<span id="cb51-1884"><a href="#cb51-1884" aria-hidden="true" tabindex="-1"></a>      <span class="op">&amp;&amp;</span> (subgroupsToShow<span class="op">.</span><span class="fu">includes</span>(<span class="st">'untreated'</span>) </span>
<span id="cb51-1885"><a href="#cb51-1885" aria-hidden="true" tabindex="-1"></a>      <span class="op">||</span> subgroupsToShow<span class="op">.</span><span class="fu">includes</span>(<span class="st">'ctrl, synth'</span>))</span>
<span id="cb51-1886"><a href="#cb51-1886" aria-hidden="true" tabindex="-1"></a>  ) {</span>
<span id="cb51-1887"><a href="#cb51-1887" aria-hidden="true" tabindex="-1"></a>    pointsCtrlSynth <span class="op">=</span> dataCtrlSynth<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> </span>
<span id="cb51-1888"><a href="#cb51-1888" aria-hidden="true" tabindex="-1"></a>      [<span class="fu">x</span>(d[aggX])<span class="op">,</span> <span class="fu">y</span>(d<span class="op">.</span><span class="at">outcome</span>)<span class="op">,</span> d<span class="op">.</span><span class="at">treat_group</span> <span class="op">+</span> <span class="st">'synth'</span>]</span>
<span id="cb51-1889"><a href="#cb51-1889" aria-hidden="true" tabindex="-1"></a>    )<span class="op">;</span></span>
<span id="cb51-1890"><a href="#cb51-1890" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb51-1891"><a href="#cb51-1891" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> groupsCtrlSynth <span class="op">=</span> d3<span class="op">.</span><span class="fu">rollup</span>(</span>
<span id="cb51-1892"><a href="#cb51-1892" aria-hidden="true" tabindex="-1"></a>    pointsCtrlSynth<span class="op">,</span> </span>
<span id="cb51-1893"><a href="#cb51-1893" aria-hidden="true" tabindex="-1"></a>    v <span class="kw">=&gt;</span> <span class="bu">Object</span><span class="op">.</span><span class="fu">assign</span>(v<span class="op">,</span> {<span class="dt">group</span><span class="op">:</span> v[<span class="dv">0</span>][<span class="dv">2</span>]})<span class="op">,</span> </span>
<span id="cb51-1894"><a href="#cb51-1894" aria-hidden="true" tabindex="-1"></a>    d <span class="kw">=&gt;</span> d[<span class="dv">2</span>]</span>
<span id="cb51-1895"><a href="#cb51-1895" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb51-1896"><a href="#cb51-1896" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> pathCtrlSynth <span class="op">=</span> svg<span class="op">.</span><span class="fu">append</span>(<span class="st">'g'</span>)</span>
<span id="cb51-1897"><a href="#cb51-1897" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'fill'</span><span class="op">,</span> <span class="st">'none'</span>)</span>
<span id="cb51-1898"><a href="#cb51-1898" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'stroke-width'</span><span class="op">,</span> <span class="dv">2</span>)</span>
<span id="cb51-1899"><a href="#cb51-1899" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'stroke-linejoin'</span><span class="op">,</span> <span class="st">'round'</span>)</span>
<span id="cb51-1900"><a href="#cb51-1900" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'stroke-dasharray'</span><span class="op">,</span> <span class="dv">5</span>)</span>
<span id="cb51-1901"><a href="#cb51-1901" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'stroke'</span><span class="op">,</span> <span class="st">'lightgreen'</span>)</span>
<span id="cb51-1902"><a href="#cb51-1902" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'path'</span>)</span>
<span id="cb51-1903"><a href="#cb51-1903" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(groupsCtrlSynth<span class="op">.</span><span class="fu">values</span>())</span>
<span id="cb51-1904"><a href="#cb51-1904" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">join</span>(<span class="st">'path'</span>)</span>
<span id="cb51-1905"><a href="#cb51-1905" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">style</span>(<span class="st">'mix-blend-mode'</span><span class="op">,</span> <span class="st">'multiply'</span>)</span>
<span id="cb51-1906"><a href="#cb51-1906" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'d'</span><span class="op">,</span> line)<span class="op">;</span></span>
<span id="cb51-1907"><a href="#cb51-1907" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb51-1908"><a href="#cb51-1908" aria-hidden="true" tabindex="-1"></a>  <span class="co">//// Agg: Treat --------------------------------------------------------------</span></span>
<span id="cb51-1909"><a href="#cb51-1909" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-1910"><a href="#cb51-1910" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> pointsTreatAgg <span class="op">=</span> dataTreatAgg<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span></span>
<span id="cb51-1911"><a href="#cb51-1911" aria-hidden="true" tabindex="-1"></a>    [<span class="fu">x</span>(d[aggX])<span class="op">,</span> <span class="fu">y</span>(d<span class="op">.</span><span class="at">outcome</span>)<span class="op">,</span> d<span class="op">.</span><span class="at">treat_group</span>]</span>
<span id="cb51-1912"><a href="#cb51-1912" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb51-1913"><a href="#cb51-1913" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> groupsTreatAgg <span class="op">=</span> d3<span class="op">.</span><span class="fu">group</span>(pointsTreatAgg<span class="op">,</span> d <span class="kw">=&gt;</span> d[<span class="dv">2</span>])<span class="op">;</span></span>
<span id="cb51-1914"><a href="#cb51-1914" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> pathTreatAgg <span class="op">=</span> svg<span class="op">.</span><span class="fu">append</span>(<span class="st">'g'</span>)</span>
<span id="cb51-1915"><a href="#cb51-1915" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'fill'</span><span class="op">,</span> <span class="st">'none'</span>)</span>
<span id="cb51-1916"><a href="#cb51-1916" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'stroke-width'</span><span class="op">,</span> <span class="fl">3.5</span>)</span>
<span id="cb51-1917"><a href="#cb51-1917" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'stroke-linejoin'</span><span class="op">,</span> <span class="st">'round'</span>)</span>
<span id="cb51-1918"><a href="#cb51-1918" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'stroke'</span><span class="op">,</span> <span class="st">'deeppink'</span>)</span>
<span id="cb51-1919"><a href="#cb51-1919" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'path'</span>)</span>
<span id="cb51-1920"><a href="#cb51-1920" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(groupsTreatAgg<span class="op">.</span><span class="fu">values</span>())</span>
<span id="cb51-1921"><a href="#cb51-1921" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">join</span>(<span class="st">'path'</span>)</span>
<span id="cb51-1922"><a href="#cb51-1922" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'d'</span><span class="op">,</span> line)<span class="op">;</span></span>
<span id="cb51-1923"><a href="#cb51-1923" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb51-1924"><a href="#cb51-1924" aria-hidden="true" tabindex="-1"></a>  <span class="co">//// Agg: Ctrl, DiD ----------------------------------------------------------</span></span>
<span id="cb51-1925"><a href="#cb51-1925" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-1926"><a href="#cb51-1926" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> pointsCtrlDiDAgg <span class="op">=</span> dataCtrlDiDAgg<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span></span>
<span id="cb51-1927"><a href="#cb51-1927" aria-hidden="true" tabindex="-1"></a>    [<span class="fu">x</span>(d[aggX])<span class="op">,</span> <span class="fu">y</span>(d<span class="op">.</span><span class="at">outcome</span>)<span class="op">,</span> d<span class="op">.</span><span class="at">treat_group</span>]</span>
<span id="cb51-1928"><a href="#cb51-1928" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb51-1929"><a href="#cb51-1929" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> groupsCtrlDiDAgg <span class="op">=</span> d3<span class="op">.</span><span class="fu">group</span>(pointsCtrlDiDAgg<span class="op">,</span> d <span class="kw">=&gt;</span> d[<span class="dv">2</span>])<span class="op">;</span></span>
<span id="cb51-1930"><a href="#cb51-1930" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> pathCtrlDiDAgg <span class="op">=</span> svg<span class="op">.</span><span class="fu">append</span>(<span class="st">'g'</span>)</span>
<span id="cb51-1931"><a href="#cb51-1931" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'fill'</span><span class="op">,</span> <span class="st">'none'</span>)</span>
<span id="cb51-1932"><a href="#cb51-1932" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'stroke-width'</span><span class="op">,</span> <span class="fl">3.5</span>)</span>
<span id="cb51-1933"><a href="#cb51-1933" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'stroke-linejoin'</span><span class="op">,</span> <span class="st">'round'</span>)</span>
<span id="cb51-1934"><a href="#cb51-1934" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'stroke'</span><span class="op">,</span> <span class="st">'deepskyblue'</span>)</span>
<span id="cb51-1935"><a href="#cb51-1935" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'path'</span>)</span>
<span id="cb51-1936"><a href="#cb51-1936" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(groupsCtrlDiDAgg<span class="op">.</span><span class="fu">values</span>())</span>
<span id="cb51-1937"><a href="#cb51-1937" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">join</span>(<span class="st">'path'</span>)</span>
<span id="cb51-1938"><a href="#cb51-1938" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'d'</span><span class="op">,</span> line)<span class="op">;</span></span>
<span id="cb51-1939"><a href="#cb51-1939" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb51-1940"><a href="#cb51-1940" aria-hidden="true" tabindex="-1"></a>  <span class="co">//// Agg: Ctrl, Synth ----------------------------------------------------------</span></span>
<span id="cb51-1941"><a href="#cb51-1941" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-1942"><a href="#cb51-1942" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> pointsCtrlSynthAgg <span class="op">=</span> dataCtrlSynthAgg<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span></span>
<span id="cb51-1943"><a href="#cb51-1943" aria-hidden="true" tabindex="-1"></a>    [<span class="fu">x</span>(d[aggX])<span class="op">,</span> <span class="fu">y</span>(d<span class="op">.</span><span class="at">outcome</span>)<span class="op">,</span> d<span class="op">.</span><span class="at">treat_group</span>]</span>
<span id="cb51-1944"><a href="#cb51-1944" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb51-1945"><a href="#cb51-1945" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> groupsCtrlSynthAgg <span class="op">=</span> d3<span class="op">.</span><span class="fu">group</span>(pointsCtrlSynthAgg<span class="op">,</span> d <span class="kw">=&gt;</span> d[<span class="dv">2</span>])<span class="op">;</span></span>
<span id="cb51-1946"><a href="#cb51-1946" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> pathCtrlSynthAgg <span class="op">=</span> svg<span class="op">.</span><span class="fu">append</span>(<span class="st">'g'</span>)</span>
<span id="cb51-1947"><a href="#cb51-1947" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'fill'</span><span class="op">,</span> <span class="st">'none'</span>)</span>
<span id="cb51-1948"><a href="#cb51-1948" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'stroke-width'</span><span class="op">,</span> <span class="fl">3.5</span>)</span>
<span id="cb51-1949"><a href="#cb51-1949" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'stroke-linejoin'</span><span class="op">,</span> <span class="st">'round'</span>)</span>
<span id="cb51-1950"><a href="#cb51-1950" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'stroke'</span><span class="op">,</span> <span class="st">'springgreen'</span>)</span>
<span id="cb51-1951"><a href="#cb51-1951" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'path'</span>)</span>
<span id="cb51-1952"><a href="#cb51-1952" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(groupsCtrlSynthAgg<span class="op">.</span><span class="fu">values</span>())</span>
<span id="cb51-1953"><a href="#cb51-1953" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">join</span>(<span class="st">'path'</span>)</span>
<span id="cb51-1954"><a href="#cb51-1954" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'d'</span><span class="op">,</span> line)<span class="op">;</span></span>
<span id="cb51-1955"><a href="#cb51-1955" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb51-1956"><a href="#cb51-1956" aria-hidden="true" tabindex="-1"></a>  <span class="co">//// K-12 Overlay ------------------------------------------------------------</span></span>
<span id="cb51-1957"><a href="#cb51-1957" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-1958"><a href="#cb51-1958" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (overlayK12 <span class="op">&amp;&amp;</span> selectedOutcome <span class="op">!==</span> <span class="st">'e027_elem_educ_direct_exp'</span>) {</span>
<span id="cb51-1959"><a href="#cb51-1959" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> pointsK12 <span class="op">=</span> dataK12<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> [<span class="fu">x</span>(d[aggX])<span class="op">,</span> <span class="fu">y</span>(d<span class="op">.</span><span class="at">outcome</span>)<span class="op">,</span> d<span class="op">.</span><span class="at">id</span>])<span class="op">;</span></span>
<span id="cb51-1960"><a href="#cb51-1960" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> groupsK12 <span class="op">=</span> d3<span class="op">.</span><span class="fu">rollup</span>(</span>
<span id="cb51-1961"><a href="#cb51-1961" aria-hidden="true" tabindex="-1"></a>      pointsK12<span class="op">,</span> v <span class="kw">=&gt;</span> <span class="bu">Object</span><span class="op">.</span><span class="fu">assign</span>(v<span class="op">,</span> {<span class="dt">id</span><span class="op">:</span> v[<span class="dv">0</span>][<span class="dv">2</span>]})<span class="op">,</span> d <span class="kw">=&gt;</span> d[<span class="dv">2</span>]</span>
<span id="cb51-1962"><a href="#cb51-1962" aria-hidden="true" tabindex="-1"></a>    )<span class="op">;</span></span>
<span id="cb51-1963"><a href="#cb51-1963" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> pathK12 <span class="op">=</span> svg<span class="op">.</span><span class="fu">append</span>(<span class="st">'g'</span>)</span>
<span id="cb51-1964"><a href="#cb51-1964" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">'fill'</span><span class="op">,</span> <span class="st">'none'</span>)</span>
<span id="cb51-1965"><a href="#cb51-1965" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">'stroke-width'</span><span class="op">,</span> <span class="fl">3.5</span>)</span>
<span id="cb51-1966"><a href="#cb51-1966" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">'stroke-linejoin'</span><span class="op">,</span> <span class="st">'round'</span>)</span>
<span id="cb51-1967"><a href="#cb51-1967" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">'stroke-opacity'</span><span class="op">,</span> <span class="op">.</span><span class="dv">5</span>)</span>
<span id="cb51-1968"><a href="#cb51-1968" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">'stroke-dasharray'</span><span class="op">,</span> <span class="dv">5</span>)</span>
<span id="cb51-1969"><a href="#cb51-1969" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'path'</span>)</span>
<span id="cb51-1970"><a href="#cb51-1970" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">data</span>(groupsK12<span class="op">.</span><span class="fu">values</span>())</span>
<span id="cb51-1971"><a href="#cb51-1971" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">join</span>(<span class="st">'path'</span>)</span>
<span id="cb51-1972"><a href="#cb51-1972" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">'d'</span><span class="op">,</span> line)</span>
<span id="cb51-1973"><a href="#cb51-1973" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">'stroke'</span><span class="op">,</span> ({id}) <span class="kw">=&gt;</span> {</span>
<span id="cb51-1974"><a href="#cb51-1974" aria-hidden="true" tabindex="-1"></a>        <span class="kw">let</span> out <span class="op">=</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb51-1975"><a href="#cb51-1975" aria-hidden="true" tabindex="-1"></a>        <span class="cf">switch</span> (id) {</span>
<span id="cb51-1976"><a href="#cb51-1976" aria-hidden="true" tabindex="-1"></a>          <span class="cf">case</span> <span class="st">'treat group'</span><span class="op">:</span></span>
<span id="cb51-1977"><a href="#cb51-1977" aria-hidden="true" tabindex="-1"></a>            out <span class="op">=</span> <span class="st">'deeppink'</span><span class="op">;</span></span>
<span id="cb51-1978"><a href="#cb51-1978" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span><span class="op">;</span></span>
<span id="cb51-1979"><a href="#cb51-1979" aria-hidden="true" tabindex="-1"></a>          <span class="cf">case</span> <span class="st">'ctrl did'</span><span class="op">:</span></span>
<span id="cb51-1980"><a href="#cb51-1980" aria-hidden="true" tabindex="-1"></a>            out <span class="op">=</span> <span class="st">'deepskyblue'</span><span class="op">;</span></span>
<span id="cb51-1981"><a href="#cb51-1981" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span><span class="op">;</span></span>
<span id="cb51-1982"><a href="#cb51-1982" aria-hidden="true" tabindex="-1"></a>          <span class="cf">case</span> <span class="st">'ctrl synth'</span><span class="op">:</span></span>
<span id="cb51-1983"><a href="#cb51-1983" aria-hidden="true" tabindex="-1"></a>            out <span class="op">=</span> <span class="st">'springgreen'</span><span class="op">;</span></span>
<span id="cb51-1984"><a href="#cb51-1984" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span><span class="op">;</span></span>
<span id="cb51-1985"><a href="#cb51-1985" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb51-1986"><a href="#cb51-1986" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> out<span class="op">;</span></span>
<span id="cb51-1987"><a href="#cb51-1987" aria-hidden="true" tabindex="-1"></a>      })<span class="op">;</span></span>
<span id="cb51-1988"><a href="#cb51-1988" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb51-1989"><a href="#cb51-1989" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb51-1990"><a href="#cb51-1990" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Tooltip ===================================================================</span></span>
<span id="cb51-1991"><a href="#cb51-1991" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-1992"><a href="#cb51-1992" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> tooltip <span class="op">=</span> svg<span class="op">.</span><span class="fu">append</span>(<span class="st">'text'</span>)  </span>
<span id="cb51-1993"><a href="#cb51-1993" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'display'</span><span class="op">,</span> <span class="st">'none'</span>)</span>
<span id="cb51-1994"><a href="#cb51-1994" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'text-anchor'</span><span class="op">,</span> <span class="st">'middle'</span>)</span>
<span id="cb51-1995"><a href="#cb51-1995" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> <span class="op">-</span><span class="dv">8</span>)<span class="op">;</span></span>
<span id="cb51-1996"><a href="#cb51-1996" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb51-1997"><a href="#cb51-1997" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Title =====================================================================</span></span>
<span id="cb51-1998"><a href="#cb51-1998" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-1999"><a href="#cb51-1999" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> title <span class="op">=</span> <span class="ss">/</span><span class="sc">^</span><span class="ss">es</span><span class="sc">?</span><span class="ss">$</span><span class="sc">|</span><span class="ss">event/</span><span class="op">.</span><span class="fu">test</span>(aggType) <span class="op">?</span> </span>
<span id="cb51-2000"><a href="#cb51-2000" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Event Study'</span> <span class="op">:</span> <span class="st">'Post-Treatment Trends'</span><span class="op">;</span></span>
<span id="cb51-2001"><a href="#cb51-2001" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">append</span>(<span class="st">'text'</span>)</span>
<span id="cb51-2002"><a href="#cb51-2002" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x'</span><span class="op">,</span> width <span class="op">/</span> <span class="dv">2</span>)</span>
<span id="cb51-2003"><a href="#cb51-2003" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> margin<span class="op">.</span><span class="at">top</span> <span class="op">-</span> <span class="dv">2</span>)</span>
<span id="cb51-2004"><a href="#cb51-2004" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'text-anchor'</span><span class="op">,</span> <span class="st">'middle'</span>)</span>
<span id="cb51-2005"><a href="#cb51-2005" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">style</span>(<span class="st">'font-size'</span><span class="op">,</span> <span class="st">'14px'</span>)</span>
<span id="cb51-2006"><a href="#cb51-2006" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">text</span>(title)<span class="op">;</span></span>
<span id="cb51-2007"><a href="#cb51-2007" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb51-2008"><a href="#cb51-2008" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Event Listeners ===========================================================</span></span>
<span id="cb51-2009"><a href="#cb51-2009" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-2010"><a href="#cb51-2010" aria-hidden="true" tabindex="-1"></a>  svg</span>
<span id="cb51-2011"><a href="#cb51-2011" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">on</span>(<span class="st">'pointermove'</span><span class="op">,</span> pointerMoved)</span>
<span id="cb51-2012"><a href="#cb51-2012" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">on</span>(<span class="st">'pointerleave'</span><span class="op">,</span> pointerLeft)<span class="op">;</span></span>
<span id="cb51-2013"><a href="#cb51-2013" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb51-2014"><a href="#cb51-2014" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> svg<span class="op">.</span><span class="fu">node</span>()<span class="op">;</span></span>
<span id="cb51-2015"><a href="#cb51-2015" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-2016"><a href="#cb51-2016" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Event Handler Functions ===================================================</span></span>
<span id="cb51-2017"><a href="#cb51-2017" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-2018"><a href="#cb51-2018" aria-hidden="true" tabindex="-1"></a>  <span class="co">//// Pointer moved -----------------------------------------------------------</span></span>
<span id="cb51-2019"><a href="#cb51-2019" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-2020"><a href="#cb51-2020" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">pointerMoved</span>(<span class="bu">event</span>) {</span>
<span id="cb51-2021"><a href="#cb51-2021" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> [xm<span class="op">,</span> ym] <span class="op">=</span> d3<span class="op">.</span><span class="fu">pointer</span>(<span class="bu">event</span>)<span class="op">;</span></span>
<span id="cb51-2022"><a href="#cb51-2022" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> allPoints <span class="op">=</span> [<span class="op">...</span>pointsTreat<span class="op">,</span> <span class="op">...</span>pointsCtrlDiD<span class="op">,</span> <span class="op">...</span>pointsCtrlSynth]<span class="op">;</span></span>
<span id="cb51-2023"><a href="#cb51-2023" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> i <span class="op">=</span> d3<span class="op">.</span><span class="fu">leastIndex</span>(allPoints<span class="op">,</span> ([x<span class="op">,</span> y]) <span class="kw">=&gt;</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">hypot</span>(x <span class="op">-</span> xm<span class="op">,</span> y <span class="op">-</span> ym))<span class="op">;</span></span>
<span id="cb51-2024"><a href="#cb51-2024" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> [xHover<span class="op">,</span> yHover<span class="op">,</span> hoveredGroup] <span class="op">=</span> allPoints[i]<span class="op">;</span></span>
<span id="cb51-2025"><a href="#cb51-2025" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb51-2026"><a href="#cb51-2026" aria-hidden="true" tabindex="-1"></a>    pathTreat</span>
<span id="cb51-2027"><a href="#cb51-2027" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">style</span>(<span class="st">'stroke-width'</span><span class="op">,</span> ({group}) <span class="kw">=&gt;</span> group <span class="op">===</span> hoveredGroup <span class="op">?</span> <span class="dv">7</span> <span class="op">:</span> <span class="kw">null</span>)</span>
<span id="cb51-2028"><a href="#cb51-2028" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">filter</span>(({group}) <span class="kw">=&gt;</span> group <span class="op">===</span> hoveredGroup)</span>
<span id="cb51-2029"><a href="#cb51-2029" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">raise</span>()<span class="op">;</span></span>
<span id="cb51-2030"><a href="#cb51-2030" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb51-2031"><a href="#cb51-2031" aria-hidden="true" tabindex="-1"></a>    pathCtrlDiD</span>
<span id="cb51-2032"><a href="#cb51-2032" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">style</span>(<span class="st">'stroke-width'</span><span class="op">,</span> ({group}) <span class="kw">=&gt;</span> group <span class="op">===</span> hoveredGroup <span class="op">?</span> <span class="dv">7</span> <span class="op">:</span> <span class="kw">null</span>)</span>
<span id="cb51-2033"><a href="#cb51-2033" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">filter</span>(({group}) <span class="kw">=&gt;</span> group <span class="op">===</span> hoveredGroup)</span>
<span id="cb51-2034"><a href="#cb51-2034" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">raise</span>()<span class="op">;</span></span>
<span id="cb51-2035"><a href="#cb51-2035" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb51-2036"><a href="#cb51-2036" aria-hidden="true" tabindex="-1"></a>    pathCtrlSynth</span>
<span id="cb51-2037"><a href="#cb51-2037" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">style</span>(<span class="st">'stroke-width'</span><span class="op">,</span> ({group}) <span class="kw">=&gt;</span> group <span class="op">===</span> hoveredGroup <span class="op">?</span> <span class="dv">7</span> <span class="op">:</span> <span class="kw">null</span>)</span>
<span id="cb51-2038"><a href="#cb51-2038" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">filter</span>(({group}) <span class="kw">=&gt;</span> group <span class="op">===</span> hoveredGroup)</span>
<span id="cb51-2039"><a href="#cb51-2039" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">raise</span>()<span class="op">;</span></span>
<span id="cb51-2040"><a href="#cb51-2040" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb51-2041"><a href="#cb51-2041" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (showSubgroups <span class="op">&amp;</span> subgroupsToShow<span class="op">.</span><span class="at">length</span> <span class="op">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb51-2042"><a href="#cb51-2042" aria-hidden="true" tabindex="-1"></a>      tooltip</span>
<span id="cb51-2043"><a href="#cb51-2043" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">html</span>(hoveredGroup<span class="op">.</span><span class="fu">replace</span>(<span class="ss">/treat</span><span class="sc">|</span><span class="ss">did</span><span class="sc">|</span><span class="ss">synth/</span><span class="op">,</span> <span class="st">''</span>))</span>
<span id="cb51-2044"><a href="#cb51-2044" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">'transform'</span><span class="op">,</span> <span class="vs">`translate(</span><span class="sc">${</span>xHover<span class="sc">}</span><span class="vs">, </span><span class="sc">${</span>yHover<span class="sc">}</span><span class="vs">)`</span>)</span>
<span id="cb51-2045"><a href="#cb51-2045" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">'display'</span><span class="op">,</span> <span class="kw">null</span>)<span class="op">;</span></span>
<span id="cb51-2046"><a href="#cb51-2046" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb51-2047"><a href="#cb51-2047" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb51-2048"><a href="#cb51-2048" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-2049"><a href="#cb51-2049" aria-hidden="true" tabindex="-1"></a>  <span class="co">//// Pointer left ------------------------------------------------------------</span></span>
<span id="cb51-2050"><a href="#cb51-2050" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-2051"><a href="#cb51-2051" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">pointerLeft</span>() {</span>
<span id="cb51-2052"><a href="#cb51-2052" aria-hidden="true" tabindex="-1"></a>    pathTreat<span class="op">.</span><span class="fu">style</span>(<span class="st">'stroke-width'</span><span class="op">,</span> <span class="kw">null</span>)<span class="op">;</span></span>
<span id="cb51-2053"><a href="#cb51-2053" aria-hidden="true" tabindex="-1"></a>    pathCtrlDiD<span class="op">.</span><span class="fu">style</span>(<span class="st">'stroke-width'</span><span class="op">,</span> <span class="kw">null</span>)<span class="op">;</span></span>
<span id="cb51-2054"><a href="#cb51-2054" aria-hidden="true" tabindex="-1"></a>    pathCtrlSynth<span class="op">.</span><span class="fu">style</span>(<span class="st">'stroke-width'</span><span class="op">,</span> <span class="kw">null</span>)<span class="op">;</span></span>
<span id="cb51-2055"><a href="#cb51-2055" aria-hidden="true" tabindex="-1"></a>    tooltip<span class="op">.</span><span class="fu">attr</span>(<span class="st">'display'</span><span class="op">,</span> <span class="st">'none'</span>)<span class="op">;</span></span>
<span id="cb51-2056"><a href="#cb51-2056" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb51-2057"><a href="#cb51-2057" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display hidden">
<div id="ojs-cell-50" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell hidden">
<div class="sourceCode cell-code hidden" id="cb52" data-startfrom="2066" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 2065;"><span id="cb52-2066"><a href="#cb52-2066" aria-hidden="true" tabindex="-1"></a>plotAggResults <span class="op">=</span> <span class="kw">function</span>(aggType) {</span>
<span id="cb52-2067"><a href="#cb52-2067" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-2068"><a href="#cb52-2068" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Data Setup ================================================================</span></span>
<span id="cb52-2069"><a href="#cb52-2069" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-2070"><a href="#cb52-2070" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> aggX <span class="op">=</span> <span class="ss">/</span><span class="sc">^</span><span class="ss">es</span><span class="sc">?</span><span class="ss">$</span><span class="sc">|</span><span class="ss">event/</span><span class="op">.</span><span class="fu">test</span>(aggType) <span class="op">?</span> <span class="st">'e'</span> <span class="op">:</span> <span class="st">'year'</span><span class="op">;</span></span>
<span id="cb52-2071"><a href="#cb52-2071" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> aggCol <span class="op">=</span> dropAK <span class="op">?</span> <span class="ss">/aggregate.</span><span class="sc">+</span><span class="ss">no ak/</span> <span class="op">:</span> <span class="ss">/aggregate</span><span class="sc">(?</span><span class="ss">!.</span><span class="sc">+</span><span class="ss">no ak</span><span class="sc">)</span><span class="ss">/</span><span class="op">;</span></span>
<span id="cb52-2072"><a href="#cb52-2072" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-2073"><a href="#cb52-2073" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Main</span></span>
<span id="cb52-2074"><a href="#cb52-2074" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> resDiD <span class="op">=</span> dataResDiDUseG<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span></span>
<span id="cb52-2075"><a href="#cb52-2075" aria-hidden="true" tabindex="-1"></a>    aggCol<span class="op">.</span><span class="fu">test</span>(d<span class="op">.</span><span class="at">treat_group</span>) <span class="op">&amp;&amp;</span> d[aggX] <span class="op">!==</span> <span class="kw">null</span></span>
<span id="cb52-2076"><a href="#cb52-2076" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb52-2077"><a href="#cb52-2077" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> resSynth <span class="op">=</span> dataResSynthUseSt<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span></span>
<span id="cb52-2078"><a href="#cb52-2078" aria-hidden="true" tabindex="-1"></a>    aggCol<span class="op">.</span><span class="fu">test</span>(d<span class="op">.</span><span class="at">treat_group</span>) <span class="op">&amp;&amp;</span> d[aggX] <span class="op">!==</span> <span class="kw">null</span></span>
<span id="cb52-2079"><a href="#cb52-2079" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb52-2080"><a href="#cb52-2080" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-2081"><a href="#cb52-2081" aria-hidden="true" tabindex="-1"></a>  <span class="co">// K12</span></span>
<span id="cb52-2082"><a href="#cb52-2082" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> resK12<span class="op">,</span> resK12Synth<span class="op">,</span> resK12DiD <span class="op">=</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb52-2083"><a href="#cb52-2083" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (overlayK12 <span class="op">&amp;&amp;</span> selectedOutcome <span class="op">!==</span> <span class="st">'e027_elem_educ_direct_exp'</span>) {</span>
<span id="cb52-2084"><a href="#cb52-2084" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (ctrlSpecDiD <span class="op">!==</span> <span class="st">'none'</span> <span class="op">&amp;&amp;</span> ctrlSpecSynth <span class="op">!==</span> <span class="st">'none'</span>) {</span>
<span id="cb52-2085"><a href="#cb52-2085" aria-hidden="true" tabindex="-1"></a>      resK12DiD <span class="op">=</span> dataResK12UseG<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span></span>
<span id="cb52-2086"><a href="#cb52-2086" aria-hidden="true" tabindex="-1"></a>        aggCol<span class="op">.</span><span class="fu">test</span>(d<span class="op">.</span><span class="at">treat_group</span>) <span class="op">&amp;&amp;</span> d[aggX] <span class="op">!==</span> <span class="kw">null</span> <span class="op">&amp;&amp;</span> d<span class="op">.</span><span class="at">id</span> <span class="op">===</span> <span class="st">'did'</span></span>
<span id="cb52-2087"><a href="#cb52-2087" aria-hidden="true" tabindex="-1"></a>      )<span class="op">;</span></span>
<span id="cb52-2088"><a href="#cb52-2088" aria-hidden="true" tabindex="-1"></a>      resK12Synth <span class="op">=</span> dataResK12UseSt<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span></span>
<span id="cb52-2089"><a href="#cb52-2089" aria-hidden="true" tabindex="-1"></a>        aggCol<span class="op">.</span><span class="fu">test</span>(d<span class="op">.</span><span class="at">treat_group</span>) <span class="op">&amp;&amp;</span> d[aggX] <span class="op">!==</span> <span class="kw">null</span> <span class="op">&amp;&amp;</span> d<span class="op">.</span><span class="at">id</span> <span class="op">===</span> <span class="st">'synth'</span></span>
<span id="cb52-2090"><a href="#cb52-2090" aria-hidden="true" tabindex="-1"></a>      )<span class="op">;</span></span>
<span id="cb52-2091"><a href="#cb52-2091" aria-hidden="true" tabindex="-1"></a>      resK12 <span class="op">=</span> [<span class="op">...</span>resK12DiD<span class="op">,</span> <span class="op">...</span>resK12Synth]<span class="op">;</span></span>
<span id="cb52-2092"><a href="#cb52-2092" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (ctrlSpecDiD <span class="op">!==</span> <span class="st">'none'</span> <span class="op">&amp;&amp;</span> ctrlSpecSynth <span class="op">===</span> <span class="st">'none'</span>) {</span>
<span id="cb52-2093"><a href="#cb52-2093" aria-hidden="true" tabindex="-1"></a>      resK12 <span class="op">=</span> dataResK12UseG<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span></span>
<span id="cb52-2094"><a href="#cb52-2094" aria-hidden="true" tabindex="-1"></a>        aggCol<span class="op">.</span><span class="fu">test</span>(d<span class="op">.</span><span class="at">treat_group</span>) <span class="op">&amp;&amp;</span> d[aggX] <span class="op">!==</span> <span class="kw">null</span> <span class="op">&amp;&amp;</span> d<span class="op">.</span><span class="at">id</span> <span class="op">===</span> <span class="st">'did'</span></span>
<span id="cb52-2095"><a href="#cb52-2095" aria-hidden="true" tabindex="-1"></a>      )<span class="op">;</span></span>
<span id="cb52-2096"><a href="#cb52-2096" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (ctrlSpecDiD <span class="op">===</span> <span class="st">'none'</span> <span class="op">&amp;&amp;</span> ctrlSpecSynth <span class="op">!==</span> <span class="st">'none'</span>) {</span>
<span id="cb52-2097"><a href="#cb52-2097" aria-hidden="true" tabindex="-1"></a>      resK12 <span class="op">=</span> dataResK12UseSt<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span></span>
<span id="cb52-2098"><a href="#cb52-2098" aria-hidden="true" tabindex="-1"></a>        aggCol<span class="op">.</span><span class="fu">test</span>(d<span class="op">.</span><span class="at">treat_group</span>) <span class="op">&amp;&amp;</span> d[aggX] <span class="op">!==</span> <span class="kw">null</span> <span class="op">&amp;&amp;</span> d<span class="op">.</span><span class="at">id</span> <span class="op">===</span> <span class="st">'synth'</span></span>
<span id="cb52-2099"><a href="#cb52-2099" aria-hidden="true" tabindex="-1"></a>      )<span class="op">;</span></span>
<span id="cb52-2100"><a href="#cb52-2100" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb52-2101"><a href="#cb52-2101" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb52-2102"><a href="#cb52-2102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-2103"><a href="#cb52-2103" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Scale Functions ===========================================================</span></span>
<span id="cb52-2104"><a href="#cb52-2104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-2105"><a href="#cb52-2105" aria-hidden="true" tabindex="-1"></a>  <span class="co">//// Find min &amp; max y and x values</span></span>
<span id="cb52-2106"><a href="#cb52-2106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-2107"><a href="#cb52-2107" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> minX<span class="op">,</span> maxX<span class="op">,</span> minY<span class="op">,</span> maxY<span class="op">,</span> minYVar<span class="op">,</span> maxYVar <span class="op">=</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb52-2108"><a href="#cb52-2108" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (showCI) {</span>
<span id="cb52-2109"><a href="#cb52-2109" aria-hidden="true" tabindex="-1"></a>    minYVar <span class="op">=</span> <span class="st">'ci_low'</span><span class="op">;</span></span>
<span id="cb52-2110"><a href="#cb52-2110" aria-hidden="true" tabindex="-1"></a>    maxYVar <span class="op">=</span> <span class="st">'ci_up'</span><span class="op">;</span></span>
<span id="cb52-2111"><a href="#cb52-2111" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb52-2112"><a href="#cb52-2112" aria-hidden="true" tabindex="-1"></a>    minYVar <span class="op">=</span> <span class="st">'att'</span><span class="op">;</span></span>
<span id="cb52-2113"><a href="#cb52-2113" aria-hidden="true" tabindex="-1"></a>    maxYVar <span class="op">=</span> <span class="st">'att'</span><span class="op">;</span></span>
<span id="cb52-2114"><a href="#cb52-2114" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb52-2115"><a href="#cb52-2115" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (ctrlSpecDiD <span class="op">!==</span> <span class="st">'none'</span> <span class="op">&amp;&amp;</span> ctrlSpecSynth <span class="op">!==</span> <span class="st">'none'</span>) {</span>
<span id="cb52-2116"><a href="#cb52-2116" aria-hidden="true" tabindex="-1"></a>    minX <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">min</span>(d3<span class="op">.</span><span class="fu">min</span>(resSynth<span class="op">,</span> d <span class="kw">=&gt;</span> d[aggX])<span class="op">,</span> d3<span class="op">.</span><span class="fu">min</span>(resDiD<span class="op">,</span> d <span class="kw">=&gt;</span> d[aggX]))<span class="op">;</span></span>
<span id="cb52-2117"><a href="#cb52-2117" aria-hidden="true" tabindex="-1"></a>    maxX <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">max</span>(d3<span class="op">.</span><span class="fu">max</span>(resSynth<span class="op">,</span> d <span class="kw">=&gt;</span> d[aggX])<span class="op">,</span> d3<span class="op">.</span><span class="fu">max</span>(resDiD<span class="op">,</span> d <span class="kw">=&gt;</span> d[aggX]))<span class="op">;</span></span>
<span id="cb52-2118"><a href="#cb52-2118" aria-hidden="true" tabindex="-1"></a>    minY <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">min</span>(</span>
<span id="cb52-2119"><a href="#cb52-2119" aria-hidden="true" tabindex="-1"></a>      d3<span class="op">.</span><span class="fu">min</span>(resSynth<span class="op">,</span> d <span class="kw">=&gt;</span> d[minYVar])<span class="op">,</span></span>
<span id="cb52-2120"><a href="#cb52-2120" aria-hidden="true" tabindex="-1"></a>      d3<span class="op">.</span><span class="fu">min</span>(resDiD<span class="op">,</span> d <span class="kw">=&gt;</span> d[minYVar])</span>
<span id="cb52-2121"><a href="#cb52-2121" aria-hidden="true" tabindex="-1"></a>    )<span class="op">;</span></span>
<span id="cb52-2122"><a href="#cb52-2122" aria-hidden="true" tabindex="-1"></a>    maxY <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">max</span>(</span>
<span id="cb52-2123"><a href="#cb52-2123" aria-hidden="true" tabindex="-1"></a>      d3<span class="op">.</span><span class="fu">max</span>(resSynth<span class="op">,</span> d <span class="kw">=&gt;</span> d[maxYVar])<span class="op">,</span></span>
<span id="cb52-2124"><a href="#cb52-2124" aria-hidden="true" tabindex="-1"></a>      d3<span class="op">.</span><span class="fu">max</span>(resDiD<span class="op">,</span> d <span class="kw">=&gt;</span> d[maxYVar])</span>
<span id="cb52-2125"><a href="#cb52-2125" aria-hidden="true" tabindex="-1"></a>    )<span class="op">;</span></span>
<span id="cb52-2126"><a href="#cb52-2126" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (ctrlSpecDiD <span class="op">===</span> <span class="st">'none'</span> <span class="op">&amp;&amp;</span> ctrlSpecSynth <span class="op">!==</span> <span class="st">'none'</span>) {</span>
<span id="cb52-2127"><a href="#cb52-2127" aria-hidden="true" tabindex="-1"></a>    minX <span class="op">=</span> d3<span class="op">.</span><span class="fu">min</span>(resSynth<span class="op">,</span> d <span class="kw">=&gt;</span> d[aggX])<span class="op">;</span></span>
<span id="cb52-2128"><a href="#cb52-2128" aria-hidden="true" tabindex="-1"></a>    maxX <span class="op">=</span> d3<span class="op">.</span><span class="fu">max</span>(resSynth<span class="op">,</span> d <span class="kw">=&gt;</span> d[aggX])<span class="op">;</span></span>
<span id="cb52-2129"><a href="#cb52-2129" aria-hidden="true" tabindex="-1"></a>    minY <span class="op">=</span> d3<span class="op">.</span><span class="fu">min</span>(resSynth<span class="op">,</span> d <span class="kw">=&gt;</span> d[minYVar])<span class="op">;</span></span>
<span id="cb52-2130"><a href="#cb52-2130" aria-hidden="true" tabindex="-1"></a>    maxY <span class="op">=</span> d3<span class="op">.</span><span class="fu">max</span>(resSynth<span class="op">,</span> d <span class="kw">=&gt;</span> d[maxYVar])<span class="op">;</span></span>
<span id="cb52-2131"><a href="#cb52-2131" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (ctrlSpecDiD <span class="op">!==</span> <span class="st">'none'</span> <span class="op">&amp;&amp;</span> ctrlSpecSynth <span class="op">===</span> <span class="st">'none'</span>) {</span>
<span id="cb52-2132"><a href="#cb52-2132" aria-hidden="true" tabindex="-1"></a>    minX <span class="op">=</span> d3<span class="op">.</span><span class="fu">min</span>(resDiD<span class="op">,</span> d <span class="kw">=&gt;</span> d[aggX])<span class="op">;</span></span>
<span id="cb52-2133"><a href="#cb52-2133" aria-hidden="true" tabindex="-1"></a>    maxX <span class="op">=</span> d3<span class="op">.</span><span class="fu">max</span>(resDiD<span class="op">,</span> d <span class="kw">=&gt;</span> d[aggX])<span class="op">;</span></span>
<span id="cb52-2134"><a href="#cb52-2134" aria-hidden="true" tabindex="-1"></a>    minY <span class="op">=</span> d3<span class="op">.</span><span class="fu">min</span>(resDiD<span class="op">,</span> d <span class="kw">=&gt;</span> d[minYVar])<span class="op">;</span></span>
<span id="cb52-2135"><a href="#cb52-2135" aria-hidden="true" tabindex="-1"></a>    maxY <span class="op">=</span> d3<span class="op">.</span><span class="fu">max</span>(resDiD<span class="op">,</span> d <span class="kw">=&gt;</span> d[maxYVar])<span class="op">;</span></span>
<span id="cb52-2136"><a href="#cb52-2136" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb52-2137"><a href="#cb52-2137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-2138"><a href="#cb52-2138" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (</span>
<span id="cb52-2139"><a href="#cb52-2139" aria-hidden="true" tabindex="-1"></a>    overlayK12 <span class="op">&amp;&amp;</span> selectedOutcome <span class="op">!==</span> <span class="st">'e027_elem_educ_direct_exp'</span></span>
<span id="cb52-2140"><a href="#cb52-2140" aria-hidden="true" tabindex="-1"></a>      <span class="op">&amp;&amp;</span> <span class="op">!</span>(ctrlSpecDiD <span class="op">===</span> <span class="st">'none'</span> <span class="op">&amp;&amp;</span> ctrlSpecSynth <span class="op">===</span> <span class="st">'none'</span>)</span>
<span id="cb52-2141"><a href="#cb52-2141" aria-hidden="true" tabindex="-1"></a>  ) {</span>
<span id="cb52-2142"><a href="#cb52-2142" aria-hidden="true" tabindex="-1"></a>    minY <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">min</span>(minY<span class="op">,</span> d3<span class="op">.</span><span class="fu">min</span>(resK12<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">att</span>))<span class="op">;</span></span>
<span id="cb52-2143"><a href="#cb52-2143" aria-hidden="true" tabindex="-1"></a>    maxY <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">max</span>(maxY<span class="op">,</span> d3<span class="op">.</span><span class="fu">max</span>(resK12<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">att</span>))<span class="op">;</span></span>
<span id="cb52-2144"><a href="#cb52-2144" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb52-2145"><a href="#cb52-2145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-2146"><a href="#cb52-2146" aria-hidden="true" tabindex="-1"></a>  <span class="co">//// Define scale functions --------------------------------------------------</span></span>
<span id="cb52-2147"><a href="#cb52-2147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-2148"><a href="#cb52-2148" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> x <span class="op">=</span> d3<span class="op">.</span><span class="fu">scaleLinear</span>()</span>
<span id="cb52-2149"><a href="#cb52-2149" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">domain</span>([minX<span class="op">,</span> maxX])</span>
<span id="cb52-2150"><a href="#cb52-2150" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">range</span>([margin<span class="op">.</span><span class="at">left</span><span class="op">,</span> width <span class="op">-</span> margin<span class="op">.</span><span class="at">right</span>])<span class="op">;</span></span>
<span id="cb52-2151"><a href="#cb52-2151" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> y <span class="op">=</span> d3<span class="op">.</span><span class="fu">scaleLinear</span>()</span>
<span id="cb52-2152"><a href="#cb52-2152" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">domain</span>([minY<span class="op">,</span> maxY])</span>
<span id="cb52-2153"><a href="#cb52-2153" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">range</span>([height <span class="op">-</span> margin<span class="op">.</span><span class="at">bottom</span><span class="op">,</span> margin<span class="op">.</span><span class="at">top</span>])</span>
<span id="cb52-2154"><a href="#cb52-2154" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">nice</span>()<span class="op">;</span></span>
<span id="cb52-2155"><a href="#cb52-2155" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb52-2156"><a href="#cb52-2156" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Parent SVG ================================================================</span></span>
<span id="cb52-2157"><a href="#cb52-2157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-2158"><a href="#cb52-2158" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> svg <span class="op">=</span> d3<span class="op">.</span><span class="fu">create</span>(<span class="st">'svg'</span>)</span>
<span id="cb52-2159"><a href="#cb52-2159" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'width'</span><span class="op">,</span> width)</span>
<span id="cb52-2160"><a href="#cb52-2160" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'height'</span><span class="op">,</span> height)<span class="op">;</span></span>
<span id="cb52-2161"><a href="#cb52-2161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-2162"><a href="#cb52-2162" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Axes ======================================================================</span></span>
<span id="cb52-2163"><a href="#cb52-2163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-2164"><a href="#cb52-2164" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> xAxis <span class="op">=</span> d3<span class="op">.</span><span class="fu">axisBottom</span>(x)</span>
<span id="cb52-2165"><a href="#cb52-2165" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">ticks</span>(tickNumX)</span>
<span id="cb52-2166"><a href="#cb52-2166" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">tickFormat</span>(d3<span class="op">.</span><span class="fu">format</span>(<span class="st">'d'</span>))<span class="op">;</span></span>
<span id="cb52-2167"><a href="#cb52-2167" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> yAxis <span class="op">=</span> d3<span class="op">.</span><span class="fu">axisLeft</span>(y)</span>
<span id="cb52-2168"><a href="#cb52-2168" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">ticks</span>(tickNumY)<span class="op">;</span></span>
<span id="cb52-2169"><a href="#cb52-2169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-2170"><a href="#cb52-2170" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">append</span>(<span class="st">'g'</span>)</span>
<span id="cb52-2171"><a href="#cb52-2171" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'transform'</span><span class="op">,</span> <span class="vs">`translate(0, </span><span class="sc">${</span>height <span class="op">-</span> margin<span class="op">.</span><span class="at">bottom</span><span class="sc">}</span><span class="vs">)`</span>)</span>
<span id="cb52-2172"><a href="#cb52-2172" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">call</span>(xAxis)</span>
<span id="cb52-2173"><a href="#cb52-2173" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.tick text'</span>)</span>
<span id="cb52-2174"><a href="#cb52-2174" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'font-size'</span><span class="op">,</span> <span class="st">'12px'</span>)<span class="op">;</span></span>
<span id="cb52-2175"><a href="#cb52-2175" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">append</span>(<span class="st">'g'</span>)</span>
<span id="cb52-2176"><a href="#cb52-2176" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'transform'</span><span class="op">,</span> <span class="vs">`translate(</span><span class="sc">${</span>margin<span class="op">.</span><span class="at">left</span><span class="sc">}</span><span class="vs">, 0)`</span>)</span>
<span id="cb52-2177"><a href="#cb52-2177" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">call</span>(yAxis)</span>
<span id="cb52-2178"><a href="#cb52-2178" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.tick text'</span>)</span>
<span id="cb52-2179"><a href="#cb52-2179" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'font-size'</span><span class="op">,</span> <span class="st">'12px'</span>)<span class="op">;</span></span>
<span id="cb52-2180"><a href="#cb52-2180" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb52-2181"><a href="#cb52-2181" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Horizontal Line at y = 0 ==================================================</span></span>
<span id="cb52-2182"><a href="#cb52-2182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-2183"><a href="#cb52-2183" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">append</span>(<span class="st">'line'</span>)</span>
<span id="cb52-2184"><a href="#cb52-2184" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'stroke-width'</span><span class="op">,</span> <span class="dv">2</span>)</span>
<span id="cb52-2185"><a href="#cb52-2185" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'stroke'</span><span class="op">,</span> <span class="st">'black'</span>)</span>
<span id="cb52-2186"><a href="#cb52-2186" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x1'</span><span class="op">,</span> <span class="fu">x</span>(minX))</span>
<span id="cb52-2187"><a href="#cb52-2187" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x2'</span><span class="op">,</span> <span class="fu">x</span>(maxX))</span>
<span id="cb52-2188"><a href="#cb52-2188" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y1'</span><span class="op">,</span> <span class="fu">y</span>(<span class="dv">0</span>))</span>
<span id="cb52-2189"><a href="#cb52-2189" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y2'</span><span class="op">,</span> <span class="fu">y</span>(<span class="dv">0</span>))</span>
<span id="cb52-2190"><a href="#cb52-2190" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb52-2191"><a href="#cb52-2191" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Treat Year Vertical Line ==================================================</span></span>
<span id="cb52-2192"><a href="#cb52-2192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-2193"><a href="#cb52-2193" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="ss">/</span><span class="sc">^</span><span class="ss">es</span><span class="sc">?</span><span class="ss">$</span><span class="sc">|</span><span class="ss">event/</span><span class="op">.</span><span class="fu">test</span>(aggType)) {</span>
<span id="cb52-2194"><a href="#cb52-2194" aria-hidden="true" tabindex="-1"></a>    svg<span class="op">.</span><span class="fu">append</span>(<span class="st">'line'</span>)</span>
<span id="cb52-2195"><a href="#cb52-2195" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">'stroke-width'</span><span class="op">,</span> <span class="dv">2</span>)</span>
<span id="cb52-2196"><a href="#cb52-2196" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">'stroke'</span><span class="op">,</span> <span class="st">'black'</span>)</span>
<span id="cb52-2197"><a href="#cb52-2197" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">'stroke-dasharray'</span><span class="op">,</span> <span class="dv">5</span>)</span>
<span id="cb52-2198"><a href="#cb52-2198" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x1'</span><span class="op">,</span> <span class="fu">x</span>(<span class="op">-</span><span class="dv">1</span>))</span>
<span id="cb52-2199"><a href="#cb52-2199" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x2'</span><span class="op">,</span> <span class="fu">x</span>(<span class="op">-</span><span class="dv">1</span>))</span>
<span id="cb52-2200"><a href="#cb52-2200" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y1'</span><span class="op">,</span> margin<span class="op">.</span><span class="at">top</span>)</span>
<span id="cb52-2201"><a href="#cb52-2201" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y2'</span><span class="op">,</span> height <span class="op">-</span> margin<span class="op">.</span><span class="at">bottom</span>)<span class="op">;</span></span>
<span id="cb52-2202"><a href="#cb52-2202" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb52-2203"><a href="#cb52-2203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-2204"><a href="#cb52-2204" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Results Lines =============================================================</span></span>
<span id="cb52-2205"><a href="#cb52-2205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-2206"><a href="#cb52-2206" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> line <span class="op">=</span> d3<span class="op">.</span><span class="fu">line</span>()</span>
<span id="cb52-2207"><a href="#cb52-2207" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">defined</span>(d <span class="kw">=&gt;</span> <span class="op">!</span><span class="pp">isNaN</span>(d[<span class="dv">1</span>]) <span class="op">&amp;</span> d[<span class="dv">1</span>] <span class="op">!==</span> <span class="kw">undefined</span> <span class="op">&amp;</span> d[<span class="dv">1</span>] <span class="op">!==</span> <span class="kw">null</span>)<span class="op">;</span></span>
<span id="cb52-2208"><a href="#cb52-2208" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb52-2209"><a href="#cb52-2209" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> ci <span class="op">=</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb52-2210"><a href="#cb52-2210" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (showCI) {</span>
<span id="cb52-2211"><a href="#cb52-2211" aria-hidden="true" tabindex="-1"></a>    ci <span class="op">=</span> d3<span class="op">.</span><span class="fu">area</span>()</span>
<span id="cb52-2212"><a href="#cb52-2212" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">defined</span>(d <span class="kw">=&gt;</span> <span class="op">!</span><span class="pp">isNaN</span>(d[<span class="dv">1</span>]) <span class="op">&amp;</span> d[<span class="dv">1</span>] <span class="op">!==</span> <span class="kw">undefined</span> <span class="op">&amp;</span> d[<span class="dv">1</span>] <span class="op">!==</span> <span class="kw">null</span>)</span>
<span id="cb52-2213"><a href="#cb52-2213" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">x</span>(d <span class="kw">=&gt;</span> d[<span class="dv">0</span>])</span>
<span id="cb52-2214"><a href="#cb52-2214" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">y0</span>(d <span class="kw">=&gt;</span> d[<span class="dv">4</span>])</span>
<span id="cb52-2215"><a href="#cb52-2215" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">y1</span>(d <span class="kw">=&gt;</span> d[<span class="dv">3</span>])</span>
<span id="cb52-2216"><a href="#cb52-2216" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb52-2217"><a href="#cb52-2217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-2218"><a href="#cb52-2218" aria-hidden="true" tabindex="-1"></a>  <span class="co">//// Synth -------------------------------------------------------------------</span></span>
<span id="cb52-2219"><a href="#cb52-2219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-2220"><a href="#cb52-2220" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> pointsSynth <span class="op">=</span> resSynth<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> </span>
<span id="cb52-2221"><a href="#cb52-2221" aria-hidden="true" tabindex="-1"></a>    [<span class="fu">x</span>(d[aggX])<span class="op">,</span> <span class="fu">y</span>(d<span class="op">.</span><span class="at">att</span>)<span class="op">,</span> d<span class="op">.</span><span class="at">treat_group</span><span class="op">,</span> <span class="fu">y</span>(d<span class="op">.</span><span class="at">ci_low</span>)<span class="op">,</span> <span class="fu">y</span>(d<span class="op">.</span><span class="at">ci_up</span>)]</span>
<span id="cb52-2222"><a href="#cb52-2222" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb52-2223"><a href="#cb52-2223" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> groupsSynth <span class="op">=</span> d3<span class="op">.</span><span class="fu">group</span>(pointsSynth<span class="op">,</span> d <span class="kw">=&gt;</span> d[<span class="dv">2</span>])<span class="op">;</span></span>
<span id="cb52-2224"><a href="#cb52-2224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-2225"><a href="#cb52-2225" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Confidence interval</span></span>
<span id="cb52-2226"><a href="#cb52-2226" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (showCI) {</span>
<span id="cb52-2227"><a href="#cb52-2227" aria-hidden="true" tabindex="-1"></a>    svg<span class="op">.</span><span class="fu">append</span>(<span class="st">'g'</span>)</span>
<span id="cb52-2228"><a href="#cb52-2228" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">'fill'</span><span class="op">,</span> <span class="st">'springgreen'</span>)</span>
<span id="cb52-2229"><a href="#cb52-2229" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">'opacity'</span><span class="op">,</span> <span class="fl">0.25</span>)</span>
<span id="cb52-2230"><a href="#cb52-2230" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">'stroke'</span><span class="op">,</span> <span class="st">'none'</span>)</span>
<span id="cb52-2231"><a href="#cb52-2231" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'path'</span>)</span>
<span id="cb52-2232"><a href="#cb52-2232" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">data</span>(groupsSynth<span class="op">.</span><span class="fu">values</span>())</span>
<span id="cb52-2233"><a href="#cb52-2233" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">join</span>(<span class="st">'path'</span>)</span>
<span id="cb52-2234"><a href="#cb52-2234" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">'d'</span><span class="op">,</span> ci)<span class="op">;</span></span>
<span id="cb52-2235"><a href="#cb52-2235" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb52-2236"><a href="#cb52-2236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-2237"><a href="#cb52-2237" aria-hidden="true" tabindex="-1"></a>  <span class="co">// ATT</span></span>
<span id="cb52-2238"><a href="#cb52-2238" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">append</span>(<span class="st">'g'</span>)</span>
<span id="cb52-2239"><a href="#cb52-2239" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'fill'</span><span class="op">,</span> <span class="st">'none'</span>)</span>
<span id="cb52-2240"><a href="#cb52-2240" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'stroke-width'</span><span class="op">,</span> <span class="fl">3.5</span>)</span>
<span id="cb52-2241"><a href="#cb52-2241" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'stroke-linejoin'</span><span class="op">,</span> <span class="st">'round'</span>)</span>
<span id="cb52-2242"><a href="#cb52-2242" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'stroke'</span><span class="op">,</span> <span class="st">'springgreen'</span>)</span>
<span id="cb52-2243"><a href="#cb52-2243" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'path'</span>)</span>
<span id="cb52-2244"><a href="#cb52-2244" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(groupsSynth<span class="op">.</span><span class="fu">values</span>())</span>
<span id="cb52-2245"><a href="#cb52-2245" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">join</span>(<span class="st">'path'</span>)</span>
<span id="cb52-2246"><a href="#cb52-2246" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'d'</span><span class="op">,</span> line)<span class="op">;</span></span>
<span id="cb52-2247"><a href="#cb52-2247" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb52-2248"><a href="#cb52-2248" aria-hidden="true" tabindex="-1"></a>  <span class="co">//// DiD ---------------------------------------------------------------------</span></span>
<span id="cb52-2249"><a href="#cb52-2249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-2250"><a href="#cb52-2250" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> pointsDiD <span class="op">=</span> resDiD<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> </span>
<span id="cb52-2251"><a href="#cb52-2251" aria-hidden="true" tabindex="-1"></a>    [<span class="fu">x</span>(d[aggX])<span class="op">,</span> <span class="fu">y</span>(d<span class="op">.</span><span class="at">att</span>)<span class="op">,</span> d<span class="op">.</span><span class="at">treat_group</span><span class="op">,</span> <span class="fu">y</span>(d<span class="op">.</span><span class="at">ci_low</span>)<span class="op">,</span> <span class="fu">y</span>(d<span class="op">.</span><span class="at">ci_up</span>)]</span>
<span id="cb52-2252"><a href="#cb52-2252" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb52-2253"><a href="#cb52-2253" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> groupsDiD <span class="op">=</span> d3<span class="op">.</span><span class="fu">group</span>(pointsDiD<span class="op">,</span> d <span class="kw">=&gt;</span> d[<span class="dv">2</span>])<span class="op">;</span></span>
<span id="cb52-2254"><a href="#cb52-2254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-2255"><a href="#cb52-2255" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Confidence interval</span></span>
<span id="cb52-2256"><a href="#cb52-2256" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (showCI) {</span>
<span id="cb52-2257"><a href="#cb52-2257" aria-hidden="true" tabindex="-1"></a>    svg<span class="op">.</span><span class="fu">append</span>(<span class="st">'g'</span>)</span>
<span id="cb52-2258"><a href="#cb52-2258" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">'fill'</span><span class="op">,</span> <span class="st">'deepskyblue'</span>)</span>
<span id="cb52-2259"><a href="#cb52-2259" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">'opacity'</span><span class="op">,</span> <span class="fl">0.25</span>)</span>
<span id="cb52-2260"><a href="#cb52-2260" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">'stroke'</span><span class="op">,</span> <span class="st">'none'</span>)</span>
<span id="cb52-2261"><a href="#cb52-2261" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'path'</span>)</span>
<span id="cb52-2262"><a href="#cb52-2262" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">data</span>(groupsDiD<span class="op">.</span><span class="fu">values</span>())</span>
<span id="cb52-2263"><a href="#cb52-2263" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">join</span>(<span class="st">'path'</span>)</span>
<span id="cb52-2264"><a href="#cb52-2264" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">'d'</span><span class="op">,</span> ci)<span class="op">;</span></span>
<span id="cb52-2265"><a href="#cb52-2265" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb52-2266"><a href="#cb52-2266" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb52-2267"><a href="#cb52-2267" aria-hidden="true" tabindex="-1"></a>  <span class="co">// ATT</span></span>
<span id="cb52-2268"><a href="#cb52-2268" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">append</span>(<span class="st">'g'</span>)</span>
<span id="cb52-2269"><a href="#cb52-2269" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'fill'</span><span class="op">,</span> <span class="st">'none'</span>)</span>
<span id="cb52-2270"><a href="#cb52-2270" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'stroke-width'</span><span class="op">,</span> <span class="fl">3.5</span>)</span>
<span id="cb52-2271"><a href="#cb52-2271" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'stroke-linejoin'</span><span class="op">,</span> <span class="st">'round'</span>)</span>
<span id="cb52-2272"><a href="#cb52-2272" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'stroke'</span><span class="op">,</span> <span class="st">'deepskyblue'</span>)</span>
<span id="cb52-2273"><a href="#cb52-2273" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'path'</span>)</span>
<span id="cb52-2274"><a href="#cb52-2274" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(groupsDiD<span class="op">.</span><span class="fu">values</span>())</span>
<span id="cb52-2275"><a href="#cb52-2275" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">join</span>(<span class="st">'path'</span>)</span>
<span id="cb52-2276"><a href="#cb52-2276" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'d'</span><span class="op">,</span> line)<span class="op">;</span></span>
<span id="cb52-2277"><a href="#cb52-2277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-2278"><a href="#cb52-2278" aria-hidden="true" tabindex="-1"></a>  <span class="co">//// K-12 --------------------------------------------------------------------</span></span>
<span id="cb52-2279"><a href="#cb52-2279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-2280"><a href="#cb52-2280" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (</span>
<span id="cb52-2281"><a href="#cb52-2281" aria-hidden="true" tabindex="-1"></a>    overlayK12 <span class="op">&amp;&amp;</span> selectedOutcome <span class="op">!==</span> <span class="st">'e027_elem_educ_direct_exp'</span></span>
<span id="cb52-2282"><a href="#cb52-2282" aria-hidden="true" tabindex="-1"></a>      <span class="op">&amp;&amp;</span> <span class="op">!</span>(ctrlSpecDiD <span class="op">===</span> <span class="st">'none'</span> <span class="op">&amp;&amp;</span> ctrlSpecSynth <span class="op">===</span> <span class="st">'none'</span>)</span>
<span id="cb52-2283"><a href="#cb52-2283" aria-hidden="true" tabindex="-1"></a>  ) {</span>
<span id="cb52-2284"><a href="#cb52-2284" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> pointsK12 <span class="op">=</span> resK12<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> [<span class="fu">x</span>(d[aggX])<span class="op">,</span> <span class="fu">y</span>(d<span class="op">.</span><span class="at">att</span>)<span class="op">,</span> d<span class="op">.</span><span class="at">id</span>])<span class="op">;</span></span>
<span id="cb52-2285"><a href="#cb52-2285" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> groupsK12 <span class="op">=</span> d3<span class="op">.</span><span class="fu">rollup</span>(</span>
<span id="cb52-2286"><a href="#cb52-2286" aria-hidden="true" tabindex="-1"></a>      pointsK12<span class="op">,</span> v <span class="kw">=&gt;</span> <span class="bu">Object</span><span class="op">.</span><span class="fu">assign</span>(v<span class="op">,</span> {<span class="dt">id</span><span class="op">:</span> v[<span class="dv">0</span>][<span class="dv">2</span>]})<span class="op">,</span> d <span class="kw">=&gt;</span> d[<span class="dv">2</span>]</span>
<span id="cb52-2287"><a href="#cb52-2287" aria-hidden="true" tabindex="-1"></a>    )<span class="op">;</span></span>
<span id="cb52-2288"><a href="#cb52-2288" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> pathK12 <span class="op">=</span> svg<span class="op">.</span><span class="fu">append</span>(<span class="st">'g'</span>)</span>
<span id="cb52-2289"><a href="#cb52-2289" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">'fill'</span><span class="op">,</span> <span class="st">'none'</span>)</span>
<span id="cb52-2290"><a href="#cb52-2290" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">'stroke-width'</span><span class="op">,</span> <span class="fl">3.5</span>)</span>
<span id="cb52-2291"><a href="#cb52-2291" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">'stroke-linejoin'</span><span class="op">,</span> <span class="st">'round'</span>)</span>
<span id="cb52-2292"><a href="#cb52-2292" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">'stroke-opacity'</span><span class="op">,</span> <span class="op">.</span><span class="dv">75</span>)</span>
<span id="cb52-2293"><a href="#cb52-2293" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">'stroke-dasharray'</span><span class="op">,</span> <span class="dv">5</span>)</span>
<span id="cb52-2294"><a href="#cb52-2294" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'path'</span>)</span>
<span id="cb52-2295"><a href="#cb52-2295" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">data</span>(groupsK12<span class="op">.</span><span class="fu">values</span>())</span>
<span id="cb52-2296"><a href="#cb52-2296" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">join</span>(<span class="st">'path'</span>)</span>
<span id="cb52-2297"><a href="#cb52-2297" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">'d'</span><span class="op">,</span> line)</span>
<span id="cb52-2298"><a href="#cb52-2298" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">'stroke'</span><span class="op">,</span> ({id}) <span class="kw">=&gt;</span> id <span class="op">===</span> <span class="st">'synth'</span> <span class="op">?</span> <span class="st">'springgreen'</span> <span class="op">:</span> <span class="st">'deepskyblue'</span>)<span class="op">;</span></span>
<span id="cb52-2299"><a href="#cb52-2299" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb52-2300"><a href="#cb52-2300" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb52-2301"><a href="#cb52-2301" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Title =====================================================================</span></span>
<span id="cb52-2302"><a href="#cb52-2302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-2303"><a href="#cb52-2303" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> title <span class="op">=</span> <span class="ss">/</span><span class="sc">^</span><span class="ss">es</span><span class="sc">?</span><span class="ss">$</span><span class="sc">|</span><span class="ss">event/</span><span class="op">.</span><span class="fu">test</span>(aggType) <span class="op">?</span> </span>
<span id="cb52-2304"><a href="#cb52-2304" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Event Study'</span> <span class="op">:</span> <span class="st">'Effects by Year'</span><span class="op">;</span></span>
<span id="cb52-2305"><a href="#cb52-2305" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">append</span>(<span class="st">'text'</span>)</span>
<span id="cb52-2306"><a href="#cb52-2306" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x'</span><span class="op">,</span> width <span class="op">/</span> <span class="dv">2</span>)</span>
<span id="cb52-2307"><a href="#cb52-2307" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> margin<span class="op">.</span><span class="at">top</span> <span class="op">-</span> <span class="dv">2</span>)</span>
<span id="cb52-2308"><a href="#cb52-2308" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'text-anchor'</span><span class="op">,</span> <span class="st">'middle'</span>)</span>
<span id="cb52-2309"><a href="#cb52-2309" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">style</span>(<span class="st">'font-size'</span><span class="op">,</span> <span class="st">'14px'</span>)</span>
<span id="cb52-2310"><a href="#cb52-2310" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">text</span>(title)<span class="op">;</span></span>
<span id="cb52-2311"><a href="#cb52-2311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-2312"><a href="#cb52-2312" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> svg<span class="op">.</span><span class="fu">node</span>()<span class="op">;</span></span>
<span id="cb52-2313"><a href="#cb52-2313" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display hidden">
<div id="ojs-cell-51" data-nodetype="declaration">

</div>
</div>
</div>
</div></aside>
<button class="collapse-toggle" type="button" title="Toggle sidebar" aria-expanded="true" aria-controls="bslib-sidebar-1">
    <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 16 16" class="bi bi-chevron-left collapse-icon" style="fill:currentColor;" aria-hidden="true" role="img">
      <path fill-rule="evenodd" d="M11.354 1.646a.5.5 0 0 1 0 .708L5.707 8l5.647 5.646a.5.5 0 0 1-.708.708l-6-6a.5.5 0 0 1 0-.708l6-6a.5.5 0 0 1 .708 0z"></path>
    </svg>
</button>
<script data-bslib-sidebar-init="">
bslib.Sidebar.initCollapsibleAll()
</script>
</div>


<script type="ojs-module-contents">
eyJjb250ZW50cyI6W3sibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMSIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6ImQzID0gcmVxdWlyZSgnZDNANycpO1xuaW1wb3J0IHsgYXEgfSBmcm9tICdAdXdkYXRhL2FycXVlcm8nO1xuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0yIiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiZGF0YUFsbFN0YXRlczAgPSBhcS5sb2FkQXJyb3coJ2RhdGEvdHJlYXQtZ3JvdXBzX2FsbC1kYXRhLmFycm93Jyk7XG5kYXRhVHJlYXRNZWFuczAgPSBhcS5sb2FkQXJyb3coJ2RhdGEvdHJlYXRfbWVhbnMuYXJyb3cnKTtcbmRhdGFDdHJsTWVhbnNEaUQwID0gYXEubG9hZEFycm93KCdkYXRhL2RpZF9jdHJsX21lYW5zLmFycm93Jyk7XG5kYXRhQ3RybE1lYW5zU3ludGgwID0gYXEubG9hZEFycm93KCdkYXRhL3N5bnRoX2N0cmxfbWVhbnMuYXJyb3cnKTtcbmRhdGFDdHJsU3RhdGVzRGlEMCA9IGFxLmxvYWRBcnJvdygnZGF0YS9kaWRfY3RybF9zdGF0ZXMuYXJyb3cnKTtcbmRhdGFDdHJsU3RhdGVzU3ludGgwID0gYXEubG9hZEFycm93KCdkYXRhL3N5bnRoX2N0cmxfc3RhdGVzLmFycm93Jyk7XG5kYXRhUmVzU3ludGgwID0gYXEubG9hZEFycm93KCdkYXRhL3N5bnRoX3Jlcy5hcnJvdycpO1xuZGF0YVJlc0RpRDAgPSBhcS5sb2FkQXJyb3coJ2RhdGEvZGlkX3Jlcy5hcnJvdycpO1xuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0zIiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiZGF0YUFsbFN0YXRlcyA9IGRhdGFBbGxTdGF0ZXMwLm9iamVjdHMoKTtcbmRhdGFUcmVhdE1lYW5zID0gZGF0YVRyZWF0TWVhbnMwLm9iamVjdHMoKTtcbmRhdGFDdHJsTWVhbnNEaUQgPSBkYXRhQ3RybE1lYW5zRGlEMC5vYmplY3RzKCk7XG5kYXRhQ3RybE1lYW5zU3ludGggPSBkYXRhQ3RybE1lYW5zU3ludGgwLm9iamVjdHMoKTtcbmRhdGFDdHJsU3RhdGVzRGlEID0gZGF0YUN0cmxTdGF0ZXNEaUQwLm9iamVjdHMoKTtcbmRhdGFDdHJsU3RhdGVzU3ludGggPSBkYXRhQ3RybFN0YXRlc1N5bnRoMC5vYmplY3RzKCk7XG5kYXRhUmVzU3ludGggPSBkYXRhUmVzU3ludGgwLm9iamVjdHMoKTtcbmRhdGFSZXNEaUQgPSBkYXRhUmVzRGlEMC5vYmplY3RzKCk7XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTQiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJvdXRjb21lTmFtZSA9IGZlID8gc2VsZWN0ZWRPdXRjb21lICsgJ19mZScgOiBzZWxlY3RlZE91dGNvbWU7XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTUiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJkYXRhVHJlYXRNZWFuc1VzZSA9IHtcbiAgbGV0IGRhdGFGaWx0ID0gZGF0YVRyZWF0TWVhbnMuZmlsdGVyKGQgPT4gZC50cmVhdF9zcGVjID09PSB0cmVhdFNwZWMpO1xuICBpZiAoZHJvcEFLKSB7XG4gICAgZGF0YUZpbHQgPSBkYXRhRmlsdC5maWx0ZXIoZCA9PiBkLnRyZWF0X2dyb3VwICE9PSAnMjAwMCcpO1xuICAgIGRhdGFGaWx0ID0gZGF0YUZpbHQubWFwKGQgPT4gXG4gICAgICBkLnRyZWF0X2dyb3VwID09PSAnMjAwMCBubyBhaycgPyB7Li4uZCwgdHJlYXRfZ3JvdXA6ICcyMDAwJ30gOiBkXG4gICAgKTtcbiAgfSBlbHNlIHtcbiAgICBkYXRhRmlsdCA9IGRhdGFGaWx0LmZpbHRlcihkID0+IGQudHJlYXRfZ3JvdXAgIT09ICcyMDAwIG5vIGFrJyk7XG4gIH1cbiAgbGV0IGRhdGFOb25BZ2cgPSBkYXRhRmlsdC5maWx0ZXIoZCA9PiAvXFxkXFxkXFxkXFxkLy50ZXN0KGQudHJlYXRfZ3JvdXApKTtcbiAgaWYgKC9cXGQvLnRlc3Qoc3RhY2tlZCkpIHtcbiAgICBkYXRhTm9uQWdnID0gZGF0YU5vbkFnZy5maWx0ZXIoZCA9PiBcbiAgICAgIGQueWVhciA8IE51bWJlcihkLnRyZWF0X2dyb3VwKSArIE51bWJlcihzdGFja2VkKVxuICAgICk7XG4gIH1cbiAgY29uc3QgZGF0YUFnZyA9IGRhdGFGaWx0LmZpbHRlcihkID0+IC9hZ2dyZWdhdGUvLnRlc3QoZC50cmVhdF9ncm91cCkpO1xuICBsZXQgZGF0YU91dCA9IFsuLi5kYXRhTm9uQWdnLCAuLi5kYXRhQWdnXTtcbiAgZGF0YU91dCA9IGRhdGFPdXQubWFwKGQgPT4gKHtcbiAgICB0cmVhdF9ncm91cDogZC50cmVhdF9ncm91cCwgeWVhcjogZC55ZWFyLCBlOiBkLmUsIG91dGNvbWU6IGRbb3V0Y29tZU5hbWVdXG4gIH0pKTtcbiAgcmV0dXJuIGRhdGFPdXQ7XG59XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTYiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJkYXRhQ3RybE1lYW5zRGlEVXNlID0ge1xuICBjb25zdCBkYXRhRmlsdCA9IGRhdGFDdHJsTWVhbnNEaUQuZmlsdGVyKFxuICAgIGQgPT4gZC5jdHJsX3NwZWMgPT09IGN0cmxTcGVjRGlEICYmIGQudHJlYXRfc3BlYyA9PT0gdHJlYXRTcGVjXG4gICk7XG4gIGNvbnN0IGRhdGFPdXQgPSBkYXRhRmlsdC5tYXAoZCA9PiAoe1xuICAgIHRyZWF0X2dyb3VwOiBkLnRyZWF0X2dyb3VwLCB5ZWFyOiBkLnllYXIsIGU6IGQuZSwgb3V0Y29tZTogZFtvdXRjb21lTmFtZV1cbiAgfSkpO1xuICByZXR1cm4gZGF0YU91dDtcbn1cbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtNyIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6ImRhdGFDdHJsTWVhbnNTeW50aFVzZSA9IHtcbiAgbGV0IGRhdGFGaWx0ID0gZGF0YUN0cmxNZWFuc1N5bnRoLmZpbHRlcihkID0+IFxuICAgIGQuY3RybF9zcGVjID09PSBjdHJsU3BlY1N5bnRoICYmIGQudHJlYXRfc3BlYyA9PT0gdHJlYXRTcGVjXG4gICk7XG4gIGlmIChkcm9wQUspIHtcbiAgICBkYXRhRmlsdCA9IGRhdGFGaWx0LmZpbHRlcihkID0+IGQudHJlYXRfZ3JvdXAgIT09ICcyMDAwJyk7XG4gICAgZGF0YUZpbHQgPSBkYXRhRmlsdC5tYXAoZCA9PiBcbiAgICAgIGQudHJlYXRfZ3JvdXAgPT09ICcyMDAwIG5vIGFrJyA/IHsuLi5kLCB0cmVhdF9ncm91cDogJzIwMDAnfSA6IGRcbiAgICApO1xuICB9IGVsc2Uge1xuICAgIGRhdGFGaWx0ID0gZGF0YUZpbHQuZmlsdGVyKGQgPT4gZC50cmVhdF9ncm91cCAhPT0gJzIwMDAgbm8gYWsnKTtcbiAgfVxuICBjb25zdCBkYXRhT3V0ID0gZGF0YUZpbHQubWFwKGQgPT4gKHtcbiAgICB0cmVhdF9ncm91cDogZC50cmVhdF9ncm91cCwgeWVhcjogZC55ZWFyLCBlOiBkLmUsIG91dGNvbWU6IGRbb3V0Y29tZU5hbWVdXG4gIH0pKTtcbiAgcmV0dXJuIGRhdGFPdXQ7XG59XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTgiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJkYXRhQWxsU3RhdGVzVXNlID0ge1xuICBsZXQgZGF0YUZpbHQgPSBkYXRhQWxsU3RhdGVzLmZpbHRlcihkID0+XG4gICAgZC50cmVhdF9zcGVjID09PSB0cmVhdFNwZWNcbiAgKTtcbiAgaWYgKGRyb3BBSykgZGF0YUZpbHQgPSBkYXRhRmlsdC5maWx0ZXIoZCA9PiBkLnN0ICE9PSAnQUsnKTtcbiAgaWYgKC9cXGQvLnRlc3Qoc3RhY2tlZCkpIHtcbiAgICBkYXRhRmlsdCA9IGRhdGFGaWx0LmZpbHRlcihkID0+IFxuICAgICAgZC55ZWFyIDwgTnVtYmVyKGQudHJlYXRfZ3JvdXApICsgTnVtYmVyKHN0YWNrZWQpXG4gICAgKTtcbiAgfVxuICBjb25zdCBkYXRhT3V0ID0gZGF0YUZpbHQubWFwKGQgPT4gKHtcbiAgICB0cmVhdF9ncm91cDogZC50cmVhdF9ncm91cCwgc3Q6IGQuc3QsIHRyZWF0ZWQ6IGQudHJlYXRlZCwgXG4gICAgeWVhcjogZC55ZWFyLCBlOiBkLmUsIG91dGNvbWU6IGRbb3V0Y29tZU5hbWVdXG4gIH0pKTtcbiAgcmV0dXJuIGRhdGFPdXQ7XG59XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTkiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJkYXRhQ3RybFN0YXRlc0RpRFVzZSA9IGRhdGFDdHJsU3RhdGVzRGlELmZpbHRlcihkID0+IFxuICBkLmN0cmxfc3BlYyA9PT0gY3RybFNwZWNEaUQgJiYgZC50cmVhdF9zcGVjID09PSB0cmVhdFNwZWNcbik7XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTEwIiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiZGF0YUN0cmxTdGF0ZXNTeW50aFVzZSA9IHtcbiAgbGV0IGRhdGFGaWx0ID0gZGF0YUN0cmxTdGF0ZXNTeW50aC5maWx0ZXIoZCA9PiBcbiAgICBkLmN0cmxfc3BlYyA9PT0gY3RybFNwZWNTeW50aCBcbiAgICAgICYmIGQudHJlYXRfc3BlYyA9PT0gdHJlYXRTcGVjXG4gICAgICAmJiBvdXRjb21lTmFtZS5pbmNsdWRlcyhkLnkpXG4gICk7XG4gIGlmIChkcm9wQUspIHtcbiAgICBkYXRhRmlsdCA9IGRhdGFGaWx0LmZpbHRlcihkID0+IGQudHJlYXRfZ3JvdXAgIT09ICcyMDAwJyk7XG4gICAgZGF0YUZpbHQgPSBkYXRhRmlsdC5tYXAoZCA9PiBcbiAgICAgIGQudHJlYXRfZ3JvdXAgPT09ICcyMDAwIG5vIGFrJyA/IHsuLi5kLCB0cmVhdF9ncm91cDogJzIwMDAnfSA6IGRcbiAgICApO1xuICB9IGVsc2Uge1xuICAgIGRhdGFGaWx0ID0gZGF0YUZpbHQuZmlsdGVyKGQgPT4gZC50cmVhdF9ncm91cCAhPT0gJzIwMDAgbm8gYWsnKTtcbiAgfVxuICByZXR1cm4gZGF0YUZpbHQ7XG59XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTExIiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiZGF0YUsxMk1lYW5zID0ge1xuICBjb25zdCBrMTJZTmFtZSA9IGZlID8gXG4gICAgJ2UwMjdfZWxlbV9lZHVjX2RpcmVjdF9leHBfZmUnIDogJ2UwMjdfZWxlbV9lZHVjX2RpcmVjdF9leHAnO1xuXG4gIGxldCBkYXRhVHJlYXRGaWx0ID0gZGF0YVRyZWF0TWVhbnMuZmlsdGVyKGQgPT4gZC50cmVhdF9zcGVjID09PSB0cmVhdFNwZWMpO1xuICBpZiAoZHJvcEFLKSB7XG4gICAgZGF0YVRyZWF0RmlsdCA9IGRhdGFUcmVhdEZpbHQuZmlsdGVyKGQgPT4gZC50cmVhdF9ncm91cCAhPT0gJzIwMDAnKTtcbiAgICBkYXRhVHJlYXRGaWx0ID0gZGF0YVRyZWF0RmlsdC5tYXAoZCA9PiBcbiAgICAgIGQudHJlYXRfZ3JvdXAgPT09ICcyMDAwIG5vIGFrJyA/IHsuLi5kLCB0cmVhdF9ncm91cDogJzIwMDAnfSA6IGRcbiAgICApO1xuICB9IGVsc2Uge1xuICAgIGRhdGFUcmVhdEZpbHQgPSBkYXRhVHJlYXRGaWx0LmZpbHRlcihkID0+IGQudHJlYXRfZ3JvdXAgIT09ICcyMDAwIG5vIGFrJyk7XG4gIH1cbiAgbGV0IGRhdGFUcmVhdE5vbkFnZyA9IGRhdGFUcmVhdEZpbHQuZmlsdGVyKGQgPT4gL1xcZFxcZFxcZFxcZC8udGVzdChkLnRyZWF0X2dyb3VwKSk7XG4gIGlmICgvXFxkLy50ZXN0KHN0YWNrZWQpKSB7XG4gICAgZGF0YVRyZWF0Tm9uQWdnID0gZGF0YVRyZWF0Tm9uQWdnLmZpbHRlcihkID0+IFxuICAgICAgZC55ZWFyIDwgTnVtYmVyKGQudHJlYXRfZ3JvdXApICsgTnVtYmVyKHN0YWNrZWQpXG4gICAgKTtcbiAgfVxuICBjb25zdCBkYXRhVHJlYXRBZ2cgPSBkYXRhVHJlYXRGaWx0LmZpbHRlcihkID0+IC9hZ2dyZWdhdGUvLnRlc3QoZC50cmVhdF9ncm91cCkpO1xuICBjb25zdCBkYXRhVHJlYXRDbGVhbiA9IFsuLi5kYXRhVHJlYXROb25BZ2csIC4uLmRhdGFUcmVhdEFnZ107XG4gIGNvbnN0IGsxMk1lYW5zVHJlYXQgPSBkYXRhVHJlYXRDbGVhbi5tYXAoZCA9PiAoe1xuICAgIHRyZWF0X2dyb3VwOiBkLnRyZWF0X2dyb3VwLCBcbiAgICB5ZWFyOiBkLnllYXIsIFxuICAgIGU6IGQuZSxcbiAgICBvdXRjb21lOiBkW2sxMllOYW1lXSxcbiAgICBpZDogJ3RyZWF0IGdyb3VwJyxcbiAgICBzdDogJ24vYSdcbiAgfSkpO1xuXG4gIGxldCB0cmVhdGVkU3RhdGVzID0gZGF0YUFsbFN0YXRlcy5maWx0ZXIoZCA9PiBcbiAgICBkLnRyZWF0ZWQgPT09IDEgJiYgZC50cmVhdF9zcGVjID09PSB0cmVhdFNwZWNcbiAgKTtcbiAgaWYgKGRyb3BBSykgdHJlYXRlZFN0YXRlcyA9IHRyZWF0ZWRTdGF0ZXMuZmlsdGVyKGQgPT4gZC5zdCAhPT0gJ0FLJyk7XG4gIGlmICgvXFxkLy50ZXN0KHN0YWNrZWQpKSB7XG4gICAgdHJlYXRlZFN0YXRlcyA9IHRyZWF0ZWRTdGF0ZXMuZmlsdGVyKGQgPT4gXG4gICAgICBkLnllYXIgPCBOdW1iZXIoZC50cmVhdF9ncm91cCkgKyBOdW1iZXIoc3RhY2tlZClcbiAgICApO1xuICB9XG4gIGNvbnN0IGsxMlN0YXRlc1RyZWF0ID0gdHJlYXRlZFN0YXRlcy5tYXAoZCA9PiAoe1xuICAgIHRyZWF0X2dyb3VwOiBkLnRyZWF0X2dyb3VwLCBcbiAgICB5ZWFyOiBkLnllYXIsIFxuICAgIGU6IGQuZSxcbiAgICBvdXRjb21lOiBkW2sxMllOYW1lXSxcbiAgICBpZDogJ3RyZWF0IHN0JyxcbiAgICBzdDogZC5zdFxuICB9KSk7XG5cbiAgY29uc3QgZGF0YURpREZpbHQgPSBkYXRhQ3RybE1lYW5zRGlELmZpbHRlcihkID0+IFxuICAgIGQuY3RybF9zcGVjID09PSBjdHJsU3BlY0RpRCAmJiBkLnRyZWF0X3NwZWMgPT09IHRyZWF0U3BlY1xuICApO1xuICBjb25zdCBrMTJNZWFuc0N0cmxEaUQgPSBkYXRhRGlERmlsdC5tYXAoZCA9PiAoe1xuICAgIHRyZWF0X2dyb3VwOiBkLnRyZWF0X2dyb3VwLCBcbiAgICB5ZWFyOiBkLnllYXIsIFxuICAgIGU6IGQuZSxcbiAgICBvdXRjb21lOiBkW2sxMllOYW1lXSxcbiAgICBpZDogJ2N0cmwgZGlkJyxcbiAgICBzdDogJ24vYSdcbiAgfSkpO1xuXG4gIGxldCBkYXRhU3ludGhGaWx0ID0gZGF0YUN0cmxNZWFuc1N5bnRoLmZpbHRlcihkID0+IFxuICAgIGQuY3RybF9zcGVjID09PSBjdHJsU3BlY1N5bnRoICYmIGQudHJlYXRfc3BlYyA9PT0gdHJlYXRTcGVjXG4gICk7XG4gIGlmIChkcm9wQUspIHtcbiAgICBkYXRhU3ludGhGaWx0ID0gZGF0YVN5bnRoRmlsdC5maWx0ZXIoZCA9PiBkLnRyZWF0X2dyb3VwICE9PSAnMjAwMCcpO1xuICAgIGRhdGFTeW50aEZpbHQgPSBkYXRhU3ludGhGaWx0Lm1hcChkID0+IFxuICAgICAgZC50cmVhdF9ncm91cCA9PT0gJzIwMDAgbm8gYWsnID8gey4uLmQsIHRyZWF0X2dyb3VwOiAnMjAwMCd9IDogZFxuICAgICk7XG4gIH0gZWxzZSB7XG4gICAgZGF0YVN5bnRoRmlsdCA9IGRhdGFTeW50aEZpbHQuZmlsdGVyKGQgPT4gZC50cmVhdF9ncm91cCAhPT0gJzIwMDAgbm8gYWsnKTtcbiAgfVxuICBjb25zdCBrMTJNZWFuc1N5bnRoRGlEID0gZGF0YVN5bnRoRmlsdC5tYXAoZCA9PiAoe1xuICAgIHRyZWF0X2dyb3VwOiBkLnRyZWF0X2dyb3VwLCBcbiAgICB5ZWFyOiBkLnllYXIsIFxuICAgIGU6IGQuZSxcbiAgICBvdXRjb21lOiBkW2sxMllOYW1lXSxcbiAgICBpZDogJ2N0cmwgc3ludGgnLFxuICAgIHN0OiAnbi9hJ1xuICB9KSk7XG5cbiAgcmV0dXJuIFtcbiAgICAuLi5rMTJNZWFuc1RyZWF0LCAuLi5rMTJTdGF0ZXNUcmVhdCwgXG4gICAgLi4uazEyTWVhbnNDdHJsRGlELCAuLi5rMTJNZWFuc1N5bnRoRGlEXG4gIF07XG59XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTEyIiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiZGF0YVJlc0RpRFVzZUcgPSB7XG4gIGNvbnN0IHJlID0gL1xcZHxhZ2dyZWdhdGUvXG4gIGNvbnN0IHNpbXVsdENiYW5kID0gbW9kU3BlY0RpRC5pbmNsdWRlcygnc2ltdWx0IGNiYW5kJykgPyB0cnVlIDogZmFsc2U7XG4gIGNvbnN0IGRhdGFGaWx0ID0gZGF0YVJlc0RpRC5maWx0ZXIoZCA9PlxuICAgIGQuY3RybF9zcGVjID09PSBjdHJsU3BlY0RpRFxuICAgICAgJiYgZC50cmVhdF9zcGVjID09PSB0cmVhdFNwZWNcbiAgICAgICYmIGQuc2ltdWx0X2NiYW5kID09PSBzaW11bHRDYmFuZFxuICAgICAgJiYgZC55ID09PSBzZWxlY3RlZE91dGNvbWVcbiAgICAgICYmIHJlLnRlc3QoZC5nKVxuICApO1xuICBjb25zdCBkYXRhT3V0ID0gZGF0YUZpbHQubWFwKGQgPT4gKHtcbiAgICB0cmVhdF9ncm91cDogZC5nLCB5ZWFyOiBkLnllYXIsIGU6IGQuZSxcbiAgICBhdHQ6IGQuYXR0LCBjaV9sb3c6IGQuY2lfbG93LCBjaV91cDogZC5jaV91cFxuICB9KSk7XG4gIHJldHVybiBkYXRhT3V0O1xufVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0xMyIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6ImRhdGFSZXNTeW50aFVzZUcgPSB7XG4gIGxldCBkYXRhRmlsdCA9IGRhdGFSZXNTeW50aC5maWx0ZXIoZCA9PiBcbiAgICBkLmN0cmxfc3BlYyA9PT0gY3RybFNwZWNTeW50aFxuICAgICAgJiYgZC50cmVhdF9zcGVjID09PSB0cmVhdFNwZWNcbiAgICAgICYmIGQueSA9PT0gc2VsZWN0ZWRPdXRjb21lIFxuICAgICAgJiYgZC55ZWFyICE9PSBudWxsXG4gICAgICAmJiBkLnRpbWVfY29ob3J0ID09PSB0cnVlXG4gICk7XG4gIGlmIChkcm9wQUspIHtcbiAgICBkYXRhRmlsdCA9IGRhdGFGaWx0LmZpbHRlcihkID0+IGQuZyAhPT0gJzIwMDAnKTtcbiAgICBkYXRhRmlsdCA9IGRhdGFGaWx0Lm1hcChkID0+IFxuICAgICAgZC5nID09PSAnMjAwMCBubyBhaycgPyB7Li4uZCwgZzogJzIwMDAnfSA6IGRcbiAgICApO1xuICB9IGVsc2Uge1xuICAgIGRhdGFGaWx0ID0gZGF0YUZpbHQuZmlsdGVyKGQgPT4gZC5nICE9PSAnMjAwMCBubyBhaycpO1xuICB9XG4gIGNvbnN0IGRhdGFPdXQgPSBkYXRhRmlsdC5tYXAoZCA9PiAoe1xuICAgIHRyZWF0X2dyb3VwOiBkLmcsIHllYXI6IGQueWVhciwgZTogZC5lLFxuICAgIGF0dDogZC5hdHQsIGNpX2xvdzogZC5jaV9sb3csIGNpX3VwOiBkLmNpX3VwXG4gIH0pKTtcbiAgcmV0dXJuIGRhdGFPdXQ7XG59XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTE0IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiZGF0YVJlc0RpRFVzZVN0ID0ge1xuICBjb25zdCByZSA9IC9bQS1aXVtBLVpdL1xuICBjb25zdCBzaW11bHRDYmFuZCA9IG1vZFNwZWNEaUQuaW5jbHVkZXMoJ3NpbXVsdCBjYmFuZCcpID8gdHJ1ZSA6IGZhbHNlO1xuICBjb25zdCBkYXRhRmlsdCA9IGRhdGFSZXNEaUQuZmlsdGVyKGQgPT4gXG4gICAgZC5jdHJsX3NwZWMgPT09IGN0cmxTcGVjRGlEXG4gICAgICAmJiBkLnRyZWF0X3NwZWMgPT09IHRyZWF0U3BlY1xuICAgICAgJiYgZC5zaW11bHRfY2JhbmQgPT09IHNpbXVsdENiYW5kXG4gICAgICAmJiBkLnkgPT09IHNlbGVjdGVkT3V0Y29tZSBcbiAgICAgICYmIHJlLnRlc3QoZC5nKVxuICApO1xuICBjb25zdCBkYXRhT3V0ID0gZGF0YUZpbHQubWFwKGQgPT4gKHtcbiAgICB0cmVhdF9ncm91cDogZC5nLCB5ZWFyOiBkLnllYXIsIGU6IGQuZSxcbiAgICBhdHQ6IGQuYXR0LCBjaV9sb3c6IGQuY2lfbG93LCBjaV91cDogZC5jaV91cFxuICB9KSk7XG4gIHJldHVybiBkYXRhT3V0O1xufVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0xNSIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6ImRhdGFSZXNTeW50aFVzZVN0ID0ge1xuICBjb25zdCBkYXRhRmlsdCA9IGRhdGFSZXNTeW50aC5maWx0ZXIoZCA9PiBcbiAgICBkLmN0cmxfc3BlYyA9PT0gY3RybFNwZWNTeW50aCBcbiAgICAgICYmIGQudHJlYXRfc3BlYyA9PT0gdHJlYXRTcGVjXG4gICAgICAmJiBkLnkgPT09IHNlbGVjdGVkT3V0Y29tZSBcbiAgICAgICYmIGQudGltZV9jb2hvcnQgPT09IGZhbHNlXG4gICk7XG4gIGNvbnN0IGRhdGFPdXQgPSBkYXRhRmlsdC5tYXAoZCA9PiAoe1xuICAgIHRyZWF0X2dyb3VwOiBkLmcsIHllYXI6IGQueWVhciwgZTogZC5lLFxuICAgIGF0dDogZC5hdHQsIGNpX2xvdzogZC5jaV9sb3csIGNpX3VwOiBkLmNpX3VwXG4gIH0pKTtcbiAgcmV0dXJuIGRhdGFPdXQ7XG59XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTE2IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiZGF0YVJlc0sxMlVzZUcgPSB7XG4gIGNvbnN0IHJlID0gL1xcZHxhZ2dyZWdhdGUvO1xuICBjb25zdCBrMTJSZXNTeW50aEZpbHQgPSBkYXRhUmVzU3ludGguZmlsdGVyKGQgPT4gXG4gICAgZC5jdHJsX3NwZWMgPT09IGN0cmxTcGVjU3ludGhcbiAgICAgICYmIGQudHJlYXRfc3BlYyA9PT0gdHJlYXRTcGVjXG4gICAgICAmJiBkLnkgPT09ICdlMDI3X2VsZW1fZWR1Y19kaXJlY3RfZXhwJ1xuICAgICAgJiYgcmUudGVzdChkLmcpXG4gICk7XG4gIGNvbnN0IGsxMlJlc1N5bnRoID0gazEyUmVzU3ludGhGaWx0Lm1hcChkID0+ICh7XG4gICAgdHJlYXRfZ3JvdXA6IGQuZywgeWVhcjogZC55ZWFyLCBlOiBkLmUsIGF0dDogZC5hdHQsIGlkOiAnc3ludGgnXG4gIH0pKTtcblxuICBjb25zdCBzaW11bHRDYmFuZCA9IG1vZFNwZWNEaUQuaW5jbHVkZXMoJ3NpbXVsdCBjYmFuZCcpID8gdHJ1ZSA6IGZhbHNlO1xuICBjb25zdCBrMTJSZXNEaURGaWx0ID0gZGF0YVJlc0RpRC5maWx0ZXIoZCA9PlxuICAgIGQuY3RybF9zcGVjID09PSBjdHJsU3BlY0RpRFxuICAgICAgJiYgZC50cmVhdF9zcGVjID09PSB0cmVhdFNwZWNcbiAgICAgICYmIGQuc2ltdWx0X2NiYW5kID09PSBzaW11bHRDYmFuZFxuICAgICAgJiYgZC55ID09PSAnZTAyN19lbGVtX2VkdWNfZGlyZWN0X2V4cCdcbiAgICAgICYmIHJlLnRlc3QoZC5nKVxuICApO1xuICBjb25zdCBrMTJSZXNEaUQgPSBrMTJSZXNEaURGaWx0Lm1hcChkID0+ICh7XG4gICAgdHJlYXRfZ3JvdXA6IGQuZywgeWVhcjogZC55ZWFyLCBlOiBkLmUsIGF0dDogZC5hdHQsIGlkOiAnZGlkJ1xuICB9KSk7XG4gIFxuICByZXR1cm4gWy4uLmsxMlJlc1N5bnRoLCAuLi5rMTJSZXNEaURdO1xufVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0xNyIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6ImRhdGFSZXNLMTJVc2VTdCA9IHtcbiAgY29uc3QgazEyUmVzU3ludGhGaWx0ID0gZGF0YVJlc1N5bnRoLmZpbHRlcihkID0+IFxuICAgIGQuY3RybF9zcGVjID09PSBjdHJsU3BlY1N5bnRoXG4gICAgICAmJiBkLnRyZWF0X3NwZWMgPT09IHRyZWF0U3BlY1xuICAgICAgJiYgZC55ID09PSAnZTAyN19lbGVtX2VkdWNfZGlyZWN0X2V4cCdcbiAgICAgICYmIGQudGltZV9jb2hvcnQgPT09IGZhbHNlXG4gICk7XG4gIGNvbnN0IGsxMlJlc1N5bnRoID0gazEyUmVzU3ludGhGaWx0Lm1hcChkID0+ICh7XG4gICAgdHJlYXRfZ3JvdXA6IGQuZywgeWVhcjogZC55ZWFyLCBlOiBkLmUsIGF0dDogZC5hdHQsIGlkOiAnc3ludGgnXG4gIH0pKTtcblxuICBjb25zdCByZSA9IC9bQS1aXVtBLVpdLztcbiAgY29uc3Qgc2ltdWx0Q2JhbmQgPSBtb2RTcGVjRGlELmluY2x1ZGVzKCdzaW11bHQgY2JhbmQnKSA/IHRydWUgOiBmYWxzZTtcbiAgY29uc3QgazEyUmVzRGlERmlsdCA9IGRhdGFSZXNEaUQuZmlsdGVyKGQgPT4gXG4gICAgZC5jdHJsX3NwZWMgPT09IGN0cmxTcGVjRGlEXG4gICAgICAmJiBkLnRyZWF0X3NwZWMgPT09IHRyZWF0U3BlY1xuICAgICAgJiYgZC5zaW11bHRfY2JhbmQgPT09IHNpbXVsdENiYW5kXG4gICAgICAmJiBkLnkgPT09ICdlMDI3X2VsZW1fZWR1Y19kaXJlY3RfZXhwJ1xuICAgICAgJiYgcmUudGVzdChkLmcpXG4gICk7XG4gIGNvbnN0IGsxMlJlc0RpRCA9IGsxMlJlc0RpREZpbHQubWFwKGQgPT4gKHtcbiAgICB0cmVhdF9ncm91cDogZC5nLCB5ZWFyOiBkLnllYXIsIGU6IGQuZSwgYXR0OiBkLmF0dCwgaWQ6ICdkaWQnXG4gIH0pKTtcbiAgcmV0dXJuIFsuLi5rMTJSZXNTeW50aCwgLi4uazEyUmVzRGlEXTtcbn1cbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMTgiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJ0cmVhdEdyb3VwU3RhdGVzTWFwID0ge1xuICBjb25zdCB0cmVhdEdyb3VwcyA9IFtcbiAgICAnMTk5MCcsICcxOTkxJywgJzE5OTInLCAnMTk5MycsICcxOTk0JywgJzE5OTUnLCAnMTk5NicsICcxOTk3JywgXG4gICAgJzE5OTgnLCAnMTk5OScsICcyMDAwJywgJzIwMDEnLCAnMjAwMicsICcyMDAzJywgJzIwMDQnLCAnMjAwNScsXG4gICAgJzIwMDcnLCAnMjAwOCcsICcyMDA5JywgJzIwMTAnLCAnMjAxMicsICcyMDE1J1xuICBdO1xuICBsZXQgdHJlYXRTdGF0ZXMgPSBbXTtcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCAyMjsgaSsrKSB7XG4gICAgbGV0IHRyZWF0ZWRTdGF0ZXNHcm91cCA9IGRhdGFBbGxTdGF0ZXMuZmlsdGVyKGQgPT4gXG4gICAgICBkLnRyZWF0X3NwZWMgPT09IHRyZWF0U3BlY1xuICAgICAgICAmJiB0cmVhdEdyb3Vwc1tpXS5pbmNsdWRlcyhkLnRyZWF0X2dyb3VwKSBcbiAgICAgICAgJiYgZC50cmVhdGVkID09PSAxXG4gICAgKTtcbiAgICBpZiAoZHJvcEFLKSB7XG4gICAgICB0cmVhdGVkU3RhdGVzR3JvdXAgPSB0cmVhdGVkU3RhdGVzR3JvdXAuZmlsdGVyKGQgPT4gZC5zdCAhPT0gJ0FLJyk7XG4gICAgfVxuICAgIHRyZWF0U3RhdGVzW2ldID0gWy4uLm5ldyBTZXQodHJlYXRlZFN0YXRlc0dyb3VwLm1hcChkID0+IGQuc3QpKV07XG4gIH1cbiAgY29uc3Qga2V5c1ZhbHNDb21iaW5lZCA9IHRyZWF0R3JvdXBzLm1hcCgoa2V5LCBpKSA9PiBba2V5LCB0cmVhdFN0YXRlc1tpXV0pO1xuICByZXR1cm4gbmV3IE1hcChrZXlzVmFsc0NvbWJpbmVkKTtcbn1cbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMTkiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJ0cmVhdEdyb3VwSWRzID0ge1xuICBjb25zdCBpbml0ID0gZGF0YVRyZWF0TWVhbnNVc2UuZmlsdGVyKGQgPT4gXG4gICAgL15cXGQvLnRlc3QoZC50cmVhdF9ncm91cClcbiAgKTtcbiAgY29uc3Qgb3V0ID0gWy4uLm5ldyBTZXQoaW5pdC5tYXAoZCA9PiBkLnRyZWF0X2dyb3VwKSldO1xuICByZXR1cm4gb3V0LnNvcnQoKGEsIGIpID0+IGEgLSBiKTtcbn1cbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMjAiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJ0cmVhdFN0WWVhcnNMb29rdXAgPSB7XG4gIGNvbnN0IHNvcnRWYXIgPSBzb3J0Q2hyb25vID8gJ3RyZWF0X2dyb3VwJyA6ICdzdCc7XG4gIGxldCBpbml0ID0gZGF0YUFsbFN0YXRlc1VzZS5maWx0ZXIoZCA9PiBkLnRyZWF0ZWQgPT09IDEpO1xuICBpZiAoZHJvcEFLKSBpbml0ID0gaW5pdC5maWx0ZXIoZCA9PiBkLnN0ICE9PSAnQUsnKTtcbiAgbGV0IHNvcnRlZCA9IG51bGw7XG4gIHNvcnRlZCA9IGluaXQuc29ydCgoYSwgYikgPT4gYVtzb3J0VmFyXSA+IGJbc29ydFZhcl0gPyAxIDogLTEpO1xuICBjb25zdCBzdFRyZWF0ID0gc29ydGVkLm1hcChkID0+ICh7c3Q6IGQuc3QsIHllYXI6IGQudHJlYXRfZ3JvdXB9KSk7XG4gIGNvbnN0IHN0VHJlYXRVbmlxdWUgPSBzdFRyZWF0LmZpbHRlcigoZCwgaSwgc2VsZikgPT4gXG4gICAgaSA9PT0gc2VsZi5maW5kSW5kZXgodCA9PiB0LnN0ID09PSBkLnN0ICYmIHQueWVhciA9PT0gZC55ZWFyKVxuICApO1xuICByZXR1cm4gc3RUcmVhdFVuaXF1ZTtcbn1cbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMjEiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJ0cmVhdFN0SWRzID0gQXJyYXkuZnJvbSh0cmVhdFN0WWVhcnNMb29rdXAubWFwKGQgPT4gZC5zdCkpO1xudHJlYXRTdFllYXJzID0gQXJyYXkuZnJvbSh0cmVhdFN0WWVhcnNMb29rdXAubWFwKGQgPT4gZC55ZWFyKSk7XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTIyIiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoib3V0Y29tZU1hcCA9IG5ldyBNYXAoW1xuICBbJ0stMTInLCAnZTAyN19lbGVtX2VkdWNfZGlyZWN0X2V4cCddLFxuICBbJ0FsbCBOb24tSy0xMicsICdlMDAzeF9kaXJlY3RfZXhwZW5kaXR1cmVfbm9uX2sxMiddLFxuICBbJ0dlbiBOb24tSy0xMicsICdlMDE0eF9kaXJlY3RfZ2VuZXJhbF9leHBlbmRfbm9uX2sxMiddLFxuICBbJ0hpZ2hlciBFZCcsICdlMDMwX3RvdGFsX2hpZ2hfZWRfZGlyX2V4cCddLFxuICBbJ0hlYWx0aCcsICdlMDU1X2hlYWx0aF9kaXJlY3RfZXhwZW5kJ10sXG4gIFsnV2VsZmFyZScsICdlMDkwX3B1YmxpY193ZWxmX2RpcmVjdF9leHAnXSxcbiAgWydQYXJrcyAmIFJlYycsICdlMDg0X3BhcmtzX3JlY19kaXJlY3RfZXhwJ10sXG4gIFsnSG91c2UgJiBDb21tJywgJ2UwNzRfaG91c19jb21fZGlyZWN0X2V4cCddLFxuICBbJ0hpZ2h3YXlzJywgJ2UwNjVfdG90YWxfaGlnaHdheXNfZGlyX2V4cCddLFxuICBbJ0RlYnQnLCAnZDAxX3RvdGFsX2RlYnRfb3V0c3RhbmRpbmcnXSxcbiAgWydUb3RhbCBSZXYnLCAncjAyX3RvdGFsX3Jldl9vd25fc291cmNlcyddLFxuICBbJ0dlbiBSZXYnLCAncjA0X2dlbl9yZXZfb3duX3NvdXJjZXMnXSxcbiAgWydUYXggUmV2JywgJ3IwNV90b3RhbF90YXhlcyddLFxuICBbJ1Byb3AgVGF4JywgJ3IwNl9wcm9wZXJ0eV90YXhfdDAxJ10sXG4gIFsnTm9uLVByb3AgVGF4JywgJ3IwN19ub25fcHJvcGVydHlfdGF4ZXMnXVxuXSk7XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTIzIiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoidHJlYXRNYXAgPSBuZXcgTWFwKFtcbiAgWydmaXJzdCcsICdmaXJzdCddLFxuICBbJ3Byb2cnLCAncHJvZyddLFxuICBbJ2ZpcnN0IGNvdXJ0JywgJ2ZpcnN0X2NvdXJ0J10sXG4gIFsncHJvZyBjb3VydCcsICdwcm9nX2NvdXJ0J11cbl0pO1xuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0yNCIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6InZpZXdvZiBzZWxlY3RlZE91dGNvbWUgPSBJbnB1dHMucmFkaW8oXG4gIG91dGNvbWVNYXAsIHt2YWx1ZTogJ2UwMjdfZWxlbV9lZHVjX2RpcmVjdF9leHAnfVxuKTtcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMjUiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJ2aWV3b2Ygb3ZlcmxheUsxMiA9IElucHV0cy50b2dnbGUoe2xhYmVsOiAnb3ZlcmxheSBLLTEyJywgdmFsdWU6IHRydWV9KTtcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMjYiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJ2aWV3b2YgdHJlYXRTcGVjID0gSW5wdXRzLnJhZGlvKHRyZWF0TWFwLCB7dmFsdWU6ICdmaXJzdF9jb3VydCd9KTtcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMjciLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJ2aWV3b2Ygc3RhY2tlZCA9IElucHV0cy5yYWRpbyhcbiAgWyc1JywgJzgnLCAnMTInLCAnbm8nXSxcbiAge2xhYmVsOiBodG1sYDxpPnN0YWNrZWQ8L2k+YCwgdmFsdWU6ICdubyd9XG4pO1xuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0yOCIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6InZpZXdvZiBzaG93RGlEID0gSW5wdXRzLnJhZGlvKFxuICBbJ25ldmVyJywgJ25vdCB5ZXQnLCAnbm9uZSddLCBcbiAge2xhYmVsOiBodG1sYDxpPkRpRDwvaT5gLCB2YWx1ZTogJ25ldmVyJ31cbik7XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTI5IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoidmlld29mIHNob3dTeW50aCA9IElucHV0cy50b2dnbGUoXG4gIHtsYWJlbDogaHRtbGA8aT5zeW50aDwvaT5gLCB2YWx1ZXM6IFsnbmV2ZXInLCAnbm9uZSddLCB2YWx1ZTogJ25ldmVyJ31cbik7XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTMwIiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiY3RybFNwZWNEaUQgPSBzdGFja2VkID09PSAnbm8nIHwgc2hvd0RpRCA9PT0gJ25vbmUnID8gXG4gIHNob3dEaUQgOiAnc3RhY2tlZCAnICsgc3RhY2tlZDtcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMzEiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJjdHJsU3BlY1N5bnRoID0gc3RhY2tlZCA9PT0gJ25vJyB8IHNob3dTeW50aCA9PT0gJ25vbmUnID8gXG4gIHNob3dTeW50aCA6ICdzdGFja2VkICcgKyBzdGFja2VkO1xuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0zMiIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6InZpZXdvZiBtb2RlbFJlc3VsdHMgPSBJbnB1dHMudG9nZ2xlKHtsYWJlbDogJ1NIT1cgUkVTVUxUUyd9KTtcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMzMiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJ2aWV3b2Ygc2hvd0NJID0gSW5wdXRzLnRvZ2dsZSh7bGFiZWw6ICdzaG93IENJJywgdmFsdWU6IHRydWV9KTtcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMzQiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJ2aWV3b2YgbW9kU3BlY0RpRCA9IElucHV0cy5jaGVja2JveChcbiAgWydzaW11bHQgY2JhbmQnXSwgXG4gIHtsYWJlbDogaHRtbGA8aT5EaUQgb3B0aW9uczwvaT5gLCB2YWx1ZTogWydzaW11bHQgY2JhbmQnXX1cbik7XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTM1IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoidmlld29mIHNob3dTdWJncm91cHMgPSBJbnB1dHMudG9nZ2xlKHtsYWJlbDogJ1NIT1cgU1VCR1JQUyd9KTtcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMzYiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJ2aWV3b2Ygc3ViZ3JvdXBzVG9TaG93ID0gSW5wdXRzLmNoZWNrYm94KFxuICBbJ3RyZWF0ZWQnLCAndW50cmVhdGVkJywgJ2N0cmwsIERpRCcsICdjdHJsLCBzeW50aCddLCBcbiAge3ZhbHVlOiBbJ3RyZWF0ZWQnLCAnY3RybCwgc3ludGgnLCAnY3RybCwgRGlEJ119XG4pO1xuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0zNyIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6InZpZXdvZiBkcm9wQUsgPSBJbnB1dHMudG9nZ2xlKHtsYWJlbDogJ2V4Y2x1ZGUgQUsnLCB2YWx1ZTogdHJ1ZX0pO1xuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0zOCIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6InZpZXdvZiBjb25zaXN0ZW50QXhlcyA9IElucHV0cy50b2dnbGUoe2xhYmVsOiAnY29uc2lzdGVudCBheGVzJywgdmFsdWU6IGZhbHNlfSk7XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTM5IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoidmlld29mIGZlID0gSW5wdXRzLnRvZ2dsZSh7bGFiZWw6ICdmaXhlZCBlZmZlY3RzJywgdmFsdWU6IHRydWV9KTtcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtNDAiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJ2aWV3b2Ygc29ydENocm9ubyA9IElucHV0cy50b2dnbGUoe2xhYmVsOiAnc29ydCBzdGF0ZXMgY2hyb25vJ30pO1xuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC00MSIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6InZpZXdvZiBzeW50aEN0cmxNYWduaWZpZXIgPSBJbnB1dHMucmFuZ2UoXG4gIFsxLCAzXSwge2xhYmVsOiAnbWFnbmlmeSBTQyBzdGF0ZXMnLCBzdGVwOiAwLjEsIHZhbHVlOiAxfVxuKTtcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtNDIiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJtdXRhYmxlIG9qc0NlbGxJZCA9IHtcbiAgY29uc3Qgb2pzQ2VsbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgJ2Rpdi5tYWluIC5hY3RpdmUgW2lkKj1cIm9qcy1jZWxsLVwiXSdcbiAgKTtcbiAgcmV0dXJuIG9qc0NlbGwuaWQ7XG59O1xuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC00MyIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6InBhZ2VUYWIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcubmF2LWxpbmtbcm9sZT1cInRhYlwiXScpXG5wYWdlVGFiLmZvckVhY2goZWwgPT4ge1xuICBlbC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgY29uc3Qgb2pzQ2VsbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICAnZGl2Lm1haW4gLmFjdGl2ZS5zaG93IFtpZCo9XCJvanMtY2VsbC1cIl0nXG4gICAgKTtcbiAgICBtdXRhYmxlIG9qc0NlbGxJZCA9IG9qc0NlbGwuaWRcbiAgfSk7XG59KTtcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtNDQiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJleHBhbmRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuYnNsaWItZnVsbC1zY3JlZW4tZW50ZXInKTtcbmV4cGFuZEJ1dHRvbi5mb3JFYWNoKGVsID0+IHtcbiAgZWwuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbihldmVudCkge1xuICAgIGNvbnN0IHBhcmVudEVsID0gZXZlbnQuY3VycmVudFRhcmdldC5jbG9zZXN0KCdbZGF0YS1mdWxsLXNjcmVlbj1cInRydWVcIl0nKTtcbiAgICBjb25zdCBvanNDZWxsID0gcGFyZW50RWwucXVlcnlTZWxlY3RvcignW2lkKj1cIm9qcy1jZWxsLVwiXScpO1xuICAgIG11dGFibGUgb2pzQ2VsbElkID0gb2pzQ2VsbC5pZDtcbiAgfSk7XG59KTtcbmV4cGFuZEJ1dHRvbi5mb3JFYWNoKGVsID0+IHtcbiAgZWwuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbihldmVudCkge1xuICAgIG11dGFibGUgZnVsbCA9IHRydWU7XG4gIH0pO1xufSk7XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTQ1IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiY2xvc2VCdXR0b25QYXJlbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdkaXYubWFpbicpO1xuY2xvc2VCdXR0b25QYXJlbnQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbihldmVudCkge1xuICBpZiAoXG4gICAgZXZlbnQudGFyZ2V0Lm1hdGNoZXMoXG4gICAgICAnLmJzbGliLWZ1bGwtc2NyZWVuLWV4aXQsICNic2xpYi1mdWxsLXNjcmVlbi1vdmVybGF5LCBzdmcuYmkuYmkteC1sZywgc3ZnLmJpLmJpLXgtbGcgcGF0aCdcbiAgICApXG4gICkge1xuICAgIG11dGFibGUgZnVsbCA9IGZhbHNlO1xuICB9XG59KVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC00NiIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6ImNvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyMnICsgb2pzQ2VsbElkKTtcbmRpbXMgPSBHZW5lcmF0b3JzLm9ic2VydmUobm90aWZ5ID0+IHtcbiAgY29uc3Qgb2JzZXJ2ZXIgPSBuZXcgUmVzaXplT2JzZXJ2ZXIoZW50cmllcyA9PiB7XG4gICAgbm90aWZ5KGVudHJpZXNbMF0uY29udGVudFJlY3QpO1xuICB9KTtcbiAgb2JzZXJ2ZXIub2JzZXJ2ZShjb250YWluZXIucGFyZW50Tm9kZSk7XG4gIHJldHVybiAoKSA9PiBvYnNlcnZlci5kaXNjb25uZWN0KCk7XG59KTtcbmhlaWdodCA9IGRpbXMuaGVpZ2h0O1xubXV0YWJsZSB3aWR0aCA9IGRpbXMud2lkdGg7XG5tdXRhYmxlIGZ1bGwgPSBmYWxzZTtcbmh0ID0gZnVsbCA/IGRpbXMuaGVpZ2h0IDogTWF0aC5taW4oMjI2LCBkaW1zLndpZHRoICogLjcpO1xudGlja051bVkgPSBNYXRoLm1heChoZWlnaHQgLyA1MCwgMik7XG50aWNrTnVtWCA9IE1hdGgubWF4KHdpZHRoIC8gNzUsIDIpO1xuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC00NyIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6Im1hcmdpbiA9IHtyZXR1cm4ge3RvcDogMjAsIHJpZ2h0OiAyMCwgYm90dG9tOiAzMCwgbGVmdDogNDB9O307XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTQ4IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoicGxvdFRyZW5kcyA9IGZ1bmN0aW9uKHRyZWF0R3JvdXApIHtcbiAgXG4gIC8vIFZhcmlhYmxlIFNldHVwID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4gIGxldCB0cmVhdFllYXIgPSB0cmVhdEdyb3VwO1xuICBpZiAodHJlYXRHcm91cC5sZW5ndGggPT09IDIpIHtcbiAgICBmb3IgKGNvbnN0IFtrZXksIHZhbHVlXSBvZiB0cmVhdEdyb3VwU3RhdGVzTWFwLmVudHJpZXMoKSkge1xuICAgICAgaWYgKHZhbHVlLmluY2x1ZGVzKHRyZWF0R3JvdXApKSB7XG4gICAgICAgIHRyZWF0WWVhciA9IGtleTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgbGV0IHN0YWNrZWRZciA9IG51bGw7XG4gIGlmIChjdHJsU3BlY0RpRC5pbmNsdWRlcygnc3RhY2tlZCcpKSB7XG4gICAgc3RhY2tlZFlyID0gTnVtYmVyKGN0cmxTcGVjRGlELm1hdGNoKC9cXGRcXGQ/LykpO1xuICB9XG5cbiAgLy8gRGF0YSBTZXR1cCA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbiAgLy8vLyBNZWFucyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgbGV0IGRhdGFUcmVhdE1lYW5HID0gbnVsbDtcbiAgaWYgKHRyZWF0R3JvdXAubGVuZ3RoID09PSAyKSB7XG4gICAgZGF0YVRyZWF0TWVhbkcgPSBkYXRhQWxsU3RhdGVzVXNlLmZpbHRlcihkID0+XG4gICAgICB0cmVhdEdyb3VwLmluY2x1ZGVzKGQuc3QpICYmIGQudHJlYXRlZCA9PT0gMVxuICAgICk7XG4gIH0gZWxzZSB7XG4gICAgZGF0YVRyZWF0TWVhbkcgPSBkYXRhVHJlYXRNZWFuc1VzZS5maWx0ZXIoZCA9PiBcbiAgICAgIHRyZWF0R3JvdXAuaW5jbHVkZXMoZC50cmVhdF9ncm91cClcbiAgICApO1xuICB9XG4gIGxldCBkYXRhQ3RybE1lYW5EaURHID0gZGF0YUN0cmxNZWFuc0RpRFVzZS5maWx0ZXIoZCA9PiBcbiAgICB0cmVhdFllYXIuaW5jbHVkZXMoZC50cmVhdF9ncm91cClcbiAgKTtcbiAgaWYgKFxuICAgIGN0cmxTcGVjRGlELmluY2x1ZGVzKCdzdGFja2VkJykgJiYgTnVtYmVyKHRyZWF0WWVhcikgKyBzdGFja2VkWXIgLSAxID4gMjAxOVxuICApIHtcbiAgICBkYXRhQ3RybE1lYW5EaURHID0gW3t5ZWFyOiAxOTgzLCBvdXRjb21lOiAwLCB0cmVhdGVkOiAwLCBzdDogJ2JsYW5rJ31dO1xuICB9XG4gIGNvbnN0IGRhdGFDdHJsTWVhblN5bnRoRyA9IGRhdGFDdHJsTWVhbnNTeW50aFVzZS5maWx0ZXIoZCA9PiBcbiAgICB0cmVhdEdyb3VwLmluY2x1ZGVzKGQudHJlYXRfZ3JvdXApXG4gICk7XG5cbiAgLy8vLyBTdGF0ZXMsIGZpbHRlciBieSB0cmVhdCBncm91cCAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgbGV0IGRhdGFBbGxTdGF0ZXNHID0gZGF0YUFsbFN0YXRlc1VzZS5maWx0ZXIoZCA9PiBcbiAgICB0cmVhdFllYXIuaW5jbHVkZXMoZC50cmVhdF9ncm91cClcbiAgKTtcbiAgaWYgKHRyZWF0R3JvdXAubGVuZ3RoID09PSAyKSB7XG4gICAgZGF0YUFsbFN0YXRlc0cgPSBkYXRhQWxsU3RhdGVzRy5maWx0ZXIoZCA9PiBcbiAgICAgIGQudHJlYXRlZCA9PT0gMCB8fCB0cmVhdEdyb3VwLmluY2x1ZGVzKGQuc3QpXG4gICAgKTtcbiAgfVxuICBjb25zdCBkYXRhQ3RybFN0YXRlc0RpREcgPSBkYXRhQ3RybFN0YXRlc0RpRFVzZS5maWx0ZXIoZCA9PlxuICAgIHRyZWF0WWVhci5pbmNsdWRlcyhkLnRyZWF0X2dyb3VwKVxuICApO1xuICBjb25zdCBkYXRhQ3RybFN0YXRlc1N5bnRoRyA9IGRhdGFDdHJsU3RhdGVzU3ludGhVc2UuZmlsdGVyKGQgPT4gXG4gICAgdHJlYXRHcm91cC5pbmNsdWRlcyhkLnRyZWF0X2dyb3VwKSBcbiAgKTtcblxuICAvLy8vIFN0YXRlcywgbm9uLXN5bnRoIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuICBsZXQgZGF0YVN0YXRlc01haW4gPSBkYXRhQWxsU3RhdGVzRztcbiAgaWYgKCFzdWJncm91cHNUb1Nob3cuaW5jbHVkZXMoJ3RyZWF0ZWQnKSkge1xuICAgIGRhdGFTdGF0ZXNNYWluID0gZGF0YVN0YXRlc01haW4uZmlsdGVyKGQgPT4gZC50cmVhdGVkID09PSAwKTtcbiAgfVxuICBpZiAoIXN1Ymdyb3Vwc1RvU2hvdy5pbmNsdWRlcygndW50cmVhdGVkJykpIHtcbiAgICBpZiAoc3ViZ3JvdXBzVG9TaG93LmluY2x1ZGVzKCdjdHJsLCBEaUQnKSAmJiBjdHJsU3BlY0RpRCAhPT0gJ25vbmUnKSB7XG4gICAgICBjb25zdCBjdHJsU3RhdGVzID0gZGF0YUN0cmxTdGF0ZXNEaURHLm1hcChkID0+IGQuY3RybF9zdGF0ZXMpWzBdO1xuICAgICAgZGF0YVN0YXRlc01haW4gPSBkYXRhU3RhdGVzTWFpbi5maWx0ZXIoZCA9PiBcbiAgICAgICAgIShkLnRyZWF0ZWQgPT09IDAgJiYgIWN0cmxTdGF0ZXMuaW5jbHVkZXMoZC5zdCkpXG4gICAgICApO1xuICAgICAgaWYgKGN0cmxTcGVjRGlELmluY2x1ZGVzKCdzdGFja2VkJykpIHtcbiAgICAgICAgZGF0YVN0YXRlc01haW4gPSBkYXRhU3RhdGVzTWFpbi5maWx0ZXIoZCA9PlxuICAgICAgICAgICEoZC50cmVhdGVkID09PSAwICYmIGQueWVhciA+PSBOdW1iZXIodHJlYXRZZWFyKSArIHN0YWNrZWRZcilcbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICAgIGlmIChOdW1iZXIodHJlYXRZZWFyKSArIHN0YWNrZWRZciAtIDEgPiAyMDE5KSB7XG4gICAgICAgIGRhdGFTdGF0ZXNNYWluID0gZGF0YVN0YXRlc01haW4uZmlsdGVyKGQgPT4gZC50cmVhdGVkICE9PSAwKTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgZGF0YVN0YXRlc01haW4gPSBkYXRhU3RhdGVzTWFpbi5maWx0ZXIoZCA9PiBkLnRyZWF0ZWQgIT09IDApO1xuICAgIH1cbiAgfVxuICBpZiAoIXNob3dTdWJncm91cHMpIGRhdGFTdGF0ZXNNYWluID0gW1xuICAgIHt5ZWFyOiAxOTgzLCBvdXRjb21lOiAwLCB0cmVhdGVkOiAwLCBzdDogJ2JsYW5rJ31cbiAgXTtcbiAgaWYgKHNob3dTdWJncm91cHMgJiYgZGF0YVN0YXRlc01haW4ubGVuZ3RoID09PSAwKSBkYXRhU3RhdGVzTWFpbiA9IFtcbiAgICB7eWVhcjogMTk4Mywgb3V0Y29tZTogMCwgdHJlYXRlZDogMCwgc3Q6ICdibGFuayd9XG4gIF07XG5cbiAgLy8vLyBTdGF0ZXMsIHN5bnRoIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgY29uc3QgZGF0YVN0YXRlc1N5bnRoID0gZGF0YUFsbFN0YXRlc0cuZmlsdGVyKGQgPT4gXG4gICAgZGF0YUN0cmxTdGF0ZXNTeW50aEcubWFwKGQgPT4gZC5zdCkuaW5jbHVkZXMoZC5zdClcbiAgKTtcbiAgY29uc3Qgc3ludGhXdHNNYXAgPSBuZXcgTWFwKGRhdGFDdHJsU3RhdGVzU3ludGhHLm1hcChkID0+IFtkLnN0LCBkLndlaWdodF0pKTtcbiAgbGV0IGRhdGFTdGF0ZXNTeW50aFd0cyA9IGRhdGFTdGF0ZXNTeW50aC5tYXAoZCA9PiAoe1xuICAgIC4uLmQsIHdlaWdodDogc3ludGhXdHNNYXAuZ2V0KGQuc3QpXG4gIH0pKTtcbiAgaWYgKCFzaG93U3ViZ3JvdXBzIHx8ICFzdWJncm91cHNUb1Nob3cuaW5jbHVkZXMoJ2N0cmwsIHN5bnRoJykpIHtcbiAgICBkYXRhU3RhdGVzU3ludGhXdHMgPSBbe3llYXI6IDE5ODMsIG91dGNvbWU6IDAsIHN0OiAnYmxhbmsnLCB3ZWlnaHQ6IDB9XTtcbiAgfVxuXG4gIC8vLy8gT3ZlcmxheSBLLTEyIG1lYW5zIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gIGxldCBkYXRhSzEyTWVhbnNHID0gbnVsbDtcbiAgaWYgKG92ZXJsYXlLMTIgJiYgc2VsZWN0ZWRPdXRjb21lICE9PSAnZTAyN19lbGVtX2VkdWNfZGlyZWN0X2V4cCcpIHtcbiAgICBkYXRhSzEyTWVhbnNHID0gZGF0YUsxMk1lYW5zLmZpbHRlcihkID0+IFxuICAgICAgdHJlYXRHcm91cC5pbmNsdWRlcyhkLnRyZWF0X2dyb3VwKSB8fCBcbiAgICAgICAgdHJlYXRZZWFyLmluY2x1ZGVzKGQudHJlYXRfZ3JvdXApICYmIFxuICAgICAgICBbJ2N0cmwgZGlkJywgJ3RyZWF0IHN0JywgJ3RyZWF0IGdyb3VwJ10uaW5jbHVkZXMoZC5pZClcbiAgICApO1xuICAgIGlmICh0cmVhdEdyb3VwLmxlbmd0aCA9PT0gMikge1xuICAgICAgZGF0YUsxMk1lYW5zRyA9IGRhdGFLMTJNZWFuc0cuZmlsdGVyKGQgPT4gXG4gICAgICAgIGQuaWQgIT09ICd0cmVhdCBncm91cCcgJiZcbiAgICAgICAgICAhKCF0cmVhdEdyb3VwLmluY2x1ZGVzKGQuc3QpICYmIGQuaWQgPT09ICd0cmVhdCBzdCcpXG4gICAgICApO1xuICAgIH0gZWxzZSB7XG4gICAgICBkYXRhSzEyTWVhbnNHID0gZGF0YUsxMk1lYW5zRy5maWx0ZXIoZCA9PiBkLmlkICE9PSAndHJlYXQgc3QnKTtcbiAgICB9XG4gICAgaWYgKGN0cmxTcGVjRGlEID09PSAnbm9uZScpIHtcbiAgICAgIGRhdGFLMTJNZWFuc0cgPSBkYXRhSzEyTWVhbnNHLmZpbHRlcihkID0+IGQuaWQgIT09ICdjdHJsIGRpZCcpO1xuICAgIH1cbiAgICBpZiAoY3RybFNwZWNTeW50aCA9PT0gJ25vbmUnKSB7XG4gICAgICBkYXRhSzEyTWVhbnNHID0gZGF0YUsxMk1lYW5zRy5maWx0ZXIoZCA9PiBkLmlkICE9PSAnY3RybCBzeW50aCcpO1xuICAgIH1cbiAgfVxuICBcbiAgLy8gU2NhbGUgRnVuY3Rpb25zID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbiAgLy8vLyBGaW5kIG1pbiAmIG1heCB5IGFuZCB4IHZhbHVlcyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgbGV0IG1heFgsIG1pblksIG1heFksIG1pbllUcmVhdCwgbWF4WVRyZWF0ID0gbnVsbDtcblxuICAvLy8vLy8gQ29uc2lzdGVudCBheGVzIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuICBpZiAoY29uc2lzdGVudEF4ZXMpIHtcbiAgICBtYXhYID0gZDMubWF4KGRhdGFUcmVhdE1lYW5zVXNlLCBkID0+IGQueWVhcik7XG4gICAgbWluWVRyZWF0ID0gZDMubWluKGRhdGFUcmVhdE1lYW5zVXNlLCBkID0+IGQub3V0Y29tZSk7XG4gICAgbWF4WVRyZWF0ID0gZDMubWF4KGRhdGFUcmVhdE1lYW5zVXNlLCBkID0+IGQub3V0Y29tZSk7XG5cbiAgICAvLy8vLy8vLyBTdGF0ZXMgc2hvd24gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgICBpZiAoc2hvd1N1Ymdyb3Vwcykge1xuICAgICAgbWluWSA9IGZlID8gXG4gICAgICAgIE1hdGgubWluKGQzLm1pbihkYXRhQWxsU3RhdGVzVXNlLCBkID0+IGQub3V0Y29tZSksIG1pbllUcmVhdCkgOiAwO1xuICAgICAgbWF4WSA9IE1hdGgubWF4KGQzLm1heChkYXRhQWxsU3RhdGVzVXNlLCBkID0+IGQub3V0Y29tZSksIG1heFlUcmVhdCk7XG5cbiAgICAvLy8vLy8vLyBNZWFucyBvbmx5IC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgICB9IGVsc2UgaWYgKGN0cmxTcGVjRGlEICE9PSAnbm9uZScgJiYgY3RybFNwZWNTeW50aCAhPT0gJ25vbmUnKSB7XG4gICAgICBpZiAoZmUpIHtcbiAgICAgICAgbWluWSA9IE1hdGgubWluKFxuICAgICAgICAgIGQzLm1pbihkYXRhQ3RybE1lYW5zRGlEVXNlLCBkID0+IGQub3V0Y29tZSksIFxuICAgICAgICAgIGQzLm1pbihkYXRhQ3RybE1lYW5zU3ludGhVc2UsIGQgPT4gZC5vdXRjb21lKSwgXG4gICAgICAgICAgbWluWVRyZWF0XG4gICAgICAgICk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBtaW5ZID0gMDtcbiAgICAgIH1cbiAgICAgIG1heFkgPSBNYXRoLm1heChcbiAgICAgICAgZDMubWF4KGRhdGFDdHJsTWVhbnNEaURVc2UsIGQgPT4gZC5vdXRjb21lKSwgXG4gICAgICAgIGQzLm1heChkYXRhQ3RybE1lYW5zU3ludGhVc2UsIGQgPT4gZC5vdXRjb21lKSwgXG4gICAgICAgIG1heFlUcmVhdFxuICAgICAgKTtcbiAgICB9IGVsc2UgaWYgKGN0cmxTcGVjU3ludGggPT09ICdub25lJykge1xuICAgICAgbWluWSA9IGZlID8gXG4gICAgICAgIE1hdGgubWluKGQzLm1pbihkYXRhQ3RybE1lYW5zRGlEVXNlLCBkID0+IGQub3V0Y29tZSksIG1pbllUcmVhdCkgOiAwO1xuICAgICAgbWF4WSA9IE1hdGgubWF4KGQzLm1heChkYXRhQ3RybE1lYW5zRGlEVXNlLCBkID0+IGQub3V0Y29tZSksIG1heFlUcmVhdCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIG1pblkgPSBmZSA/IFxuICAgICAgICBNYXRoLm1pbihkMy5taW4oZGF0YUN0cmxNZWFuc1N5bnRoVXNlLCBkID0+IGQub3V0Y29tZSksIG1pbllUcmVhdCkgOiAwO1xuICAgICAgbWF4WSA9IE1hdGgubWF4KGQzLm1heChkYXRhQ3RybE1lYW5zU3ludGhVc2UsIGQgPT4gZC5vdXRjb21lKSwgbWF4WVRyZWF0KTtcbiAgICB9XG4gIFxuICAvLy8vLy8gVmFyeWluZyBheGVzIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuICB9IGVsc2Uge1xuICAgIG1heFggPSBkMy5tYXgoZGF0YVRyZWF0TWVhbkcsIGQgPT4gZC55ZWFyKTtcbiAgICBtaW5ZVHJlYXQgPSBkMy5taW4oZGF0YVRyZWF0TWVhbkcsIGQgPT4gZC5vdXRjb21lKTtcbiAgICBtYXhZVHJlYXQgPSBkMy5tYXgoZGF0YVRyZWF0TWVhbkcsIGQgPT4gZC5vdXRjb21lKTtcblxuICAgIC8vLy8vLy8vIFN0YXRlcyBzaG93biAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuICAgIGlmIChzaG93U3ViZ3JvdXBzKSB7XG4gICAgICBpZiAoc3ViZ3JvdXBzVG9TaG93LmluY2x1ZGVzKCdjdHJsLCBzeW50aCcpICYmIGN0cmxTcGVjU3ludGggIT09ICdub25lJykge1xuICAgICAgICBpZiAoZmUpIHtcbiAgICAgICAgICBtaW5ZID0gTWF0aC5taW4oXG4gICAgICAgICAgICBkMy5taW4oZGF0YVN0YXRlc01haW4sIGQgPT4gZC5vdXRjb21lKSwgXG4gICAgICAgICAgICBkMy5taW4oZGF0YVN0YXRlc1N5bnRoV3RzLCBkID0+IGQub3V0Y29tZSksIFxuICAgICAgICAgICAgbWluWVRyZWF0XG4gICAgICAgICAgKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBtaW5ZID0gMDtcbiAgICAgICAgfVxuICAgICAgICBtYXhZID0gTWF0aC5tYXgoXG4gICAgICAgICAgZDMubWF4KGRhdGFTdGF0ZXNNYWluLCBkID0+IGQub3V0Y29tZSksIFxuICAgICAgICAgIGQzLm1heChkYXRhU3RhdGVzU3ludGhXdHMsIGQgPT4gZC5vdXRjb21lKSwgXG4gICAgICAgICAgbWF4WVRyZWF0XG4gICAgICAgICk7XG4gICAgICB9IGVsc2UgaWYgKGN0cmxTcGVjRGlEICE9PSAnbm9uZScgJiYgY3RybFNwZWNTeW50aCAhPT0gJ25vbmUnKSB7XG4gICAgICAgIG1pblkgPSBmZSA/IFxuICAgICAgICAgIE1hdGgubWluKFxuICAgICAgICAgICAgZDMubWluKGRhdGFTdGF0ZXNNYWluLCBkID0+IGQub3V0Y29tZSksXG4gICAgICAgICAgICBkMy5taW4oZGF0YUN0cmxNZWFuRGlERywgZCA9PiBkLm91dGNvbWUpLFxuICAgICAgICAgICAgZDMubWluKGRhdGFDdHJsTWVhblN5bnRoRywgZCA9PiBkLm91dGNvbWUpLFxuICAgICAgICAgICAgbWluWVRyZWF0XG4gICAgICAgICAgKSA6IDA7XG4gICAgICAgIG1heFkgPSBNYXRoLm1heChcbiAgICAgICAgICBkMy5tYXgoZGF0YVN0YXRlc01haW4sIGQgPT4gZC5vdXRjb21lKSwgXG4gICAgICAgICAgZDMubWF4KGRhdGFDdHJsTWVhbkRpREcsIGQgPT4gZC5vdXRjb21lKSxcbiAgICAgICAgICBkMy5tYXgoZGF0YUN0cmxNZWFuU3ludGhHLCBkID0+IGQub3V0Y29tZSksXG4gICAgICAgICAgbWF4WVRyZWF0XG4gICAgICAgICk7XG4gICAgICB9IGVsc2UgaWYgKGN0cmxTcGVjRGlEICE9PSAnbm9uZScgJiYgY3RybFNwZWNTeW50aCA9PT0gJ25vbmUnKSB7XG4gICAgICAgIG1pblkgPSBmZSA/IFxuICAgICAgICAgIE1hdGgubWluKFxuICAgICAgICAgICAgZDMubWluKGRhdGFTdGF0ZXNNYWluLCBkID0+IGQub3V0Y29tZSksXG4gICAgICAgICAgICBkMy5taW4oZGF0YUN0cmxNZWFuRGlERywgZCA9PiBkLm91dGNvbWUpLFxuICAgICAgICAgICAgbWluWVRyZWF0XG4gICAgICAgICAgKSA6IDA7XG4gICAgICAgIG1heFkgPSBNYXRoLm1heChcbiAgICAgICAgICBkMy5tYXgoZGF0YVN0YXRlc01haW4sIGQgPT4gZC5vdXRjb21lKSwgXG4gICAgICAgICAgZDMubWF4KGRhdGFDdHJsTWVhbkRpREcsIGQgPT4gZC5vdXRjb21lKSxcbiAgICAgICAgICBtYXhZVHJlYXRcbiAgICAgICAgKTtcbiAgICAgIH0gZWxzZSBpZiAoY3RybFNwZWNEaUQgPT09ICdub25lJyAmJiBjdHJsU3BlY1N5bnRoICE9PSAnbm9uZScpIHtcbiAgICAgICAgbWluWSA9IGZlID8gXG4gICAgICAgICAgTWF0aC5taW4oXG4gICAgICAgICAgICBkMy5taW4oZGF0YVN0YXRlc01haW4sIGQgPT4gZC5vdXRjb21lKSxcbiAgICAgICAgICAgIGQzLm1pbihkYXRhQ3RybE1lYW5TeW50aEcsIGQgPT4gZC5vdXRjb21lKSxcbiAgICAgICAgICAgIG1pbllUcmVhdFxuICAgICAgICAgICkgOiAwO1xuICAgICAgICBtYXhZID0gTWF0aC5tYXgoXG4gICAgICAgICAgZDMubWF4KGRhdGFTdGF0ZXNNYWluLCBkID0+IGQub3V0Y29tZSksIFxuICAgICAgICAgIGQzLm1heChkYXRhQ3RybE1lYW5TeW50aEcsIGQgPT4gZC5vdXRjb21lKSxcbiAgICAgICAgICBtYXhZVHJlYXRcbiAgICAgICAgKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIG1pblkgPSBmZSA/IFxuICAgICAgICAgIE1hdGgubWluKGQzLm1pbihkYXRhU3RhdGVzTWFpbiwgZCA9PiBkLm91dGNvbWUpLCBtaW5ZVHJlYXQpIDogMDtcbiAgICAgICAgbWF4WSA9IE1hdGgubWF4KGQzLm1heChkYXRhU3RhdGVzTWFpbiwgZCA9PiBkLm91dGNvbWUpLCBtYXhZVHJlYXQpO1xuICAgICAgfVxuXG4gICAgLy8vLy8vLy8gTWVhbnMgb25seSAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gICAgfSBlbHNlIGlmIChjdHJsU3BlY0RpRCAhPT0gJ25vbmUnICYmIGN0cmxTcGVjU3ludGggIT09ICdub25lJykge1xuICAgICAgaWYgKGZlKSB7XG4gICAgICAgIG1pblkgPSBNYXRoLm1pbihcbiAgICAgICAgICBkMy5taW4oZGF0YUN0cmxNZWFuRGlERywgZCA9PiBkLm91dGNvbWUpLCBcbiAgICAgICAgICBkMy5taW4oZGF0YUN0cmxNZWFuU3ludGhHLCBkID0+IGQub3V0Y29tZSksIFxuICAgICAgICAgIG1pbllUcmVhdFxuICAgICAgICApO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgbWluWSA9IDA7XG4gICAgICB9XG4gICAgICBtYXhZID0gTWF0aC5tYXgoXG4gICAgICAgIGQzLm1heChkYXRhQ3RybE1lYW5EaURHLCBkID0+IGQub3V0Y29tZSksIFxuICAgICAgICBkMy5tYXgoZGF0YUN0cmxNZWFuU3ludGhHLCBkID0+IGQub3V0Y29tZSksIFxuICAgICAgICBtYXhZVHJlYXRcbiAgICAgICk7XG4gICAgfSBlbHNlIGlmIChjdHJsU3BlY0RpRCAhPT0gJ25vbmUnICYmIGN0cmxTcGVjU3ludGggPT09ICdub25lJykge1xuICAgICAgbWluWSA9IGZlID8gXG4gICAgICAgIE1hdGgubWluKGQzLm1pbihkYXRhQ3RybE1lYW5EaURHLCBkID0+IGQub3V0Y29tZSksIG1pbllUcmVhdCkgOiAwO1xuICAgICAgbWF4WSA9IE1hdGgubWF4KGQzLm1heChkYXRhQ3RybE1lYW5EaURHLCBkID0+IGQub3V0Y29tZSksIG1heFlUcmVhdCk7XG4gICAgfSBlbHNlIGlmIChjdHJsU3BlY0RpRCA9PT0gJ25vbmUnICYmIGN0cmxTcGVjU3ludGggIT09ICdub25lJykge1xuICAgICAgbWluWSA9IGZlID8gXG4gICAgICAgIE1hdGgubWluKGQzLm1pbihkYXRhQ3RybE1lYW5TeW50aEcsIGQgPT4gZC5vdXRjb21lKSwgbWluWVRyZWF0KSA6IDA7XG4gICAgICBtYXhZID0gTWF0aC5tYXgoZDMubWF4KGRhdGFDdHJsTWVhblN5bnRoRywgZCA9PiBkLm91dGNvbWUpLCBtYXhZVHJlYXQpO1xuICAgIH0gZWxzZSB7XG4gICAgICBtaW5ZID0gZmUgPyBtaW5ZVHJlYXQgOiAwO1xuICAgICAgbWF4WSA9IG1heFlUcmVhdDtcbiAgICB9XG4gIH1cblxuICAvLy8vIElmIG92ZXJsYXlpbmcgSy0xMiBtZWFuc1xuICBpZiAob3ZlcmxheUsxMiAmJiBzZWxlY3RlZE91dGNvbWUgIT09ICdlMDI3X2VsZW1fZWR1Y19kaXJlY3RfZXhwJykge1xuICAgIG1pblkgPSBNYXRoLm1pbihtaW5ZLCBkMy5taW4oZGF0YUsxMk1lYW5zRywgZCA9PiBkLm91dGNvbWUpKTtcbiAgICBtYXhZID0gTWF0aC5tYXgobWF4WSwgZDMubWF4KGRhdGFLMTJNZWFuc0csIGQgPT4gZC5vdXRjb21lKSk7XG4gIH1cblxuICAvLy8vIERlZmluZSBzY2FsZSBmdW5jdGlvbnMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuICBjb25zdCB4ID0gZDMuc2NhbGVMaW5lYXIoKVxuICAgIC5kb21haW4oWzE5ODMsIG1heFhdKVxuICAgIC5yYW5nZShbbWFyZ2luLmxlZnQsIHdpZHRoIC0gbWFyZ2luLnJpZ2h0XSk7XG4gIGNvbnN0IHkgPSBkMy5zY2FsZUxpbmVhcigpXG4gICAgLmRvbWFpbihbbWluWSwgbWF4WV0pXG4gICAgLnJhbmdlKFtodCAtIG1hcmdpbi5ib3R0b20sIG1hcmdpbi50b3BdKVxuICAgIC5uaWNlKCk7XG4gIFxuICAvLyBQYXJlbnQgU1ZHID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuICBjb25zdCBzdmcgPSBkMy5jcmVhdGUoJ3N2ZycpXG4gICAgLmF0dHIoJ3dpZHRoJywgd2lkdGgpXG4gICAgLmF0dHIoJ2hlaWdodCcsIGh0KTtcbiAgXG4gIC8vIEF4ZXMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4gIGNvbnN0IHhBeGlzID0gZDMuYXhpc0JvdHRvbSh4KVxuICAgIC50aWNrcyh0aWNrTnVtWClcbiAgICAudGlja0Zvcm1hdChkMy5mb3JtYXQoJ2QnKSk7XG4gIGNvbnN0IHlBeGlzID0gZDMuYXhpc0xlZnQoeSlcbiAgICAudGlja3ModGlja051bVkpO1xuXG4gIHN2Zy5hcHBlbmQoJ2cnKVxuICAgIC5hdHRyKCd0cmFuc2Zvcm0nLCBgdHJhbnNsYXRlKDAsICR7aHQgLSBtYXJnaW4uYm90dG9tfSlgKVxuICAgIC5jYWxsKHhBeGlzKVxuICAgIC5zZWxlY3RBbGwoJy50aWNrIHRleHQnKVxuICAgIC5hdHRyKCdmb250LXNpemUnLCAnMTJweCcpO1xuICBzdmcuYXBwZW5kKCdnJylcbiAgICAuYXR0cigndHJhbnNmb3JtJywgYHRyYW5zbGF0ZSgke21hcmdpbi5sZWZ0fSwgMClgKVxuICAgIC5jYWxsKHlBeGlzKVxuICAgIC5zZWxlY3RBbGwoJy50aWNrIHRleHQnKVxuICAgIC5hdHRyKCdmb250LXNpemUnLCAnMTJweCcpO1xuICBcbiAgLy8gVHJlYXQgWWVhciBWZXJ0aWNhbCBMaW5lID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbiAgc3ZnLmFwcGVuZCgnbGluZScpXG4gICAgLmF0dHIoJ3N0cm9rZS13aWR0aCcsIDIpXG4gICAgLmF0dHIoJ3N0cm9rZScsICdibGFjaycpXG4gICAgLmF0dHIoJ3N0cm9rZS1kYXNoYXJyYXknLCA1KVxuICAgIC5hdHRyKCd4MScsIHgodHJlYXRZZWFyIC0gMSkpXG4gICAgLmF0dHIoJ3gyJywgeCh0cmVhdFllYXIgLSAxKSlcbiAgICAuYXR0cigneTEnLCBtYXJnaW4udG9wKVxuICAgIC5hdHRyKCd5MicsIGh0IC0gbWFyZ2luLmJvdHRvbSk7XG4gIFxuICAvLyBPdXRjb21lIFRyZW5kcyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuICBjb25zdCBsaW5lID0gZDMubGluZSgpLmRlZmluZWQoZCA9PiBcbiAgICAhaXNOYU4oZFsxXSkgJiBkWzFdICE9PSB1bmRlZmluZWQgJiBkWzFdICE9PSBudWxsXG4gICk7XG4gIFxuICAvLy8vIFN0YXRlLCBub24tc3ludGggLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuICBjb25zdCBwb2ludHNTdGF0ZSA9IGRhdGFTdGF0ZXNNYWluLm1hcChkID0+IFxuICAgIFt4KGQueWVhciksIHkoZC5vdXRjb21lKSwgZC5zdCwgZC50cmVhdGVkXVxuICApO1xuICBjb25zdCBncm91cHNTdGF0ZSA9IGQzLnJvbGx1cChcbiAgICBwb2ludHNTdGF0ZSwgXG4gICAgdiA9PiBPYmplY3QuYXNzaWduKHYsIHtzdGF0ZTogdlswXVsyXSwgdHJlYXRlZDogdlswXVszXX0pLCBcbiAgICBkID0+IGRbMl1cbiAgKTtcbiAgY29uc3QgcGF0aFN0YXRlID0gc3ZnLmFwcGVuZCgnZycpXG4gICAgLmF0dHIoJ2ZpbGwnLCAnbm9uZScpXG4gICAgLmF0dHIoJ3N0cm9rZS13aWR0aCcsIDIpXG4gICAgLmF0dHIoJ3N0cm9rZS1saW5lam9pbicsICdyb3VuZCcpXG4gICAgLmF0dHIoJ3N0cm9rZS1kYXNoYXJyYXknLCA1KVxuICAgIC5zZWxlY3RBbGwoJ3BhdGgnKVxuICAgIC5kYXRhKGdyb3Vwc1N0YXRlLnZhbHVlcygpKVxuICAgIC5qb2luKCdwYXRoJylcbiAgICAuc3R5bGUoJ21peC1ibGVuZC1tb2RlJywgJ211bHRpcGx5JylcbiAgICAuYXR0cignZCcsIGxpbmUpXG4gICAgLmF0dHIoJ3N0cm9rZScsICh7dHJlYXRlZH0pID0+IHRyZWF0ZWQgPT09IDEgPyAnaG90cGluaycgOiAnbGlnaHRza3libHVlJyk7XG5cbiAgLy8vLyBTdGF0ZSwgc3ludGggLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgY29uc3QgcG9pbnRzU3RhdGVTeW50aCA9IGRhdGFTdGF0ZXNTeW50aFd0cy5tYXAoZCA9PlxuICAgIFt4KGQueWVhciksIHkoZC5vdXRjb21lKSwgZC5zdCwgZC53ZWlnaHRdXG4gICk7XG4gIGNvbnN0IGdyb3Vwc1N0YXRlU3ludGggPSBkMy5yb2xsdXAoXG4gICAgcG9pbnRzU3RhdGVTeW50aCxcbiAgICB2ID0+IE9iamVjdC5hc3NpZ24odiwge3N0YXRlOiB2WzBdWzJdLCB3ZWlnaHQ6IHZbMF1bM119KSxcbiAgICBkID0+IGRbMl1cbiAgKTtcbiAgY29uc3QgcGF0aFN0YXRlU3ludGggPSBzdmcuYXBwZW5kKCdnJylcbiAgICAuYXR0cignZmlsbCcsICdub25lJylcbiAgICAuYXR0cignc3Ryb2tlLWxpbmVqb2luJywgJ3JvdW5kJylcbiAgICAuYXR0cignc3Ryb2tlJywgJ2xpZ2h0Z3JlZW4nKVxuICAgIC5zZWxlY3RBbGwoJ3BhdGgnKVxuICAgIC5kYXRhKGdyb3Vwc1N0YXRlU3ludGgudmFsdWVzKCkpXG4gICAgLmpvaW4oJ3BhdGgnKVxuICAgIC5zdHlsZSgnbWl4LWJsZW5kLW1vZGUnLCAnbXVsdGlwbHknKVxuICAgIC5hdHRyKCdzdHJva2Utd2lkdGgnLCAoe3dlaWdodH0pID0+IHdlaWdodCAqIDggKiBzeW50aEN0cmxNYWduaWZpZXIpXG4gICAgLmF0dHIoJ2QnLCBsaW5lKTtcblxuICAvLy8vIE1lYW4sIHRyZWF0IC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuICBjb25zdCBwb2ludHNUcmVhdE1lYW4gPSBkYXRhVHJlYXRNZWFuRy5tYXAoZCA9PiBcbiAgICBbeChkLnllYXIpLCB5KGQub3V0Y29tZSksIGQudHJlYXRfZ3JvdXBdXG4gICk7XG4gIGNvbnN0IGdyb3Vwc1RyZWF0TWVhbiA9IGQzLmdyb3VwKHBvaW50c1RyZWF0TWVhbiwgZCA9PiBkWzJdKTtcbiAgY29uc3QgcGF0aFRyZWF0TWVhbiA9IHN2Zy5hcHBlbmQoJ2cnKVxuICAgIC5hdHRyKCdmaWxsJywgJ25vbmUnKVxuICAgIC5hdHRyKCdzdHJva2Utd2lkdGgnLCAzLjUpXG4gICAgLmF0dHIoJ3N0cm9rZS1saW5lam9pbicsICdyb3VuZCcpXG4gICAgLmF0dHIoJ3N0cm9rZScsICdkZWVwcGluaycpXG4gICAgLnNlbGVjdEFsbCgncGF0aCcpXG4gICAgLmRhdGEoZ3JvdXBzVHJlYXRNZWFuLnZhbHVlcygpKVxuICAgIC5qb2luKCdwYXRoJylcbiAgICAuYXR0cignZCcsIGxpbmUpO1xuXG4gIC8vLy8gTWVhbiwgY3RybCBEaUQgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gIGNvbnN0IHBvaW50c0N0cmxNZWFuRGlEID0gZGF0YUN0cmxNZWFuRGlERy5tYXAoZCA9PiBcbiAgICBbeChkLnllYXIpLCB5KGQub3V0Y29tZSksIGQudHJlYXRfZ3JvdXBdXG4gICk7XG4gIGNvbnN0IGdyb3Vwc0N0cmxNZWFuRGlEID0gZDMuZ3JvdXAocG9pbnRzQ3RybE1lYW5EaUQsIGQgPT4gZFsyXSk7XG4gIGNvbnN0IHBhdGhDdHJsTWVhbkRpRCA9IHN2Zy5hcHBlbmQoJ2cnKVxuICAgIC5hdHRyKCdmaWxsJywgJ25vbmUnKVxuICAgIC5hdHRyKCdzdHJva2Utd2lkdGgnLCAzLjUpXG4gICAgLmF0dHIoJ3N0cm9rZS1saW5lam9pbicsICdyb3VuZCcpXG4gICAgLmF0dHIoJ3N0cm9rZScsICdkZWVwc2t5Ymx1ZScpXG4gICAgLnNlbGVjdEFsbCgncGF0aCcpXG4gICAgLmRhdGEoZ3JvdXBzQ3RybE1lYW5EaUQudmFsdWVzKCkpXG4gICAgLmpvaW4oJ3BhdGgnKVxuICAgIC5hdHRyKCdkJywgbGluZSk7XG5cbiAgLy8vLyBNZWFuLCBjdHJsIHN5bnRoIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgY29uc3QgcG9pbnRzQ3RybE1lYW5TeW50aCA9IGRhdGFDdHJsTWVhblN5bnRoRy5tYXAoZCA9PiBcbiAgICBbeChkLnllYXIpLCB5KGQub3V0Y29tZSksIGQudHJlYXRfZ3JvdXBdXG4gICk7XG4gIGNvbnN0IGdyb3Vwc0N0cmxNZWFuU3ludGggPSBkMy5ncm91cChwb2ludHNDdHJsTWVhblN5bnRoLCBkID0+IGRbMl0pO1xuICBjb25zdCBwYXRoQ3RybE1lYW5TeW50aCA9IHN2Zy5hcHBlbmQoJ2cnKVxuICAgIC5hdHRyKCdmaWxsJywgJ25vbmUnKVxuICAgIC5hdHRyKCdzdHJva2Utd2lkdGgnLCAzLjUpXG4gICAgLmF0dHIoJ3N0cm9rZS1saW5lam9pbicsICdyb3VuZCcpXG4gICAgLmF0dHIoJ3N0cm9rZScsICdzcHJpbmdncmVlbicpXG4gICAgLnNlbGVjdEFsbCgncGF0aCcpXG4gICAgLmRhdGEoZ3JvdXBzQ3RybE1lYW5TeW50aC52YWx1ZXMoKSlcbiAgICAuam9pbigncGF0aCcpXG4gICAgLmF0dHIoJ2QnLCBsaW5lKTtcbiAgXG4gIC8vLy8gSy0xMiBtZWFucyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICBcbiAgaWYgKG92ZXJsYXlLMTIgJiYgc2VsZWN0ZWRPdXRjb21lICE9PSAnZTAyN19lbGVtX2VkdWNfZGlyZWN0X2V4cCcpIHtcbiAgICBjb25zdCBwb2ludHNLMTIgPSBkYXRhSzEyTWVhbnNHLm1hcChkID0+IFt4KGQueWVhciksIHkoZC5vdXRjb21lKSwgZC5pZF0pO1xuICAgIGNvbnN0IGdyb3Vwc0sxMiA9IGQzLnJvbGx1cChcbiAgICAgIHBvaW50c0sxMiwgdiA9PiBPYmplY3QuYXNzaWduKHYsIHtpZDogdlswXVsyXX0pLCBkID0+IGRbMl1cbiAgICApO1xuICAgIGNvbnN0IHBhdGhLMTIgPSBzdmcuYXBwZW5kKCdnJylcbiAgICAgIC5hdHRyKCdmaWxsJywgJ25vbmUnKVxuICAgICAgLmF0dHIoJ3N0cm9rZS13aWR0aCcsIDMuNSlcbiAgICAgIC5hdHRyKCdzdHJva2UtbGluZWpvaW4nLCAncm91bmQnKVxuICAgICAgLmF0dHIoJ3N0cm9rZS1vcGFjaXR5JywgLjUpXG4gICAgICAuYXR0cignc3Ryb2tlLWRhc2hhcnJheScsIDUpXG4gICAgICAuc2VsZWN0QWxsKCdwYXRoJylcbiAgICAgIC5kYXRhKGdyb3Vwc0sxMi52YWx1ZXMoKSlcbiAgICAgIC5qb2luKCdwYXRoJylcbiAgICAgIC5hdHRyKCdkJywgbGluZSlcbiAgICAgIC5hdHRyKCdzdHJva2UnLCAoe2lkfSkgPT4ge1xuICAgICAgICBsZXQgb3V0ID0gbnVsbDtcbiAgICAgICAgc3dpdGNoIChpZCkge1xuICAgICAgICAgIGNhc2UgJ3RyZWF0IGdyb3VwJzpcbiAgICAgICAgICAgIG91dCA9ICdkZWVwcGluayc7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICBjYXNlICd0cmVhdCBzdCc6XG4gICAgICAgICAgICBvdXQgPSAnZGVlcHBpbmsnO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgY2FzZSAnY3RybCBkaWQnOlxuICAgICAgICAgICAgb3V0ID0gJ2RlZXBza3libHVlJztcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIGNhc2UgJ2N0cmwgc3ludGgnOlxuICAgICAgICAgICAgb3V0ID0gJ3NwcmluZ2dyZWVuJztcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvdXQ7XG4gICAgICB9KTtcbiAgfVxuICBcbiAgLy8gVG9vbHRpcCAoU3RhdGUgTmFtZSkgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbiAgY29uc3QgdG9vbHRpcCA9IHN2Zy5hcHBlbmQoJ3RleHQnKSAgXG4gICAgLmF0dHIoJ2Rpc3BsYXknLCAnbm9uZScpXG4gICAgLmF0dHIoJ3RleHQtYW5jaG9yJywgJ21pZGRsZScpXG4gICAgLmF0dHIoJ3knLCAtOCk7XG4gIFxuICAvLyBUaXRsZSA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgXG4gIGxldCBzdGF0ZU5hbWVzID0gbnVsbDtcbiAgaWYgKHRyZWF0R3JvdXAubGVuZ3RoID09PSAyKSB7XG4gICAgc3RhdGVOYW1lcyA9IHRyZWF0R3JvdXA7XG4gIH0gZWxzZSB7XG4gICAgc3RhdGVOYW1lcyA9IHRyZWF0R3JvdXBTdGF0ZXNNYXAuZ2V0KHRyZWF0R3JvdXApLmpvaW4oJywgJyk7XG4gIH1cbiAgc3ZnLmFwcGVuZCgndGV4dCcpXG4gICAgLmF0dHIoJ3gnLCB3aWR0aCAvIDIpXG4gICAgLmF0dHIoJ3knLCBtYXJnaW4udG9wIC0gMTApXG4gICAgLmF0dHIoJ3RleHQtYW5jaG9yJywgJ21pZGRsZScpXG4gICAgLnN0eWxlKCdmb250LXNpemUnLCAnMTJweCcpXG4gICAgLnRleHQodHJlYXRZZWFyICsgJzogJyArIHN0YXRlTmFtZXMpO1xuXG4gIC8vIEV2ZW50IExpc3RlbmVycyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4gIHN2Z1xuICAgIC5vbigncG9pbnRlcm1vdmUnLCBwb2ludGVyTW92ZWQpXG4gICAgLm9uKCdwb2ludGVybGVhdmUnLCBwb2ludGVyTGVmdCk7XG4gIFxuICByZXR1cm4gc3ZnLm5vZGUoKTtcblxuICAvLyBFdmVudCBIYW5kbGVyIEZ1bmN0aW9ucyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuICAvLy8vIFBvaW50ZXIgbW92ZWQgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuICBmdW5jdGlvbiBwb2ludGVyTW92ZWQoZXZlbnQpIHtcbiAgICBjb25zdCBbeG0sIHltXSA9IGQzLnBvaW50ZXIoZXZlbnQpO1xuICAgIGNvbnN0IGFsbFBvaW50cyA9IFsuLi5wb2ludHNTdGF0ZSwgLi4ucG9pbnRzU3RhdGVTeW50aF07XG4gICAgY29uc3QgaSA9IGQzLmxlYXN0SW5kZXgoYWxsUG9pbnRzLCAoW3gsIHldKSA9PiBNYXRoLmh5cG90KHggLSB4bSwgeSAtIHltKSk7XG4gICAgY29uc3QgW3hIb3ZlciwgeUhvdmVyLCBob3ZlcmVkU3RhdGVdID0gYWxsUG9pbnRzW2ldO1xuICAgIFxuICAgIHBhdGhTdGF0ZVxuICAgICAgLnN0eWxlKCdzdHJva2Utd2lkdGgnLCAoe3N0YXRlfSkgPT4gc3RhdGUgPT09IGhvdmVyZWRTdGF0ZSA/IDcgOiBudWxsKVxuICAgICAgLmZpbHRlcigoe3N0YXRlfSkgPT4gc3RhdGUgPT09IGhvdmVyZWRTdGF0ZSlcbiAgICAgIC5yYWlzZSgpO1xuICAgIFxuICAgIHBhdGhTdGF0ZVN5bnRoXG4gICAgICAuc3R5bGUoJ3N0cm9rZScsICh7c3RhdGV9KSA9PiBzdGF0ZSA9PT0gaG92ZXJlZFN0YXRlID8gJ2JsYWNrJyA6IG51bGwpXG4gICAgICAuZmlsdGVyKCh7c3RhdGV9KSA9PiBzdGF0ZSA9PT0gaG92ZXJlZFN0YXRlKVxuICAgICAgLnJhaXNlKCk7XG4gICAgXG4gICAgaWYgKHNob3dTdWJncm91cHMgJiBzdWJncm91cHNUb1Nob3cubGVuZ3RoID4gMCkge1xuICAgICAgdG9vbHRpcFxuICAgICAgICAuaHRtbChob3ZlcmVkU3RhdGUpXG4gICAgICAgIC5hdHRyKCd0cmFuc2Zvcm0nLCBgdHJhbnNsYXRlKCR7eEhvdmVyfSwgJHt5SG92ZXJ9KWApXG4gICAgICAgIC5hdHRyKCdkaXNwbGF5JywgbnVsbCk7XG4gICAgfVxuICB9XG5cbiAgLy8vLyBQb2ludGVyIGxlZnQgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgZnVuY3Rpb24gcG9pbnRlckxlZnQoKSB7XG4gICAgcGF0aFN0YXRlLnN0eWxlKCdzdHJva2Utd2lkdGgnLCBudWxsKTtcbiAgICBwYXRoU3RhdGVTeW50aC5zdHlsZSgnc3Ryb2tlJywgbnVsbCk7XG4gICAgdG9vbHRpcC5hdHRyKCdkaXNwbGF5JywgJ25vbmUnKTtcbiAgfVxufVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC00OSIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6InBsb3RSZXN1bHRzID0gZnVuY3Rpb24odHJlYXRHcm91cCkge1xuXG4gIC8vIERhdGEgU2V0dXAgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICBcbiAgLy8vLyBNYWluIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgbGV0IGRhdGFSZXNTeW50aEcsIGRhdGFSZXNEaURHID0gbnVsbDtcbiAgbGV0IHRyZWF0WWVhciA9IHRyZWF0R3JvdXA7XG4gIGlmICh0cmVhdEdyb3VwLmxlbmd0aCA9PT0gMikge1xuICAgIGRhdGFSZXNTeW50aEcgPSBkYXRhUmVzU3ludGhVc2VTdC5maWx0ZXIoZCA9PiBkLnRyZWF0X2dyb3VwID09PSB0cmVhdEdyb3VwKTtcbiAgICBkYXRhUmVzRGlERyA9IGRhdGFSZXNEaURVc2VTdC5maWx0ZXIoZCA9PiBkLnRyZWF0X2dyb3VwID09PSB0cmVhdEdyb3VwKTtcbiAgICBmb3IgKGNvbnN0IFtrZXksIHZhbHVlXSBvZiB0cmVhdEdyb3VwU3RhdGVzTWFwLmVudHJpZXMoKSkge1xuICAgICAgaWYgKHZhbHVlLmluY2x1ZGVzKHRyZWF0R3JvdXApKSB0cmVhdFllYXIgPSBrZXk7XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIGRhdGFSZXNTeW50aEcgPSBkYXRhUmVzU3ludGhVc2VHLmZpbHRlcihkID0+IGQudHJlYXRfZ3JvdXAgPT09IHRyZWF0R3JvdXApO1xuICAgIGRhdGFSZXNEaURHID0gZGF0YVJlc0RpRFVzZUcuZmlsdGVyKGQgPT4gZC50cmVhdF9ncm91cCA9PT0gdHJlYXRHcm91cCk7XG4gIH1cblxuICAvLy8vIE92ZXJsYXkgSy0xMiByZXN1bHRzIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuICBsZXQgZGF0YVJlc0sxMkcgPSBudWxsO1xuICBpZiAob3ZlcmxheUsxMiAmJiBzZWxlY3RlZE91dGNvbWUgIT09ICdlMDI3X2VsZW1fZWR1Y19kaXJlY3RfZXhwJykge1xuICAgIGlmICh0cmVhdEdyb3VwLmxlbmd0aCA9PT0gMikge1xuICAgICAgZGF0YVJlc0sxMkcgPSBkYXRhUmVzSzEyVXNlU3QuZmlsdGVyKGQgPT4gZC50cmVhdF9ncm91cCA9PT0gdHJlYXRHcm91cCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGRhdGFSZXNLMTJHID0gZGF0YVJlc0sxMlVzZUcuZmlsdGVyKGQgPT4gZC50cmVhdF9ncm91cCA9PT0gdHJlYXRHcm91cCk7XG4gICAgfVxuICAgIGlmIChjdHJsU3BlY0RpRCA9PT0gJ25vbmUnKSB7XG4gICAgICBkYXRhUmVzSzEyRyA9IGRhdGFSZXNLMTJHLmZpbHRlcihkID0+IGQuaWQgIT09ICdkaWQnKTtcbiAgICB9XG4gICAgaWYgKGN0cmxTcGVjU3ludGggPT09ICdub25lJykge1xuICAgICAgZGF0YVJlc0sxMkcgPSBkYXRhUmVzSzEyRy5maWx0ZXIoZCA9PiBkLmlkICE9PSAnc3ludGgnKTtcbiAgICB9XG4gIH1cbiAgXG4gIC8vIFNjYWxlIEZ1bmN0aW9ucyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4gIC8vLy8gRmluZCBtaW4gJiBtYXggeSBhbmQgeCB2YWx1ZXNcblxuICBsZXQgbWluWCwgbWF4WCwgbWluWSwgbWF4WSwgbWluWVZhciwgbWF4WVZhciA9IG51bGw7XG4gIGlmIChzaG93Q0kpIHtcbiAgICBtaW5ZVmFyID0gJ2NpX2xvdyc7XG4gICAgbWF4WVZhciA9ICdjaV91cCc7XG4gIH0gZWxzZSB7XG4gICAgbWluWVZhciA9ICdhdHQnO1xuICAgIG1heFlWYXIgPSAnYXR0JztcbiAgfVxuXG4gIC8vLy8vLyBDb25zaXN0ZW50IGF4ZXMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gIGlmIChjb25zaXN0ZW50QXhlcykge1xuICAgIGlmIChjdHJsU3BlY0RpRCAhPT0gJ25vbmUnICYmIGN0cmxTcGVjU3ludGggIT09ICdub25lJykge1xuICAgICAgaWYgKHRyZWF0R3JvdXAubGVuZ3RoID09PSAyKSB7XG4gICAgICAgIG1pblggPSBNYXRoLm1pbihcbiAgICAgICAgICBkMy5taW4oZGF0YVJlc1N5bnRoVXNlU3QsIGQgPT4gZC55ZWFyKSxcbiAgICAgICAgICBkMy5taW4oZGF0YVJlc0RpRFVzZVN0LCBkID0+IGQueWVhcilcbiAgICAgICAgKTtcbiAgICAgICAgbWF4WCA9IE1hdGgubWF4KFxuICAgICAgICAgIGQzLm1heChkYXRhUmVzU3ludGhVc2VTdCwgZCA9PiBkLnllYXIpLFxuICAgICAgICAgIGQzLm1heChkYXRhUmVzRGlEVXNlU3QsIGQgPT4gZC55ZWFyKVxuICAgICAgICApO1xuICAgICAgICBtaW5ZID0gTWF0aC5taW4oXG4gICAgICAgICAgZDMubWluKGRhdGFSZXNTeW50aFVzZVN0LCBkID0+IGRbbWluWVZhcl0pLFxuICAgICAgICAgIGQzLm1pbihkYXRhUmVzRGlEVXNlU3QsIGQgPT4gZFttaW5ZVmFyXSlcbiAgICAgICAgKTtcbiAgICAgICAgbWF4WSA9IE1hdGgubWF4KFxuICAgICAgICAgIGQzLm1heChkYXRhUmVzU3ludGhVc2VTdCwgZCA9PiBkW21heFlWYXJdKSxcbiAgICAgICAgICBkMy5tYXgoZGF0YVJlc0RpRFVzZVN0LCBkID0+IGRbbWF4WVZhcl0pXG4gICAgICAgICk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBtaW5YID0gTWF0aC5taW4oXG4gICAgICAgICAgZDMubWluKGRhdGFSZXNTeW50aFVzZUcsIGQgPT4gZC55ZWFyKSxcbiAgICAgICAgICBkMy5taW4oZGF0YVJlc0RpRFVzZUcsIGQgPT4gZC55ZWFyKVxuICAgICAgICApO1xuICAgICAgICBtYXhYID0gTWF0aC5tYXgoXG4gICAgICAgICAgZDMubWF4KGRhdGFSZXNTeW50aFVzZUcsIGQgPT4gZC55ZWFyKSxcbiAgICAgICAgICBkMy5tYXgoZGF0YVJlc0RpRFVzZUcsIGQgPT4gZC55ZWFyKVxuICAgICAgICApO1xuICAgICAgICBtaW5ZID0gTWF0aC5taW4oXG4gICAgICAgICAgZDMubWluKGRhdGFSZXNTeW50aFVzZUcsIGQgPT4gZFttaW5ZVmFyXSksXG4gICAgICAgICAgZDMubWluKGRhdGFSZXNEaURVc2VHLCBkID0+IGRbbWluWVZhcl0pXG4gICAgICAgICk7XG4gICAgICAgIG1heFkgPSBNYXRoLm1heChcbiAgICAgICAgICBkMy5tYXgoZGF0YVJlc1N5bnRoVXNlRywgZCA9PiBkW21heFlWYXJdKSxcbiAgICAgICAgICBkMy5tYXgoZGF0YVJlc0RpRFVzZUcsIGQgPT4gZFttYXhZVmFyXSlcbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKGN0cmxTcGVjRGlEID09PSAnbm9uZScgJiYgY3RybFNwZWNTeW50aCAhPT0gJ25vbmUnKSB7XG4gICAgICBpZiAodHJlYXRHcm91cC5sZW5ndGggPT09IDIpIHtcbiAgICAgICAgbWluWCA9IGQzLm1pbihkYXRhUmVzU3ludGhVc2VTdCwgZCA9PiBkLnllYXIpO1xuICAgICAgICBtYXhYID0gZDMubWF4KGRhdGFSZXNTeW50aFVzZVN0LCBkID0+IGQueWVhcik7XG4gICAgICAgIG1pblkgPSBkMy5taW4oZGF0YVJlc1N5bnRoVXNlU3QsIGQgPT4gZFttaW5ZVmFyXSk7XG4gICAgICAgIG1heFkgPSBkMy5tYXgoZGF0YVJlc1N5bnRoVXNlU3QsIGQgPT4gZFttYXhZVmFyXSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBtaW5YID0gZDMubWluKGRhdGFSZXNTeW50aFVzZUcsIGQgPT4gZC55ZWFyKTtcbiAgICAgICAgbWF4WCA9IGQzLm1heChkYXRhUmVzU3ludGhVc2VHLCBkID0+IGQueWVhcik7XG4gICAgICAgIG1pblkgPSBkMy5taW4oZGF0YVJlc1N5bnRoVXNlRywgZCA9PiBkW21pbllWYXJdKTtcbiAgICAgICAgbWF4WSA9IGQzLm1heChkYXRhUmVzU3ludGhVc2VHLCBkID0+IGRbbWF4WVZhcl0pO1xuICAgICAgfVxuICAgIH0gZWxzZSBpZiAoY3RybFNwZWNEaUQgIT09ICdub25lJyAmJiBjdHJsU3BlY1N5bnRoID09PSAnbm9uZScpIHtcbiAgICAgIGlmICh0cmVhdEdyb3VwLmxlbmd0aCA9PT0gMikge1xuICAgICAgICBtaW5YID0gZDMubWluKGRhdGFSZXNEaURVc2VTdCwgZCA9PiBkLnllYXIpO1xuICAgICAgICBtYXhYID0gZDMubWF4KGRhdGFSZXNEaURVc2VTdCwgZCA9PiBkLnllYXIpO1xuICAgICAgICBtaW5ZID0gZDMubWluKGRhdGFSZXNEaURVc2VTdCwgZCA9PiBkW21pbllWYXJdKTtcbiAgICAgICAgbWF4WSA9IGQzLm1heChkYXRhUmVzRGlEVXNlU3QsIGQgPT4gZFttYXhZVmFyXSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBtaW5YID0gZDMubWluKGRhdGFSZXNEaURVc2VHLCBkID0+IGQueWVhcik7XG4gICAgICAgIG1heFggPSBkMy5tYXgoZGF0YVJlc0RpRFVzZUcsIGQgPT4gZC55ZWFyKTtcbiAgICAgICAgbWluWSA9IGQzLm1pbihkYXRhUmVzRGlEVXNlRywgZCA9PiBkW21pbllWYXJdKTtcbiAgICAgICAgbWF4WSA9IGQzLm1heChkYXRhUmVzRGlEVXNlRywgZCA9PiBkW21heFlWYXJdKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAob3ZlcmxheUsxMiAmJiBzZWxlY3RlZE91dGNvbWUgIT09ICdlMDI3X2VsZW1fZWR1Y19kaXJlY3RfZXhwJykge1xuICAgICAgaWYgKGN0cmxTcGVjRGlEICE9PSAnbm9uZScgJiYgY3RybFNwZWNTeW50aCAhPT0gJ25vbmUnKSB7XG4gICAgICAgIGlmICh0cmVhdEdyb3VwLmxlbmd0aCA9PT0gMikge1xuICAgICAgICAgIG1pblkgPSBNYXRoLm1pbihtaW5ZLCBkMy5taW4oZGF0YVJlc0sxMlVzZVN0LCBkID0+IGQuYXR0KSk7XG4gICAgICAgICAgbWF4WSA9IE1hdGgubWF4KG1heFksIGQzLm1heChkYXRhUmVzSzEyVXNlU3QsIGQgPT4gZC5hdHQpKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBtaW5ZID0gTWF0aC5taW4obWluWSwgZDMubWluKGRhdGFSZXNLMTJVc2VHLCBkID0+IGQuYXR0KSk7XG4gICAgICAgICAgbWF4WSA9IE1hdGgubWF4KG1heFksIGQzLm1heChkYXRhUmVzSzEyVXNlRywgZCA9PiBkLmF0dCkpO1xuICAgICAgICB9XG4gICAgICB9IGVsc2UgaWYgKGN0cmxTcGVjRGlEID09PSAnbm9uZScgJiYgY3RybFNwZWNTeW50aCAhPT0gJ25vbmUnKSB7XG4gICAgICAgIGlmICh0cmVhdEdyb3VwLmxlbmd0aCA9PT0gMikge1xuICAgICAgICAgIGNvbnN0IGsxMlN5bnRoID0gZGF0YVJlc0sxMlVzZVN0LmZpbHRlcihkID0+IGQuaWQgPT09ICdzeW50aCcpO1xuICAgICAgICAgIG1pblkgPSBNYXRoLm1pbihtaW5ZLCBkMy5taW4oazEyU3ludGgsIGQgPT4gZC5hdHQpKTtcbiAgICAgICAgICBtYXhZID0gTWF0aC5tYXgobWF4WSwgZDMubWF4KGsxMlN5bnRoLCBkID0+IGQuYXR0KSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgY29uc3QgazEyU3ludGggPSBkYXRhUmVzSzEyVXNlRy5maWx0ZXIoZCA9PiBkLmlkID09PSAnc3ludGgnKTtcbiAgICAgICAgICBtaW5ZID0gTWF0aC5taW4obWluWSwgZDMubWluKGsxMlN5bnRoLCBkID0+IGQuYXR0KSk7XG4gICAgICAgICAgbWF4WSA9IE1hdGgubWF4KG1heFksIGQzLm1heChrMTJTeW50aCwgZCA9PiBkLmF0dCkpO1xuICAgICAgICB9XG4gICAgICB9IGVsc2UgaWYgKGN0cmxTcGVjRGlEICE9PSAnbm9uZScgJiYgY3RybFNwZWNTeW50aCA9PT0gJ25vbmUnKSB7XG4gICAgICAgIGlmICh0cmVhdEdyb3VwLmxlbmd0aCA9PT0gMikge1xuICAgICAgICAgIGNvbnN0IGsxMkRpRCA9IGRhdGFSZXNLMTJVc2VTdC5maWx0ZXIoZCA9PiBkLmlkID09PSAnZGlkJyk7XG4gICAgICAgICAgbWluWSA9IE1hdGgubWluKG1pblksIGQzLm1pbihrMTJEaUQsIGQgPT4gZC5hdHQpKTtcbiAgICAgICAgICBtYXhZID0gTWF0aC5tYXgobWF4WSwgZDMubWF4KGsxMkRpRCwgZCA9PiBkLmF0dCkpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGNvbnN0IGsxMkRpRCA9IGRhdGFSZXNLMTJVc2VHLmZpbHRlcihkID0+IGQuaWQgPT09ICdkaWQnKTtcbiAgICAgICAgICBtaW5ZID0gTWF0aC5taW4obWluWSwgZDMubWluKGsxMkRpRCwgZCA9PiBkLmF0dCkpO1xuICAgICAgICAgIG1heFkgPSBNYXRoLm1heChtYXhZLCBkMy5tYXgoazEyRGlELCBkID0+IGQuYXR0KSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIFxuICAvLy8vLy8gVmFyeWluZyBheGVzIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuICB9IGVsc2Uge1xuICAgIGlmIChjdHJsU3BlY0RpRCAhPT0gJ25vbmUnICYmIGN0cmxTcGVjU3ludGggIT09ICdub25lJykge1xuICAgICAgbWluWCA9IE1hdGgubWluKFxuICAgICAgICBkMy5taW4oZGF0YVJlc1N5bnRoRywgZCA9PiBkLnllYXIpLFxuICAgICAgICBkMy5taW4oZGF0YVJlc0RpREcsIGQgPT4gZC55ZWFyKVxuICAgICAgKTtcbiAgICAgIG1heFggPSBNYXRoLm1heChcbiAgICAgICAgZDMubWF4KGRhdGFSZXNTeW50aEcsIGQgPT4gZC55ZWFyKSxcbiAgICAgICAgZDMubWF4KGRhdGFSZXNEaURHLCBkID0+IGQueWVhcilcbiAgICAgICk7XG4gICAgICBtaW5ZID0gTWF0aC5taW4oXG4gICAgICAgIGQzLm1pbihkYXRhUmVzU3ludGhHLCBkID0+IGRbbWluWVZhcl0pLFxuICAgICAgICBkMy5taW4oZGF0YVJlc0RpREcsIGQgPT4gZFttaW5ZVmFyXSlcbiAgICAgICk7XG4gICAgICBtYXhZID0gTWF0aC5tYXgoXG4gICAgICAgIGQzLm1heChkYXRhUmVzU3ludGhHLCBkID0+IGRbbWF4WVZhcl0pLFxuICAgICAgICBkMy5tYXgoZGF0YVJlc0RpREcsIGQgPT4gZFttYXhZVmFyXSlcbiAgICAgICk7XG4gICAgfSBlbHNlIGlmIChjdHJsU3BlY0RpRCA9PT0gJ25vbmUnICYmIGN0cmxTcGVjU3ludGggIT09ICdub25lJykge1xuICAgICAgbWluWCA9IGQzLm1pbihkYXRhUmVzU3ludGhHLCBkID0+IGQueWVhcik7XG4gICAgICBtYXhYID0gZDMubWF4KGRhdGFSZXNTeW50aEcsIGQgPT4gZC55ZWFyKTtcbiAgICAgIG1pblkgPSBkMy5taW4oZGF0YVJlc1N5bnRoRywgZCA9PiBkW21pbllWYXJdKTtcbiAgICAgIG1heFkgPSBkMy5tYXgoZGF0YVJlc1N5bnRoRywgZCA9PiBkW21heFlWYXJdKTtcbiAgICB9IGVsc2UgaWYgKGN0cmxTcGVjRGlEICE9PSAnbm9uZScgJiYgY3RybFNwZWNTeW50aCA9PT0gJ25vbmUnKSB7XG4gICAgICBtaW5YID0gZDMubWluKGRhdGFSZXNEaURHLCBkID0+IGQueWVhcik7XG4gICAgICBtYXhYID0gZDMubWF4KGRhdGFSZXNEaURHLCBkID0+IGQueWVhcik7XG4gICAgICBtaW5ZID0gZDMubWluKGRhdGFSZXNEaURHLCBkID0+IGRbbWluWVZhcl0pO1xuICAgICAgbWF4WSA9IGQzLm1heChkYXRhUmVzRGlERywgZCA9PiBkW21heFlWYXJdKTtcbiAgICB9XG5cbiAgICBpZiAob3ZlcmxheUsxMiAmJiBzZWxlY3RlZE91dGNvbWUgIT09ICdlMDI3X2VsZW1fZWR1Y19kaXJlY3RfZXhwJykge1xuICAgICAgbWluWSA9IE1hdGgubWluKG1pblksIGQzLm1pbihkYXRhUmVzSzEyRywgZCA9PiBkLmF0dCkpO1xuICAgICAgbWF4WSA9IE1hdGgubWF4KG1heFksIGQzLm1heChkYXRhUmVzSzEyRywgZCA9PiBkLmF0dCkpO1xuICAgIH1cbiAgfVxuXG4gIC8vLy8gRGVmaW5lIHNjYWxlIGZ1bmN0aW9ucyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gIGNvbnN0IHggPSBkMy5zY2FsZUxpbmVhcigpXG4gICAgLmRvbWFpbihbbWluWCwgbWF4WF0pXG4gICAgLnJhbmdlKFttYXJnaW4ubGVmdCwgd2lkdGggLSBtYXJnaW4ucmlnaHRdKTtcbiAgY29uc3QgeSA9IGQzLnNjYWxlTGluZWFyKClcbiAgICAuZG9tYWluKFttaW5ZLCBtYXhZXSlcbiAgICAucmFuZ2UoW2h0IC0gbWFyZ2luLmJvdHRvbSwgbWFyZ2luLnRvcF0pXG4gICAgLm5pY2UoKTtcblxuICAvLyBQYXJlbnQgU1ZHID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuICBjb25zdCBzdmcgPSBkMy5jcmVhdGUoJ3N2ZycpXG4gICAgLmF0dHIoJ3dpZHRoJywgd2lkdGgpXG4gICAgLmF0dHIoJ2hlaWdodCcsIGh0KTtcblxuICAvLyBBeGVzID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuICBjb25zdCB4QXhpcyA9IGQzLmF4aXNCb3R0b20oeClcbiAgICAudGlja3ModGlja051bVgpXG4gICAgLnRpY2tGb3JtYXQoZDMuZm9ybWF0KCdkJykpO1xuICBjb25zdCB5QXhpcyA9IGQzLmF4aXNMZWZ0KHkpXG4gICAgLnRpY2tzKHRpY2tOdW1ZKTtcblxuICBzdmcuYXBwZW5kKCdnJylcbiAgICAuYXR0cigndHJhbnNmb3JtJywgYHRyYW5zbGF0ZSgwLCAke2h0IC0gbWFyZ2luLmJvdHRvbX0pYClcbiAgICAuY2FsbCh4QXhpcylcbiAgICAuc2VsZWN0QWxsKCcudGljayB0ZXh0JylcbiAgICAuYXR0cignZm9udC1zaXplJywgJzEycHgnKTtcbiAgc3ZnLmFwcGVuZCgnZycpXG4gICAgLmF0dHIoJ3RyYW5zZm9ybScsIGB0cmFuc2xhdGUoJHttYXJnaW4ubGVmdH0sIDApYClcbiAgICAuY2FsbCh5QXhpcylcbiAgICAuc2VsZWN0QWxsKCcudGljayB0ZXh0JylcbiAgICAuYXR0cignZm9udC1zaXplJywgJzEycHgnKTtcbiAgXG4gIC8vIEhvcml6b250YWwgTGluZSBhdCB5ID0gMCA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4gIHN2Zy5hcHBlbmQoJ2xpbmUnKVxuICAgIC5hdHRyKCdzdHJva2Utd2lkdGgnLCAyKVxuICAgIC5hdHRyKCdzdHJva2UnLCAnYmxhY2snKVxuICAgIC5hdHRyKCd4MScsIHgobWluWCkpXG4gICAgLmF0dHIoJ3gyJywgeChtYXhYKSlcbiAgICAuYXR0cigneTEnLCB5KDApKVxuICAgIC5hdHRyKCd5MicsIHkoMCkpXG5cbiAgLy8gVHJlYXQgWWVhciBWZXJ0aWNhbCBMaW5lID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbiAgc3ZnLmFwcGVuZCgnbGluZScpXG4gICAgLmF0dHIoJ3N0cm9rZS13aWR0aCcsIDIpXG4gICAgLmF0dHIoJ3N0cm9rZScsICdibGFjaycpXG4gICAgLmF0dHIoJ3N0cm9rZS1kYXNoYXJyYXknLCA1KVxuICAgIC5hdHRyKCd4MScsIHgodHJlYXRZZWFyIC0gMSkpXG4gICAgLmF0dHIoJ3gyJywgeCh0cmVhdFllYXIgLSAxKSlcbiAgICAuYXR0cigneTEnLCBtYXJnaW4udG9wKVxuICAgIC5hdHRyKCd5MicsIGh0IC0gbWFyZ2luLmJvdHRvbSk7XG5cbiAgLy8gUmVzdWx0cyBMaW5lcyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbiAgY29uc3QgbGluZSA9IGQzLmxpbmUoKVxuICAgIC5kZWZpbmVkKGQgPT4gIWlzTmFOKGRbMV0pICYgZFsxXSAhPT0gdW5kZWZpbmVkICYgZFsxXSAhPT0gbnVsbCk7XG4gIFxuICBsZXQgY2kgPSBudWxsO1xuICBpZiAoc2hvd0NJKSB7XG4gICAgY2kgPSBkMy5hcmVhKClcbiAgICAgIC5kZWZpbmVkKGQgPT4gIWlzTmFOKGRbMV0pICYgZFsxXSAhPT0gdW5kZWZpbmVkICYgZFsxXSAhPT0gbnVsbClcbiAgICAgIC54KGQgPT4gZFswXSlcbiAgICAgIC55MChkID0+IGRbNF0pXG4gICAgICAueTEoZCA9PiBkWzNdKVxuICB9XG5cbiAgLy8vLyBTeW50aCAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgY29uc3QgcG9pbnRzU3ludGggPSBkYXRhUmVzU3ludGhHLm1hcChkID0+IFxuICAgIFt4KGQueWVhciksIHkoZC5hdHQpLCBkLnRyZWF0X2dyb3VwLCB5KGQuY2lfbG93KSwgeShkLmNpX3VwKV1cbiAgKTtcbiAgY29uc3QgZ3JvdXBzU3ludGggPSBkMy5ncm91cChwb2ludHNTeW50aCwgZCA9PiBkWzJdKTtcblxuICAvLy8vLy8gQ29uZmlkZW5jZSBpbnRlcnZhbCAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuICBpZiAoc2hvd0NJKSB7XG4gICAgc3ZnLmFwcGVuZCgnZycpXG4gICAgICAuYXR0cignZmlsbCcsICdzcHJpbmdncmVlbicpXG4gICAgICAuYXR0cignb3BhY2l0eScsIDAuMjUpXG4gICAgICAuYXR0cignc3Ryb2tlJywgJ25vbmUnKVxuICAgICAgLnNlbGVjdEFsbCgncGF0aCcpXG4gICAgICAuZGF0YShncm91cHNTeW50aC52YWx1ZXMoKSlcbiAgICAgIC5qb2luKCdwYXRoJylcbiAgICAgIC5hdHRyKCdkJywgY2kpO1xuICB9XG4gIFxuICAvLy8vLy8gQVRUIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuICBjb25zdCBwYXRoU3ludGggPSBzdmcuYXBwZW5kKCdnJylcbiAgICAuYXR0cignZmlsbCcsICdub25lJylcbiAgICAuYXR0cignc3Ryb2tlLXdpZHRoJywgMy41KVxuICAgIC5hdHRyKCdzdHJva2UtbGluZWpvaW4nLCAncm91bmQnKVxuICAgIC5hdHRyKCdzdHJva2UnLCAnc3ByaW5nZ3JlZW4nKVxuICAgIC5zZWxlY3RBbGwoJ3BhdGgnKVxuICAgIC5kYXRhKGdyb3Vwc1N5bnRoLnZhbHVlcygpKVxuICAgIC5qb2luKCdwYXRoJylcbiAgICAuYXR0cignZCcsIGxpbmUpO1xuICBcbiAgLy8vLyBEaUQgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgY29uc3QgcG9pbnRzRGlEID0gZGF0YVJlc0RpREcubWFwKGQgPT4gXG4gICAgW3goZC55ZWFyKSwgeShkLmF0dCksIGQudHJlYXRfZ3JvdXAsIHkoZC5jaV9sb3cpLCB5KGQuY2lfdXApXVxuICApO1xuICBjb25zdCBncm91cHNEaUQgPSBkMy5ncm91cChwb2ludHNEaUQsIGQgPT4gZFsyXSk7XG5cbiAgLy8vLy8vIENvbmZpZGVuY2UgaW50ZXJ2YWwgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgaWYgKHNob3dDSSkge1xuICAgIHN2Zy5hcHBlbmQoJ2cnKVxuICAgICAgLmF0dHIoJ2ZpbGwnLCAnZGVlcHNreWJsdWUnKVxuICAgICAgLmF0dHIoJ29wYWNpdHknLCAwLjI1KVxuICAgICAgLmF0dHIoJ3N0cm9rZScsICdub25lJylcbiAgICAgIC5zZWxlY3RBbGwoJ3BhdGgnKVxuICAgICAgLmRhdGEoZ3JvdXBzRGlELnZhbHVlcygpKVxuICAgICAgLmpvaW4oJ3BhdGgnKVxuICAgICAgLmF0dHIoJ2QnLCBjaSk7XG4gIH1cbiAgXG4gIC8vLy8vLyBBVFQgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gIGNvbnN0IHBhdGhEaUQgPSBzdmcuYXBwZW5kKCdnJylcbiAgICAuYXR0cignZmlsbCcsICdub25lJylcbiAgICAuYXR0cignc3Ryb2tlLXdpZHRoJywgMy41KVxuICAgIC5hdHRyKCdzdHJva2UtbGluZWpvaW4nLCAncm91bmQnKVxuICAgIC5hdHRyKCdzdHJva2UnLCAnZGVlcHNreWJsdWUnKVxuICAgIC5zZWxlY3RBbGwoJ3BhdGgnKVxuICAgIC5kYXRhKGdyb3Vwc0RpRC52YWx1ZXMoKSlcbiAgICAuam9pbigncGF0aCcpXG4gICAgLmF0dHIoJ2QnLCBsaW5lKTtcbiAgXG4gIC8vLy8gSy0xMiByZXN1bHRzIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gIGlmIChvdmVybGF5SzEyICYmIHNlbGVjdGVkT3V0Y29tZSAhPT0gJ2UwMjdfZWxlbV9lZHVjX2RpcmVjdF9leHAnKSB7XG4gICAgY29uc3QgcG9pbnRzSzEyID0gZGF0YVJlc0sxMkcubWFwKGQgPT4gW3goZC55ZWFyKSwgeShkLmF0dCksIGQuaWRdKTtcbiAgICBjb25zdCBncm91cHNLMTIgPSBkMy5yb2xsdXAoXG4gICAgICBwb2ludHNLMTIsIHYgPT4gT2JqZWN0LmFzc2lnbih2LCB7aWQ6IHZbMF1bMl19KSwgZCA9PiBkWzJdXG4gICAgKTtcbiAgICBjb25zdCBwYXRoSzEyID0gc3ZnLmFwcGVuZCgnZycpXG4gICAgICAuYXR0cignZmlsbCcsICdub25lJylcbiAgICAgIC5hdHRyKCdzdHJva2Utd2lkdGgnLCAzLjUpXG4gICAgICAuYXR0cignc3Ryb2tlLWxpbmVqb2luJywgJ3JvdW5kJylcbiAgICAgIC5hdHRyKCdzdHJva2Utb3BhY2l0eScsIC43NSlcbiAgICAgIC5hdHRyKCdzdHJva2UtZGFzaGFycmF5JywgNSlcbiAgICAgIC5zZWxlY3RBbGwoJ3BhdGgnKVxuICAgICAgLmRhdGEoZ3JvdXBzSzEyLnZhbHVlcygpKVxuICAgICAgLmpvaW4oJ3BhdGgnKVxuICAgICAgLmF0dHIoJ2QnLCBsaW5lKVxuICAgICAgLmF0dHIoJ3N0cm9rZScsICh7aWR9KSA9PiBpZCA9PT0gJ3N5bnRoJyA/ICdzcHJpbmdncmVlbicgOiAnZGVlcHNreWJsdWUnKTtcbiAgfVxuXG4gIC8vIFRpdGxlID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICBcbiAgbGV0IHN0YXRlTmFtZXMgPSBudWxsO1xuICBpZiAodHJlYXRHcm91cC5sZW5ndGggPT09IDIpIHtcbiAgICBzdGF0ZU5hbWVzID0gdHJlYXRHcm91cDtcbiAgfSBlbHNlIHtcbiAgICBzdGF0ZU5hbWVzID0gdHJlYXRHcm91cFN0YXRlc01hcC5nZXQodHJlYXRHcm91cCkuam9pbignLCAnKTtcbiAgfVxuICBzdmcuYXBwZW5kKCd0ZXh0JylcbiAgICAuYXR0cigneCcsIHdpZHRoIC8gMilcbiAgICAuYXR0cigneScsIG1hcmdpbi50b3AgLSAxMClcbiAgICAuYXR0cigndGV4dC1hbmNob3InLCAnbWlkZGxlJylcbiAgICAuc3R5bGUoJ2ZvbnQtc2l6ZScsICcxMnB4JylcbiAgICAudGV4dCh0cmVhdFllYXIgKyAnOiAnICsgc3RhdGVOYW1lcyk7XG5cbiAgcmV0dXJuIHN2Zy5ub2RlKCk7XG59XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTUwIiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoicGxvdEFnZ1RyZW5kcyA9IGZ1bmN0aW9uKGFnZ1R5cGUpIHtcblxuICAvLyBEYXRhIFNldHVwID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuICBjb25zdCBhZ2dYID0gL15lcz8kfGV2ZW50Ly50ZXN0KGFnZ1R5cGUpID8gJ2UnIDogJ3llYXInO1xuICBsZXQgYWdnQ29sID0gbnVsbDtcbiAgaWYgKGRyb3BBSyAmJiBzdGFja2VkICE9PSAnbm8nKSB7XG4gICAgYWdnQ29sID0gbmV3IFJlZ0V4cCgnYWdncmVnYXRlIG5vIGFrKCBzdGFja2VkICcgKyBOdW1iZXIoc3RhY2tlZCkgKyAnKT8kJyk7XG4gIH0gZWxzZSBpZiAoIWRyb3BBSyAmJiBzdGFja2VkICE9PSAnbm8nKSB7XG4gICAgYWdnQ29sID0gbmV3IFJlZ0V4cCgnYWdncmVnYXRlKCBzdGFja2VkICcgKyBOdW1iZXIoc3RhY2tlZCkgKyAnKT8kJyk7XG4gIH0gZWxzZSBpZiAoZHJvcEFLICYmIHN0YWNrZWQgPT09ICdubycpIHtcbiAgICBhZ2dDb2wgPSBuZXcgUmVnRXhwKCdhZ2dyZWdhdGUgbm8gYWsoIG5vdCBzdGFja2VkKT8kJyk7XG4gIH0gZWxzZSB7XG4gICAgYWdnQ29sID0gbmV3IFJlZ0V4cCgnYWdncmVnYXRlKCBub3Qgc3RhY2tlZCk/JCcpO1xuICB9XG4gIFxuICAvLy8vIE1haW4gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuICAvLyBNZWFuc1xuICBjb25zdCBkYXRhVHJlYXRBZ2cgPSBkYXRhVHJlYXRNZWFuc1VzZS5maWx0ZXIoZCA9PlxuICAgIGFnZ0NvbC50ZXN0KGQudHJlYXRfZ3JvdXApICYmIGRbYWdnWF0gIT09IG51bGxcbiAgKTtcbiAgY29uc3QgZGF0YUN0cmxEaURBZ2cgPSBkYXRhQ3RybE1lYW5zRGlEVXNlLmZpbHRlcihkID0+XG4gICAgYWdnQ29sLnRlc3QoZC50cmVhdF9ncm91cCkgJiYgZFthZ2dYXSAhPT0gbnVsbFxuICApO1xuICBjb25zdCBkYXRhQ3RybFN5bnRoQWdnID0gZGF0YUN0cmxNZWFuc1N5bnRoVXNlLmZpbHRlcihkID0+XG4gICAgYWdnQ29sLnRlc3QoZC50cmVhdF9ncm91cCkgJiYgZFthZ2dYXSAhPT0gbnVsbFxuICApO1xuICAvLyBTdWJncm91cHNcbiAgbGV0IGRhdGFUcmVhdCA9IGRhdGFBbGxTdGF0ZXNVc2UuZmlsdGVyKGQgPT4gZC50cmVhdGVkID09PSAxKTtcbiAgbGV0IGRhdGFDdHJsRGlEID0gZGF0YUN0cmxNZWFuc0RpRFVzZS5maWx0ZXIoZCA9PiBcbiAgICAhZC50cmVhdF9ncm91cC5pbmNsdWRlcygnYWdncmVnYXRlJylcbiAgKTtcbiAgbGV0IGRhdGFDdHJsU3ludGggPSBkYXRhQ3RybE1lYW5zU3ludGhVc2UuZmlsdGVyKGQgPT4gXG4gICAgIWQudHJlYXRfZ3JvdXAuaW5jbHVkZXMoJ2FnZ3JlZ2F0ZScpICYmIC9bQS1aXVtBLVpdLy50ZXN0KGQudHJlYXRfZ3JvdXApXG4gICk7XG4gIGlmICghL15lcz8kfGV2ZW50Ly50ZXN0KGFnZ1R5cGUpKSB7XG4gICAgZGF0YVRyZWF0ID0gZGF0YVRyZWF0LmZpbHRlcihkID0+IGQuZSA+PSAwKTtcbiAgICBkYXRhQ3RybERpRCA9IGRhdGFDdHJsRGlELmZpbHRlcihkID0+IGQuZSA+PSAwKTtcbiAgICBkYXRhQ3RybFN5bnRoID0gZGF0YUN0cmxTeW50aC5maWx0ZXIoZCA9PiBkLmUgPj0gMCk7XG4gIH1cbiAgaWYgKHN0YWNrZWQgIT09ICdubycpIHtcbiAgICBkYXRhVHJlYXQgPSBkYXRhVHJlYXQuZmlsdGVyKGQgPT4gXG4gICAgICBOdW1iZXIoZC50cmVhdF9ncm91cCkgKyBOdW1iZXIoc3RhY2tlZCkgLSAxIDw9IDIwMTlcbiAgICApO1xuICB9XG4gIGlmIChkcm9wQUspIHtcbiAgICBkYXRhVHJlYXQgPSBkYXRhVHJlYXQuZmlsdGVyKGQgPT4gZC5zdCAhPT0gJ0FLJyk7XG4gICAgZGF0YUN0cmxTeW50aCA9IGRhdGFDdHJsU3ludGguZmlsdGVyKGQgPT4gZC50cmVhdF9ncm91cCAhPT0gJ0FLJyk7XG4gIH1cbiAgXG4gIC8vLy8gT3ZlcmxheSBLLTEyIHJlc3VsdHMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICBcbiAgbGV0IGRhdGFLMTIgPSBudWxsO1xuICBpZiAob3ZlcmxheUsxMiAmJiBzZWxlY3RlZE91dGNvbWUgIT09ICdlMDI3X2VsZW1fZWR1Y19kaXJlY3RfZXhwJykge1xuICAgIGRhdGFLMTIgPSBkYXRhSzEyTWVhbnMuZmlsdGVyKGQgPT5cbiAgICAgIGFnZ0NvbC50ZXN0KGQudHJlYXRfZ3JvdXApXG4gICAgICAgICYmIGRbYWdnWF0gIT09IG51bGxcbiAgICApO1xuICAgIGlmIChjdHJsU3BlY0RpRCA9PT0gJ25vbmUnKSB7XG4gICAgICBkYXRhSzEyID0gZGF0YUsxMi5maWx0ZXIoZCA9PiBkLmlkICE9PSAnY3RybCBkaWQnKTtcbiAgICB9XG4gICAgaWYgKGN0cmxTcGVjU3ludGggPT09ICdub25lJykge1xuICAgICAgZGF0YUsxMiA9IGRhdGFLMTIuZmlsdGVyKGQgPT4gZC5pZCAhPT0gJ2N0cmwgc3ludGgnKTtcbiAgICB9XG4gIH1cblxuICAvLyBTY2FsZSBGdW5jdGlvbnMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuICAvLy8vIEZpbmQgbWluICYgbWF4IHkgYW5kIHggdmFsdWVzIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuICBsZXQgbWluWCwgbWF4WCwgbWluWSwgbWF4WSA9IG51bGw7XG5cbiAgaWYgKC9eZXM/JHxldmVudC8udGVzdChhZ2dUeXBlKSkge1xuICAgIG1pblggPSBkMy5taW4oZGF0YVRyZWF0QWdnLCBkID0+IGQuZSk7XG4gICAgbWF4WCA9IGQzLm1heChkYXRhVHJlYXRBZ2csIGQgPT4gZC5lKTtcbiAgfSBlbHNlIHtcbiAgICBtaW5YID0gZDMubWluKGRhdGFUcmVhdEFnZywgZCA9PiBkLnllYXIpO1xuICAgIG1heFggPSBkMy5tYXgoZGF0YVRyZWF0QWdnLCBkID0+IGQueWVhcik7XG4gIH1cbiAgXG4gIC8vLy8vLyBNZWFucyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gIG1pblkgPSBkMy5taW4oZGF0YVRyZWF0QWdnLCBkID0+IGQub3V0Y29tZSk7XG4gIG1heFkgPSBkMy5tYXgoZGF0YVRyZWF0QWdnLCBkID0+IGQub3V0Y29tZSk7XG4gIFxuICBpZiAoY3RybFNwZWNEaUQgIT09ICdub25lJyAmJiBjdHJsU3BlY1N5bnRoICE9PSAnbm9uZScpIHtcbiAgICBtaW5ZID0gTWF0aC5taW4oXG4gICAgICBkMy5taW4oZGF0YUN0cmxEaURBZ2csIGQgPT4gZC5vdXRjb21lKSxcbiAgICAgIGQzLm1pbihkYXRhQ3RybFN5bnRoQWdnLCBkID0+IGQub3V0Y29tZSksXG4gICAgICBtaW5ZXG4gICAgKTtcbiAgICBtYXhZID0gTWF0aC5tYXgoXG4gICAgICBkMy5tYXgoZGF0YUN0cmxEaURBZ2csIGQgPT4gZC5vdXRjb21lKSxcbiAgICAgIGQzLm1heChkYXRhQ3RybFN5bnRoQWdnLCBkID0+IGQub3V0Y29tZSksXG4gICAgICBtYXhZXG4gICAgKTtcbiAgfSBlbHNlIGlmIChjdHJsU3BlY0RpRCA9PT0gJ25vbmUnICYmIGN0cmxTcGVjU3ludGggIT09ICdub25lJykge1xuICAgIG1pblkgPSBNYXRoLm1pbihkMy5taW4oZGF0YUN0cmxTeW50aEFnZywgZCA9PiBkLm91dGNvbWUpLCBtaW5ZKTtcbiAgICBtYXhZID0gTWF0aC5tYXgoZDMubWF4KGRhdGFDdHJsU3ludGhBZ2csIGQgPT4gZC5vdXRjb21lKSwgbWF4WSk7XG4gIH0gZWxzZSBpZiAoY3RybFNwZWNEaUQgIT09ICdub25lJyAmJiBjdHJsU3BlY1N5bnRoID09PSAnbm9uZScpIHtcbiAgICBtaW5ZID0gTWF0aC5taW4oZDMubWluKGRhdGFDdHJsRGlEQWdnLCBkID0+IGQub3V0Y29tZSksIG1pblkpO1xuICAgIG1heFkgPSBNYXRoLm1heChkMy5tYXgoZGF0YUN0cmxEaURBZ2csIGQgPT4gZC5vdXRjb21lKSwgbWF4WSk7XG4gIH1cbiAgXG4gIC8vLy8vLyBTdGF0ZXMgLyBzdWJncm91cCBjb250cm9scyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICBcbiAgaWYgKHNob3dTdWJncm91cHMpIHtcbiAgICBpZiAoc3ViZ3JvdXBzVG9TaG93LmluY2x1ZGVzKCd0cmVhdGVkJykpIHtcbiAgICAgIG1pblkgPSBNYXRoLm1pbihkMy5taW4oZGF0YVRyZWF0LCBkID0+IGQub3V0Y29tZSksIG1pblkpO1xuICAgICAgbWF4WSA9IE1hdGgubWF4KGQzLm1heChkYXRhVHJlYXQsIGQgPT4gZC5vdXRjb21lKSwgbWF4WSk7XG4gICAgfVxuICAgIGlmIChcbiAgICAgIChzdWJncm91cHNUb1Nob3cuaW5jbHVkZXMoJ2N0cmwsIERpRCcpIFxuICAgICAgICB8fCBzdWJncm91cHNUb1Nob3cuaW5jbHVkZXMoJ3VudHJlYXRlZCcpKVxuICAgICAgICAmJiBjdHJsU3BlY0RpRCAhPT0gJ25vbmUnXG4gICAgKSB7XG4gICAgICBtaW5ZID0gTWF0aC5taW4oZDMubWluKGRhdGFDdHJsRGlELCBkID0+IGQub3V0Y29tZSksIG1pblkpO1xuICAgICAgbWF4WSA9IE1hdGgubWF4KGQzLm1heChkYXRhQ3RybERpRCwgZCA9PiBkLm91dGNvbWUpLCBtYXhZKTtcbiAgICB9XG4gICAgaWYgKFxuICAgICAgKHN1Ymdyb3Vwc1RvU2hvdy5pbmNsdWRlcygnY3RybCwgc3ludGgnKSBcbiAgICAgICAgfHwgc3ViZ3JvdXBzVG9TaG93LmluY2x1ZGVzKCd1bnRyZWF0ZWQnKSlcbiAgICAgICAgJiYgY3RybFNwZWNTeW50aCAhPT0gJ25vbmUnXG4gICAgKSB7XG4gICAgICBtaW5ZID0gTWF0aC5taW4oZDMubWluKGRhdGFDdHJsU3ludGgsIGQgPT4gZC5vdXRjb21lKSwgbWluWSk7XG4gICAgICBtYXhZID0gTWF0aC5tYXgoZDMubWF4KGRhdGFDdHJsU3ludGgsIGQgPT4gZC5vdXRjb21lKSwgbWF4WSk7XG4gICAgfVxuICB9XG5cbiAgaWYgKG92ZXJsYXlLMTIgJiYgc2VsZWN0ZWRPdXRjb21lICE9PSAnZTAyN19lbGVtX2VkdWNfZGlyZWN0X2V4cCcpIHtcbiAgICBtaW5ZID0gTWF0aC5taW4oZDMubWluKGRhdGFLMTIsIGQgPT4gZC5vdXRjb21lKSwgbWluWSk7XG4gICAgbWF4WSA9IE1hdGgubWF4KGQzLm1heChkYXRhSzEyLCBkID0+IGQub3V0Y29tZSksIG1heFkpO1xuICB9XG5cbiAgaWYgKCFmZSkgbWluWSA9IDA7XG5cbiAgLy8vLyBEZWZpbmUgc2NhbGUgZnVuY3Rpb25zIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgY29uc3QgeCA9IGQzLnNjYWxlTGluZWFyKClcbiAgICAuZG9tYWluKFttaW5YLCBtYXhYXSlcbiAgICAucmFuZ2UoW21hcmdpbi5sZWZ0LCB3aWR0aCAtIG1hcmdpbi5yaWdodF0pO1xuICBjb25zdCB5ID0gZDMuc2NhbGVMaW5lYXIoKVxuICAgIC5kb21haW4oW21pblksIG1heFldKVxuICAgIC5yYW5nZShbaGVpZ2h0IC0gbWFyZ2luLmJvdHRvbSwgbWFyZ2luLnRvcF0pXG4gICAgLm5pY2UoKTtcblxuICAvLyBQYXJlbnQgU1ZHID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuICBjb25zdCBzdmcgPSBkMy5jcmVhdGUoJ3N2ZycpXG4gICAgLmF0dHIoJ3dpZHRoJywgd2lkdGgpXG4gICAgLmF0dHIoJ2hlaWdodCcsIGhlaWdodCk7XG5cbiAgLy8gQXhlcyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbiAgY29uc3QgeEF4aXMgPSBkMy5heGlzQm90dG9tKHgpXG4gICAgLnRpY2tzKHRpY2tOdW1YKVxuICAgIC50aWNrRm9ybWF0KGQzLmZvcm1hdCgnZCcpKTtcbiAgY29uc3QgeUF4aXMgPSBkMy5heGlzTGVmdCh5KVxuICAgIC50aWNrcyh0aWNrTnVtWSk7XG5cbiAgc3ZnLmFwcGVuZCgnZycpXG4gICAgLmF0dHIoJ3RyYW5zZm9ybScsIGB0cmFuc2xhdGUoMCwgJHtoZWlnaHQgLSBtYXJnaW4uYm90dG9tfSlgKVxuICAgIC5jYWxsKHhBeGlzKVxuICAgIC5zZWxlY3RBbGwoJy50aWNrIHRleHQnKVxuICAgIC5hdHRyKCdmb250LXNpemUnLCAnMTJweCcpO1xuICBzdmcuYXBwZW5kKCdnJylcbiAgICAuYXR0cigndHJhbnNmb3JtJywgYHRyYW5zbGF0ZSgke21hcmdpbi5sZWZ0fSwgMClgKVxuICAgIC5jYWxsKHlBeGlzKVxuICAgIC5zZWxlY3RBbGwoJy50aWNrIHRleHQnKVxuICAgIC5hdHRyKCdmb250LXNpemUnLCAnMTJweCcpO1xuICBcbiAgLy8gVHJlYXQgWWVhciBWZXJ0aWNhbCBMaW5lID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbiAgaWYgKC9eZXM/JHxldmVudC8udGVzdChhZ2dUeXBlKSkge1xuICAgIHN2Zy5hcHBlbmQoJ2xpbmUnKVxuICAgICAgLmF0dHIoJ3N0cm9rZS13aWR0aCcsIDIpXG4gICAgICAuYXR0cignc3Ryb2tlJywgJ2JsYWNrJylcbiAgICAgIC5hdHRyKCdzdHJva2UtZGFzaGFycmF5JywgNSlcbiAgICAgIC5hdHRyKCd4MScsIHgoLTEpKVxuICAgICAgLmF0dHIoJ3gyJywgeCgtMSkpXG4gICAgICAuYXR0cigneTEnLCBtYXJnaW4udG9wKVxuICAgICAgLmF0dHIoJ3kyJywgaGVpZ2h0IC0gbWFyZ2luLmJvdHRvbSk7XG4gIH1cblxuICAvLyBPdXRjb21lIFRyZW5kcyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuICBjb25zdCBsaW5lID0gZDMubGluZSgpLmRlZmluZWQoZCA9PiBcbiAgICAhaXNOYU4oZFsxXSkgJiBkWzFdICE9PSB1bmRlZmluZWQgJiBkWzFdICE9PSBudWxsXG4gICk7XG5cbiAgLy8vLyBTdWJncm91cHMgMTogVHJlYXRlZCBzdGF0ZXMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgbGV0IHBvaW50c1RyZWF0ID0gW1t4KG1pblgpLCB5KG1pblkpLCAnJ11dO1xuICBpZiAoc2hvd1N1Ymdyb3VwcyAmJiBzdWJncm91cHNUb1Nob3cuaW5jbHVkZXMoJ3RyZWF0ZWQnKSkge1xuICAgIHBvaW50c1RyZWF0ID0gZGF0YVRyZWF0Lm1hcChkID0+IFt4KGRbYWdnWF0pLCB5KGQub3V0Y29tZSksIGQuc3QgKyAndHJlYXQnXSk7XG4gIH1cbiAgY29uc3QgZ3JvdXBzVHJlYXQgPSBkMy5yb2xsdXAoXG4gICAgcG9pbnRzVHJlYXQsIFxuICAgIHYgPT4gT2JqZWN0LmFzc2lnbih2LCB7Z3JvdXA6IHZbMF1bMl19KSwgXG4gICAgZCA9PiBkWzJdXG4gICk7XG4gIGNvbnN0IHBhdGhUcmVhdCA9IHN2Zy5hcHBlbmQoJ2cnKVxuICAgIC5hdHRyKCdmaWxsJywgJ25vbmUnKVxuICAgIC5hdHRyKCdzdHJva2Utd2lkdGgnLCAyKVxuICAgIC5hdHRyKCdzdHJva2UtbGluZWpvaW4nLCAncm91bmQnKVxuICAgIC5hdHRyKCdzdHJva2UtZGFzaGFycmF5JywgNSlcbiAgICAuYXR0cignc3Ryb2tlJywgJ2hvdHBpbmsnKVxuICAgIC5zZWxlY3RBbGwoJ3BhdGgnKVxuICAgIC5kYXRhKGdyb3Vwc1RyZWF0LnZhbHVlcygpKVxuICAgIC5qb2luKCdwYXRoJylcbiAgICAuc3R5bGUoJ21peC1ibGVuZC1tb2RlJywgJ211bHRpcGx5JylcbiAgICAuYXR0cignZCcsIGxpbmUpO1xuICBcbiAgLy8vLyBTdWJncm91cHMgMjogQ3RybCwgRGlEIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgbGV0IHBvaW50c0N0cmxEaUQgPSBbW3gobWluWCksIHkobWluWSksICcnXV07XG4gIGlmIChcbiAgICBzaG93U3ViZ3JvdXBzIFxuICAgICAgJiYgKHN1Ymdyb3Vwc1RvU2hvdy5pbmNsdWRlcygndW50cmVhdGVkJykgXG4gICAgICB8fCBzdWJncm91cHNUb1Nob3cuaW5jbHVkZXMoJ2N0cmwsIERpRCcpKVxuICApIHtcbiAgICBwb2ludHNDdHJsRGlEID0gZGF0YUN0cmxEaUQubWFwKGQgPT4gXG4gICAgICBbeChkW2FnZ1hdKSwgeShkLm91dGNvbWUpLCBkLnRyZWF0X2dyb3VwICsgJ2RpZCddXG4gICAgKTtcbiAgfVxuICBjb25zdCBncm91cHNDdHJsRGlEID0gZDMucm9sbHVwKFxuICAgIHBvaW50c0N0cmxEaUQsIFxuICAgIHYgPT4gT2JqZWN0LmFzc2lnbih2LCB7Z3JvdXA6IHZbMF1bMl19KSwgXG4gICAgZCA9PiBkWzJdXG4gICk7XG4gIGNvbnN0IHBhdGhDdHJsRGlEID0gc3ZnLmFwcGVuZCgnZycpXG4gICAgLmF0dHIoJ2ZpbGwnLCAnbm9uZScpXG4gICAgLmF0dHIoJ3N0cm9rZS13aWR0aCcsIDIpXG4gICAgLmF0dHIoJ3N0cm9rZS1saW5lam9pbicsICdyb3VuZCcpXG4gICAgLmF0dHIoJ3N0cm9rZS1kYXNoYXJyYXknLCA1KVxuICAgIC5hdHRyKCdzdHJva2UnLCAnbGlnaHRza3libHVlJylcbiAgICAuc2VsZWN0QWxsKCdwYXRoJylcbiAgICAuZGF0YShncm91cHNDdHJsRGlELnZhbHVlcygpKVxuICAgIC5qb2luKCdwYXRoJylcbiAgICAuc3R5bGUoJ21peC1ibGVuZC1tb2RlJywgJ211bHRpcGx5JylcbiAgICAuYXR0cignZCcsIGxpbmUpO1xuICBcbiAgLy8vLyBTdWJncm91cHMgMzogQ3RybCwgU3ludGggLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgbGV0IHBvaW50c0N0cmxTeW50aCA9IFtbeChtaW5YKSwgeShtaW5ZKSwgJyddXTtcbiAgaWYgKFxuICAgIHNob3dTdWJncm91cHMgXG4gICAgICAmJiAoc3ViZ3JvdXBzVG9TaG93LmluY2x1ZGVzKCd1bnRyZWF0ZWQnKSBcbiAgICAgIHx8IHN1Ymdyb3Vwc1RvU2hvdy5pbmNsdWRlcygnY3RybCwgc3ludGgnKSlcbiAgKSB7XG4gICAgcG9pbnRzQ3RybFN5bnRoID0gZGF0YUN0cmxTeW50aC5tYXAoZCA9PiBcbiAgICAgIFt4KGRbYWdnWF0pLCB5KGQub3V0Y29tZSksIGQudHJlYXRfZ3JvdXAgKyAnc3ludGgnXVxuICAgICk7XG4gIH1cbiAgY29uc3QgZ3JvdXBzQ3RybFN5bnRoID0gZDMucm9sbHVwKFxuICAgIHBvaW50c0N0cmxTeW50aCwgXG4gICAgdiA9PiBPYmplY3QuYXNzaWduKHYsIHtncm91cDogdlswXVsyXX0pLCBcbiAgICBkID0+IGRbMl1cbiAgKTtcbiAgY29uc3QgcGF0aEN0cmxTeW50aCA9IHN2Zy5hcHBlbmQoJ2cnKVxuICAgIC5hdHRyKCdmaWxsJywgJ25vbmUnKVxuICAgIC5hdHRyKCdzdHJva2Utd2lkdGgnLCAyKVxuICAgIC5hdHRyKCdzdHJva2UtbGluZWpvaW4nLCAncm91bmQnKVxuICAgIC5hdHRyKCdzdHJva2UtZGFzaGFycmF5JywgNSlcbiAgICAuYXR0cignc3Ryb2tlJywgJ2xpZ2h0Z3JlZW4nKVxuICAgIC5zZWxlY3RBbGwoJ3BhdGgnKVxuICAgIC5kYXRhKGdyb3Vwc0N0cmxTeW50aC52YWx1ZXMoKSlcbiAgICAuam9pbigncGF0aCcpXG4gICAgLnN0eWxlKCdtaXgtYmxlbmQtbW9kZScsICdtdWx0aXBseScpXG4gICAgLmF0dHIoJ2QnLCBsaW5lKTtcbiAgXG4gIC8vLy8gQWdnOiBUcmVhdCAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gIGNvbnN0IHBvaW50c1RyZWF0QWdnID0gZGF0YVRyZWF0QWdnLm1hcChkID0+XG4gICAgW3goZFthZ2dYXSksIHkoZC5vdXRjb21lKSwgZC50cmVhdF9ncm91cF1cbiAgKTtcbiAgY29uc3QgZ3JvdXBzVHJlYXRBZ2cgPSBkMy5ncm91cChwb2ludHNUcmVhdEFnZywgZCA9PiBkWzJdKTtcbiAgY29uc3QgcGF0aFRyZWF0QWdnID0gc3ZnLmFwcGVuZCgnZycpXG4gICAgLmF0dHIoJ2ZpbGwnLCAnbm9uZScpXG4gICAgLmF0dHIoJ3N0cm9rZS13aWR0aCcsIDMuNSlcbiAgICAuYXR0cignc3Ryb2tlLWxpbmVqb2luJywgJ3JvdW5kJylcbiAgICAuYXR0cignc3Ryb2tlJywgJ2RlZXBwaW5rJylcbiAgICAuc2VsZWN0QWxsKCdwYXRoJylcbiAgICAuZGF0YShncm91cHNUcmVhdEFnZy52YWx1ZXMoKSlcbiAgICAuam9pbigncGF0aCcpXG4gICAgLmF0dHIoJ2QnLCBsaW5lKTtcbiAgXG4gIC8vLy8gQWdnOiBDdHJsLCBEaUQgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gIGNvbnN0IHBvaW50c0N0cmxEaURBZ2cgPSBkYXRhQ3RybERpREFnZy5tYXAoZCA9PlxuICAgIFt4KGRbYWdnWF0pLCB5KGQub3V0Y29tZSksIGQudHJlYXRfZ3JvdXBdXG4gICk7XG4gIGNvbnN0IGdyb3Vwc0N0cmxEaURBZ2cgPSBkMy5ncm91cChwb2ludHNDdHJsRGlEQWdnLCBkID0+IGRbMl0pO1xuICBjb25zdCBwYXRoQ3RybERpREFnZyA9IHN2Zy5hcHBlbmQoJ2cnKVxuICAgIC5hdHRyKCdmaWxsJywgJ25vbmUnKVxuICAgIC5hdHRyKCdzdHJva2Utd2lkdGgnLCAzLjUpXG4gICAgLmF0dHIoJ3N0cm9rZS1saW5lam9pbicsICdyb3VuZCcpXG4gICAgLmF0dHIoJ3N0cm9rZScsICdkZWVwc2t5Ymx1ZScpXG4gICAgLnNlbGVjdEFsbCgncGF0aCcpXG4gICAgLmRhdGEoZ3JvdXBzQ3RybERpREFnZy52YWx1ZXMoKSlcbiAgICAuam9pbigncGF0aCcpXG4gICAgLmF0dHIoJ2QnLCBsaW5lKTtcbiAgXG4gIC8vLy8gQWdnOiBDdHJsLCBTeW50aCAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgY29uc3QgcG9pbnRzQ3RybFN5bnRoQWdnID0gZGF0YUN0cmxTeW50aEFnZy5tYXAoZCA9PlxuICAgIFt4KGRbYWdnWF0pLCB5KGQub3V0Y29tZSksIGQudHJlYXRfZ3JvdXBdXG4gICk7XG4gIGNvbnN0IGdyb3Vwc0N0cmxTeW50aEFnZyA9IGQzLmdyb3VwKHBvaW50c0N0cmxTeW50aEFnZywgZCA9PiBkWzJdKTtcbiAgY29uc3QgcGF0aEN0cmxTeW50aEFnZyA9IHN2Zy5hcHBlbmQoJ2cnKVxuICAgIC5hdHRyKCdmaWxsJywgJ25vbmUnKVxuICAgIC5hdHRyKCdzdHJva2Utd2lkdGgnLCAzLjUpXG4gICAgLmF0dHIoJ3N0cm9rZS1saW5lam9pbicsICdyb3VuZCcpXG4gICAgLmF0dHIoJ3N0cm9rZScsICdzcHJpbmdncmVlbicpXG4gICAgLnNlbGVjdEFsbCgncGF0aCcpXG4gICAgLmRhdGEoZ3JvdXBzQ3RybFN5bnRoQWdnLnZhbHVlcygpKVxuICAgIC5qb2luKCdwYXRoJylcbiAgICAuYXR0cignZCcsIGxpbmUpO1xuICBcbiAgLy8vLyBLLTEyIE92ZXJsYXkgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgaWYgKG92ZXJsYXlLMTIgJiYgc2VsZWN0ZWRPdXRjb21lICE9PSAnZTAyN19lbGVtX2VkdWNfZGlyZWN0X2V4cCcpIHtcbiAgICBjb25zdCBwb2ludHNLMTIgPSBkYXRhSzEyLm1hcChkID0+IFt4KGRbYWdnWF0pLCB5KGQub3V0Y29tZSksIGQuaWRdKTtcbiAgICBjb25zdCBncm91cHNLMTIgPSBkMy5yb2xsdXAoXG4gICAgICBwb2ludHNLMTIsIHYgPT4gT2JqZWN0LmFzc2lnbih2LCB7aWQ6IHZbMF1bMl19KSwgZCA9PiBkWzJdXG4gICAgKTtcbiAgICBjb25zdCBwYXRoSzEyID0gc3ZnLmFwcGVuZCgnZycpXG4gICAgICAuYXR0cignZmlsbCcsICdub25lJylcbiAgICAgIC5hdHRyKCdzdHJva2Utd2lkdGgnLCAzLjUpXG4gICAgICAuYXR0cignc3Ryb2tlLWxpbmVqb2luJywgJ3JvdW5kJylcbiAgICAgIC5hdHRyKCdzdHJva2Utb3BhY2l0eScsIC41KVxuICAgICAgLmF0dHIoJ3N0cm9rZS1kYXNoYXJyYXknLCA1KVxuICAgICAgLnNlbGVjdEFsbCgncGF0aCcpXG4gICAgICAuZGF0YShncm91cHNLMTIudmFsdWVzKCkpXG4gICAgICAuam9pbigncGF0aCcpXG4gICAgICAuYXR0cignZCcsIGxpbmUpXG4gICAgICAuYXR0cignc3Ryb2tlJywgKHtpZH0pID0+IHtcbiAgICAgICAgbGV0IG91dCA9IG51bGw7XG4gICAgICAgIHN3aXRjaCAoaWQpIHtcbiAgICAgICAgICBjYXNlICd0cmVhdCBncm91cCc6XG4gICAgICAgICAgICBvdXQgPSAnZGVlcHBpbmsnO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgY2FzZSAnY3RybCBkaWQnOlxuICAgICAgICAgICAgb3V0ID0gJ2RlZXBza3libHVlJztcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIGNhc2UgJ2N0cmwgc3ludGgnOlxuICAgICAgICAgICAgb3V0ID0gJ3NwcmluZ2dyZWVuJztcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvdXQ7XG4gICAgICB9KTtcbiAgfVxuICBcbiAgLy8gVG9vbHRpcCA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbiAgY29uc3QgdG9vbHRpcCA9IHN2Zy5hcHBlbmQoJ3RleHQnKSAgXG4gICAgLmF0dHIoJ2Rpc3BsYXknLCAnbm9uZScpXG4gICAgLmF0dHIoJ3RleHQtYW5jaG9yJywgJ21pZGRsZScpXG4gICAgLmF0dHIoJ3knLCAtOCk7XG4gIFxuICAvLyBUaXRsZSA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuICBjb25zdCB0aXRsZSA9IC9eZXM/JHxldmVudC8udGVzdChhZ2dUeXBlKSA/IFxuICAgICdFdmVudCBTdHVkeScgOiAnUG9zdC1UcmVhdG1lbnQgVHJlbmRzJztcbiAgc3ZnLmFwcGVuZCgndGV4dCcpXG4gICAgLmF0dHIoJ3gnLCB3aWR0aCAvIDIpXG4gICAgLmF0dHIoJ3knLCBtYXJnaW4udG9wIC0gMilcbiAgICAuYXR0cigndGV4dC1hbmNob3InLCAnbWlkZGxlJylcbiAgICAuc3R5bGUoJ2ZvbnQtc2l6ZScsICcxNHB4JylcbiAgICAudGV4dCh0aXRsZSk7XG4gIFxuICAvLyBFdmVudCBMaXN0ZW5lcnMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuICBzdmdcbiAgICAub24oJ3BvaW50ZXJtb3ZlJywgcG9pbnRlck1vdmVkKVxuICAgIC5vbigncG9pbnRlcmxlYXZlJywgcG9pbnRlckxlZnQpO1xuICBcbiAgcmV0dXJuIHN2Zy5ub2RlKCk7XG5cbiAgLy8gRXZlbnQgSGFuZGxlciBGdW5jdGlvbnMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbiAgLy8vLyBQb2ludGVyIG1vdmVkIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgZnVuY3Rpb24gcG9pbnRlck1vdmVkKGV2ZW50KSB7XG4gICAgY29uc3QgW3htLCB5bV0gPSBkMy5wb2ludGVyKGV2ZW50KTtcbiAgICBjb25zdCBhbGxQb2ludHMgPSBbLi4ucG9pbnRzVHJlYXQsIC4uLnBvaW50c0N0cmxEaUQsIC4uLnBvaW50c0N0cmxTeW50aF07XG4gICAgY29uc3QgaSA9IGQzLmxlYXN0SW5kZXgoYWxsUG9pbnRzLCAoW3gsIHldKSA9PiBNYXRoLmh5cG90KHggLSB4bSwgeSAtIHltKSk7XG4gICAgY29uc3QgW3hIb3ZlciwgeUhvdmVyLCBob3ZlcmVkR3JvdXBdID0gYWxsUG9pbnRzW2ldO1xuICAgIFxuICAgIHBhdGhUcmVhdFxuICAgICAgLnN0eWxlKCdzdHJva2Utd2lkdGgnLCAoe2dyb3VwfSkgPT4gZ3JvdXAgPT09IGhvdmVyZWRHcm91cCA/IDcgOiBudWxsKVxuICAgICAgLmZpbHRlcigoe2dyb3VwfSkgPT4gZ3JvdXAgPT09IGhvdmVyZWRHcm91cClcbiAgICAgIC5yYWlzZSgpO1xuICAgIFxuICAgIHBhdGhDdHJsRGlEXG4gICAgICAuc3R5bGUoJ3N0cm9rZS13aWR0aCcsICh7Z3JvdXB9KSA9PiBncm91cCA9PT0gaG92ZXJlZEdyb3VwID8gNyA6IG51bGwpXG4gICAgICAuZmlsdGVyKCh7Z3JvdXB9KSA9PiBncm91cCA9PT0gaG92ZXJlZEdyb3VwKVxuICAgICAgLnJhaXNlKCk7XG4gICAgXG4gICAgcGF0aEN0cmxTeW50aFxuICAgICAgLnN0eWxlKCdzdHJva2Utd2lkdGgnLCAoe2dyb3VwfSkgPT4gZ3JvdXAgPT09IGhvdmVyZWRHcm91cCA/IDcgOiBudWxsKVxuICAgICAgLmZpbHRlcigoe2dyb3VwfSkgPT4gZ3JvdXAgPT09IGhvdmVyZWRHcm91cClcbiAgICAgIC5yYWlzZSgpO1xuICAgIFxuICAgIGlmIChzaG93U3ViZ3JvdXBzICYgc3ViZ3JvdXBzVG9TaG93Lmxlbmd0aCA+IDApIHtcbiAgICAgIHRvb2x0aXBcbiAgICAgICAgLmh0bWwoaG92ZXJlZEdyb3VwLnJlcGxhY2UoL3RyZWF0fGRpZHxzeW50aC8sICcnKSlcbiAgICAgICAgLmF0dHIoJ3RyYW5zZm9ybScsIGB0cmFuc2xhdGUoJHt4SG92ZXJ9LCAke3lIb3Zlcn0pYClcbiAgICAgICAgLmF0dHIoJ2Rpc3BsYXknLCBudWxsKTtcbiAgICB9XG4gIH1cblxuICAvLy8vIFBvaW50ZXIgbGVmdCAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuICBmdW5jdGlvbiBwb2ludGVyTGVmdCgpIHtcbiAgICBwYXRoVHJlYXQuc3R5bGUoJ3N0cm9rZS13aWR0aCcsIG51bGwpO1xuICAgIHBhdGhDdHJsRGlELnN0eWxlKCdzdHJva2Utd2lkdGgnLCBudWxsKTtcbiAgICBwYXRoQ3RybFN5bnRoLnN0eWxlKCdzdHJva2Utd2lkdGgnLCBudWxsKTtcbiAgICB0b29sdGlwLmF0dHIoJ2Rpc3BsYXknLCAnbm9uZScpO1xuICB9XG59XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTUxIiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoicGxvdEFnZ1Jlc3VsdHMgPSBmdW5jdGlvbihhZ2dUeXBlKSB7XG5cbiAgLy8gRGF0YSBTZXR1cCA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbiAgY29uc3QgYWdnWCA9IC9eZXM/JHxldmVudC8udGVzdChhZ2dUeXBlKSA/ICdlJyA6ICd5ZWFyJztcbiAgY29uc3QgYWdnQ29sID0gZHJvcEFLID8gL2FnZ3JlZ2F0ZS4rbm8gYWsvIDogL2FnZ3JlZ2F0ZSg/IS4rbm8gYWspLztcblxuICAvLyBNYWluXG4gIGNvbnN0IHJlc0RpRCA9IGRhdGFSZXNEaURVc2VHLmZpbHRlcihkID0+XG4gICAgYWdnQ29sLnRlc3QoZC50cmVhdF9ncm91cCkgJiYgZFthZ2dYXSAhPT0gbnVsbFxuICApO1xuICBjb25zdCByZXNTeW50aCA9IGRhdGFSZXNTeW50aFVzZVN0LmZpbHRlcihkID0+XG4gICAgYWdnQ29sLnRlc3QoZC50cmVhdF9ncm91cCkgJiYgZFthZ2dYXSAhPT0gbnVsbFxuICApO1xuXG4gIC8vIEsxMlxuICBsZXQgcmVzSzEyLCByZXNLMTJTeW50aCwgcmVzSzEyRGlEID0gbnVsbDtcbiAgaWYgKG92ZXJsYXlLMTIgJiYgc2VsZWN0ZWRPdXRjb21lICE9PSAnZTAyN19lbGVtX2VkdWNfZGlyZWN0X2V4cCcpIHtcbiAgICBpZiAoY3RybFNwZWNEaUQgIT09ICdub25lJyAmJiBjdHJsU3BlY1N5bnRoICE9PSAnbm9uZScpIHtcbiAgICAgIHJlc0sxMkRpRCA9IGRhdGFSZXNLMTJVc2VHLmZpbHRlcihkID0+XG4gICAgICAgIGFnZ0NvbC50ZXN0KGQudHJlYXRfZ3JvdXApICYmIGRbYWdnWF0gIT09IG51bGwgJiYgZC5pZCA9PT0gJ2RpZCdcbiAgICAgICk7XG4gICAgICByZXNLMTJTeW50aCA9IGRhdGFSZXNLMTJVc2VTdC5maWx0ZXIoZCA9PlxuICAgICAgICBhZ2dDb2wudGVzdChkLnRyZWF0X2dyb3VwKSAmJiBkW2FnZ1hdICE9PSBudWxsICYmIGQuaWQgPT09ICdzeW50aCdcbiAgICAgICk7XG4gICAgICByZXNLMTIgPSBbLi4ucmVzSzEyRGlELCAuLi5yZXNLMTJTeW50aF07XG4gICAgfSBlbHNlIGlmIChjdHJsU3BlY0RpRCAhPT0gJ25vbmUnICYmIGN0cmxTcGVjU3ludGggPT09ICdub25lJykge1xuICAgICAgcmVzSzEyID0gZGF0YVJlc0sxMlVzZUcuZmlsdGVyKGQgPT5cbiAgICAgICAgYWdnQ29sLnRlc3QoZC50cmVhdF9ncm91cCkgJiYgZFthZ2dYXSAhPT0gbnVsbCAmJiBkLmlkID09PSAnZGlkJ1xuICAgICAgKTtcbiAgICB9IGVsc2UgaWYgKGN0cmxTcGVjRGlEID09PSAnbm9uZScgJiYgY3RybFNwZWNTeW50aCAhPT0gJ25vbmUnKSB7XG4gICAgICByZXNLMTIgPSBkYXRhUmVzSzEyVXNlU3QuZmlsdGVyKGQgPT5cbiAgICAgICAgYWdnQ29sLnRlc3QoZC50cmVhdF9ncm91cCkgJiYgZFthZ2dYXSAhPT0gbnVsbCAmJiBkLmlkID09PSAnc3ludGgnXG4gICAgICApO1xuICAgIH1cbiAgfVxuXG4gIC8vIFNjYWxlIEZ1bmN0aW9ucyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4gIC8vLy8gRmluZCBtaW4gJiBtYXggeSBhbmQgeCB2YWx1ZXNcblxuICBsZXQgbWluWCwgbWF4WCwgbWluWSwgbWF4WSwgbWluWVZhciwgbWF4WVZhciA9IG51bGw7XG4gIGlmIChzaG93Q0kpIHtcbiAgICBtaW5ZVmFyID0gJ2NpX2xvdyc7XG4gICAgbWF4WVZhciA9ICdjaV91cCc7XG4gIH0gZWxzZSB7XG4gICAgbWluWVZhciA9ICdhdHQnO1xuICAgIG1heFlWYXIgPSAnYXR0JztcbiAgfVxuICBpZiAoY3RybFNwZWNEaUQgIT09ICdub25lJyAmJiBjdHJsU3BlY1N5bnRoICE9PSAnbm9uZScpIHtcbiAgICBtaW5YID0gTWF0aC5taW4oZDMubWluKHJlc1N5bnRoLCBkID0+IGRbYWdnWF0pLCBkMy5taW4ocmVzRGlELCBkID0+IGRbYWdnWF0pKTtcbiAgICBtYXhYID0gTWF0aC5tYXgoZDMubWF4KHJlc1N5bnRoLCBkID0+IGRbYWdnWF0pLCBkMy5tYXgocmVzRGlELCBkID0+IGRbYWdnWF0pKTtcbiAgICBtaW5ZID0gTWF0aC5taW4oXG4gICAgICBkMy5taW4ocmVzU3ludGgsIGQgPT4gZFttaW5ZVmFyXSksXG4gICAgICBkMy5taW4ocmVzRGlELCBkID0+IGRbbWluWVZhcl0pXG4gICAgKTtcbiAgICBtYXhZID0gTWF0aC5tYXgoXG4gICAgICBkMy5tYXgocmVzU3ludGgsIGQgPT4gZFttYXhZVmFyXSksXG4gICAgICBkMy5tYXgocmVzRGlELCBkID0+IGRbbWF4WVZhcl0pXG4gICAgKTtcbiAgfSBlbHNlIGlmIChjdHJsU3BlY0RpRCA9PT0gJ25vbmUnICYmIGN0cmxTcGVjU3ludGggIT09ICdub25lJykge1xuICAgIG1pblggPSBkMy5taW4ocmVzU3ludGgsIGQgPT4gZFthZ2dYXSk7XG4gICAgbWF4WCA9IGQzLm1heChyZXNTeW50aCwgZCA9PiBkW2FnZ1hdKTtcbiAgICBtaW5ZID0gZDMubWluKHJlc1N5bnRoLCBkID0+IGRbbWluWVZhcl0pO1xuICAgIG1heFkgPSBkMy5tYXgocmVzU3ludGgsIGQgPT4gZFttYXhZVmFyXSk7XG4gIH0gZWxzZSBpZiAoY3RybFNwZWNEaUQgIT09ICdub25lJyAmJiBjdHJsU3BlY1N5bnRoID09PSAnbm9uZScpIHtcbiAgICBtaW5YID0gZDMubWluKHJlc0RpRCwgZCA9PiBkW2FnZ1hdKTtcbiAgICBtYXhYID0gZDMubWF4KHJlc0RpRCwgZCA9PiBkW2FnZ1hdKTtcbiAgICBtaW5ZID0gZDMubWluKHJlc0RpRCwgZCA9PiBkW21pbllWYXJdKTtcbiAgICBtYXhZID0gZDMubWF4KHJlc0RpRCwgZCA9PiBkW21heFlWYXJdKTtcbiAgfVxuXG4gIGlmIChcbiAgICBvdmVybGF5SzEyICYmIHNlbGVjdGVkT3V0Y29tZSAhPT0gJ2UwMjdfZWxlbV9lZHVjX2RpcmVjdF9leHAnXG4gICAgICAmJiAhKGN0cmxTcGVjRGlEID09PSAnbm9uZScgJiYgY3RybFNwZWNTeW50aCA9PT0gJ25vbmUnKVxuICApIHtcbiAgICBtaW5ZID0gTWF0aC5taW4obWluWSwgZDMubWluKHJlc0sxMiwgZCA9PiBkLmF0dCkpO1xuICAgIG1heFkgPSBNYXRoLm1heChtYXhZLCBkMy5tYXgocmVzSzEyLCBkID0+IGQuYXR0KSk7XG4gIH1cblxuICAvLy8vIERlZmluZSBzY2FsZSBmdW5jdGlvbnMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuICBjb25zdCB4ID0gZDMuc2NhbGVMaW5lYXIoKVxuICAgIC5kb21haW4oW21pblgsIG1heFhdKVxuICAgIC5yYW5nZShbbWFyZ2luLmxlZnQsIHdpZHRoIC0gbWFyZ2luLnJpZ2h0XSk7XG4gIGNvbnN0IHkgPSBkMy5zY2FsZUxpbmVhcigpXG4gICAgLmRvbWFpbihbbWluWSwgbWF4WV0pXG4gICAgLnJhbmdlKFtoZWlnaHQgLSBtYXJnaW4uYm90dG9tLCBtYXJnaW4udG9wXSlcbiAgICAubmljZSgpO1xuICBcbiAgLy8gUGFyZW50IFNWRyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbiAgY29uc3Qgc3ZnID0gZDMuY3JlYXRlKCdzdmcnKVxuICAgIC5hdHRyKCd3aWR0aCcsIHdpZHRoKVxuICAgIC5hdHRyKCdoZWlnaHQnLCBoZWlnaHQpO1xuXG4gIC8vIEF4ZXMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4gIGNvbnN0IHhBeGlzID0gZDMuYXhpc0JvdHRvbSh4KVxuICAgIC50aWNrcyh0aWNrTnVtWClcbiAgICAudGlja0Zvcm1hdChkMy5mb3JtYXQoJ2QnKSk7XG4gIGNvbnN0IHlBeGlzID0gZDMuYXhpc0xlZnQoeSlcbiAgICAudGlja3ModGlja051bVkpO1xuXG4gIHN2Zy5hcHBlbmQoJ2cnKVxuICAgIC5hdHRyKCd0cmFuc2Zvcm0nLCBgdHJhbnNsYXRlKDAsICR7aGVpZ2h0IC0gbWFyZ2luLmJvdHRvbX0pYClcbiAgICAuY2FsbCh4QXhpcylcbiAgICAuc2VsZWN0QWxsKCcudGljayB0ZXh0JylcbiAgICAuYXR0cignZm9udC1zaXplJywgJzEycHgnKTtcbiAgc3ZnLmFwcGVuZCgnZycpXG4gICAgLmF0dHIoJ3RyYW5zZm9ybScsIGB0cmFuc2xhdGUoJHttYXJnaW4ubGVmdH0sIDApYClcbiAgICAuY2FsbCh5QXhpcylcbiAgICAuc2VsZWN0QWxsKCcudGljayB0ZXh0JylcbiAgICAuYXR0cignZm9udC1zaXplJywgJzEycHgnKTtcbiAgXG4gIC8vIEhvcml6b250YWwgTGluZSBhdCB5ID0gMCA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4gIHN2Zy5hcHBlbmQoJ2xpbmUnKVxuICAgIC5hdHRyKCdzdHJva2Utd2lkdGgnLCAyKVxuICAgIC5hdHRyKCdzdHJva2UnLCAnYmxhY2snKVxuICAgIC5hdHRyKCd4MScsIHgobWluWCkpXG4gICAgLmF0dHIoJ3gyJywgeChtYXhYKSlcbiAgICAuYXR0cigneTEnLCB5KDApKVxuICAgIC5hdHRyKCd5MicsIHkoMCkpXG4gIFxuICAvLyBUcmVhdCBZZWFyIFZlcnRpY2FsIExpbmUgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuICBpZiAoL15lcz8kfGV2ZW50Ly50ZXN0KGFnZ1R5cGUpKSB7XG4gICAgc3ZnLmFwcGVuZCgnbGluZScpXG4gICAgICAuYXR0cignc3Ryb2tlLXdpZHRoJywgMilcbiAgICAgIC5hdHRyKCdzdHJva2UnLCAnYmxhY2snKVxuICAgICAgLmF0dHIoJ3N0cm9rZS1kYXNoYXJyYXknLCA1KVxuICAgICAgLmF0dHIoJ3gxJywgeCgtMSkpXG4gICAgICAuYXR0cigneDInLCB4KC0xKSlcbiAgICAgIC5hdHRyKCd5MScsIG1hcmdpbi50b3ApXG4gICAgICAuYXR0cigneTInLCBoZWlnaHQgLSBtYXJnaW4uYm90dG9tKTtcbiAgfVxuXG4gIC8vIFJlc3VsdHMgTGluZXMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4gIGNvbnN0IGxpbmUgPSBkMy5saW5lKClcbiAgICAuZGVmaW5lZChkID0+ICFpc05hTihkWzFdKSAmIGRbMV0gIT09IHVuZGVmaW5lZCAmIGRbMV0gIT09IG51bGwpO1xuICBcbiAgbGV0IGNpID0gbnVsbDtcbiAgaWYgKHNob3dDSSkge1xuICAgIGNpID0gZDMuYXJlYSgpXG4gICAgICAuZGVmaW5lZChkID0+ICFpc05hTihkWzFdKSAmIGRbMV0gIT09IHVuZGVmaW5lZCAmIGRbMV0gIT09IG51bGwpXG4gICAgICAueChkID0+IGRbMF0pXG4gICAgICAueTAoZCA9PiBkWzRdKVxuICAgICAgLnkxKGQgPT4gZFszXSlcbiAgfVxuXG4gIC8vLy8gU3ludGggLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gIGNvbnN0IHBvaW50c1N5bnRoID0gcmVzU3ludGgubWFwKGQgPT4gXG4gICAgW3goZFthZ2dYXSksIHkoZC5hdHQpLCBkLnRyZWF0X2dyb3VwLCB5KGQuY2lfbG93KSwgeShkLmNpX3VwKV1cbiAgKTtcbiAgY29uc3QgZ3JvdXBzU3ludGggPSBkMy5ncm91cChwb2ludHNTeW50aCwgZCA9PiBkWzJdKTtcblxuICAvLyBDb25maWRlbmNlIGludGVydmFsXG4gIGlmIChzaG93Q0kpIHtcbiAgICBzdmcuYXBwZW5kKCdnJylcbiAgICAgIC5hdHRyKCdmaWxsJywgJ3NwcmluZ2dyZWVuJylcbiAgICAgIC5hdHRyKCdvcGFjaXR5JywgMC4yNSlcbiAgICAgIC5hdHRyKCdzdHJva2UnLCAnbm9uZScpXG4gICAgICAuc2VsZWN0QWxsKCdwYXRoJylcbiAgICAgIC5kYXRhKGdyb3Vwc1N5bnRoLnZhbHVlcygpKVxuICAgICAgLmpvaW4oJ3BhdGgnKVxuICAgICAgLmF0dHIoJ2QnLCBjaSk7XG4gIH1cblxuICAvLyBBVFRcbiAgc3ZnLmFwcGVuZCgnZycpXG4gICAgLmF0dHIoJ2ZpbGwnLCAnbm9uZScpXG4gICAgLmF0dHIoJ3N0cm9rZS13aWR0aCcsIDMuNSlcbiAgICAuYXR0cignc3Ryb2tlLWxpbmVqb2luJywgJ3JvdW5kJylcbiAgICAuYXR0cignc3Ryb2tlJywgJ3NwcmluZ2dyZWVuJylcbiAgICAuc2VsZWN0QWxsKCdwYXRoJylcbiAgICAuZGF0YShncm91cHNTeW50aC52YWx1ZXMoKSlcbiAgICAuam9pbigncGF0aCcpXG4gICAgLmF0dHIoJ2QnLCBsaW5lKTtcbiAgXG4gIC8vLy8gRGlEIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gIGNvbnN0IHBvaW50c0RpRCA9IHJlc0RpRC5tYXAoZCA9PiBcbiAgICBbeChkW2FnZ1hdKSwgeShkLmF0dCksIGQudHJlYXRfZ3JvdXAsIHkoZC5jaV9sb3cpLCB5KGQuY2lfdXApXVxuICApO1xuICBjb25zdCBncm91cHNEaUQgPSBkMy5ncm91cChwb2ludHNEaUQsIGQgPT4gZFsyXSk7XG5cbiAgLy8gQ29uZmlkZW5jZSBpbnRlcnZhbFxuICBpZiAoc2hvd0NJKSB7XG4gICAgc3ZnLmFwcGVuZCgnZycpXG4gICAgICAuYXR0cignZmlsbCcsICdkZWVwc2t5Ymx1ZScpXG4gICAgICAuYXR0cignb3BhY2l0eScsIDAuMjUpXG4gICAgICAuYXR0cignc3Ryb2tlJywgJ25vbmUnKVxuICAgICAgLnNlbGVjdEFsbCgncGF0aCcpXG4gICAgICAuZGF0YShncm91cHNEaUQudmFsdWVzKCkpXG4gICAgICAuam9pbigncGF0aCcpXG4gICAgICAuYXR0cignZCcsIGNpKTtcbiAgfVxuICBcbiAgLy8gQVRUXG4gIHN2Zy5hcHBlbmQoJ2cnKVxuICAgIC5hdHRyKCdmaWxsJywgJ25vbmUnKVxuICAgIC5hdHRyKCdzdHJva2Utd2lkdGgnLCAzLjUpXG4gICAgLmF0dHIoJ3N0cm9rZS1saW5lam9pbicsICdyb3VuZCcpXG4gICAgLmF0dHIoJ3N0cm9rZScsICdkZWVwc2t5Ymx1ZScpXG4gICAgLnNlbGVjdEFsbCgncGF0aCcpXG4gICAgLmRhdGEoZ3JvdXBzRGlELnZhbHVlcygpKVxuICAgIC5qb2luKCdwYXRoJylcbiAgICAuYXR0cignZCcsIGxpbmUpO1xuXG4gIC8vLy8gSy0xMiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gIGlmIChcbiAgICBvdmVybGF5SzEyICYmIHNlbGVjdGVkT3V0Y29tZSAhPT0gJ2UwMjdfZWxlbV9lZHVjX2RpcmVjdF9leHAnXG4gICAgICAmJiAhKGN0cmxTcGVjRGlEID09PSAnbm9uZScgJiYgY3RybFNwZWNTeW50aCA9PT0gJ25vbmUnKVxuICApIHtcbiAgICBjb25zdCBwb2ludHNLMTIgPSByZXNLMTIubWFwKGQgPT4gW3goZFthZ2dYXSksIHkoZC5hdHQpLCBkLmlkXSk7XG4gICAgY29uc3QgZ3JvdXBzSzEyID0gZDMucm9sbHVwKFxuICAgICAgcG9pbnRzSzEyLCB2ID0+IE9iamVjdC5hc3NpZ24odiwge2lkOiB2WzBdWzJdfSksIGQgPT4gZFsyXVxuICAgICk7XG4gICAgY29uc3QgcGF0aEsxMiA9IHN2Zy5hcHBlbmQoJ2cnKVxuICAgICAgLmF0dHIoJ2ZpbGwnLCAnbm9uZScpXG4gICAgICAuYXR0cignc3Ryb2tlLXdpZHRoJywgMy41KVxuICAgICAgLmF0dHIoJ3N0cm9rZS1saW5lam9pbicsICdyb3VuZCcpXG4gICAgICAuYXR0cignc3Ryb2tlLW9wYWNpdHknLCAuNzUpXG4gICAgICAuYXR0cignc3Ryb2tlLWRhc2hhcnJheScsIDUpXG4gICAgICAuc2VsZWN0QWxsKCdwYXRoJylcbiAgICAgIC5kYXRhKGdyb3Vwc0sxMi52YWx1ZXMoKSlcbiAgICAgIC5qb2luKCdwYXRoJylcbiAgICAgIC5hdHRyKCdkJywgbGluZSlcbiAgICAgIC5hdHRyKCdzdHJva2UnLCAoe2lkfSkgPT4gaWQgPT09ICdzeW50aCcgPyAnc3ByaW5nZ3JlZW4nIDogJ2RlZXBza3libHVlJyk7XG4gIH1cbiAgXG4gIC8vIFRpdGxlID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4gIGNvbnN0IHRpdGxlID0gL15lcz8kfGV2ZW50Ly50ZXN0KGFnZ1R5cGUpID8gXG4gICAgJ0V2ZW50IFN0dWR5JyA6ICdFZmZlY3RzIGJ5IFllYXInO1xuICBzdmcuYXBwZW5kKCd0ZXh0JylcbiAgICAuYXR0cigneCcsIHdpZHRoIC8gMilcbiAgICAuYXR0cigneScsIG1hcmdpbi50b3AgLSAyKVxuICAgIC5hdHRyKCd0ZXh0LWFuY2hvcicsICdtaWRkbGUnKVxuICAgIC5zdHlsZSgnZm9udC1zaXplJywgJzE0cHgnKVxuICAgIC50ZXh0KHRpdGxlKTtcblxuICByZXR1cm4gc3ZnLm5vZGUoKTtcbn1cbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtNTIiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJtb2RlbFJlc3VsdHMgPyBwbG90QWdnUmVzdWx0cygnZScpIDogcGxvdEFnZ1RyZW5kcygnZScpO1xuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC01MyIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6Im1vZGVsUmVzdWx0cyA/IHBsb3RBZ2dSZXN1bHRzKCdjYWwnKSA6IHBsb3RBZ2dUcmVuZHMoJ2NhbCcpO1xuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC01NCIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6Im1vZGVsUmVzdWx0cyA/IHBsb3RSZXN1bHRzKHRyZWF0R3JvdXBJZHNbMF0pIDogcGxvdFRyZW5kcyh0cmVhdEdyb3VwSWRzWzBdKTtcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtNTUiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJtb2RlbFJlc3VsdHMgPyBwbG90UmVzdWx0cyh0cmVhdEdyb3VwSWRzWzFdKSA6IHBsb3RUcmVuZHModHJlYXRHcm91cElkc1sxXSk7XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTU2IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoibW9kZWxSZXN1bHRzID8gcGxvdFJlc3VsdHModHJlYXRHcm91cElkc1syXSkgOiBwbG90VHJlbmRzKHRyZWF0R3JvdXBJZHNbMl0pO1xuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC01NyIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6Im1vZGVsUmVzdWx0cyA/IHBsb3RSZXN1bHRzKHRyZWF0R3JvdXBJZHNbM10pIDogcGxvdFRyZW5kcyh0cmVhdEdyb3VwSWRzWzNdKTtcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtNTgiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJtb2RlbFJlc3VsdHMgPyBwbG90UmVzdWx0cyh0cmVhdEdyb3VwSWRzWzRdKSA6IHBsb3RUcmVuZHModHJlYXRHcm91cElkc1s0XSk7XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTU5IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoibW9kZWxSZXN1bHRzID8gcGxvdFJlc3VsdHModHJlYXRHcm91cElkc1s1XSkgOiBwbG90VHJlbmRzKHRyZWF0R3JvdXBJZHNbNV0pO1xuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC02MCIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6Im1vZGVsUmVzdWx0cyA/IHBsb3RSZXN1bHRzKHRyZWF0R3JvdXBJZHNbNl0pIDogcGxvdFRyZW5kcyh0cmVhdEdyb3VwSWRzWzZdKTtcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtNjEiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJtb2RlbFJlc3VsdHMgPyBwbG90UmVzdWx0cyh0cmVhdEdyb3VwSWRzWzddKSA6IHBsb3RUcmVuZHModHJlYXRHcm91cElkc1s3XSk7XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTYyIiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoibW9kZWxSZXN1bHRzID8gcGxvdFJlc3VsdHModHJlYXRHcm91cElkc1s4XSkgOiBwbG90VHJlbmRzKHRyZWF0R3JvdXBJZHNbOF0pO1xuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC02MyIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6Im1vZGVsUmVzdWx0cyA/IHBsb3RSZXN1bHRzKHRyZWF0R3JvdXBJZHNbOV0pIDogcGxvdFRyZW5kcyh0cmVhdEdyb3VwSWRzWzldKTtcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtNjQiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJtb2RlbFJlc3VsdHMgPyBwbG90UmVzdWx0cyh0cmVhdEdyb3VwSWRzWzEwXSkgOiBwbG90VHJlbmRzKHRyZWF0R3JvdXBJZHNbMTBdKTtcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtNjUiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJ7XG4gIGlmIChzdGFja2VkICE9PSAnbm8nKSB7XG4gICAgaWYgKE51bWJlcih0cmVhdEdyb3VwSWRzWzExXSkgKyBOdW1iZXIoc3RhY2tlZCkgLSAxIDw9IDIwMTkpIHtcbiAgICAgIHJldHVybiBtb2RlbFJlc3VsdHMgPyBcbiAgICAgICAgcGxvdFJlc3VsdHModHJlYXRHcm91cElkc1sxMV0pIDogcGxvdFRyZW5kcyh0cmVhdEdyb3VwSWRzWzExXSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiAnJztcbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIG1vZGVsUmVzdWx0cyA/IFxuICAgICAgcGxvdFJlc3VsdHModHJlYXRHcm91cElkc1sxMV0pIDogcGxvdFRyZW5kcyh0cmVhdEdyb3VwSWRzWzExXSk7XG4gIH1cbn1cbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtNjYiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJ7XG4gIGlmIChzdGFja2VkICE9PSAnbm8nKSB7XG4gICAgaWYgKE51bWJlcih0cmVhdEdyb3VwSWRzWzEyXSkgKyBOdW1iZXIoc3RhY2tlZCkgLSAxIDw9IDIwMTkpIHtcbiAgICAgIHJldHVybiBtb2RlbFJlc3VsdHMgPyBcbiAgICAgICAgcGxvdFJlc3VsdHModHJlYXRHcm91cElkc1sxMl0pIDogcGxvdFRyZW5kcyh0cmVhdEdyb3VwSWRzWzEyXSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiAnJztcbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIG1vZGVsUmVzdWx0cyA/IFxuICAgICAgcGxvdFJlc3VsdHModHJlYXRHcm91cElkc1sxMl0pIDogcGxvdFRyZW5kcyh0cmVhdEdyb3VwSWRzWzEyXSk7XG4gIH1cbn1cbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtNjciLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJ7XG4gIGlmIChzdGFja2VkICE9PSAnbm8nKSB7XG4gICAgaWYgKE51bWJlcih0cmVhdEdyb3VwSWRzWzEzXSkgKyBOdW1iZXIoc3RhY2tlZCkgLSAxIDw9IDIwMTkpIHtcbiAgICAgIHJldHVybiBtb2RlbFJlc3VsdHMgPyBcbiAgICAgICAgcGxvdFJlc3VsdHModHJlYXRHcm91cElkc1sxM10pIDogcGxvdFRyZW5kcyh0cmVhdEdyb3VwSWRzWzEzXSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiAnJztcbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIG1vZGVsUmVzdWx0cyA/IFxuICAgICAgcGxvdFJlc3VsdHModHJlYXRHcm91cElkc1sxM10pIDogcGxvdFRyZW5kcyh0cmVhdEdyb3VwSWRzWzEzXSk7XG4gIH1cbn1cbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtNjgiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJ7XG4gIGlmICh0cmVhdEdyb3VwSWRzLmxlbmd0aCA+IDE0KSB7XG4gICAgaWYgKHN0YWNrZWQgIT09ICdubycpIHtcbiAgICAgIGlmIChOdW1iZXIodHJlYXRHcm91cElkc1sxNF0pICsgTnVtYmVyKHN0YWNrZWQpIC0gMSA8PSAyMDE5KSB7XG4gICAgICAgIHJldHVybiBtb2RlbFJlc3VsdHMgPyBcbiAgICAgICAgICBwbG90UmVzdWx0cyh0cmVhdEdyb3VwSWRzWzE0XSkgOiBwbG90VHJlbmRzKHRyZWF0R3JvdXBJZHNbMTRdKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiAnJztcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIG1vZGVsUmVzdWx0cyA/IFxuICAgICAgICBwbG90UmVzdWx0cyh0cmVhdEdyb3VwSWRzWzE0XSkgOiBwbG90VHJlbmRzKHRyZWF0R3JvdXBJZHNbMTRdKTtcbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuICcnO1xuICB9XG59XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTY5IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoie1xuICBpZiAodHJlYXRHcm91cElkcy5sZW5ndGggPiAxNSkge1xuICAgIGlmIChzdGFja2VkICE9PSAnbm8nKSB7XG4gICAgICBpZiAoTnVtYmVyKHRyZWF0R3JvdXBJZHNbMTVdKSArIE51bWJlcihzdGFja2VkKSAtIDEgPD0gMjAxOSkge1xuICAgICAgICByZXR1cm4gbW9kZWxSZXN1bHRzID8gXG4gICAgICAgICAgcGxvdFJlc3VsdHModHJlYXRHcm91cElkc1sxNV0pIDogcGxvdFRyZW5kcyh0cmVhdEdyb3VwSWRzWzE1XSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gJyc7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBtb2RlbFJlc3VsdHMgPyBcbiAgICAgICAgcGxvdFJlc3VsdHModHJlYXRHcm91cElkc1sxNV0pIDogcGxvdFRyZW5kcyh0cmVhdEdyb3VwSWRzWzE1XSk7XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIHJldHVybiAnJztcbiAgfVxufVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC03MCIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6IntcbiAgaWYgKHRyZWF0R3JvdXBJZHMubGVuZ3RoID4gMTYpIHtcbiAgICBpZiAoc3RhY2tlZCAhPT0gJ25vJykge1xuICAgICAgaWYgKE51bWJlcih0cmVhdEdyb3VwSWRzWzE2XSkgKyBOdW1iZXIoc3RhY2tlZCkgLSAxIDw9IDIwMTkpIHtcbiAgICAgICAgcmV0dXJuIG1vZGVsUmVzdWx0cyA/IFxuICAgICAgICAgIHBsb3RSZXN1bHRzKHRyZWF0R3JvdXBJZHNbMTZdKSA6IHBsb3RUcmVuZHModHJlYXRHcm91cElkc1sxNl0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuICcnO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gbW9kZWxSZXN1bHRzID8gXG4gICAgICAgIHBsb3RSZXN1bHRzKHRyZWF0R3JvdXBJZHNbMTZdKSA6IHBsb3RUcmVuZHModHJlYXRHcm91cElkc1sxNl0pO1xuICAgIH1cbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gJyc7XG4gIH1cbn1cbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtNzEiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJ7XG4gIGlmICh0cmVhdEdyb3VwSWRzLmxlbmd0aCA+IDE3KSB7XG4gICAgaWYgKHN0YWNrZWQgIT09ICdubycpIHtcbiAgICAgIGlmIChOdW1iZXIodHJlYXRHcm91cElkc1sxN10pICsgTnVtYmVyKHN0YWNrZWQpIC0gMSA8PSAyMDE5KSB7XG4gICAgICAgIHJldHVybiBtb2RlbFJlc3VsdHMgPyBcbiAgICAgICAgICBwbG90UmVzdWx0cyh0cmVhdEdyb3VwSWRzWzE3XSkgOiBwbG90VHJlbmRzKHRyZWF0R3JvdXBJZHNbMTddKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiAnJztcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIG1vZGVsUmVzdWx0cyA/IFxuICAgICAgICBwbG90UmVzdWx0cyh0cmVhdEdyb3VwSWRzWzE3XSkgOiBwbG90VHJlbmRzKHRyZWF0R3JvdXBJZHNbMTddKTtcbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuICcnO1xuICB9XG59XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTcyIiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoie1xuICBpZiAoc3RhY2tlZCAhPT0gJ25vJykge1xuICAgIGlmIChOdW1iZXIodHJlYXRTdFllYXJzWzBdKSArIE51bWJlcihzdGFja2VkKSAtIDEgPD0gMjAxOSkge1xuICAgICAgcmV0dXJuIG1vZGVsUmVzdWx0cyA/IFxuICAgICAgICBwbG90UmVzdWx0cyh0cmVhdFN0SWRzWzBdKSA6IHBsb3RUcmVuZHModHJlYXRTdElkc1swXSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiAnJztcbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIG1vZGVsUmVzdWx0cyA/IHBsb3RSZXN1bHRzKHRyZWF0U3RJZHNbMF0pIDogcGxvdFRyZW5kcyh0cmVhdFN0SWRzWzBdKTtcbiAgfVxufVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC03MyIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6IntcbiAgaWYgKHN0YWNrZWQgIT09ICdubycpIHtcbiAgICBpZiAoTnVtYmVyKHRyZWF0U3RZZWFyc1sxXSkgKyBOdW1iZXIoc3RhY2tlZCkgLSAxIDw9IDIwMTkpIHtcbiAgICAgIHJldHVybiBtb2RlbFJlc3VsdHMgPyBcbiAgICAgICAgcGxvdFJlc3VsdHModHJlYXRTdElkc1sxXSkgOiBwbG90VHJlbmRzKHRyZWF0U3RJZHNbMV0pO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gJyc7XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIHJldHVybiBtb2RlbFJlc3VsdHMgPyBwbG90UmVzdWx0cyh0cmVhdFN0SWRzWzFdKSA6IHBsb3RUcmVuZHModHJlYXRTdElkc1sxXSk7XG4gIH1cbn1cbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtNzQiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJ7XG4gIGlmIChzdGFja2VkICE9PSAnbm8nKSB7XG4gICAgaWYgKE51bWJlcih0cmVhdFN0WWVhcnNbMl0pICsgTnVtYmVyKHN0YWNrZWQpIC0gMSA8PSAyMDE5KSB7XG4gICAgICByZXR1cm4gbW9kZWxSZXN1bHRzID8gXG4gICAgICAgIHBsb3RSZXN1bHRzKHRyZWF0U3RJZHNbMl0pIDogcGxvdFRyZW5kcyh0cmVhdFN0SWRzWzJdKTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuICcnO1xuICAgIH1cbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gbW9kZWxSZXN1bHRzID8gcGxvdFJlc3VsdHModHJlYXRTdElkc1syXSkgOiBwbG90VHJlbmRzKHRyZWF0U3RJZHNbMl0pO1xuICB9XG59XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTc1IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoie1xuICBpZiAoc3RhY2tlZCAhPT0gJ25vJykge1xuICAgIGlmIChOdW1iZXIodHJlYXRTdFllYXJzWzNdKSArIE51bWJlcihzdGFja2VkKSAtIDEgPD0gMjAxOSkge1xuICAgICAgcmV0dXJuIG1vZGVsUmVzdWx0cyA/IFxuICAgICAgICBwbG90UmVzdWx0cyh0cmVhdFN0SWRzWzNdKSA6IHBsb3RUcmVuZHModHJlYXRTdElkc1szXSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiAnJztcbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIG1vZGVsUmVzdWx0cyA/IHBsb3RSZXN1bHRzKHRyZWF0U3RJZHNbM10pIDogcGxvdFRyZW5kcyh0cmVhdFN0SWRzWzNdKTtcbiAgfVxufVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC03NiIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6IntcbiAgaWYgKHN0YWNrZWQgIT09ICdubycpIHtcbiAgICBpZiAoTnVtYmVyKHRyZWF0U3RZZWFyc1s0XSkgKyBOdW1iZXIoc3RhY2tlZCkgLSAxIDw9IDIwMTkpIHtcbiAgICAgIHJldHVybiBtb2RlbFJlc3VsdHMgPyBcbiAgICAgICAgcGxvdFJlc3VsdHModHJlYXRTdElkc1s0XSkgOiBwbG90VHJlbmRzKHRyZWF0U3RJZHNbNF0pO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gJyc7XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIHJldHVybiBtb2RlbFJlc3VsdHMgPyBwbG90UmVzdWx0cyh0cmVhdFN0SWRzWzRdKSA6IHBsb3RUcmVuZHModHJlYXRTdElkc1s0XSk7XG4gIH1cbn1cbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtNzciLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJ7XG4gIGlmIChzdGFja2VkICE9PSAnbm8nKSB7XG4gICAgaWYgKE51bWJlcih0cmVhdFN0WWVhcnNbNV0pICsgTnVtYmVyKHN0YWNrZWQpIC0gMSA8PSAyMDE5KSB7XG4gICAgICByZXR1cm4gbW9kZWxSZXN1bHRzID8gXG4gICAgICAgIHBsb3RSZXN1bHRzKHRyZWF0U3RJZHNbNV0pIDogcGxvdFRyZW5kcyh0cmVhdFN0SWRzWzVdKTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuICcnO1xuICAgIH1cbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gbW9kZWxSZXN1bHRzID8gcGxvdFJlc3VsdHModHJlYXRTdElkc1s1XSkgOiBwbG90VHJlbmRzKHRyZWF0U3RJZHNbNV0pO1xuICB9XG59XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTc4IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoie1xuICBpZiAoc3RhY2tlZCAhPT0gJ25vJykge1xuICAgIGlmIChOdW1iZXIodHJlYXRTdFllYXJzWzZdKSArIE51bWJlcihzdGFja2VkKSAtIDEgPD0gMjAxOSkge1xuICAgICAgcmV0dXJuIG1vZGVsUmVzdWx0cyA/IFxuICAgICAgICBwbG90UmVzdWx0cyh0cmVhdFN0SWRzWzZdKSA6IHBsb3RUcmVuZHModHJlYXRTdElkc1s2XSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiAnJztcbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIG1vZGVsUmVzdWx0cyA/IHBsb3RSZXN1bHRzKHRyZWF0U3RJZHNbNl0pIDogcGxvdFRyZW5kcyh0cmVhdFN0SWRzWzZdKTtcbiAgfVxufVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC03OSIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6IntcbiAgaWYgKHN0YWNrZWQgIT09ICdubycpIHtcbiAgICBpZiAoTnVtYmVyKHRyZWF0U3RZZWFyc1s3XSkgKyBOdW1iZXIoc3RhY2tlZCkgLSAxIDw9IDIwMTkpIHtcbiAgICAgIHJldHVybiBtb2RlbFJlc3VsdHMgPyBcbiAgICAgICAgcGxvdFJlc3VsdHModHJlYXRTdElkc1s3XSkgOiBwbG90VHJlbmRzKHRyZWF0U3RJZHNbN10pO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gJyc7XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIHJldHVybiBtb2RlbFJlc3VsdHMgPyBwbG90UmVzdWx0cyh0cmVhdFN0SWRzWzddKSA6IHBsb3RUcmVuZHModHJlYXRTdElkc1s3XSk7XG4gIH1cbn1cbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtODAiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJ7XG4gIGlmIChzdGFja2VkICE9PSAnbm8nKSB7XG4gICAgaWYgKE51bWJlcih0cmVhdFN0WWVhcnNbOF0pICsgTnVtYmVyKHN0YWNrZWQpIC0gMSA8PSAyMDE5KSB7XG4gICAgICByZXR1cm4gbW9kZWxSZXN1bHRzID8gXG4gICAgICAgIHBsb3RSZXN1bHRzKHRyZWF0U3RJZHNbOF0pIDogcGxvdFRyZW5kcyh0cmVhdFN0SWRzWzhdKTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuICcnO1xuICAgIH1cbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gbW9kZWxSZXN1bHRzID8gcGxvdFJlc3VsdHModHJlYXRTdElkc1s4XSkgOiBwbG90VHJlbmRzKHRyZWF0U3RJZHNbOF0pO1xuICB9XG59XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTgxIiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoie1xuICBpZiAoc3RhY2tlZCAhPT0gJ25vJykge1xuICAgIGlmIChOdW1iZXIodHJlYXRTdFllYXJzWzldKSArIE51bWJlcihzdGFja2VkKSAtIDEgPD0gMjAxOSkge1xuICAgICAgcmV0dXJuIG1vZGVsUmVzdWx0cyA/IFxuICAgICAgICBwbG90UmVzdWx0cyh0cmVhdFN0SWRzWzldKSA6IHBsb3RUcmVuZHModHJlYXRTdElkc1s5XSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiAnJztcbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIG1vZGVsUmVzdWx0cyA/IHBsb3RSZXN1bHRzKHRyZWF0U3RJZHNbOV0pIDogcGxvdFRyZW5kcyh0cmVhdFN0SWRzWzldKTtcbiAgfVxufVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC04MiIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6IntcbiAgaWYgKHN0YWNrZWQgIT09ICdubycpIHtcbiAgICBpZiAoTnVtYmVyKHRyZWF0U3RZZWFyc1sxMF0pICsgTnVtYmVyKHN0YWNrZWQpIC0gMSA8PSAyMDE5KSB7XG4gICAgICByZXR1cm4gbW9kZWxSZXN1bHRzID8gXG4gICAgICAgIHBsb3RSZXN1bHRzKHRyZWF0U3RJZHNbMTBdKSA6IHBsb3RUcmVuZHModHJlYXRTdElkc1sxMF0pO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gJyc7XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIHJldHVybiBtb2RlbFJlc3VsdHMgPyBwbG90UmVzdWx0cyh0cmVhdFN0SWRzWzEwXSkgOiBwbG90VHJlbmRzKHRyZWF0U3RJZHNbMTBdKTtcbiAgfVxufVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC04MyIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6IntcbiAgaWYgKHN0YWNrZWQgIT09ICdubycpIHtcbiAgICBpZiAoTnVtYmVyKHRyZWF0U3RZZWFyc1sxMV0pICsgTnVtYmVyKHN0YWNrZWQpIC0gMSA8PSAyMDE5KSB7XG4gICAgICByZXR1cm4gbW9kZWxSZXN1bHRzID8gXG4gICAgICAgIHBsb3RSZXN1bHRzKHRyZWF0U3RJZHNbMTFdKSA6IHBsb3RUcmVuZHModHJlYXRTdElkc1sxMV0pO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gJyc7XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIHJldHVybiBtb2RlbFJlc3VsdHMgPyBwbG90UmVzdWx0cyh0cmVhdFN0SWRzWzExXSkgOiBwbG90VHJlbmRzKHRyZWF0U3RJZHNbMTFdKTtcbiAgfVxufVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC04NCIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6IntcbiAgaWYgKHN0YWNrZWQgIT09ICdubycpIHtcbiAgICBpZiAoTnVtYmVyKHRyZWF0U3RZZWFyc1sxMl0pICsgTnVtYmVyKHN0YWNrZWQpIC0gMSA8PSAyMDE5KSB7XG4gICAgICByZXR1cm4gbW9kZWxSZXN1bHRzID8gXG4gICAgICAgIHBsb3RSZXN1bHRzKHRyZWF0U3RJZHNbMTJdKSA6IHBsb3RUcmVuZHModHJlYXRTdElkc1sxMl0pO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gJyc7XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIHJldHVybiBtb2RlbFJlc3VsdHMgPyBwbG90UmVzdWx0cyh0cmVhdFN0SWRzWzEyXSkgOiBwbG90VHJlbmRzKHRyZWF0U3RJZHNbMTJdKTtcbiAgfVxufVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC04NSIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6IntcbiAgaWYgKHN0YWNrZWQgIT09ICdubycpIHtcbiAgICBpZiAoTnVtYmVyKHRyZWF0U3RZZWFyc1sxM10pICsgTnVtYmVyKHN0YWNrZWQpIC0gMSA8PSAyMDE5KSB7XG4gICAgICByZXR1cm4gbW9kZWxSZXN1bHRzID8gXG4gICAgICAgIHBsb3RSZXN1bHRzKHRyZWF0U3RJZHNbMTNdKSA6IHBsb3RUcmVuZHModHJlYXRTdElkc1sxM10pO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gJyc7XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIHJldHVybiBtb2RlbFJlc3VsdHMgPyBwbG90UmVzdWx0cyh0cmVhdFN0SWRzWzEzXSkgOiBwbG90VHJlbmRzKHRyZWF0U3RJZHNbMTNdKTtcbiAgfVxufVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC04NiIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6IntcbiAgaWYgKHN0YWNrZWQgIT09ICdubycpIHtcbiAgICBpZiAoTnVtYmVyKHRyZWF0U3RZZWFyc1sxNF0pICsgTnVtYmVyKHN0YWNrZWQpIC0gMSA8PSAyMDE5KSB7XG4gICAgICByZXR1cm4gbW9kZWxSZXN1bHRzID8gXG4gICAgICAgIHBsb3RSZXN1bHRzKHRyZWF0U3RJZHNbMTRdKSA6IHBsb3RUcmVuZHModHJlYXRTdElkc1sxNF0pO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gJyc7XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIHJldHVybiBtb2RlbFJlc3VsdHMgPyBwbG90UmVzdWx0cyh0cmVhdFN0SWRzWzE0XSkgOiBwbG90VHJlbmRzKHRyZWF0U3RJZHNbMTRdKTtcbiAgfVxufVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC04NyIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6IntcbiAgaWYgKHN0YWNrZWQgIT09ICdubycpIHtcbiAgICBpZiAoTnVtYmVyKHRyZWF0U3RZZWFyc1sxNV0pICsgTnVtYmVyKHN0YWNrZWQpIC0gMSA8PSAyMDE5KSB7XG4gICAgICByZXR1cm4gbW9kZWxSZXN1bHRzID8gXG4gICAgICAgIHBsb3RSZXN1bHRzKHRyZWF0U3RJZHNbMTVdKSA6IHBsb3RUcmVuZHModHJlYXRTdElkc1sxNV0pO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gJyc7XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIHJldHVybiBtb2RlbFJlc3VsdHMgPyBwbG90UmVzdWx0cyh0cmVhdFN0SWRzWzE1XSkgOiBwbG90VHJlbmRzKHRyZWF0U3RJZHNbMTVdKTtcbiAgfVxufVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC04OCIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6IntcbiAgaWYgKHN0YWNrZWQgIT09ICdubycpIHtcbiAgICBpZiAoTnVtYmVyKHRyZWF0U3RZZWFyc1sxNl0pICsgTnVtYmVyKHN0YWNrZWQpIC0gMSA8PSAyMDE5KSB7XG4gICAgICByZXR1cm4gbW9kZWxSZXN1bHRzID8gXG4gICAgICAgIHBsb3RSZXN1bHRzKHRyZWF0U3RJZHNbMTZdKSA6IHBsb3RUcmVuZHModHJlYXRTdElkc1sxNl0pO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gJyc7XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIHJldHVybiBtb2RlbFJlc3VsdHMgPyBwbG90UmVzdWx0cyh0cmVhdFN0SWRzWzE2XSkgOiBwbG90VHJlbmRzKHRyZWF0U3RJZHNbMTZdKTtcbiAgfVxufVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC04OSIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6IntcbiAgaWYgKHN0YWNrZWQgIT09ICdubycpIHtcbiAgICBpZiAoTnVtYmVyKHRyZWF0U3RZZWFyc1sxN10pICsgTnVtYmVyKHN0YWNrZWQpIC0gMSA8PSAyMDE5KSB7XG4gICAgICByZXR1cm4gbW9kZWxSZXN1bHRzID8gXG4gICAgICAgIHBsb3RSZXN1bHRzKHRyZWF0U3RJZHNbMTddKSA6IHBsb3RUcmVuZHModHJlYXRTdElkc1sxN10pO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gJyc7XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIHJldHVybiBtb2RlbFJlc3VsdHMgPyBwbG90UmVzdWx0cyh0cmVhdFN0SWRzWzE3XSkgOiBwbG90VHJlbmRzKHRyZWF0U3RJZHNbMTddKTtcbiAgfVxufVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC05MCIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6IntcbiAgaWYgKHN0YWNrZWQgIT09ICdubycpIHtcbiAgICBpZiAoTnVtYmVyKHRyZWF0U3RZZWFyc1sxOF0pICsgTnVtYmVyKHN0YWNrZWQpIC0gMSA8PSAyMDE5KSB7XG4gICAgICByZXR1cm4gbW9kZWxSZXN1bHRzID8gXG4gICAgICAgIHBsb3RSZXN1bHRzKHRyZWF0U3RJZHNbMThdKSA6IHBsb3RUcmVuZHModHJlYXRTdElkc1sxOF0pO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gJyc7XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIHJldHVybiBtb2RlbFJlc3VsdHMgPyBwbG90UmVzdWx0cyh0cmVhdFN0SWRzWzE4XSkgOiBwbG90VHJlbmRzKHRyZWF0U3RJZHNbMThdKTtcbiAgfVxufVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC05MSIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6IntcbiAgaWYgKHN0YWNrZWQgIT09ICdubycpIHtcbiAgICBpZiAoTnVtYmVyKHRyZWF0U3RZZWFyc1sxOV0pICsgTnVtYmVyKHN0YWNrZWQpIC0gMSA8PSAyMDE5KSB7XG4gICAgICByZXR1cm4gbW9kZWxSZXN1bHRzID8gXG4gICAgICAgIHBsb3RSZXN1bHRzKHRyZWF0U3RJZHNbMTldKSA6IHBsb3RUcmVuZHModHJlYXRTdElkc1sxOV0pO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gJyc7XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIHJldHVybiBtb2RlbFJlc3VsdHMgPyBwbG90UmVzdWx0cyh0cmVhdFN0SWRzWzE5XSkgOiBwbG90VHJlbmRzKHRyZWF0U3RJZHNbMTldKTtcbiAgfVxufVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC05MiIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6IntcbiAgaWYgKHN0YWNrZWQgIT09ICdubycpIHtcbiAgICBpZiAoTnVtYmVyKHRyZWF0U3RZZWFyc1syMF0pICsgTnVtYmVyKHN0YWNrZWQpIC0gMSA8PSAyMDE5KSB7XG4gICAgICByZXR1cm4gbW9kZWxSZXN1bHRzID8gXG4gICAgICAgIHBsb3RSZXN1bHRzKHRyZWF0U3RJZHNbMjBdKSA6IHBsb3RUcmVuZHModHJlYXRTdElkc1syMF0pO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gJyc7XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIHJldHVybiBtb2RlbFJlc3VsdHMgPyBwbG90UmVzdWx0cyh0cmVhdFN0SWRzWzIwXSkgOiBwbG90VHJlbmRzKHRyZWF0U3RJZHNbMjBdKTtcbiAgfVxufVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC05MyIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6IntcbiAgaWYgKHN0YWNrZWQgIT09ICdubycpIHtcbiAgICBpZiAoTnVtYmVyKHRyZWF0U3RZZWFyc1syMV0pICsgTnVtYmVyKHN0YWNrZWQpIC0gMSA8PSAyMDE5KSB7XG4gICAgICByZXR1cm4gbW9kZWxSZXN1bHRzID8gXG4gICAgICAgIHBsb3RSZXN1bHRzKHRyZWF0U3RJZHNbMjFdKSA6IHBsb3RUcmVuZHModHJlYXRTdElkc1syMV0pO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gJyc7XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIHJldHVybiBtb2RlbFJlc3VsdHMgPyBwbG90UmVzdWx0cyh0cmVhdFN0SWRzWzIxXSkgOiBwbG90VHJlbmRzKHRyZWF0U3RJZHNbMjFdKTtcbiAgfVxufVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC05NCIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6IntcbiAgaWYgKHRyZWF0U3RJZHMubGVuZ3RoID4gMjIpIHtcbiAgICBpZiAoc3RhY2tlZCAhPT0gJ25vJykge1xuICAgICAgaWYgKE51bWJlcih0cmVhdFN0WWVhcnNbMjJdKSArIE51bWJlcihzdGFja2VkKSAtIDEgPD0gMjAxOSkge1xuICAgICAgICByZXR1cm4gbW9kZWxSZXN1bHRzID8gXG4gICAgICAgICAgcGxvdFJlc3VsdHModHJlYXRTdElkc1syMl0pIDogcGxvdFRyZW5kcyh0cmVhdFN0SWRzWzIyXSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gJyc7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBtb2RlbFJlc3VsdHMgPyBwbG90UmVzdWx0cyh0cmVhdFN0SWRzWzIyXSkgOiBwbG90VHJlbmRzKHRyZWF0U3RJZHNbMjJdKTtcbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuICcnO1xuICB9XG59XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTk1IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoie1xuICBpZiAodHJlYXRTdElkcy5sZW5ndGggPiAyMykge1xuICAgIGlmIChzdGFja2VkICE9PSAnbm8nKSB7XG4gICAgICBpZiAoTnVtYmVyKHRyZWF0U3RZZWFyc1syM10pICsgTnVtYmVyKHN0YWNrZWQpIC0gMSA8PSAyMDE5KSB7XG4gICAgICAgIHJldHVybiBtb2RlbFJlc3VsdHMgPyBcbiAgICAgICAgICBwbG90UmVzdWx0cyh0cmVhdFN0SWRzWzIzXSkgOiBwbG90VHJlbmRzKHRyZWF0U3RJZHNbMjNdKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiAnJztcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIG1vZGVsUmVzdWx0cyA/IHBsb3RSZXN1bHRzKHRyZWF0U3RJZHNbMjNdKSA6IHBsb3RUcmVuZHModHJlYXRTdElkc1syM10pO1xuICAgIH1cbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gJyc7XG4gIH1cbn1cbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtOTYiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJ7XG4gIGlmICh0cmVhdFN0SWRzLmxlbmd0aCA+IDI0KSB7XG4gICAgaWYgKHN0YWNrZWQgIT09ICdubycpIHtcbiAgICAgIGlmIChOdW1iZXIodHJlYXRTdFllYXJzWzI0XSkgKyBOdW1iZXIoc3RhY2tlZCkgLSAxIDw9IDIwMTkpIHtcbiAgICAgICAgcmV0dXJuIG1vZGVsUmVzdWx0cyA/IFxuICAgICAgICAgIHBsb3RSZXN1bHRzKHRyZWF0U3RJZHNbMjRdKSA6IHBsb3RUcmVuZHModHJlYXRTdElkc1syNF0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuICcnO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gbW9kZWxSZXN1bHRzID8gcGxvdFJlc3VsdHModHJlYXRTdElkc1syNF0pIDogcGxvdFRyZW5kcyh0cmVhdFN0SWRzWzI0XSk7XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIHJldHVybiAnJztcbiAgfVxufVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC05NyIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6IntcbiAgaWYgKHRyZWF0U3RJZHMubGVuZ3RoID4gMjUpIHtcbiAgICBpZiAoc3RhY2tlZCAhPT0gJ25vJykge1xuICAgICAgaWYgKE51bWJlcih0cmVhdFN0WWVhcnNbMjVdKSArIE51bWJlcihzdGFja2VkKSAtIDEgPD0gMjAxOSkge1xuICAgICAgICByZXR1cm4gbW9kZWxSZXN1bHRzID8gXG4gICAgICAgICAgcGxvdFJlc3VsdHModHJlYXRTdElkc1syNV0pIDogcGxvdFRyZW5kcyh0cmVhdFN0SWRzWzI1XSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gJyc7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBtb2RlbFJlc3VsdHMgPyBwbG90UmVzdWx0cyh0cmVhdFN0SWRzWzI1XSkgOiBwbG90VHJlbmRzKHRyZWF0U3RJZHNbMjVdKTtcbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuICcnO1xuICB9XG59XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTk4IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoie1xuICBpZiAodHJlYXRTdElkcy5sZW5ndGggPiAyNikge1xuICAgIGlmIChzdGFja2VkICE9PSAnbm8nKSB7XG4gICAgICBpZiAoTnVtYmVyKHRyZWF0U3RZZWFyc1syNl0pICsgTnVtYmVyKHN0YWNrZWQpIC0gMSA8PSAyMDE5KSB7XG4gICAgICAgIHJldHVybiBtb2RlbFJlc3VsdHMgPyBcbiAgICAgICAgICBwbG90UmVzdWx0cyh0cmVhdFN0SWRzWzI2XSkgOiBwbG90VHJlbmRzKHRyZWF0U3RJZHNbMjZdKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiAnJztcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIG1vZGVsUmVzdWx0cyA/IHBsb3RSZXN1bHRzKHRyZWF0U3RJZHNbMjZdKSA6IHBsb3RUcmVuZHModHJlYXRTdElkc1syNl0pO1xuICAgIH1cbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gJyc7XG4gIH1cbn1cbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtOTkiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJ7XG4gIGlmICh0cmVhdFN0SWRzLmxlbmd0aCA+IDI3KSB7XG4gICAgaWYgKHN0YWNrZWQgIT09ICdubycpIHtcbiAgICAgIGlmIChOdW1iZXIodHJlYXRTdFllYXJzWzI3XSkgKyBOdW1iZXIoc3RhY2tlZCkgLSAxIDw9IDIwMTkpIHtcbiAgICAgICAgcmV0dXJuIG1vZGVsUmVzdWx0cyA/IFxuICAgICAgICAgIHBsb3RSZXN1bHRzKHRyZWF0U3RJZHNbMjddKSA6IHBsb3RUcmVuZHModHJlYXRTdElkc1syN10pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuICcnO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gbW9kZWxSZXN1bHRzID8gcGxvdFJlc3VsdHModHJlYXRTdElkc1syN10pIDogcGxvdFRyZW5kcyh0cmVhdFN0SWRzWzI3XSk7XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIHJldHVybiAnJztcbiAgfVxufVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0xMDAiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJ7XG4gIGlmICh0cmVhdFN0SWRzLmxlbmd0aCA+IDI4KSB7XG4gICAgaWYgKHN0YWNrZWQgIT09ICdubycpIHtcbiAgICAgIGlmIChOdW1iZXIodHJlYXRTdFllYXJzWzI4XSkgKyBOdW1iZXIoc3RhY2tlZCkgLSAxIDw9IDIwMTkpIHtcbiAgICAgICAgcmV0dXJuIG1vZGVsUmVzdWx0cyA/IFxuICAgICAgICAgIHBsb3RSZXN1bHRzKHRyZWF0U3RJZHNbMjhdKSA6IHBsb3RUcmVuZHModHJlYXRTdElkc1syOF0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuICcnO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gbW9kZWxSZXN1bHRzID8gcGxvdFJlc3VsdHModHJlYXRTdElkc1syOF0pIDogcGxvdFRyZW5kcyh0cmVhdFN0SWRzWzI4XSk7XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIHJldHVybiAnJztcbiAgfVxufVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0xMDEiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiInJztcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldFF1aWV0Iiwic291cmNlIjoic2hpbnlJbnB1dCgnc2VsZWN0ZWRPdXRjb21lJykifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXRRdWlldCIsInNvdXJjZSI6InNoaW55SW5wdXQoJ292ZXJsYXlLMTInKSJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldFF1aWV0Iiwic291cmNlIjoic2hpbnlJbnB1dCgndHJlYXRTcGVjJykifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXRRdWlldCIsInNvdXJjZSI6InNoaW55SW5wdXQoJ3N0YWNrZWQnKSJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldFF1aWV0Iiwic291cmNlIjoic2hpbnlJbnB1dCgnc2hvd0RpRCcpIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0UXVpZXQiLCJzb3VyY2UiOiJzaGlueUlucHV0KCdzaG93U3ludGgnKSJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldFF1aWV0Iiwic291cmNlIjoic2hpbnlJbnB1dCgnbW9kZWxSZXN1bHRzJykifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXRRdWlldCIsInNvdXJjZSI6InNoaW55SW5wdXQoJ3Nob3dDSScpIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0UXVpZXQiLCJzb3VyY2UiOiJzaGlueUlucHV0KCdtb2RTcGVjRGlEJykifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXRRdWlldCIsInNvdXJjZSI6InNoaW55SW5wdXQoJ3Nob3dTdWJncm91cHMnKSJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldFF1aWV0Iiwic291cmNlIjoic2hpbnlJbnB1dCgnc3ViZ3JvdXBzVG9TaG93JykifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXRRdWlldCIsInNvdXJjZSI6InNoaW55SW5wdXQoJ2Ryb3BBSycpIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0UXVpZXQiLCJzb3VyY2UiOiJzaGlueUlucHV0KCdjb25zaXN0ZW50QXhlcycpIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0UXVpZXQiLCJzb3VyY2UiOiJzaGlueUlucHV0KCdmZScpIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0UXVpZXQiLCJzb3VyY2UiOiJzaGlueUlucHV0KCdzb3J0Q2hyb25vJykifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXRRdWlldCIsInNvdXJjZSI6InNoaW55SW5wdXQoJ3N5bnRoQ3RybE1hZ25pZmllcicpIn1dfQ==
</script>
<script type="module">
if (window.location.protocol === "file:") { alert("The OJS runtime does not work with file:// URLs. Please use a web server to view this document."); }
window._ojs.paths.runtimeToDoc = "../../..";
window._ojs.paths.runtimeToRoot = "../../..";
window._ojs.paths.docToRoot = "";
window._ojs.selfContained = false;
window._ojs.runtime.interpretFromScriptTags();
</script>
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /container fluid -->

<script type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (_event) {
  if (window.bslib.Card) {
    window.bslib.Card.initializeAllCards();
  }
}); 
</script>
  



</body></html>